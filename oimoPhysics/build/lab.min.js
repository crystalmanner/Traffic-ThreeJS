'use strict';var view,demos,o3dgc,process,THREE,WebGL2RenderingContext,TextDecoder,performance,ImageBitmap,createImageBitmap,fetch,CodeMirror,getComputedStyle,define,require,requirejs,esprima,exports,module;(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define(b):a.CodeMirror=b()})(this,function(){function a(m){return RegExp("(^|\\s)"+m+"(?:$|\\s)\\s*")}function b(m){for(var a=m.childNodes.length;0<a;--a)m.removeChild(m.firstChild);return m}function c(m,a){return b(m).appendChild(a)}function d(m,a,p,h){m=document.createElement(m);p&&(m.className=p);h&&(m.style.cssText=h);if("string"==typeof a)m.appendChild(document.createTextNode(a));
else if(a)for(p=0;p<a.length;++p)m.appendChild(a[p]);return m}function g(m,a,p,h){m=d(m,a,p,h);m.setAttribute("role","presentation");return m}function e(m,a){3==a.nodeType&&(a=a.parentNode);if(m.contains)return m.contains(a);do if(11==a.nodeType&&(a=a.host),a==m)return!0;while(a=a.parentNode)}function l(){var m;try{m=document.activeElement}catch(a){m=document.body||null}for(;m&&m.shadowRoot&&m.shadowRoot.activeElement;)m=m.shadowRoot.activeElement;return m}function n(m,ja){var p=m.className;a(ja).test(p)||
(m.className+=(p?" ":"")+ja)}function B(m,ja){for(var p=m.split(" "),h=0;h<p.length;h++)p[h]&&!a(p[h]).test(ja)&&(ja+=" "+p[h]);return ja}function E(m){var a=Array.prototype.slice.call(arguments,1);return function(){return m.apply(null,a)}}function s(m,a,p){a||(a={});for(var h in m)!m.hasOwnProperty(h)||!1===p&&a.hasOwnProperty(h)||(a[h]=m[h]);return a}function D(m,a,p,h,b){null==a&&(a=m.search(/[^\s\u00a0]/),-1==a&&(a=m.length));h=h||0;for(b=b||0;;){var c=m.indexOf("\t",h);if(0>c||c>=a)return b+
(a-h);b+=c-h;b+=p-b%p;h=c+1}}function q(m,a){for(var p=0;p<m.length;++p)if(m[p]==a)return p;return-1}function O(m,a,p){for(var h=0,b=0;;){var c=m.indexOf("\t",h);-1==c&&(c=m.length);var f=c-h;if(c==m.length||b+f>=a)return h+Math.min(f,a-b);b+=c-h;b+=p-b%p;h=c+1;if(b>=a)return h}}function r(m){for(;hf.length<=m;)hf.push(I(hf)+" ");return hf[m]}function I(m){return m[m.length-1]}function F(m,a){for(var p=[],h=0;h<m.length;h++)p[h]=a(m[h],h);return p}function T(m,a,p){for(var h=0,b=p(a);h<m.length&&
p(m[h])<=b;)h++;m.splice(h,0,a)}function N(){}function $(m,a){var p;Object.create?p=Object.create(m):(N.prototype=m,p=new N);a&&s(a,p);return p}function L(m){return/\w/.test(m)||"\u0080"<m&&(m.toUpperCase()!=m.toLowerCase()||Zg.test(m))}function ka(m,a){return a?-1<a.source.indexOf("\\w")&&L(m)?!0:a.test(m):L(m)}function na(m){for(var a in m)if(m.hasOwnProperty(a)&&m[a])return!1;return!0}function Ja(m){return 768<=m.charCodeAt(0)&&sg.test(m)}function ea(m,a,p){for(;(0>p?0<a:a<m.length)&&Ja(m.charAt(a));)a+=
p;return a}function eb(m,a,p){for(;;){if(1>=Math.abs(a-p))return m(a)?a:p;var h=Math.floor((a+p)/2);m(h)?p=h:a=h}}function Ta(m,a,p){this.input=p;this.scrollbarFiller=d("div",null,"CodeMirror-scrollbar-filler");this.scrollbarFiller.setAttribute("cm-not-content","true");this.gutterFiller=d("div",null,"CodeMirror-gutter-filler");this.gutterFiller.setAttribute("cm-not-content","true");this.lineDiv=g("div",null,"CodeMirror-code");this.selectionDiv=d("div",null,null,"position: relative; z-index: 1");this.cursorDiv=
d("div",null,"CodeMirror-cursors");this.measure=d("div",null,"CodeMirror-measure");this.lineMeasure=d("div",null,"CodeMirror-measure");this.lineSpace=g("div",[this.measure,this.lineMeasure,this.selectionDiv,this.cursorDiv,this.lineDiv],null,"position: relative; outline: none");var h=g("div",[this.lineSpace],"CodeMirror-lines");this.mover=d("div",[h],null,"position: relative");this.sizer=d("div",[this.mover],"CodeMirror-sizer");this.sizerWidth=null;this.heightForcer=d("div",null,null,"position: absolute; height: "+
tg+"px; width: 1px;");this.gutters=d("div",null,"CodeMirror-gutters");this.lineGutter=null;this.scroller=d("div",[this.sizer,this.heightForcer,this.gutters],"CodeMirror-scroll");this.scroller.setAttribute("tabIndex","-1");this.wrapper=d("div",[this.scrollbarFiller,this.gutterFiller,this.scroller],"CodeMirror");Da&&8>Wa&&(this.gutters.style.zIndex=-1,this.scroller.style.paddingRight=0);vb||Vb&&td||(this.scroller.draggable=!0);m&&(m.appendChild?m.appendChild(this.wrapper):m(this.wrapper));this.reportedViewFrom=
this.reportedViewTo=this.viewFrom=this.viewTo=a.first;this.view=[];this.externalMeasured=this.renderedView=null;this.lastWrapHeight=this.lastWrapWidth=this.viewOffset=0;this.updateLineNumbers=null;this.nativeBarWidth=this.barHeight=this.barWidth=0;this.scrollbarsClipped=!1;this.lineNumWidth=this.lineNumInnerWidth=this.lineNumChars=null;this.alignWidgets=!1;this.maxLine=this.cachedCharWidth=this.cachedTextHeight=this.cachedPaddingH=null;this.maxLineLength=0;this.maxLineChanged=!1;this.wheelDX=this.wheelDY=
this.wheelStartX=this.wheelStartY=null;this.shift=!1;this.activeTouch=this.selForContextMenu=null;p.init(this)}function P(m,a){a-=m.first;if(0>a||a>=m.size)throw Error("There is no line "+(a+m.first)+" in the document.");for(var p=m;!p.lines;)for(var h=0;;++h){var b=p.children[h],c=b.chunkSize();if(a<c){p=b;break}a-=c}return p.lines[a]}function Pa(m,a,p){var h=[],b=a.line;m.iter(a.line,p.line+1,function(m){m=m.text;b==p.line&&(m=m.slice(0,p.ch));b==a.line&&(m=m.slice(a.ch));h.push(m);++b});return h}
function ya(m,a,p){var h=[];m.iter(a,p,function(m){h.push(m.text)});return h}function sa(m,a){var p=a-m.height;if(p)for(var h=m;h;h=h.parent)h.height+=p}function qa(m){if(null==m.parent)return null;var a=m.parent;m=q(a.lines,m);for(var p=a.parent;p;a=p,p=p.parent)for(var h=0;p.children[h]!=a;++h)m+=p.children[h].chunkSize();return m+a.first}function Ia(m,a){var p=m.first;a:do{for(var h=0;h<m.children.length;++h){var b=m.children[h],c=b.height;if(a<c){m=b;continue a}a-=c;p+=b.chunkSize()}return p}while(!m.lines);
for(h=0;h<m.lines.length;++h){b=m.lines[h].height;if(a<b)break;a-=b}return p+h}function Fa(m,a){return a>=m.first&&a<m.first+m.size}function Ea(m,a){return String(m.lineNumberFormatter(a+m.firstLineNumber))}function J(m,a,b){void 0===b&&(b=null);if(!(this instanceof J))return new J(m,a,b);this.line=m;this.ch=a;this.sticky=b}function Q(m,a){return m.line-a.line||m.ch-a.ch}function Ga(m,a){return m.sticky==a.sticky&&0==Q(m,a)}function Z(m){return J(m.line,m.ch)}function nb(m,a){return 0>Q(m,a)?a:m}
function xa(m,a){return 0>Q(m,a)?m:a}function K(m,a){if(a.line<m.first)return J(m.first,0);var b=m.first+m.size-1;if(a.line>b)return J(b,P(m,b).text.length);var b=P(m,a.line).text.length,h=a.ch,b=null==h||h>b?J(a.line,b):0>h?J(a.line,0):a;return b}function Qa(m,a){for(var b=[],h=0;h<a.length;h++)b[h]=K(m,a[h]);return b}function Xa(m,a,b){this.marker=m;this.from=a;this.to=b}function X(m,a){if(m)for(var b=0;b<m.length;++b){var h=m[b];if(h.marker==a)return h}}function Wb(m,a){if(a.full)return null;var b=
Fa(m,a.from.line)&&P(m,a.from.line).markedSpans,h=Fa(m,a.to.line)&&P(m,a.to.line).markedSpans;if(!b&&!h)return null;var w=a.from.ch,c=a.to.ch,f=0==Q(a.from,a.to),d;if(b)for(var k=0;k<b.length;++k){var e=b[k],g=e.marker;if(null==e.from||(g.inclusiveLeft?e.from<=w:e.from<w)||e.from==w&&!("bookmark"!=g.type||f&&e.marker.insertLeft)){var z=null==e.to||(g.inclusiveRight?e.to>=w:e.to>w);(d||(d=[])).push(new Xa(g,e.from,z?null:e.to))}}var b=d,x;if(h)for(d=0;d<h.length;++d)if(k=h[d],e=k.marker,null==k.to||
(e.inclusiveRight?k.to>=c:k.to>c)||k.from==c&&"bookmark"==e.type&&(!f||k.marker.insertLeft))g=null==k.from||(e.inclusiveLeft?k.from<=c:k.from<c),(x||(x=[])).push(new Xa(e,g?null:k.from-c,null==k.to?null:k.to-c));h=x;c=1==a.text.length;f=I(a.text).length+(c?w:0);if(b)for(x=0;x<b.length;++x)if(d=b[x],null==d.to)(k=X(h,d.marker),k)?c&&(d.to=null==k.to?null:k.to+f):d.to=w;if(h)for(w=0;w<h.length;++w)x=h[w],null!=x.to&&(x.to+=f),null==x.from?X(b,x.marker)||(x.from=f,c&&(b||(b=[])).push(x)):(x.from+=f,
c&&(b||(b=[])).push(x));b&&(b=Jc(b));h&&h!=b&&(h=Jc(h));w=[b];if(!c){var c=a.text.length-2,l;if(0<c&&b)for(f=0;f<b.length;++f)null==b[f].to&&(l||(l=[])).push(new Xa(b[f].marker,null,null));for(b=0;b<c;++b)w.push(l);w.push(h)}return w}function Jc(m){for(var a=0;a<m.length;++a){var b=m[a];null!=b.from&&b.from==b.to&&!1!==b.marker.clearWhenEmpty&&m.splice(a--,1)}return m.length?m:null}function aa(m,a,b){var h=null;m.iter(a.line,b.line+1,function(m){if(m.markedSpans)for(var a=0;a<m.markedSpans.length;++a){var ja=
m.markedSpans[a].marker;!ja.readOnly||h&&-1!=q(h,ja)||(h||(h=[])).push(ja)}});if(!h)return null;m=[{from:a,to:b}];for(a=0;a<h.length;++a){b=h[a];for(var w=b.find(0),c=0;c<m.length;++c){var f=m[c];if(!(0>Q(f.to,w.from)||0<Q(f.from,w.to))){var d=[c,1],k=Q(f.from,w.from),e=Q(f.to,w.to);(0>k||!b.inclusiveLeft&&!k)&&d.push({from:f.from,to:w.from});(0<e||!b.inclusiveRight&&!e)&&d.push({from:w.to,to:f.to});m.splice.apply(m,d);c+=d.length-3}}}return m}function Fb(m){var a=m.markedSpans;if(a){for(var b=0;b<
a.length;++b)a[b].marker.detachLine(m);m.markedSpans=null}}function Jb(m,a){if(a){for(var b=0;b<a.length;++b)a[b].marker.attachLine(m);m.markedSpans=a}}function fb(m,a){var b=m.lines.length-a.lines.length;if(0!=b)return b;var b=m.find(),h=a.find(),w=Q(b.from,h.from)||(m.inclusiveLeft?-1:0)-(a.inclusiveLeft?-1:0);return w?-w:(b=Q(b.to,h.to)||(m.inclusiveRight?1:0)-(a.inclusiveRight?1:0))?b:a.id-m.id}function hb(m,a){var b=$c&&m.markedSpans,h;if(b)for(var w=void 0,c=0;c<b.length;++c)w=b[c],w.marker.collapsed&&
null==(a?w.from:w.to)&&(!h||0>fb(h,w.marker))&&(h=w.marker);return h}function ib(m,a,b,h,w){m=P(m,a);if(m=$c&&m.markedSpans)for(a=0;a<m.length;++a){var c=m[a];if(c.marker.collapsed){var f=c.marker.find(0),d=Q(f.from,b)||(c.marker.inclusiveLeft?-1:0)-(w.inclusiveLeft?-1:0),k=Q(f.to,h)||(c.marker.inclusiveRight?1:0)-(w.inclusiveRight?1:0);if(!(0<=d&&0>=k||0>=d&&0<=k)&&(0>=d&&(c.marker.inclusiveRight&&w.inclusiveLeft?0<=Q(f.to,b):0<Q(f.to,b))||0<=d&&(c.marker.inclusiveRight&&w.inclusiveLeft?0>=Q(f.from,
h):0>Q(f.from,h))))return!0}}}function Bb(m){for(var a;a=hb(m,!0);)m=a.find(-1,!0).line;return m}function Kc(m,a){var b=P(m,a),h=Bb(b);return b==h?a:qa(h)}function Ac(m,a){if(a>m.lastLine())return a;var b=P(m,a),h;if(!wb(m,b))return a;for(;h=hb(b,!1);)b=h.find(1,!0).line;return qa(b)+1}function wb(m,a){var b=$c&&a.markedSpans;if(b)for(var h=void 0,w=0;w<b.length;++w)if(h=b[w],h.marker.collapsed&&(null==h.from||!h.marker.widgetNode&&0==h.from&&h.marker.inclusiveLeft&&ad(m,a,h)))return!0}function ad(m,
a,b){if(null==b.to)return a=b.marker.find(1,!0),ad(m,a.line,X(a.line.markedSpans,b.marker));if(b.marker.inclusiveRight&&b.to==a.text.length)return!0;for(var h=void 0,w=0;w<a.markedSpans.length;++w)if(h=a.markedSpans[w],h.marker.collapsed&&!h.marker.widgetNode&&h.from==b.to&&(null==h.to||h.to!=b.from)&&(h.marker.inclusiveLeft||b.marker.inclusiveRight)&&ad(m,a,h))return!0}function U(m){m=Bb(m);for(var a=0,b=m.parent,h=0;h<b.lines.length;++h){var w=b.lines[h];if(w==m)break;else a+=w.height}for(m=b.parent;m;b=
m,m=b.parent)for(h=0;h<m.children.length&&(w=m.children[h],w!=b);++h)a+=w.height;return a}function Na(m){if(0==m.height)return 0;for(var a=m.text.length,b,h=m;b=hb(h,!0);)b=b.find(0,!0),h=b.from.line,a+=b.from.ch-b.to.ch;for(h=m;b=hb(h,!1);)m=b.find(0,!0),a-=h.text.length-m.from.ch,h=m.to.line,a+=h.text.length-m.to.ch;return a}function pa(m){var a=m.display;m=m.doc;a.maxLine=P(m,m.first);a.maxLineLength=Na(a.maxLine);a.maxLineChanged=!0;m.iter(function(m){var b=Na(m);b>a.maxLineLength&&(a.maxLineLength=
b,a.maxLine=m)})}function Cb(m,a,b,h){if(!m)return h(a,b,"ltr");for(var w=!1,c=0;c<m.length;++c){var f=m[c];if(f.from<b&&f.to>a||a==b&&f.to==a)h(Math.max(f.from,a),Math.min(f.to,b),1==f.level?"rtl":"ltr"),w=!0}w||h(a,b,"ltr")}function ma(m,a,b){var h;ye=null;for(var w=0;w<m.length;++w){var c=m[w];if(c.from<a&&c.to>a)return w;c.to==a&&(c.from!=c.to&&"before"==b?h=w:ye=w);c.from==a&&(c.from!=c.to&&"before"!=b?h=w:ye=w)}return null!=h?h:ye}function ra(m,a){var b=m.order;null==b&&(b=m.order=$g(m.text,
a));return b}function Kb(m,a,b){a=ea(m.text,a+b,b);return 0>a||a>m.text.length?null:a}function Gb(m,a,b){m=Kb(m,a.ch,b);return null==m?null:new J(a.line,m,0>b?"after":"before")}function jb(m,a,b,h,w){if(m&&(m=ra(b,a.doc.direction))){m=0>w?I(m):m[0];var c=0>w==(1==m.level)?"after":"before",f;if(0<m.level){var d=Bc(a,b);f=0>w?b.text.length-1:0;var k=nc(a,d,f).top;f=eb(function(m){return nc(a,d,m).top==k},0>w==(1==m.level)?m.from:m.to-1,f);"before"==c&&(f=Kb(b,f,1))}else f=0>w?m.to:m.from;return new J(h,
f,c)}return new J(h,0>w?b.text.length:0,0>w?"before":"after")}function dc(m,a,b,h){var w=ra(a,m.doc.direction);if(!w)return Gb(a,b,h);b.ch>=a.text.length?(b.ch=a.text.length,b.sticky="before"):0>=b.ch&&(b.ch=0,b.sticky="after");var c=ma(w,b.ch,b.sticky),f=w[c];if("ltr"==m.doc.direction&&0==f.level%2&&(0<h?f.to>b.ch:f.from<b.ch))return Gb(a,b,h);var d=function(m,b){return Kb(a,m instanceof J?m.ch:m,b)},k,e=function(b){if(!m.options.lineWrapping)return{begin:0,end:a.text.length};var h=k=k||Bc(m,a);
b=Ka(m,a,nc(m,h,b),"line").top;return kf(m,a,h,b)},g=e("before"==b.sticky?d(b,-1):b.ch);if("rtl"==m.doc.direction||1==f.level){var z=1==f.level==0>h,x=d(b,z?1:-1);if(null!=x&&(z?x<=f.to&&x<=g.end:x>=f.from&&x>=g.begin))return new J(b.line,x,z?"before":"after")}f=function(m,a,ja){for(var h=function(m,a){return a?new J(b.line,d(m,1),"before"):new J(b.line,m,"after")};0<=m&&m<w.length;m+=a){var c=w[m],f=0<a==(1!=c.level),Va=f?ja.begin:d(ja.end,-1);if(c.from<=Va&&Va<c.to)return h(Va,f);Va=f?c.from:d(c.to,
-1);if(ja.begin<=Va&&Va<ja.end)return h(Va,f)}};if(c=f(c+h,h,g))return c;g=0<h?g.end:d(g.begin,-1);return null==g||0<h&&g==a.text.length||!(c=f(0<h?0:w.length-1,h,e(g)))?null:c}function ab(m,a,b){if(m.removeEventListener)m.removeEventListener(a,b,!1);else if(m.detachEvent)m.detachEvent("on"+a,b);else{var h=(m=m._handlers)&&m[a];h&&(b=q(h,b),-1<b&&(m[a]=h.slice(0,b).concat(h.slice(b+1))))}}function La(m,a){var b=m._handlers&&m._handlers[a]||mf;if(b.length)for(var h=Array.prototype.slice.call(arguments,
2),w=0;w<b.length;++w)b[w].apply(null,h)}function Aa(m,a,b){"string"==typeof a&&(a={type:a,preventDefault:function(){this.defaultPrevented=!0}});La(m,b||a.type,m,a);return ca(a)||a.codemirrorIgnore}function da(m){var a=m._handlers&&m._handlers.cursorActivity;if(a){m=m.curOp.cursorActivityHandlers||(m.curOp.cursorActivityHandlers=[]);for(var b=0;b<a.length;++b)-1==q(m,a[b])&&m.push(a[b])}}function ob(m,a){return 0<(m._handlers&&m._handlers[a]||mf).length}function V(m){m.prototype.on=function(m,a){ha(this,
m,a)};m.prototype.off=function(m,a){ab(this,m,a)}}function za(m){m.preventDefault?m.preventDefault():m.returnValue=!1}function ba(m){m.stopPropagation?m.stopPropagation():m.cancelBubble=!0}function ca(m){return null!=m.defaultPrevented?m.defaultPrevented:!1==m.returnValue}function gb(m){za(m);ba(m)}function kb(m){var a=m.which;null==a&&(m.button&1?a=1:m.button&2?a=3:m.button&4&&(a=2));ec&&m.ctrlKey&&1==a&&(a=3);return a}function M(m){if(null==Of){var a=d("span","\u200b");c(m,d("span",[a,document.createTextNode("x")]));
0!=m.firstChild.offsetHeight&&(Of=1>=a.offsetWidth&&2<a.offsetHeight&&!(Da&&8>Wa))}m=Of?d("span","\u200b"):d("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");m.setAttribute("cm-text","");return m}function pb(m,a){2<arguments.length&&(a.dependencies=Array.prototype.slice.call(arguments,2));Pf[m]=a}function R(m){if("string"==typeof m&&Lc.hasOwnProperty(m))m=Lc[m];else if(m&&"string"==typeof m.name&&Lc.hasOwnProperty(m.name)){var a=Lc[m.name];"string"==typeof a&&(a={name:a});
m=$(a,m);m.name=a.name}else{if("string"==typeof m&&/^[\w\-]+\/[\w\-]+\+xml$/.test(m))return R("application/xml");if("string"==typeof m&&/^[\w\-]+\/[\w\-]+\+json$/.test(m))return R("application/json")}return"string"==typeof m?{name:m}:m||{name:"null"}}function oa(m,a){a=R(a);var b=Pf[a.name];if(!b)return oa(m,"text/plain");b=b(m,a);if(Wd.hasOwnProperty(a.name)){var h=Wd[a.name],w;for(w in h)h.hasOwnProperty(w)&&(b.hasOwnProperty(w)&&(b["_"+w]=b[w]),b[w]=h[w])}b.name=a.name;a.helperType&&(b.helperType=
a.helperType);if(a.modeProps)for(var c in a.modeProps)b[c]=a.modeProps[c];return b}function A(m,a){var b=Wd.hasOwnProperty(m)?Wd[m]:Wd[m]={};s(a,b)}function fa(m,a){if(!0===a)return a;if(m.copyState)return m.copyState(a);var b={},h;for(h in a){var w=a[h];w instanceof Array&&(w=w.concat([]));b[h]=w}return b}function ga(m,a){for(var b;m.innerMode;){b=m.innerMode(a);if(!b||b.mode==m)break;a=b.state;m=b.mode}return b||{mode:m,state:a}}function Ha(m,a,b){return m.startState?m.startState(a,b):!0}function ia(m,
a,b,h){var w=[m.state.modeGen],c={};qb(m,a.text,m.doc.mode,b,function(m,a){return w.push(m,a)},c,h);b=function(b){var h=m.state.overlays[b],p=1,f=0;qb(m,a.text,h.mode,!0,function(m,a){for(var ja=p;f<m;){var b=w[p];b>m&&w.splice(p,1,m,w[p+1],b);p+=2;f=Math.min(m,b)}if(a)if(h.opaque)w.splice(ja,p-ja,m,"overlay "+a),p=ja+2;else for(;ja<p;ja+=2)b=w[ja+1],w[ja+1]=(b?b+" ":"")+"overlay "+a},c)};for(h=0;h<m.state.overlays.length;++h)b(h);return{styles:w,classes:c.bgClass||c.textClass?c:null}}function H(m,
a,b){if(!a.styles||a.styles[0]!=m.state.modeGen){var h=G(m,qa(a)),w=ia(m,a,a.text.length>m.options.maxHighlightLength?fa(m.doc.mode,h):h);a.stateAfter=h;a.styles=w.styles;w.classes?a.styleClasses=w.classes:a.styleClasses&&(a.styleClasses=null);b===m.doc.frontier&&m.doc.frontier++}return a.styles}function G(m,a,b){var h=m.doc,w=m.display;if(!h.mode.startState)return!0;var c=wh(m,a,b),d=c>h.first&&P(h,c-1).stateAfter,d=d?fa(h.mode,d):Ha(h.mode);h.iter(c,a,function(b){f(m,b.text,d);b.stateAfter=c==a-
1||0==c%5||c>=w.viewFrom&&c<w.viewTo?fa(h.mode,d):null;++c});b&&(h.frontier=c);return d}function f(m,a,b,h){var w=m.doc.mode;m=new rb(a,m.options.tabSize);m.start=m.pos=h||0;for(""==a&&k(w,b);!m.eol();)z(w,m,b),m.start=m.pos}function k(m,a){if(m.blankLine)return m.blankLine(a);if(m.innerMode){var b=ga(m,a);if(b.mode.blankLine)return b.mode.blankLine(b.state)}}function z(m,a,b,h){for(var w=0;10>w;w++){h&&(h[0]=ga(m,b).mode);var c=m.token(a,b);if(a.pos>a.start)return c}throw Error("Mode "+m.name+" failed to advance stream.");
}function x(m,a,b,h){var w=function(m){return{start:g.start,end:g.pos,string:g.current(),type:d||null,state:m?fa(c.mode,e):e}},c=m.doc,f=c.mode,d;a=K(c,a);var k=P(c,a.line),e=G(m,a.line,b),g=new rb(k.text,m.options.tabSize),x;for(h&&(x=[]);(h||g.pos<a.ch)&&!g.eol();)g.start=g.pos,d=z(f,g,e),h&&x.push(w(!0));return h?x:w()}function fc(m,a){if(m)for(;;){var b=m.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!b)break;m=m.slice(0,b.index)+m.slice(b.index+b[0].length);var h=b[1]?"bgClass":"textClass";null==
a[h]?a[h]=b[2]:RegExp("(?:^|s)"+b[2]+"(?:$|s)").test(a[h])||(a[h]+=" "+b[2])}return m}function qb(m,a,b,h,w,c,d){var e=b.flattenSpans;null==e&&(e=m.options.flattenSpans);var g=0,x=null,l=new rb(a,m.options.tabSize),n,s=m.options.addModeClass&&[null];for(""==a&&fc(k(b,h),c);!l.eol();){l.pos>m.options.maxHighlightLength?(e=!1,d&&f(m,a,h,l.pos),l.pos=a.length,n=null):n=fc(z(b,l,h,s),c);if(s){var q=s[0].name;q&&(n="m-"+(n?q+" "+n:q))}if(!e||x!=n){for(;g<l.start;)g=Math.min(l.start,g+5E3),w(g,x);x=n}l.start=
l.pos}for(;g<l.pos;)m=Math.min(l.pos,g+5E3),w(m,x),g=m}function wh(m,a,b){for(var h,w,c=m.doc,f=b?-1:a-(m.doc.mode.innerMode?1E3:100);a>f;--a){if(a<=c.first)return c.first;var d=P(c,a-1);if(d.stateAfter&&(!b||a<=c.frontier))return a;d=D(d.text,null,m.options.tabSize);if(null==w||h>d)w=a-1,h=d}return w}function ah(a,b){if(!a||/^\s*$/.test(a))return null;var p=b.addModeClass?bh:ug;return p[a]||(p[a]=a.replace(/\S+/g,"cm-$&"))}function ch(a,ja){var p=g("span",null,null,vb?"padding-right: .1px":null),
p={pre:g("pre",[p],"CodeMirror-line"),content:p,col:0,pos:0,cm:a,trailingSpace:!1,splitSpaces:(Da||vb)&&a.getOption("lineWrapping")};ja.measure={};for(var h=0;h<=(ja.rest?ja.rest.length:0);h++){var w=h?ja.rest[h-1]:ja.line,f=void 0;p.pos=0;p.addToken=dh;var d;d=a.display.measure;if(null!=Qf)d=Qf;else{var k=c(d,document.createTextNode("A\u062eA")),e=ud(k,0,1).getBoundingClientRect(),k=ud(k,1,2).getBoundingClientRect();b(d);d=e&&e.left!=e.right?Qf=3>k.right-e.right:!1}d&&(f=ra(w,a.doc.direction))&&
(p.addToken=eh(p.addToken,f));p.map=[];d=ja!=a.display.externalMeasured&&qa(w);a:{f=p;d=H(a,w,d);var z=w.markedSpans,e=w.text,k=0;if(z)for(var x=e.length,l=0,n=1,s="",q=void 0,D=void 0,r=0,E=void 0,A=void 0,fc=void 0,O=void 0,F=void 0;;){if(r==l){for(var E=A=fc=O=D="",F=null,r=Infinity,P=[],I=void 0,Z=0;Z<z.length;++Z){var qb=z[Z],K=qb.marker;"bookmark"==K.type&&qb.from==l&&K.widgetNode?P.push(K):qb.from<=l&&(null==qb.to||qb.to>l||K.collapsed&&qb.to==l&&qb.from==l)?(null!=qb.to&&qb.to!=l&&r>qb.to&&
(r=qb.to,A=""),K.className&&(E+=" "+K.className),K.css&&(D=(D?D+";":"")+K.css),K.startStyle&&qb.from==l&&(fc+=" "+K.startStyle),K.endStyle&&qb.to==r&&(I||(I=[])).push(K.endStyle,qb.to),K.title&&!O&&(O=K.title),K.collapsed&&(!F||0>fb(F.marker,K))&&(F=qb)):qb.from>l&&r>qb.from&&(r=qb.from)}if(I)for(Z=0;Z<I.length;Z+=2)I[Z+1]==r&&(A+=" "+I[Z]);if(!F||F.from==l)for(I=0;I<P.length;++I)Rf(f,0,P[I]);if(F&&(F.from||0)==l){Rf(f,(null==F.to?x+1:F.to)-l,F.marker,null==F.from);if(null==F.to)break a;F.to==l&&
(F=!1)}}if(l>=x)break;for(P=Math.min(x,r);;){if(s){I=l+s.length;F||(Z=I>P?s.slice(0,P-l):s,f.addToken(f,Z,q?q+E:E,fc,l+Z.length==r?A:"",O,D));if(I>=P){s=s.slice(P-l);l=P;break}l=I;fc=""}s=e.slice(k,k=d[n++]);q=ah(d[n++],f.cm.options)}}else for(z=1;z<d.length;z+=2)f.addToken(f,e.slice(k,k=d[z]),ah(d[z+1],f.cm.options))}w.styleClasses&&(w.styleClasses.bgClass&&(p.bgClass=B(w.styleClasses.bgClass,p.bgClass||"")),w.styleClasses.textClass&&(p.textClass=B(w.styleClasses.textClass,p.textClass||"")));0==
p.map.length&&p.map.push(0,0,p.content.appendChild(M(a.display.measure)));0==h?(ja.measure.map=p.map,ja.measure.cache={}):((ja.measure.maps||(ja.measure.maps=[])).push(p.map),(ja.measure.caches||(ja.measure.caches=[])).push({}))}vb&&(h=p.content.lastChild,/\bcm-tab\b/.test(h.className)||h.querySelector&&h.querySelector(".cm-tab"))&&(p.content.className="cm-tab-wrap-hack");La(a,"renderLine",a,ja.line,p.pre);p.pre.className&&(p.textClass=B(p.pre.className,p.textClass||""));return p}function yh(a){var b=
d("span","\u2022","cm-invalidchar");b.title="\\u"+a.charCodeAt(0).toString(16);b.setAttribute("aria-label",b.title);return b}function dh(a,b,p,h,w,c,f){if(b){var k;if(a.splitSpaces)if(k=a.trailingSpace,1<b.length&&!/  /.test(b))k=b;else{for(var e="",g=0;g<b.length;g++){var z=b.charAt(g);" "!=z||!k||g!=b.length-1&&32!=b.charCodeAt(g+1)||(z="\u00a0");e+=z;k=" "==z}k=e}else k=b;e=k;g=a.cm.state.specialChars;z=!1;if(g.test(b)){k=document.createDocumentFragment();for(var x=0;;){g.lastIndex=x;var l=g.exec(b),
n=l?l.index-x:b.length-x;if(n){var s=document.createTextNode(e.slice(x,x+n));Da&&9>Wa?k.appendChild(d("span",[s])):k.appendChild(s);a.map.push(a.pos,a.pos+n,s);a.col+=n;a.pos+=n}if(!l)break;x+=n+1;n=void 0;"\t"==l[0]?(l=a.cm.options.tabSize,l-=a.col%l,n=k.appendChild(d("span",r(l),"cm-tab")),n.setAttribute("role","presentation"),n.setAttribute("cm-text","\t"),a.col+=l):("\r"==l[0]||"\n"==l[0]?(n=k.appendChild(d("span","\r"==l[0]?"\u240d":"\u2424","cm-invalidchar")),n.setAttribute("cm-text",l[0])):
(n=a.cm.options.specialCharPlaceholder(l[0]),n.setAttribute("cm-text",l[0]),Da&&9>Wa?k.appendChild(d("span",[n])):k.appendChild(n)),a.col+=1);a.map.push(a.pos,a.pos+1,n);a.pos++}}else a.col+=b.length,k=document.createTextNode(e),a.map.push(a.pos,a.pos+b.length,k),Da&&9>Wa&&(z=!0),a.pos+=b.length;a.trailingSpace=32==e.charCodeAt(b.length-1);if(p||h||w||z||f)return b=p||"",h&&(b+=h),w&&(b+=w),h=d("span",[k],b,f),c&&(h.title=c),a.content.appendChild(h);a.content.appendChild(k)}}function eh(a,b){return function(p,
h,w,c,f,d,k){w=w?w+" cm-force-border":"cm-force-border";for(var e=p.pos,g=e+h.length;;){for(var z=void 0,x=0;x<b.length&&!(z=b[x],z.to>e&&z.from<=e);x++);if(z.to>=g)return a(p,h,w,c,f,d,k);a(p,h.slice(0,z.to-e),w,c,null,d,k);c=null;h=h.slice(z.to-e);e=z.to}}}function Rf(a,b,p,h){var w=!h&&p.widgetNode;w&&a.map.push(a.pos,a.pos+b,w);!h&&a.cm.display.input.needsContentAttribute&&(w||(w=a.content.appendChild(document.createElement("span"))),w.setAttribute("cm-marker",p.id));w&&(a.cm.display.input.setUneditable(w),
a.content.appendChild(w));a.pos+=b;a.trailingSpace=!1}function fh(a,b,p){for(var h=this.line=b,w;h=hb(h,!1);)h=h.find(1,!0).line,(w||(w=[])).push(h);this.size=(this.rest=w)?qa(I(this.rest))-p+1:1;this.node=this.text=null;this.hidden=wb(a,b)}function Sf(a,b,p){var h=[],w;for(w=b;w<p;)b=new fh(a.doc,P(a.doc,w),w),w+=b.size,h.push(b);return h}function zh(a,b){var p=a.ownsGroup;if(p)try{var h=p.delayedCallbacks,w=0;do{for(;w<h.length;w++)h[w].call(null);for(var c=0;c<p.ops.length;c++){var f=p.ops[c];
if(f.cursorActivityHandlers)for(;f.cursorActivityCalled<f.cursorActivityHandlers.length;)f.cursorActivityHandlers[f.cursorActivityCalled++].call(null,f.cm)}}while(w<h.length)}finally{Xd=null,b(p)}}function Db(a,b){var p=a._handlers&&a._handlers[b]||mf;if(p.length){var h=Array.prototype.slice.call(arguments,2),w;Xd?w=Xd.delayedCallbacks:ze?w=ze:(w=ze=[],setTimeout(nf,0));for(var c=function(a){w.push(function(){return p[a].apply(null,h)})},f=0;f<p.length;++f)c(f)}}function nf(){var a=ze;ze=null;for(var b=
0;b<a.length;++b)a[b]()}function wg(a,b,p,h){for(var w=0;w<b.changes.length;w++){var c=b.changes[w];if("text"==c){var c=a,f=b,d=f.text.className,k=xg(c,f);f.text==f.node&&(f.node=k.pre);f.text.parentNode.replaceChild(k.pre,f.text);f.text=k.pre;k.bgClass!=f.bgClass||k.textClass!=f.textClass?(f.bgClass=k.bgClass,f.textClass=k.textClass,yg(c,f)):d&&(f.text.className=d)}else if("gutter"==c)gh(a,b,p,h);else if("class"==c)yg(a,b);else if("widget"==c){c=a;f=b;d=h;f.alignable&&(f.alignable=null);for(var k=
f.node.firstChild,e=void 0;k;k=e)e=k.nextSibling,"CodeMirror-linewidget"==k.className&&f.node.removeChild(k);hh(c,f,d)}}b.changes=null}function Yd(a){a.node==a.text&&(a.node=d("div",null,null,"position: relative"),a.text.parentNode&&a.text.parentNode.replaceChild(a.node,a.text),a.node.appendChild(a.text),Da&&8>Wa&&(a.node.style.zIndex=2));return a.node}function xg(a,b){var p=a.display.externalMeasured;return p&&p.line==b.line?(a.display.externalMeasured=null,b.measure=p.measure,p.built):ch(a,b)}function yg(a,
b){var p=b.bgClass?b.bgClass+" "+(b.line.bgClass||""):b.line.bgClass;p&&(p+=" CodeMirror-linebackground");if(b.background)p?b.background.className=p:(b.background.parentNode.removeChild(b.background),b.background=null);else if(p){var h=Yd(b);b.background=h.insertBefore(d("div",null,p),h.firstChild);a.display.input.setUneditable(b.background)}b.line.wrapClass?Yd(b).className=b.line.wrapClass:b.node!=b.text&&(b.node.className="");b.text.className=(b.textClass?b.textClass+" "+(b.line.textClass||""):
b.line.textClass)||""}function gh(a,b,p,h){b.gutter&&(b.node.removeChild(b.gutter),b.gutter=null);b.gutterBackground&&(b.node.removeChild(b.gutterBackground),b.gutterBackground=null);if(b.line.gutterClass){var w=Yd(b);b.gutterBackground=d("div",null,"CodeMirror-gutter-background "+b.line.gutterClass,"left: "+(a.options.fixedGutter?h.fixedPos:-h.gutterTotalWidth)+"px; width: "+h.gutterTotalWidth+"px");a.display.input.setUneditable(b.gutterBackground);w.insertBefore(b.gutterBackground,b.text)}w=b.line.gutterMarkers;
if(a.options.lineNumbers||w){var c=Yd(b),f=b.gutter=d("div",null,"CodeMirror-gutter-wrapper","left: "+(a.options.fixedGutter?h.fixedPos:-h.gutterTotalWidth)+"px");a.display.input.setUneditable(f);c.insertBefore(f,b.text);b.line.gutterClass&&(f.className+=" "+b.line.gutterClass);!a.options.lineNumbers||w&&w["CodeMirror-linenumbers"]||(b.lineNumber=f.appendChild(d("div",Ea(a.options,p),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+h.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.display.lineNumInnerWidth+
"px")));if(w)for(b=0;b<a.options.gutters.length;++b)p=a.options.gutters[b],(c=w.hasOwnProperty(p)&&w[p])&&f.appendChild(d("div",[c],"CodeMirror-gutter-elt","left: "+h.gutterLeft[p]+"px; width: "+h.gutterWidth[p]+"px"))}}function Ah(a,b,p,h){var w=xg(a,b);b.text=b.node=w.pre;w.bgClass&&(b.bgClass=w.bgClass);w.textClass&&(b.textClass=w.textClass);yg(a,b);gh(a,b,p,h);hh(a,b,h);return b.node}function hh(a,b,p){ih(a,b.line,b,p,!0);if(b.rest)for(var h=0;h<b.rest.length;h++)ih(a,b.rest[h],b,p,!1)}function ih(a,
b,p,h,w){if(b.widgets){var c=Yd(p),f=0;for(b=b.widgets;f<b.length;++f){var k=b[f],e=d("div",[k.node],"CodeMirror-linewidget");k.handleMouseEvents||e.setAttribute("cm-ignore-events","true");var g=k,z=e,x=h;if(g.noHScroll){(p.alignable||(p.alignable=[])).push(z);var l=x.wrapperWidth;z.style.left=x.fixedPos+"px";g.coverGutter||(l-=x.gutterTotalWidth,z.style.paddingLeft=x.gutterTotalWidth+"px");z.style.width=l+"px"}g.coverGutter&&(z.style.zIndex=5,z.style.position="relative",g.noHScroll||(z.style.marginLeft=
-x.gutterTotalWidth+"px"));a.display.input.setUneditable(e);w&&k.above?c.insertBefore(e,p.gutter||p.text):c.appendChild(e);Db(k,"redraw")}}}function of(a){if(null!=a.height)return a.height;var b=a.doc.cm;if(!b)return 0;if(!e(document.body,a.node)){var p="position: relative;";a.coverGutter&&(p+="margin-left: -"+b.display.gutters.offsetWidth+"px;");a.noHScroll&&(p+="width: "+b.display.wrapper.clientWidth+"px;");c(b.display.measure,d("div",[a.node],null,p))}return a.height=a.node.parentNode.offsetHeight}
function Ya(a,b){for(var p=b.target||b.srcElement;p!=a.wrapper;p=p.parentNode)if(!p||1==p.nodeType&&"true"==p.getAttribute("cm-ignore-events")||p.parentNode==a.sizer&&p!=a.mover)return!0}function Ae(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}function Tf(a){if(a.cachedPaddingH)return a.cachedPaddingH;var b=c(a.measure,d("pre","x")),b=window.getComputedStyle?window.getComputedStyle(b):b.currentStyle,b={left:parseInt(b.paddingLeft),right:parseInt(b.paddingRight)};isNaN(b.left)||isNaN(b.right)||
(a.cachedPaddingH=b);return b}function Mc(a){return tg-a.display.nativeBarWidth}function Zd(a){return a.display.scroller.clientWidth-Mc(a)-a.display.barWidth}function Uf(a){return a.display.scroller.clientHeight-Mc(a)-a.display.barHeight}function Vf(a,b,p){if(a.line==b)return{map:a.measure.map,cache:a.measure.cache};for(var h=0;h<a.rest.length;h++)if(a.rest[h]==b)return{map:a.measure.maps[h],cache:a.measure.caches[h]};for(b=0;b<a.rest.length;b++)if(qa(a.rest[b])>p)return{map:a.measure.maps[b],cache:a.measure.caches[b],
before:!0}}function vd(a,b){if(b>=a.display.viewFrom&&b<a.display.viewTo)return a.display.view[Cc(a,b)];var p=a.display.externalMeasured;if(p&&b>=p.lineN&&b<p.lineN+p.size)return p}function Bc(a,b){var p=qa(b),h=vd(a,p);h&&!h.text?h=null:h&&h.changes&&(wg(a,h,p,wd(a)),a.curOp.forceUpdate=!0);if(!h){var w;w=Bb(b);h=qa(w);w=a.display.externalMeasured=new fh(a.doc,w,h);w.lineN=h;h=w.built=ch(a,w);w.text=h.pre;c(a.display.lineMeasure,h.pre);h=w}p=Vf(h,b,p);return{line:b,view:h,rect:null,map:p.map,cache:p.cache,
before:p.before,hasHeights:!1}}function nc(a,b,p,h,w){b.before&&(p=-1);var f=p+(h||"");if(b.cache.hasOwnProperty(f))a=b.cache[f];else{b.rect||(b.rect=b.view.text.getBoundingClientRect());if(!b.hasHeights){var k=b.view,e=b.rect,g=a.options.lineWrapping,z=g&&Zd(a);if(!k.measure.heights||g&&k.measure.width!=z){var x=k.measure.heights=[];if(g)for(k.measure.width=z,k=k.text.firstChild.getClientRects(),g=0;g<k.length-1;g++){var z=k[g],l=k[g+1];2<Math.abs(z.bottom-l.bottom)&&x.push((z.bottom+l.top)/2-e.top)}x.push(e.bottom-
e.top)}b.hasHeights=!0}x=h;k=bd(b.map,p,x);h=k.node;e=k.start;g=k.end;p=k.collapse;var n;if(3==h.nodeType){for(var s=0;4>s;s++){for(;e&&Ja(b.line.text.charAt(k.coverStart+e));)--e;for(;k.coverStart+g<k.coverEnd&&Ja(b.line.text.charAt(k.coverStart+g));)++g;if(Da&&9>Wa&&0==e&&g==k.coverEnd-k.coverStart)n=h.parentNode.getBoundingClientRect();else{n=ud(h,e,g).getClientRects();g=pf;if("left"==x)for(z=0;z<n.length&&(g=n[z]).left==g.right;z++);else for(z=n.length-1;0<=z&&(g=n[z]).left==g.right;z--);n=g}if(n.left||
n.right||0==e)break;g=e;e-=1;p="right"}if(Da&&11>Wa){if(s=window.screen)if(s=null!=screen.logicalXDPI)if(s=screen.logicalXDPI!=screen.deviceXDPI)null!=Wf?s=Wf:(x=c(a.display.measure,d("span","x")),s=x.getBoundingClientRect(),x=ud(x,0,1).getBoundingClientRect(),s=Wf=1<Math.abs(s.left-x.left));s&&(s=screen.logicalXDPI/screen.deviceXDPI,x=screen.logicalYDPI/screen.deviceYDPI,n={left:n.left*s,right:n.right*s,top:n.top*x,bottom:n.bottom*x})}}else 0<e&&(p=x="right"),n=a.options.lineWrapping&&1<(s=h.getClientRects()).length?
s["right"==x?s.length-1:0]:h.getBoundingClientRect();Da&&9>Wa&&!(e||n&&(n.left||n.right))&&(n=(n=h.parentNode.getClientRects()[0])?{left:n.left,right:n.left+cd(a.display),top:n.top,bottom:n.bottom}:pf);h=n.top-b.rect.top;e=n.bottom-b.rect.top;s=(h+e)/2;x=b.view.measure.heights;for(k=0;k<x.length-1&&!(s<x[k]);k++);p={left:("right"==p?n.right:n.left)-b.rect.left,right:("left"==p?n.left:n.right)-b.rect.left,top:k?x[k-1]:0,bottom:x[k]};n.left||n.right||(p.bogus=!0);a.options.singleCursorHeightPerLine||
(p.rtop=h,p.rbottom=e);a=p;a.bogus||(b.cache[f]=a)}return{left:a.left,right:a.right,top:w?a.rtop:a.top,bottom:w?a.rbottom:a.bottom}}function bd(a,b,p){for(var h,w,c,f,d,k,e=0;e<a.length;e+=3){d=a[e];k=a[e+1];if(b<d)w=0,c=1,f="left";else if(b<k)w=b-d,c=w+1;else if(e==a.length-3||b==k&&a[e+3]>b)c=k-d,w=c-1,b>=k&&(f="right");if(null!=w){h=a[e+2];d==k&&p==(h.insertLeft?"left":"right")&&(f=p);if("left"==p&&0==w)for(;e&&a[e-2]==a[e-3]&&a[e-1].insertLeft;)h=a[(e-=3)+2],f="left";if("right"==p&&w==k-d)for(;e<
a.length-3&&a[e+3]==a[e+4]&&!a[e+5].insertLeft;)h=a[(e+=3)+2],f="right";break}}return{node:h,start:w,end:c,collapse:f,coverStart:d,coverEnd:k}}function Be(a){if(a.measure&&(a.measure.cache={},a.measure.heights=null,a.rest))for(var b=0;b<a.rest.length;b++)a.measure.caches[b]={}}function Ce(a){a.display.externalMeasure=null;b(a.display.lineMeasure);for(var ja=0;ja<a.display.view.length;ja++)Be(a.display.view[ja])}function dd(a){Ce(a);a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=
null;a.options.lineWrapping||(a.display.maxLineChanged=!0);a.display.lineNumChars=null}function qf(){return rf&&ed?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function sf(){return rf&&ed?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Ka(a,b,p,
h,w){if(!w&&b.widgets)for(w=0;w<b.widgets.length;++w)if(b.widgets[w].above){var c=of(b.widgets[w]);p.top+=c;p.bottom+=c}if("line"==h)return p;h||(h="local");b=U(b);b="local"==h?b+a.display.lineSpace.offsetTop:b-a.display.viewOffset;if("page"==h||"window"==h)a=a.display.lineSpace.getBoundingClientRect(),b+=a.top+("window"==h?0:sf()),h=a.left+("window"==h?0:qf()),p.left+=h,p.right+=h;p.top+=b;p.bottom+=b;return p}function Sb(a,b,p){if("div"==p)return b;var h=b.left;b=b.top;"page"==p?(h-=qf(),b-=sf()):
"local"!=p&&p||(p=a.display.sizer.getBoundingClientRect(),h+=p.left,b+=p.top);a=a.display.lineSpace.getBoundingClientRect();return{left:h-a.left,top:b-a.top}}function Ra(a,b,p,h,w){h||(h=P(a.doc,b.line));var c=h;b=b.ch;h=nc(a,Bc(a,h),b,w);return Ka(a,c,h,p)}function Xb(a,b,p,h,w,c){function f(b,ja){var d=nc(a,w,b,ja?"right":"left",c);ja?d.left=d.right:d.right=d.left;return Ka(a,h,d,p)}function d(a,m,b){return f(b?a-1:a,0!=k[m].level%2!=b)}h=h||P(a.doc,b.line);w||(w=Bc(a,h));var k=ra(h,a.doc.direction),
e=b.ch;b=b.sticky;e>=h.text.length?(e=h.text.length,b="before"):0>=e&&(e=0,b="after");if(!k)return f("before"==b?e-1:e,"before"==b);var g=ma(k,e,b),z=ye,g=d(e,g,"before"==b);null!=z&&(g.other=d(e,z,"before"!=b));return g}function oc(a,b){var p=0;b=K(a.doc,b);a.options.lineWrapping||(p=cd(a.display)*b.ch);var h=P(a.doc,b.line),w=U(h)+a.display.lineSpace.offsetTop;return{left:p,right:p,top:w,bottom:w+h.height}}function xd(a,b,p){var h=a.doc;p+=a.display.viewOffset;if(0>p)return a=J(h.first,0,null),
a.xRel=-1,a.outside=!0,a;var w=Ia(h,p),c=h.first+h.size-1;if(w>c)return a=P(h,c).text.length,a=J(h.first+h.size-1,a,null),a.xRel=1,a.outside=!0,a;0>b&&(b=0);for(c=P(h,w);;)if(h=zg(a,c,w,b,p),c=(w=hb(c,!1))&&w.find(0,!0),w&&(h.ch>c.from.ch||h.ch==c.from.ch&&0<h.xRel))w=qa(c=c.to.line);else return h}function kf(a,b,p,h){var w=b.text.length,c=eb(function(w){return Ka(a,b,nc(a,p,w-1),"line").bottom<=h},w,0),w=eb(function(w){return Ka(a,b,nc(a,p,w),"line").top>h},c,w);return{begin:c,end:w}}function zg(a,
b,p,h,w){w-=U(b);var c=0,f=b.text.length,d=Bc(a,b);if(ra(b,a.doc.direction)){if(a.options.lineWrapping){var k;k=kf(a,b,d,w);c=k.begin;f=k.end}p=new J(p,c);var e=Xb(a,p,"line",b,d).left;k=e<h?1:-1;var g=e-h,z;do{e=g;z=p;p=dc(a,b,p,k);if(null==p||p.ch<c||f<=("before"==p.sticky?p.ch-1:p.ch)){p=z;break}g=Xb(a,p,"line",b,d).left-h}while(0>k!=0>g&&Math.abs(g)<=Math.abs(e));if(Math.abs(g)>Math.abs(e)){if(0>g==0>e)throw Error("Broke out of infinite loop in coordsCharInner");p=z}}else c=eb(function(p){var c=
Ka(a,b,nc(a,d,p),"line");return c.top>w?(f=Math.min(p,f),!0):c.bottom<=w?!1:c.left>h?!0:c.right<h?!1:h-c.left<c.right-h},c,f),c=ea(b.text,c,1),p=new J(p,c,c==f?"before":"after");c=Xb(a,p,"line",b,d);if(w<c.top||c.bottom<w)p.outside=!0;p.xRel=h<c.left?-1:h>c.right?1:0;return p}function pc(a){if(null!=a.cachedTextHeight)return a.cachedTextHeight;if(null==Nc){Nc=d("pre");for(var ja=0;49>ja;++ja)Nc.appendChild(document.createTextNode("x")),Nc.appendChild(d("br"));Nc.appendChild(document.createTextNode("x"))}c(a.measure,
Nc);ja=Nc.offsetHeight/50;3<ja&&(a.cachedTextHeight=ja);b(a.measure);return ja||1}function cd(a){if(null!=a.cachedCharWidth)return a.cachedCharWidth;var b=d("span","xxxxxxxxxx"),p=d("pre",[b]);c(a.measure,p);b=b.getBoundingClientRect();b=(b.right-b.left)/10;2<b&&(a.cachedCharWidth=b);return b||10}function wd(a){for(var b=a.display,p={},h={},w=b.gutters.clientLeft,c=b.gutters.firstChild,f=0;c;c=c.nextSibling,++f)p[a.options.gutters[f]]=c.offsetLeft+c.clientLeft+w,h[a.options.gutters[f]]=c.clientWidth;
return{fixedPos:$d(b),gutterTotalWidth:b.gutters.offsetWidth,gutterLeft:p,gutterWidth:h,wrapperWidth:b.wrapper.clientWidth}}function $d(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function ae(a){var b=pc(a.display),p=a.options.lineWrapping,h=p&&Math.max(5,a.display.scroller.clientWidth/cd(a.display)-3);return function(w){if(wb(a.doc,w))return 0;var c=0;if(w.widgets)for(var f=0;f<w.widgets.length;f++)w.widgets[f].height&&(c+=w.widgets[f].height);return p?
c+(Math.ceil(w.text.length/h)||1)*b:c+b}}function be(a){var b=a.doc,p=ae(a);b.iter(function(a){var m=p(a);m!=a.height&&sa(a,m)})}function sb(a,b,p,h){var c=a.display;if(!p&&"true"==(b.target||b.srcElement).getAttribute("cm-not-content"))return null;var f,d;p=c.lineSpace.getBoundingClientRect();try{f=b.clientX-p.left,d=b.clientY-p.top}catch(k){return null}b=xd(a,f,d);var e;h&&1==b.xRel&&(e=P(a.doc,b.line).text).length==b.ch&&(h=D(e,e.length,a.options.tabSize)-e.length,b=J(b.line,Math.max(0,Math.round((f-
Tf(a.display).left)/cd(a.display))-h)));return b}function Cc(a,b){if(b>=a.display.viewTo)return null;b-=a.display.viewFrom;if(0>b)return null;for(var p=a.display.view,h=0;h<p.length;h++)if(b-=p[h].size,0>b)return h}function Oc(a){a.display.input.showSelection(a.display.input.prepareSelection())}function De(a,b){for(var p=a.doc,h={},c=h.cursors=document.createDocumentFragment(),f=h.selection=document.createDocumentFragment(),d=0;d<p.sel.ranges.length;d++)if(!1!==b||d!=p.sel.primIndex){var k=p.sel.ranges[d];
if(!(k.from().line>=a.display.viewTo||k.to().line<a.display.viewFrom)){var e=k.empty();(e||a.options.showCursorWhenSelecting)&&yd(a,k.head,c);e||tf(a,k,f)}}return h}function yd(a,b,p){b=Xb(a,b,"div",null,null,!a.options.singleCursorHeightPerLine);var h=p.appendChild(d("div","\u00a0","CodeMirror-cursor"));h.style.left=b.left+"px";h.style.top=b.top+"px";h.style.height=Math.max(0,b.bottom-b.top)*a.options.cursorHeight+"px";b.other&&(a=p.appendChild(d("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor")),
a.style.display="",a.style.left=b.other.left+"px",a.style.top=b.other.top+"px",a.style.height=0.85*(b.other.bottom-b.other.top)+"px")}function tf(a,b,p){function h(a,m,b,h){0>m&&(m=0);m=Math.round(m);h=Math.round(h);e.appendChild(d("div",null,"CodeMirror-selected","position: absolute; left: "+a+"px;\n                             top: "+m+"px; width: "+(null==b?x-a:b)+"px;\n                             height: "+(h-m)+"px"))}function c(b,ja,p){var w=P(k,b),f=w.text.length,d,e;Cb(ra(w,k.direction),
ja||0,null==p?f:p,function(c,k,Va){var g=Ra(a,J(b,c),"div",w,"left"),Rb,jf;c==k?(Rb=g,Va=jf=g.left):(Rb=Ra(a,J(b,k-1),"div",w,"right"),"rtl"==Va&&(Va=g,g=Rb,Rb=Va),Va=g.left,jf=Rb.right);null==ja&&0==c&&(Va=z);3<Rb.top-g.top&&(h(Va,g.top,null,g.bottom),Va=z,g.bottom<Rb.top&&h(Va,g.bottom,null,Rb.top));null==p&&k==f&&(jf=x);if(!d||g.top<d.top||g.top==d.top&&g.left<d.left)d=g;if(!e||Rb.bottom>e.bottom||Rb.bottom==e.bottom&&Rb.right>e.right)e=Rb;Va<z+1&&(Va=z);h(Va,Rb.top,jf-Va,Rb.bottom)});return{start:d,
end:e}}var f=a.display,k=a.doc,e=document.createDocumentFragment(),g=Tf(a.display),z=g.left,x=Math.max(f.sizerWidth,Zd(a)-f.sizer.offsetLeft)-g.right,f=b.from();b=b.to();if(f.line==b.line)c(f.line,f.ch,b.ch);else{var l=P(k,f.line),g=P(k,b.line),g=Bb(l)==Bb(g),f=c(f.line,f.ch,g?l.text.length+1:null).end;b=c(b.line,g?0:null,b.ch).start;g&&(f.top<b.top-2?(h(f.right,f.top,null,f.bottom),h(z,b.top,b.left,b.bottom)):h(f.right,f.top,b.left-f.right,f.bottom));f.bottom<b.top&&h(z,f.bottom,null,b.top)}p.appendChild(e)}
function zd(a){if(a.state.focused){var b=a.display;clearInterval(b.blinker);var p=!0;b.cursorDiv.style.visibility="";0<a.options.cursorBlinkRate?b.blinker=setInterval(function(){return b.cursorDiv.style.visibility=(p=!p)?"":"hidden"},a.options.cursorBlinkRate):0>a.options.cursorBlinkRate&&(b.cursorDiv.style.visibility="hidden")}}function Ee(a){a.state.focused||(a.display.input.focus(),ce(a))}function de(a){a.state.delayingBlurEvent=!0;setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=
!1,Pc(a))},100)}function ce(a,b){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1);"nocursor"!=a.options.readOnly&&(a.state.focused||(La(a,"focus",a,b),a.state.focused=!0,n(a.display.wrapper,"CodeMirror-focused"),a.curOp||a.display.selForContextMenu==a.doc.sel||(a.display.input.reset(),vb&&setTimeout(function(){return a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),zd(a))}function Pc(a,b){a.state.delayingBlurEvent||(a.state.focused&&(La(a,"blur",a,b),a.state.focused=!1,fd(a.display.wrapper,
"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.display.shift=!1)},150))}function Ad(a){a=a.display;for(var b=a.lineDiv.offsetTop,p=0;p<a.view.length;p++){var h=a.view[p],c=void 0;if(!h.hidden){if(Da&&8>Wa)var f=h.node.offsetTop+h.node.offsetHeight,c=f-b,b=f;else c=h.node.getBoundingClientRect(),c=c.bottom-c.top;f=h.line.height-c;2>c&&(c=pc(a));if(0.001<f||-0.001>f)if(sa(h.line,c),ee(h.line),h.rest)for(c=0;c<h.rest.length;c++)ee(h.rest[c])}}}function ee(a){if(a.widgets)for(var b=
0;b<a.widgets.length;++b)a.widgets[b].height=a.widgets[b].node.parentNode.offsetHeight}function fe(a,b,p){var h=p&&null!=p.top?Math.max(0,p.top):a.scroller.scrollTop,h=Math.floor(h-a.lineSpace.offsetTop),c=p&&null!=p.bottom?p.bottom:h+a.wrapper.clientHeight,h=Ia(b,h),c=Ia(b,c);if(p&&p.ensure){var f=p.ensure.from.line;p=p.ensure.to.line;f<h?(h=f,c=Ia(b,U(P(b,f))+a.wrapper.clientHeight)):Math.min(p,b.lastLine())>=c&&(h=Ia(b,U(P(b,p))-a.wrapper.clientHeight),c=p)}return{from:h,to:Math.max(c,h+1)}}function ge(a){var b=
a.display,p=b.view;if(b.alignWidgets||b.gutters.firstChild&&a.options.fixedGutter){for(var h=$d(b)-b.scroller.scrollLeft+a.doc.scrollLeft,c=b.gutters.offsetWidth,f=h+"px",d=0;d<p.length;d++)if(!p[d].hidden){a.options.fixedGutter&&(p[d].gutter&&(p[d].gutter.style.left=f),p[d].gutterBackground&&(p[d].gutterBackground.style.left=f));var k=p[d].alignable;if(k)for(var e=0;e<k.length;e++)k[e].style.left=f}a.options.fixedGutter&&(b.gutters.style.left=h+c+"px")}}function Ag(a){if(!a.options.lineNumbers)return!1;
var b=a.doc,b=Ea(a.options,b.first+b.size-1),p=a.display;if(b.length!=p.lineNumChars){var h=p.measure.appendChild(d("div",[d("div",b)],"CodeMirror-linenumber CodeMirror-gutter-elt")),c=h.firstChild.offsetWidth,h=h.offsetWidth-c;p.lineGutter.style.width="";p.lineNumInnerWidth=Math.max(c,p.lineGutter.offsetWidth-h)+1;p.lineNumWidth=p.lineNumInnerWidth+h;p.lineNumChars=p.lineNumInnerWidth?b.length:-1;p.lineGutter.style.width=p.lineNumWidth+"px";Bd(a);return!0}return!1}function he(a,b){var p=a.display,
h=pc(a.display);0>b.top&&(b.top=0);var c=a.curOp&&null!=a.curOp.scrollTop?a.curOp.scrollTop:p.scroller.scrollTop,f=Uf(a),d={};b.bottom-b.top>f&&(b.bottom=b.top+f);var k=a.doc.height+Ae(p),e=b.top<h,h=b.bottom>k-h;b.top<c?d.scrollTop=e?0:b.top:b.bottom>c+f&&(f=Math.min(b.top,(h?k:b.bottom)-f),f!=c&&(d.scrollTop=f));c=a.curOp&&null!=a.curOp.scrollLeft?a.curOp.scrollLeft:p.scroller.scrollLeft;p=Zd(a)-(a.options.fixedGutter?p.gutters.offsetWidth:0);if(f=b.right-b.left>p)b.right=b.left+p;10>b.left?d.scrollLeft=
0:b.left<c?d.scrollLeft=Math.max(0,b.left-(f?0:10)):b.right>p+c-3&&(d.scrollLeft=b.right+(f?0:10)-p);return d}function Cd(a,b){null!=b&&(Fe(a),a.curOp.scrollTop=(null==a.curOp.scrollTop?a.doc.scrollTop:a.curOp.scrollTop)+b)}function Ge(a){Fe(a);var b=a.getCursor(),p=b,h=b;a.options.lineWrapping||(p=b.ch?J(b.line,b.ch-1):b,h=J(b.line,b.ch+1));a.curOp.scrollToPos={from:p,to:h,margin:a.options.cursorScrollMargin}}function uf(a,b,p){null==b&&null==p||Fe(a);null!=b&&(a.curOp.scrollLeft=b);null!=p&&(a.curOp.scrollTop=
p)}function Fe(a){var b=a.curOp.scrollToPos;if(b){a.curOp.scrollToPos=null;var p=oc(a,b.from),h=oc(a,b.to);jh(a,p,h,b.margin)}}function jh(a,b,p,h){b=he(a,{left:Math.min(b.left,p.left),top:Math.min(b.top,p.top)-h,right:Math.max(b.right,p.right),bottom:Math.max(b.bottom,p.bottom)+h});uf(a,b.scrollLeft,b.scrollTop)}function Dd(a,b){2>Math.abs(a.doc.scrollTop-b)||(Vb||gd(a,{top:b}),Lb(a,b,!0),Vb&&gd(a),Qc(a,100))}function Lb(a,b,p){b=Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,
b);if(a.display.scroller.scrollTop!=b||p)a.doc.scrollTop=b,a.display.scrollbars.setScrollTop(b),a.display.scroller.scrollTop!=b&&(a.display.scroller.scrollTop=b)}function gc(a,b,p,h){b=Math.min(b,a.display.scroller.scrollWidth-a.display.scroller.clientWidth);(p?b==a.doc.scrollLeft:2>Math.abs(a.doc.scrollLeft-b))&&!h||(a.doc.scrollLeft=b,ge(a),a.display.scroller.scrollLeft!=b&&(a.display.scroller.scrollLeft=b),a.display.scrollbars.setScrollLeft(b))}function He(a){var b=a.display,p=b.gutters.offsetWidth,
h=Math.round(a.doc.height+Ae(a.display));return{clientHeight:b.scroller.clientHeight,viewHeight:b.wrapper.clientHeight,scrollWidth:b.scroller.scrollWidth,clientWidth:b.scroller.clientWidth,viewWidth:b.wrapper.clientWidth,barLeft:a.options.fixedGutter?p:0,docHeight:h,scrollHeight:h+Mc(a)+b.barHeight,nativeBarWidth:b.nativeBarWidth,gutterWidth:p}}function Rc(a,b){b||(b=He(a));var p=a.display.barWidth,h=a.display.barHeight;Bg(a,b);for(var c=0;4>c&&p!=a.display.barWidth||h!=a.display.barHeight;c++)p!=
a.display.barWidth&&a.options.lineWrapping&&Ad(a),Bg(a,He(a)),p=a.display.barWidth,h=a.display.barHeight}function Bg(a,b){var p=a.display,h=p.scrollbars.update(b);p.sizer.style.paddingRight=(p.barWidth=h.right)+"px";p.sizer.style.paddingBottom=(p.barHeight=h.bottom)+"px";p.heightForcer.style.borderBottom=h.bottom+"px solid transparent";h.right&&h.bottom?(p.scrollbarFiller.style.display="block",p.scrollbarFiller.style.height=h.bottom+"px",p.scrollbarFiller.style.width=h.right+"px"):p.scrollbarFiller.style.display=
"";h.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(p.gutterFiller.style.display="block",p.gutterFiller.style.height=h.bottom+"px",p.gutterFiller.style.width=b.gutterWidth+"px"):p.gutterFiller.style.display=""}function Cg(a){a.display.scrollbars&&(a.display.scrollbars.clear(),a.display.scrollbars.addClass&&fd(a.display.wrapper,a.display.scrollbars.addClass));a.display.scrollbars=new Xf[a.options.scrollbarStyle](function(b){a.display.wrapper.insertBefore(b,a.display.scrollbarFiller);
ha(b,"mousedown",function(){a.state.focused&&setTimeout(function(){return a.display.input.focus()},0)});b.setAttribute("cm-not-content","true")},function(b,p){"horizontal"==p?gc(a,b):Dd(a,b)},a);a.display.scrollbars.addClass&&n(a.display.wrapper,a.display.scrollbars.addClass)}function Sc(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,
scrollTop:null,scrollToPos:null,focus:!1,id:++Yf};a=a.curOp;Xd?Xd.ops.push(a):a.ownsGroup=Xd={ops:[a],delayedCallbacks:[]}}function Ed(a){zh(a.curOp,function(a){for(var m=0;m<a.ops.length;m++)a.ops[m].cm.curOp=null;a=a.ops;for(m=0;m<a.length;m++){var b=a[m],c=b.cm,f=c.display,k=c,e=k.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Mc(k)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=
Mc(k)+"px",e.scrollbarsClipped=!0);b.updateMaxLine&&pa(c);b.mustUpdate=b.viewChanged||b.forceUpdate||null!=b.scrollTop||b.scrollToPos&&(b.scrollToPos.from.line<f.viewFrom||b.scrollToPos.to.line>=f.viewTo)||f.maxLineChanged&&c.options.lineWrapping;b.update=b.mustUpdate&&new ie(c,b.mustUpdate&&{top:b.scrollTop,ensure:b.scrollToPos},b.forceUpdate)}for(m=0;m<a.length;m++)b=a[m],b.updatedDisplay=b.mustUpdate&&Fd(b.cm,b.update);for(m=0;m<a.length;m++)if(b=a[m],c=b.cm,f=c.display,b.updatedDisplay&&Ad(c),
b.barMeasure=He(c),f.maxLineChanged&&!c.options.lineWrapping&&(k=b,e=f.maxLine.text.length,e=nc(c,Bc(c,f.maxLine),e,void 0),k.adjustWidthTo=e.left+3,c.display.sizerWidth=b.adjustWidthTo,b.barMeasure.scrollWidth=Math.max(f.scroller.clientWidth,f.sizer.offsetLeft+b.adjustWidthTo+Mc(c)+c.display.barWidth),b.maxScrollLeft=Math.max(0,f.sizer.offsetLeft+b.adjustWidthTo-Zd(c))),b.updatedDisplay||b.selectionChanged)b.preparedSelection=f.input.prepareSelection(b.focus);for(m=0;m<a.length;m++)b=a[m],c=b.cm,
null!=b.adjustWidthTo&&(c.display.sizer.style.minWidth=b.adjustWidthTo+"px",b.maxScrollLeft<c.doc.scrollLeft&&gc(c,Math.min(c.display.scroller.scrollLeft,b.maxScrollLeft),!0),c.display.maxLineChanged=!1),f=b.focus&&b.focus==l()&&(!document.hasFocus||document.hasFocus()),b.preparedSelection&&c.display.input.showSelection(b.preparedSelection,f),(b.updatedDisplay||b.startHeight!=c.doc.height)&&Rc(c,b.barMeasure),b.updatedDisplay&&hd(c,b.barMeasure),b.selectionChanged&&zd(c),c.state.focused&&b.updateInput&&
c.display.input.reset(b.typing),f&&Ee(b.cm);for(m=0;m<a.length;m++){b=a[m];c=b.cm;f=c.display;k=c.doc;b.updatedDisplay&&Gd(c,b.update);null==f.wheelStartX||null==b.scrollTop&&null==b.scrollLeft&&!b.scrollToPos||(f.wheelStartX=f.wheelStartY=null);null!=b.scrollTop&&Lb(c,b.scrollTop,b.forceScroll);null!=b.scrollLeft&&gc(c,b.scrollLeft,!0,!0);if(b.scrollToPos){var e=c,g=K(k,b.scrollToPos.from),z=K(k,b.scrollToPos.to),x=b.scrollToPos.margin;null==x&&(x=0);for(var n=void 0,s=0;5>s;s++){var q=!1,n=Xb(e,
g),r=z&&z!=g?Xb(e,z):n,n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top)-x,right:Math.max(n.left,r.left),bottom:Math.max(n.bottom,r.bottom)+x},r=he(e,n),D=e.doc.scrollTop,B=e.doc.scrollLeft;null!=r.scrollTop&&(Dd(e,r.scrollTop),1<Math.abs(e.doc.scrollTop-D)&&(q=!0));null!=r.scrollLeft&&(gc(e,r.scrollLeft),1<Math.abs(e.doc.scrollLeft-B)&&(q=!0));if(!q)break}e=c;z=n;Aa(e,"scrollCursorIntoView")||(x=e.display,s=x.sizer.getBoundingClientRect(),g=null,0>z.top+s.top?g=!0:z.bottom+s.top>(window.innerHeight||
document.documentElement.clientHeight)&&(g=!1),null==g||Zf||(z=d("div","\u200b",null,"position: absolute;\n                         top: "+(z.top-x.viewOffset-e.display.lineSpace.offsetTop)+"px;\n                         height: "+(z.bottom-z.top+Mc(e)+x.barHeight)+"px;\n                         left: "+z.left+"px; width: "+Math.max(2,z.right-z.left)+"px;"),e.display.lineSpace.appendChild(z),z.scrollIntoView(g),e.display.lineSpace.removeChild(z)))}g=b.maybeHiddenMarkers;e=b.maybeUnhiddenMarkers;if(g)for(z=
0;z<g.length;++z)g[z].lines.length||La(g[z],"hide");if(e)for(g=0;g<e.length;++g)e[g].lines.length&&La(e[g],"unhide");f.wrapper.offsetHeight&&(k.scrollTop=c.display.scroller.scrollTop);b.changeObjs&&La(c,"changes",c,b.changeObjs);b.update&&b.update.finish()}})}function Tb(a,b){if(a.curOp)return b();Sc(a);try{return b()}finally{Ed(a)}}function tb(a,b){return function(){if(a.curOp)return b.apply(a,arguments);Sc(a);try{return b.apply(a,arguments)}finally{Ed(a)}}}function lb(a){return function(){if(this.curOp)return a.apply(this,
arguments);Sc(this);try{return a.apply(this,arguments)}finally{Ed(this)}}}function Sa(a){return function(){var b=this.cm;if(!b||b.curOp)return a.apply(this,arguments);Sc(b);try{return a.apply(this,arguments)}finally{Ed(b)}}}function xb(a,b,c,h){null==b&&(b=a.doc.first);null==c&&(c=a.doc.first+a.doc.size);h||(h=0);var f=a.display;h&&c<f.viewTo&&(null==f.updateLineNumbers||f.updateLineNumbers>b)&&(f.updateLineNumbers=b);a.curOp.viewChanged=!0;if(b>=f.viewTo)$c&&Kc(a.doc,b)<f.viewTo&&qc(a);else if(c<=
f.viewFrom)$c&&Ac(a.doc,c+h)>f.viewFrom?qc(a):(f.viewFrom+=h,f.viewTo+=h);else if(b<=f.viewFrom&&c>=f.viewTo)qc(a);else if(b<=f.viewFrom){var d=Tc(a,c,c+h,1);d?(f.view=f.view.slice(d.index),f.viewFrom=d.lineN,f.viewTo+=h):qc(a)}else if(c>=f.viewTo)(d=Tc(a,b,b,-1))?(f.view=f.view.slice(0,d.index),f.viewTo=d.lineN):qc(a);else{var d=Tc(a,b,b,-1),k=Tc(a,c,c+h,1);d&&k?(f.view=f.view.slice(0,d.index).concat(Sf(a,d.lineN,k.lineN)).concat(f.view.slice(k.index)),f.viewTo+=h):qc(a)}if(a=f.externalMeasured)c<
a.lineN?a.lineN+=h:b<a.lineN+a.size&&(f.externalMeasured=null)}function hc(a,b,c){a.curOp.viewChanged=!0;var h=a.display,f=a.display.externalMeasured;f&&b>=f.lineN&&b<f.lineN+f.size&&(h.externalMeasured=null);b<h.viewFrom||b>=h.viewTo||(a=h.view[Cc(a,b)],null!=a.node&&(a=a.changes||(a.changes=[]),-1==q(a,c)&&a.push(c)))}function qc(a){a.display.viewFrom=a.display.viewTo=a.doc.first;a.display.view=[];a.display.viewOffset=0}function Tc(a,b,c,h){var f=Cc(a,b),d=a.display.view;if(!$c||c==a.doc.first+
a.doc.size)return{index:f,lineN:c};for(var k=a.display.viewFrom,e=0;e<f;e++)k+=d[e].size;if(k!=b){if(0<h){if(f==d.length-1)return null;b=k+d[f].size-b;f++}else b=k-b;c+=b}for(;Kc(a.doc,c)!=c;){if(f==(0>h?0:d.length-1))return null;c+=h*d[f-(0>h?1:0)].size;f+=h}return{index:f,lineN:c}}function Ie(a){a=a.display.view;for(var b=0,c=0;c<a.length;c++){var h=a[c];h.hidden||h.node&&!h.changes||++b}return b}function Qc(a,b){a.doc.mode.startState&&a.doc.frontier<a.display.viewTo&&a.state.highlight.set(b,E(vf,
a))}function vf(a){var b=a.doc;b.frontier<b.first&&(b.frontier=b.first);if(!(b.frontier>=a.display.viewTo)){var c=+new Date+a.options.workTime,h=fa(b.mode,G(a,b.frontier)),w=[];b.iter(b.frontier,Math.min(b.first+b.size,a.display.viewTo+500),function(d){if(b.frontier>=a.display.viewFrom){var k=d.styles,e=d.text.length>a.options.maxHighlightLength,g=ia(a,d,e?fa(b.mode,h):h,!0);d.styles=g.styles;var z=d.styleClasses;(g=g.classes)?d.styleClasses=g:z&&(d.styleClasses=null);z=!k||k.length!=d.styles.length||
z!=g&&(!z||!g||z.bgClass!=g.bgClass||z.textClass!=g.textClass);for(g=0;!z&&g<k.length;++g)z=k[g]!=d.styles[g];z&&w.push(b.frontier);d.stateAfter=e?h:fa(b.mode,h)}else d.text.length<=a.options.maxHighlightLength&&f(a,d.text,h),d.stateAfter=0==b.frontier%5?fa(b.mode,h):null;++b.frontier;if(+new Date>c)return Qc(a,a.options.workDelay),!0});w.length&&Tb(a,function(){for(var b=0;b<w.length;b++)hc(a,w[b],"text")})}}function Fd(a,c){var p=a.display,h=a.doc;if(c.editorIsHidden)return qc(a),!1;if(!c.force&&
c.visible.from>=p.viewFrom&&c.visible.to<=p.viewTo&&(null==p.updateLineNumbers||p.updateLineNumbers>=p.viewTo)&&p.renderedView==p.view&&0==Ie(a))return!1;Ag(a)&&(qc(a),c.dims=wd(a));var f=h.first+h.size,d=Math.max(c.visible.from-a.options.viewportMargin,h.first),k=Math.min(f,c.visible.to+a.options.viewportMargin);p.viewFrom<d&&20>d-p.viewFrom&&(d=Math.max(h.first,p.viewFrom));p.viewTo>k&&20>p.viewTo-k&&(k=Math.min(f,p.viewTo));$c&&(d=Kc(a.doc,d),k=Ac(a.doc,k));h=d!=p.viewFrom||k!=p.viewTo||p.lastWrapHeight!=
c.wrapperHeight||p.lastWrapWidth!=c.wrapperWidth;f=a.display;0==f.view.length||d>=f.viewTo||k<=f.viewFrom?(f.view=Sf(a,d,k),f.viewFrom=d):(f.viewFrom>d?f.view=Sf(a,d,f.viewFrom).concat(f.view):f.viewFrom<d&&(f.view=f.view.slice(Cc(a,d))),f.viewFrom=d,f.viewTo<k?f.view=f.view.concat(Sf(a,f.viewTo,k)):f.viewTo>k&&(f.view=f.view.slice(0,Cc(a,k))));f.viewTo=k;p.viewOffset=U(P(a.doc,p.viewFrom));a.display.mover.style.top=p.viewOffset+"px";k=Ie(a);if(!h&&0==k&&!c.force&&p.renderedView==p.view&&(null==p.updateLineNumbers||
p.updateLineNumbers>=p.viewTo))return!1;a.hasFocus()?d=null:(d=l())&&e(a.display.lineDiv,d)?(d={activeElt:d},window.getSelection&&(f=window.getSelection(),f.anchorNode&&f.extend&&e(a.display.lineDiv,f.anchorNode)&&(d.anchorNode=f.anchorNode,d.anchorOffset=f.anchorOffset,d.focusNode=f.focusNode,d.focusOffset=f.focusOffset))):d=null;4<k&&(p.lineDiv.style.display="none");kh(a,p.updateLineNumbers,c.dims);4<k&&(p.lineDiv.style.display="");p.renderedView=p.view;(k=d)&&k.activeElt&&k.activeElt!=l()&&(k.activeElt.focus(),
k.anchorNode&&e(document.body,k.anchorNode)&&e(document.body,k.focusNode)&&(d=window.getSelection(),f=document.createRange(),f.setEnd(k.anchorNode,k.anchorOffset),f.collapse(!1),d.removeAllRanges(),d.addRange(f),d.extend(k.focusNode,k.focusOffset)));b(p.cursorDiv);b(p.selectionDiv);p.gutters.style.height=p.sizer.style.minHeight=0;h&&(p.lastWrapHeight=c.wrapperHeight,p.lastWrapWidth=c.wrapperWidth,Qc(a,400));p.updateLineNumbers=null;return!0}function Gd(a,b){for(var c=b.viewport,h=!0;;h=!1){if(!h||
!a.options.lineWrapping||b.oldDisplayWidth==Zd(a))if(c&&null!=c.top&&(c={top:Math.min(a.doc.height+Ae(a.display)-Uf(a),c.top)}),b.visible=fe(a.display,a.doc,c),b.visible.from>=a.display.viewFrom&&b.visible.to<=a.display.viewTo)break;if(!Fd(a,b))break;Ad(a);h=He(a);Oc(a);Rc(a,h);hd(a,h)}b.signal(a,"update",a);if(a.display.viewFrom!=a.display.reportedViewFrom||a.display.viewTo!=a.display.reportedViewTo)b.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=a.display.viewFrom,
a.display.reportedViewTo=a.display.viewTo}function gd(a,b){var c=new ie(a,b);if(Fd(a,c)){Ad(a);Gd(a,c);var h=He(a);Oc(a);Rc(a,h);hd(a,h);c.finish()}}function kh(a,c,f){function h(b){var h=b.nextSibling;vb&&ec&&a.display.currentWheelTarget==b?b.style.display="none":b.parentNode.removeChild(b);return h}for(var w=a.display,d=a.options.lineNumbers,k=w.lineDiv,e=k.firstChild,g=w.view,w=w.viewFrom,z=0;z<g.length;z++){var x=g[z];if(!x.hidden)if(x.node&&x.node.parentNode==k){for(;e!=x.node;)e=h(e);e=d&&null!=
c&&c<=w&&x.lineNumber;x.changes&&(-1<q(x.changes,"gutter")&&(e=!1),wg(a,x,w,f));e&&(b(x.lineNumber),x.lineNumber.appendChild(document.createTextNode(Ea(a.options,w))));e=x.node.nextSibling}else{var l=Ah(a,x,w,f);k.insertBefore(l,e)}w+=x.size}for(;e;)e=h(e)}function Bd(a){a.display.sizer.style.marginLeft=a.display.gutters.offsetWidth+"px"}function hd(a,b){a.display.sizer.style.minHeight=b.docHeight+"px";a.display.heightForcer.style.top=b.docHeight+"px";a.display.gutters.style.height=b.docHeight+a.display.barHeight+
Mc(a)+"px"}function Uc(a){var c=a.display.gutters,f=a.options.gutters;b(c);for(var h=0;h<f.length;++h){var w=f[h],k=c.appendChild(d("div",null,"CodeMirror-gutter "+w));"CodeMirror-linenumbers"==w&&(a.display.lineGutter=k,k.style.width=(a.display.lineNumWidth||1)+"px")}c.style.display=h?"":"none";Bd(a)}function je(a){var b=q(a.gutters,"CodeMirror-linenumbers");-1==b&&a.lineNumbers?a.gutters=a.gutters.concat(["CodeMirror-linenumbers"]):-1<b&&!a.lineNumbers&&(a.gutters=a.gutters.slice(0),a.gutters.splice(b,
1))}function Je(a){var b=a.wheelDeltaX,c=a.wheelDeltaY;null==b&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(b=a.detail);null==c&&a.detail&&a.axis==a.VERTICAL_AXIS?c=a.detail:null==c&&(c=a.wheelDelta);return{x:b,y:c}}function wf(a){a=Je(a);a.x*=cb;a.y*=cb;return a}function ke(a,b){var c=Je(b),h=c.x,c=c.y,f=a.display,d=f.scroller,k=d.scrollWidth>d.clientWidth,e=d.scrollHeight>d.clientHeight;if(h&&k||c&&e){if(c&&ec&&vb){var k=b.target,g=f.view;a:for(;k!=d;k=k.parentNode)for(var z=0;z<g.length;z++)if(g[z].node==
k){a.display.currentWheelTarget=k;break a}}!h||Vb||rc||null==cb?(c&&null!=cb&&(e=c*cb,k=a.doc.scrollTop,g=k+f.wrapper.clientHeight,0>e?k=Math.max(0,k+e-50):g=Math.min(a.doc.height,g+e+50),gd(a,{top:k,bottom:g})),20>sc&&(null==f.wheelStartX?(f.wheelStartX=d.scrollLeft,f.wheelStartY=d.scrollTop,f.wheelDX=h,f.wheelDY=c,setTimeout(function(){if(null!=f.wheelStartX){var a=d.scrollLeft-f.wheelStartX,b=d.scrollTop-f.wheelStartY,a=b&&f.wheelDY&&b/f.wheelDY||a&&f.wheelDX&&a/f.wheelDX;f.wheelStartX=f.wheelStartY=
null;a&&(cb=(cb*sc+a)/(sc+1),++sc)}},200)):(f.wheelDX+=h,f.wheelDY+=c))):(c&&e&&Dd(a,Math.max(0,d.scrollTop+c*cb)),gc(a,Math.max(0,d.scrollLeft+h*cb)),(!c||c&&e)&&za(b),f.wheelStartX=null)}}function Mb(a,b){var c=a[b];a.sort(function(a,b){return Q(a.from(),b.from())});b=q(a,c);for(c=1;c<a.length;c++){var h=a[c],f=a[c-1];if(0<=Q(f.to(),h.from())){var d=xa(f.from(),h.from()),k=nb(f.to(),h.to()),h=f.empty()?h.from()==h.head:f.from()==f.head;c<=b&&--b;a.splice(--c,2,new wa(h?k:d,h?d:k))}}return new yb(a,
b)}function Yb(a,b){return new yb([new wa(a,b||a)],0)}function Hb(a){return a.text?J(a.from.line+a.text.length-1,I(a.text).length+(1==a.text.length?a.from.ch:0)):a.to}function Hd(a,b){if(0>Q(a,b.from))return a;if(0>=Q(a,b.to))return Hb(b);var c=a.line+b.text.length-(b.to.line-b.from.line)-1,h=a.ch;a.line==b.to.line&&(h+=Hb(b).ch-b.to.ch);return J(c,h)}function ic(a,b){for(var c=[],h=0;h<a.sel.ranges.length;h++){var f=a.sel.ranges[h];c.push(new wa(Hd(f.anchor,b),Hd(f.head,b)))}return Mb(c,a.sel.primIndex)}
function Id(a,b,c){return a.line==b.line?J(c.line,a.ch-b.ch+c.ch):J(c.line+(a.line-b.line),a.ch)}function id(a){a.doc.mode=oa(a.options,a.doc.modeOption);Dc(a)}function Dc(a){a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null)});a.doc.frontier=a.doc.first;Qc(a,100);a.state.modeGen++;a.curOp&&xb(a)}function Jd(a,b){return 0==b.from.ch&&0==b.to.ch&&""==I(b.text)&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}function xf(a,b,c,h){function f(a,m,c){var p=h;a.text=m;a.stateAfter&&
(a.stateAfter=null);a.styles&&(a.styles=null);null!=a.order&&(a.order=null);Fb(a);Jb(a,c);m=p?p(a):1;m!=a.height&&sa(a,m);Db(a,"change",a,b)}function d(a,b){for(var m=[],f=a;f<b;++f)m.push(new jd(g[f],c?c[f]:null,h));return m}var k=b.from,e=b.to,g=b.text,z=P(a,k.line),x=P(a,e.line),l=I(g),n=c?c[g.length-1]:null,s=e.line-k.line;b.full?(a.insert(0,d(0,g.length)),a.remove(g.length,a.size-g.length)):Jd(a,b)?(e=d(0,g.length-1),f(x,x.text,n),s&&a.remove(k.line,s),e.length&&a.insert(k.line,e)):z==x?1==g.length?
f(z,z.text.slice(0,k.ch)+l+z.text.slice(e.ch),n):(s=d(1,g.length-1),s.push(new jd(l+z.text.slice(e.ch),n,h)),f(z,z.text.slice(0,k.ch)+g[0],c?c[0]:null),a.insert(k.line+1,s)):1==g.length?(f(z,z.text.slice(0,k.ch)+g[0]+x.text.slice(e.ch),c?c[0]:null),a.remove(k.line+1,s)):(f(z,z.text.slice(0,k.ch)+g[0],c?c[0]:null),f(x,l+x.text.slice(e.ch),n),n=d(1,g.length-1),1<s&&a.remove(k.line+1,s-1),a.insert(k.line+1,n));Db(a,"change",a,b)}function Ib(a,b,c){function h(a,m,f){if(a.linked)for(var d=0;d<a.linked.length;++d){var k=
a.linked[d];if(k.doc!=m){var e=f&&k.sharedHist;if(!c||e)b(k.doc,e),h(k.doc,a,e)}}}h(a,null,!0)}function Dg(a,b){if(b.cm)throw Error("This document is already in use.");a.doc=b;b.cm=a;be(a);id(a);$f(a);a.options.lineWrapping||pa(a);a.options.mode=b.modeOption;xb(a)}function $f(a){("rtl"==a.doc.direction?n:fd)(a.display.lineDiv,"CodeMirror-rtl")}function yf(a){Tb(a,function(){$f(a);xb(a)})}function Ke(a){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOrigin=
this.lastSelOrigin=this.lastOp=this.lastSelOp=null;this.generation=this.maxGeneration=a||1}function Le(a,b){var c={from:Z(b.from),to:Hb(b),text:Pa(a,b.from,b.to)};ag(a,c,b.from.line,b.to.line+1);Ib(a,function(a){return ag(a,c,b.from.line,b.to.line+1)},!0);return c}function la(a){for(;a.length;)if(I(a).ranges)a.pop();else break}function Zb(a,b,c,h){var f=a.history;f.undone.length=0;var d=+new Date,k,e,g;if(g=f.lastOp==h||f.lastOrigin==b.origin&&b.origin&&("+"==b.origin.charAt(0)&&a.cm&&f.lastModTime>
d-a.cm.options.historyEventDelay||"*"==b.origin.charAt(0)))f.lastOp==h?(la(f.done),k=I(f.done)):f.done.length&&!I(f.done).ranges?k=I(f.done):1<f.done.length&&!f.done[f.done.length-2].ranges?(f.done.pop(),k=I(f.done)):k=void 0,g=k;if(g)e=I(k.changes),0==Q(b.from,b.to)&&0==Q(b.from,e.to)?e.to=Hb(b):k.changes.push(Le(a,b));else for((k=I(f.done))&&k.ranges||kd(a.sel,f.done),k={changes:[Le(a,b)],generation:f.generation},f.done.push(k);f.done.length>f.undoDepth;)f.done.shift(),f.done[0].ranges||f.done.shift();
f.done.push(c);f.generation=++f.maxGeneration;f.lastModTime=f.lastSelTime=d;f.lastOp=f.lastSelOp=h;f.lastOrigin=f.lastSelOrigin=b.origin;e||La(a,"historyAdded")}function kd(a,b){var c=I(b);c&&c.ranges&&c.equals(a)||b.push(a)}function ag(a,b,c,h){var f=b["spans_"+a.id],d=0;a.iter(Math.max(a.first,c),Math.min(a.first+a.size,h),function(h){h.markedSpans&&((f||(f=b["spans_"+a.id]={}))[d]=h.markedSpans);++d})}function Nb(a){if(!a)return null;for(var b,c=0;c<a.length;++c)a[c].marker.explicitlyCleared?b||
(b=a.slice(0,c)):b&&b.push(a[c]);return b?b.length?b:null:a}function Eg(a,b){var c;if(c=b["spans_"+a.id]){for(var h=[],f=0;f<b.text.length;++f)h.push(Nb(c[f]));c=h}else c=null;h=Wb(a,b);if(!c)return h;if(!h)return c;for(f=0;f<c.length;++f){var d=c[f],k=h[f];if(d&&k){var e=0;a:for(;e<k.length;++e){for(var g=k[e],z=0;z<d.length;++z)if(d[z].marker==g.marker)continue a;d.push(g)}}else k&&(c[f]=k)}return c}function Vc(a,b,c){for(var h=[],f=0;f<a.length;++f){var d=a[f];if(d.ranges)h.push(c?yb.prototype.deepCopy.call(d):
d);else{var d=d.changes,k=[];h.push({changes:k});for(var e=0;e<d.length;++e){var g=d[e],z=void 0;k.push({from:g.from,to:g.to,text:g.text});if(b)for(var x in g)(z=x.match(/^spans_(\d+)$/))&&-1<q(b,Number(z[1]))&&(I(k)[x]=g[x],delete g[x])}}}return h}function ld(a,b,c,h){return a.cm&&a.cm.display.shift||a.extend?(a=b.anchor,h&&(b=0>Q(c,a),b!=0>Q(h,a)?(a=c,c=h):b!=0>Q(c,h)&&(c=h)),new wa(a,c)):new wa(h||c,c)}function $b(a,b,c,h){Za(a,new yb([ld(a,a.sel.primary(),b,c)],0),h)}function Ec(a,b,c){for(var h=
[],f=0;f<a.sel.ranges.length;f++)h[f]=ld(a,a.sel.ranges[f],b[f],null);b=Mb(h,a.sel.primIndex);Za(a,b,c)}function Ob(a,b,c,h){var f=a.sel.ranges.slice(0);f[b]=c;Za(a,Mb(f,a.sel.primIndex),h)}function Fc(a,b,c){c={ranges:b.ranges,update:function(b){this.ranges=[];for(var c=0;c<b.length;c++)this.ranges[c]=new wa(K(a,b[c].anchor),K(a,b[c].head))},origin:c&&c.origin};La(a,"beforeSelectionChange",a,c);a.cm&&La(a.cm,"beforeSelectionChange",a.cm,c);return c.ranges!=b.ranges?Mb(c.ranges,c.ranges.length-1):
b}function tc(a,b,c){var h=a.history.done,f=I(h);f&&f.ranges?(h[h.length-1]=b,ac(a,b,c)):Za(a,b,c)}function Za(a,b,c){ac(a,b,c);b=a.sel;var h=a.cm?a.cm.curOp.id:NaN,f=a.history,d=c&&c.origin,k;if(!(k=h==f.lastSelOp)&&(k=d)&&(k=f.lastSelOrigin==d)&&!(k=f.lastModTime==f.lastSelTime&&f.lastOrigin==d)){k=I(f.done);var e=d.charAt(0);k="*"==e||"+"==e&&k.ranges.length==b.ranges.length&&k.somethingSelected()==b.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}k?
f.done[f.done.length-1]=b:kd(b,f.done);f.lastSelTime=+new Date;f.lastSelOrigin=d;f.lastSelOp=h;c&&!1!==c.clearRedo&&la(f.undone)}function ac(a,b,c){if(ob(a,"beforeSelectionChange")||a.cm&&ob(a.cm,"beforeSelectionChange"))b=Fc(a,b,c);var h=c&&c.bias||(0>Q(b.primary().head,a.sel.primary().head)?-1:1);Wc(a,md(a,b,h,!0));c&&!1===c.scroll||!a.cm||Ge(a.cm)}function Wc(a,b){b.equals(a.sel)||(a.sel=b,a.cm&&(a.cm.curOp.updateInput=a.cm.curOp.selectionChanged=!0,da(a.cm)),Db(a,"cursorActivity",a))}function uc(a){Wc(a,
md(a,a.sel,null,!1))}function md(a,b,c,h){for(var f,d=0;d<b.ranges.length;d++){var k=b.ranges[d],e=b.ranges.length==a.sel.ranges.length&&a.sel.ranges[d],g=Me(a,k.anchor,e&&e.anchor,c,h),e=Me(a,k.head,e&&e.head,c,h);if(f||g!=k.anchor||e!=k.head)f||(f=b.ranges.slice(0,d)),f[d]=new wa(g,e)}return f?Mb(f,b.primIndex):b}function $a(a,b,c,h,f){var d=P(a,b.line);if(d.markedSpans)for(var k=0;k<d.markedSpans.length;++k){var e=d.markedSpans[k],g=e.marker;if((null==e.from||(g.inclusiveLeft?e.from<=b.ch:e.from<
b.ch))&&(null==e.to||(g.inclusiveRight?e.to>=b.ch:e.to>b.ch))){if(f&&(La(g,"beforeCursorEnter"),g.explicitlyCleared))if(d.markedSpans){--k;continue}else break;if(g.atomic){if(c){k=g.find(0>h?1:-1);e=void 0;if(0>h?g.inclusiveRight:g.inclusiveLeft)k=Kd(a,k,-h,k&&k.line==b.line?d:null);if(k&&k.line==b.line&&(e=Q(k,c))&&(0>h?0>e:0<e))return $a(a,k,b,h,f)}c=g.find(0>h?-1:1);if(0>h?g.inclusiveLeft:g.inclusiveRight)c=Kd(a,c,h,c.line==b.line?d:null);return c?$a(a,c,b,h,f):null}}}return b}function Me(a,b,
c,h,f){h=h||1;b=$a(a,b,c,h,f)||!f&&$a(a,b,c,h,!0)||$a(a,b,c,-h,f)||!f&&$a(a,b,c,-h,!0);return b?b:(a.cantEdit=!0,J(a.first,0))}function Kd(a,b,c,h){return 0>c&&0==b.ch?b.line>a.first?K(a,J(b.line-1)):null:0<c&&b.ch==(h||P(a,b.line)).text.length?b.line<a.first+a.size-1?J(b.line+1,0):null:new J(b.line,b.ch+c)}function zf(a){a.setSelection(J(a.firstLine(),0),J(a.lastLine()),vc)}function Af(a,b,c){var h={canceled:!1,from:b.from,to:b.to,text:b.text,origin:b.origin,cancel:function(){return h.canceled=!0}};
c&&(h.update=function(b,c,f,p){b&&(h.from=K(a,b));c&&(h.to=K(a,c));f&&(h.text=f);void 0!==p&&(h.origin=p)});La(a,"beforeChange",a,h);a.cm&&La(a.cm,"beforeChange",a.cm,h);return h.canceled?null:{from:h.from,to:h.to,text:h.text,origin:h.origin}}function nd(a,b,c){if(a.cm){if(!a.cm.curOp)return tb(a.cm,nd)(a,b,c);if(a.cm.state.suppressEdits)return}if(ob(a,"beforeChange")||a.cm&&ob(a.cm,"beforeChange"))if(b=Af(a,b,!0),!b)return;if(c=bg&&!c&&aa(a,b.from,b.to))for(var h=c.length-1;0<=h;--h)Bf(a,{from:c[h].from,
to:c[h].to,text:h?[""]:b.text});else Bf(a,b)}function Bf(a,b){if(1!=b.text.length||""!=b.text[0]||0!=Q(b.from,b.to)){var c=ic(a,b);Zb(a,b,c,a.cm?a.cm.curOp.id:NaN);Ld(a,b,c,Wb(a,b));var h=[];Ib(a,function(a,m){m||-1!=q(h,a.history)||(Ne(a.history,b),h.push(a.history));Ld(a,b,null,Wb(a,b))})}}function le(a,b,c){if(!a.cm||!a.cm.state.suppressEdits||c){for(var h=a.history,f,d=a.sel,k="undo"==b?h.done:h.undone,e="undo"==b?h.undone:h.done,g=0;g<k.length&&(f=k[g],c?!f.ranges||f.equals(a.sel):f.ranges);g++);
if(g!=k.length){for(h.lastOrigin=h.lastSelOrigin=null;;)if(f=k.pop(),f.ranges){kd(f,e);if(c&&!f.equals(a.sel)){Za(a,f,{clearRedo:!1});return}d=f}else break;var z=[];kd(d,e);e.push({changes:z,generation:h.generation});h.generation=f.generation||++h.maxGeneration;var x=ob(a,"beforeChange")||a.cm&&ob(a.cm,"beforeChange");c=function(c){var h=f.changes[c];h.origin=b;if(x&&!Af(a,h,!1))return k.length=0,{};z.push(Le(a,h));var p=c?ic(a,h):I(k);Ld(a,h,p,Eg(a,h));!c&&a.cm&&a.cm.scrollIntoView({from:h.from,
to:Hb(h)});var d=[];Ib(a,function(a,b){b||-1!=q(d,a.history)||(Ne(a.history,h),d.push(a.history));Ld(a,h,null,Eg(a,h))})};for(h=f.changes.length-1;0<=h;--h)if(d=c(h))return d.v}}}function Cf(a,b){if(0!=b&&(a.first+=b,a.sel=new yb(F(a.sel.ranges,function(a){return new wa(J(a.anchor.line+b,a.anchor.ch),J(a.head.line+b,a.head.ch))}),a.sel.primIndex),a.cm)){xb(a.cm,a.first,a.first-b,b);for(var c=a.cm.display,h=c.viewFrom;h<c.viewTo;h++)hc(a.cm,h,"gutter")}}function Ld(a,b,c,h){if(a.cm&&!a.cm.curOp)return tb(a.cm,
Ld)(a,b,c,h);if(b.to.line<a.first)Cf(a,b.text.length-1-(b.to.line-b.from.line));else if(!(b.from.line>a.lastLine())){if(b.from.line<a.first){var f=b.text.length-1-(a.first-b.from.line);Cf(a,f);b={from:J(a.first,0),to:J(b.to.line+f,b.to.ch),text:[I(b.text)],origin:b.origin}}f=a.lastLine();b.to.line>f&&(b={from:b.from,to:J(f,P(a,f).text.length),text:[b.text[0]],origin:b.origin});b.removed=Pa(a,b.from,b.to);c||(c=ic(a,b));a.cm?cg(a.cm,b,h):xf(a,b,h);ac(a,c,vc)}}function cg(a,b,c){var h=a.doc,f=a.display,
d=b.from,k=b.to,e=!1,g=d.line;a.options.lineWrapping||(g=qa(Bb(P(h,d.line))),h.iter(g,k.line+1,function(a){if(a==f.maxLine)return e=!0}));-1<h.sel.contains(b.from,b.to)&&da(a);xf(h,b,c,ae(a));a.options.lineWrapping||(h.iter(g,d.line+b.text.length,function(a){var b=Na(a);b>f.maxLineLength&&(f.maxLine=a,f.maxLineLength=b,f.maxLineChanged=!0,e=!1)}),e&&(a.curOp.updateMaxLine=!0));h.frontier=Math.min(h.frontier,d.line);Qc(a,400);c=b.text.length-(k.line-d.line)-1;b.full?xb(a):d.line!=k.line||1!=b.text.length||
Jd(a.doc,b)?xb(a,d.line,k.line+1,c):hc(a,d.line,"text");c=ob(a,"changes");if((h=ob(a,"change"))||c)b={from:d,to:k,text:b.text,removed:b.removed,origin:b.origin},h&&Db(a,"change",a,b),c&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(b);a.display.selForContextMenu=null}function od(a,b,c,h,f){h||(h=c);if(0>Q(h,c)){var d=h;h=c;c=d}"string"==typeof b&&(b=a.splitLines(b));nd(a,{from:c,to:h,text:b,origin:f})}function bc(a,b,c,h){c<a.line?a.line+=h:b<a.line&&(a.line=b,a.ch=0)}function Df(a,b,c,h){for(var f=
0;f<a.length;++f){var d=a[f],k=!0;if(d.ranges)for(d.copied||(d=a[f]=d.deepCopy(),d.copied=!0),k=0;k<d.ranges.length;k++)bc(d.ranges[k].anchor,b,c,h),bc(d.ranges[k].head,b,c,h);else{for(var e=0;e<d.changes.length;++e){var g=d.changes[e];if(c<g.from.line)g.from=J(g.from.line+h,g.from.ch),g.to=J(g.to.line+h,g.to.ch);else if(b<=g.to.line){k=!1;break}}k||(a.splice(0,f+1),f=0)}}}function Ne(a,b){var c=b.from.line,h=b.to.line,f=b.text.length-(h-c)-1;Df(a.done,c,h,f);Df(a.undone,c,h,f)}function Md(a,b,c,
h){var f=b,d=b;"number"==typeof b?d=P(a,Math.max(a.first,Math.min(b,a.first+a.size-1))):f=qa(b);if(null==f)return null;h(d,f)&&a.cm&&hc(a.cm,f,c);return d}function Oe(a,b,c,h){var f=new Eb(a,c,h),d=a.cm;d&&f.noHScroll&&(d.display.alignWidgets=!0);Md(a,b,"widget",function(b){var c=b.widgets||(b.widgets=[]);null==f.insertAt?c.push(f):c.splice(Math.min(c.length-1,Math.max(0,f.insertAt)),0,f);f.line=b;d&&!wb(a,b)&&(c=U(b)<a.scrollTop,sa(b,b.height+of(f)),c&&Cd(d,f.height),d.curOp.forceUpdate=!0);return!0});
Db(d,"lineWidgetAdded",d,f,"number"==typeof b?b:qa(b));return f}function pd(a,b,c,h,f){if(h&&h.shared)return Ef(a,b,c,h,f);if(a.cm&&!a.cm.curOp)return tb(a.cm,pd)(a,b,c,h,f);var d=new wc(a,f);f=Q(b,c);h&&s(h,d,!1);if(0<f||0==f&&!1!==d.clearWhenEmpty)return d;d.replacedWith&&(d.collapsed=!0,d.widgetNode=g("span",[d.replacedWith],"CodeMirror-widget"),h.handleMouseEvents||d.widgetNode.setAttribute("cm-ignore-events","true"),h.insertLeft&&(d.widgetNode.insertLeft=!0));if(d.collapsed){if(ib(a,b.line,b,
c,d)||b.line!=c.line&&ib(a,c.line,b,c,d))throw Error("Inserting collapsed marker partially overlapping an existing one");$c=!0}d.addToHistory&&Zb(a,{from:b,to:c,origin:"markText"},a.sel,NaN);var k=b.line,e=a.cm,z;a.iter(k,c.line+1,function(a){e&&d.collapsed&&!e.options.lineWrapping&&Bb(a)==e.display.maxLine&&(z=!0);d.collapsed&&k!=b.line&&sa(a,0);var m=new Xa(d,k==b.line?b.ch:null,k==c.line?c.ch:null);a.markedSpans=a.markedSpans?a.markedSpans.concat([m]):[m];m.marker.attachLine(a);++k});d.collapsed&&
a.iter(b.line,c.line+1,function(b){wb(a,b)&&sa(b,0)});d.clearOnEnter&&ha(d,"beforeCursorEnter",function(){return d.clear()});d.readOnly&&(bg=!0,(a.history.done.length||a.history.undone.length)&&a.clearHistory());d.collapsed&&(d.id=++dg,d.atomic=!0);if(e){z&&(e.curOp.updateMaxLine=!0);if(d.collapsed)xb(e,b.line,c.line+1);else if(d.className||d.title||d.startStyle||d.endStyle||d.css)for(h=b.line;h<=c.line;h++)hc(e,h,"text");d.atomic&&uc(e.doc);Db(e,"markerAdded",e,d)}return d}function Ef(a,b,c,h,f){h=
s(h);h.shared=!1;var d=[pd(a,b,c,h,f)],k=d[0],e=h.widgetNode;Ib(a,function(a){e&&(h.widgetNode=e.cloneNode(!0));d.push(pd(a,K(a,b),K(a,c),h,f));for(var m=0;m<a.linked.length;++m)if(a.linked[m].isParent)return;k=I(d)});return new Nd(d,k)}function Ff(a){return a.findMarks(J(a.first,0),a.clipPos(J(a.lastLine())),function(a){return a.parent})}function zb(a){for(var b=function(b){b=a[b];var c=[b.primary.doc];Ib(b.primary.doc,function(a){return c.push(a)});for(var f=0;f<b.markers.length;f++){var p=b.markers[f];
-1==q(c,p.doc)&&(p.parent=null,b.markers.splice(f--,1))}},c=0;c<a.length;c++)b(c)}function Pe(a){var b=this;jc(b);if(!Aa(b,a)&&!Ya(b.display,a)){za(a);Da&&(Qe=+new Date);var c=sb(b,a,!0),h=a.dataTransfer.files;if(c&&!b.isReadOnly())if(h&&h.length&&window.FileReader&&window.File)for(var f=h.length,d=Array(f),k=0,e=function(a,m){if(!b.options.allowDropFileTypes||-1!=q(b.options.allowDropFileTypes,a.type)){var h=new FileReader;h.onload=tb(b,function(){var a=h.result;/[\x00-\x08\x0e-\x1f]{2}/.test(a)&&
(a="");d[m]=a;++k==f&&(c=K(b.doc,c),a={from:c,to:c,text:b.doc.splitLines(d.join(b.doc.lineSeparator())),origin:"paste"},nd(b.doc,a),tc(b.doc,Yb(c,Hb(a))))});h.readAsText(a)}},g=0;g<f;++g)e(h[g],g);else if(b.state.draggingText&&-1<b.doc.sel.contains(c))b.state.draggingText(a),setTimeout(function(){return b.display.input.focus()},20);else try{if(e=a.dataTransfer.getData("Text")){b.state.draggingText&&!b.state.draggingText.copy&&(g=b.listSelections());ac(b.doc,Yb(c,c));if(g)for(h=0;h<g.length;++h)od(b.doc,
"",g[h].anchor,g[h].head,"drag");b.replaceSelection(e,"around","paste");b.display.input.focus()}}catch(z){}}}function jc(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=null)}function Gf(a){if(document.body.getElementsByClassName)for(var b=document.body.getElementsByClassName("CodeMirror"),c=0;c<b.length;c++){var h=b[c].CodeMirror;h&&a(h)}}function Fg(){var a;ha(window,"resize",function(){null==a&&(a=setTimeout(function(){a=null;Gf(Re)},100))});
ha(window,"blur",function(){return Gf(Pc)})}function Re(a){var b=a.display;if(b.lastWrapHeight!=b.wrapper.clientHeight||b.lastWrapWidth!=b.wrapper.clientWidth)b.cachedCharWidth=b.cachedTextHeight=b.cachedPaddingH=null,b.scrollbarsClipped=!1,a.setSize()}function Gg(a){var b=a.split(/-(?!$)/);a=b[b.length-1];for(var c,h,f,d,k=0;k<b.length-1;k++){var e=b[k];if(/^(cmd|meta|m)$/i.test(e))d=!0;else if(/^a(lt)?$/i.test(e))c=!0;else if(/^(c|ctrl|control)$/i.test(e))h=!0;else if(/^s(hift)?$/i.test(e))f=!0;
else throw Error("Unrecognized modifier name: "+e);}c&&(a="Alt-"+a);h&&(a="Ctrl-"+a);d&&(a="Cmd-"+a);f&&(a="Shift-"+a);return a}function lh(a){var b={},c;for(c in a)if(a.hasOwnProperty(c)){var h=a[c];if(!/^(name|fallthrough|(de|at)tach)$/.test(c)){if("..."!=h)for(var f=F(c.split(" "),Gg),d=0;d<f.length;d++){var k=void 0,e=void 0;d==f.length-1?(e=f.join(" "),k=h):(e=f.slice(0,d+1).join(" "),k="...");var g=b[e];if(!g)b[e]=k;else if(g!=k)throw Error("Inconsistent bindings for "+e);}delete a[c]}}for(var z in b)a[z]=
b[z];return a}function Od(a,b,c,f){b=Hf(b);var d=b.call?b.call(a,f):b[a];if(!1===d)return"nothing";if("..."===d)return"multi";if(null!=d&&c(d))return"handled";if(b.fallthrough){if("[object Array]"!=Object.prototype.toString.call(b.fallthrough))return Od(a,b.fallthrough,c,f);for(d=0;d<b.fallthrough.length;d++){var k=Od(a,b.fallthrough[d],c,f);if(k)return k}}}function eg(a){a="string"==typeof a?a:Xc[a.keyCode];return"Ctrl"==a||"Alt"==a||"Shift"==a||"Mod"==a}function fg(a,b){if(rc&&34==a.keyCode&&a["char"])return!1;
var c=Xc[a.keyCode],f=c;if(null==f||a.altGraphKey)return!1;a.altKey&&"Alt"!=c&&(f="Alt-"+f);(gg?a.metaKey:a.ctrlKey)&&"Ctrl"!=c&&(f="Ctrl-"+f);(gg?a.ctrlKey:a.metaKey)&&"Cmd"!=c&&(f="Cmd-"+f);!b&&a.shiftKey&&"Shift"!=c&&(f="Shift-"+f);return f}function Hf(a){return"string"==typeof a?Se[a]:a}function Pd(a,b){for(var c=a.doc.sel.ranges,f=[],d=0;d<c.length;d++){for(var k=b(c[d]);f.length&&0>=Q(k.from,I(f).to);){var e=f.pop();if(0>Q(e.from,k.from)){k.from=e.from;break}}f.push(k)}Tb(a,function(){for(var b=
f.length-1;0<=b;b--)od(a.doc,"",f[b].from,f[b].to,"+delete");Ge(a)})}function Hg(a,b){var c=P(a.doc,b),f=Bb(c);f!=c&&(b=qa(f));return jb(!0,a,f,b,1)}function Te(a,b){var c=Hg(a,b.line),f=P(a.doc,c.line),d=ra(f,a.doc.direction);return d&&0!=d[0].level?c:(f=Math.max(0,f.text.search(/\S/)),J(c.line,b.line==c.line&&b.ch<=f&&b.ch?0:f,c.sticky))}function Ue(a,b,c){if("string"==typeof b&&(b=If[b],!b))return!1;a.display.input.ensurePolled();var f=a.display.shift,d=!1;try{a.isReadOnly()&&(a.state.suppressEdits=
!0),c&&(a.display.shift=!1),d=b(a)!=Jf}finally{a.display.shift=f,a.state.suppressEdits=!1}return d}function Ve(a,b,c){for(var f=0;f<a.state.keyMaps.length;f++){var d=Od(b,a.state.keyMaps[f],c,a);if(d)return d}return a.options.extraKeys&&Od(b,a.options.extraKeys,c,a)||Od(b,a.options.keyMap,c,a)}function We(a,b,c,f){var d=a.state.keySeq;if(d){if(eg(b))return"handled";Kf.set(50,function(){a.state.keySeq==d&&(a.state.keySeq=null,a.display.input.reset())});b=d+" "+b}f=Ve(a,b,f);"multi"==f&&(a.state.keySeq=
b);"handled"==f&&Db(a,"keyHandled",a,b,c);if("handled"==f||"multi"==f)za(c),zd(a);return d&&!f&&/\'$/.test(b)?(za(c),!0):!!f}function hg(a,b){var c=fg(b,!0);return c?b.shiftKey&&!a.state.keySeq?We(a,"Shift-"+c,b,function(b){return Ue(a,b,!0)})||We(a,c,b,function(b){if("string"==typeof b?/^go[A-Z]/.test(b):b.motion)return Ue(a,b)}):We(a,c,b,function(b){return Ue(a,b)}):!1}function Ig(a,b,c){return We(a,"'"+c+"'",b,function(b){return Ue(a,b,!0)})}function Jg(a){this.curOp.focus=l();if(!Aa(this,a)){Da&&
11>Wa&&27==a.keyCode&&(a.returnValue=!1);var b=a.keyCode;this.display.shift=16==b||a.shiftKey;var c=hg(this,a);rc&&(ig=c?b:null,!c&&88==b&&!Kg&&(ec?a.metaKey:a.ctrlKey)&&this.replaceSelection("",null,"cut"));18!=b||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||Pb(this)}}function Pb(a){function b(a){18!=a.keyCode&&a.altKey||(fd(c,"CodeMirror-crosshair"),ab(document,"keyup",b),ab(document,"mouseover",b))}var c=a.display.lineDiv;n(c,"CodeMirror-crosshair");ha(document,"keyup",b);ha(document,
"mouseover",b)}function Lg(a){16==a.keyCode&&(this.doc.sel.shift=!1);Aa(this,a)}function Mg(a){if(!(Ya(this.display,a)||Aa(this,a)||a.ctrlKey&&!a.altKey||ec&&a.metaKey)){var b=a.keyCode,c=a.charCode;if(rc&&b==ig)ig=null,za(a);else if(!rc||a.which&&!(10>a.which)||!hg(this,a))if(b=String.fromCharCode(null==c?b:c),"\b"!=b&&!Ig(this,a,b))this.display.input.onKeyPress(a)}}function Ng(a){var b=this.display;if(!(Aa(this,a)||b.activeTouch&&b.input.supportsTouch()))if(b.input.ensurePolled(),b.shift=a.shiftKey,
Ya(b,a))vb||(b.scroller.draggable=!1,setTimeout(function(){return b.scroller.draggable=!0},100));else if(!Qd(this,a,"gutterClick",!0)){var c=sb(this,a);window.focus();switch(kb(a)){case 1:this.state.selectingText?this.state.selectingText(a):c?jg(this,a,c):(a.target||a.srcElement)==b.scroller&&za(a);break;case 2:vb&&(this.state.lastMiddleDown=+new Date);c&&$b(this.doc,c);setTimeout(function(){return b.input.focus()},20);za(a);break;case 3:Lf?kg(this,a):de(this)}}}function jg(a,b,c){Da?setTimeout(E(Ee,
a),0):a.curOp.focus=l();var f=+new Date,d;kc&&kc.time>f-400&&0==Q(kc.pos,c)?d="triple":qd&&qd.time>f-400&&0==Q(qd.pos,c)?(d="double",kc={time:f,pos:c}):(d="single",qd={time:f,pos:c});var f=a.doc.sel,k=ec?b.metaKey:b.ctrlKey,e;a.options.dragDrop&&mh&&!a.isReadOnly()&&"single"==d&&-1<(e=f.contains(c))&&(0>Q((e=f.ranges[e]).from(),c)||0<c.xRel)&&(0<Q(e.to(),c)||0>c.xRel)?Og(a,b,c,k):Pg(a,b,c,d,k)}function Og(a,b,c,f){var d=a.display,k=!1,e=tb(a,function(b){vb&&(d.scroller.draggable=!1);a.state.draggingText=
!1;ab(document,"mouseup",e);ab(document,"mousemove",g);ab(d.scroller,"dragstart",z);ab(d.scroller,"drop",e);k||(za(b),f||$b(a.doc,c),vb||Da&&9==Wa?setTimeout(function(){document.body.focus();d.input.focus()},20):d.input.focus())}),g=function(a){k=k||10<=Math.abs(b.clientX-a.clientX)+Math.abs(b.clientY-a.clientY)},z=function(){return k=!0};vb&&(d.scroller.draggable=!0);a.state.draggingText=e;e.copy=ec?b.altKey:b.ctrlKey;d.scroller.dragDrop&&d.scroller.dragDrop();ha(document,"mouseup",e);ha(document,
"mousemove",g);ha(d.scroller,"dragstart",z);ha(d.scroller,"drop",e);de(a);setTimeout(function(){return d.input.focus()},20)}function Pg(a,b,c,f,d){function k(b){if(0!=Q(E,b))if(E=b,"rect"==f){for(var d=[],e=a.options.tabSize,w=D(P(x,c.line).text,c.ch,e),ja=D(P(x,b.line).text,b.ch,e),g=Math.min(w,ja),w=Math.max(w,ja),ja=Math.min(c.line,b.line),z=Math.min(a.lastLine(),Math.max(c.line,b.line));ja<=z;ja++){var l=P(x,ja).text,Va=O(l,g,e);g==w?d.push(new wa(J(ja,Va),J(ja,Va))):l.length>Va&&d.push(new wa(J(ja,
Va),J(ja,O(l,w,e))))}d.length||d.push(new wa(c,c));Za(x,Mb(q.ranges.slice(0,s).concat(d),s),{origin:"*mouse",scroll:!1});a.scrollIntoView(b)}else g=n,d=g.anchor,e=b,"single"!=f&&(b="double"==f?a.findWordAt(b):new wa(J(b.line,0),K(x,J(b.line+1,0))),0<Q(b.anchor,d)?(e=b.head,d=xa(g.from(),b.anchor)):(e=b.anchor,d=nb(g.to(),b.head))),b=q.ranges.slice(0),b[s]=new wa(K(x,d),e),Za(x,Mb(b,s),lg)}function e(b){var c=++fc,d=sb(a,b,!0,"rect"==f);if(d)if(0!=Q(d,E)){a.curOp.focus=l();k(d);var p=fe(z,x);(d.line>=
p.to||d.line<p.from)&&setTimeout(tb(a,function(){fc==c&&e(b)}),150)}else{var w=b.clientY<A.top?-20:b.clientY>A.bottom?20:0;w&&setTimeout(tb(a,function(){fc==c&&(z.scroller.scrollTop+=w,e(b))}),50)}}function g(b){a.state.selectingText=!1;fc=Infinity;za(b);z.input.focus();ab(document,"mousemove",F);ab(document,"mouseup",I);x.history.lastSelOrigin=null}var z=a.display,x=a.doc;za(b);var n,s,q=x.sel,r=q.ranges;d&&!b.shiftKey?(s=x.sel.contains(c),n=-1<s?r[s]:new wa(c,c)):(n=x.sel.primary(),s=x.sel.primIndex);
if(me?b.shiftKey&&b.metaKey:b.altKey)f="rect",d||(n=new wa(c,c)),c=sb(a,b,!0,!0),s=-1;else if("double"==f){var B=a.findWordAt(c);n=a.display.shift||x.extend?ld(x,n,B.anchor,B.head):B}else"triple"==f?(B=new wa(J(c.line,0),K(x,J(c.line+1,0))),n=a.display.shift||x.extend?ld(x,n,B.anchor,B.head):B):n=ld(x,n,c);d?-1==s?(s=r.length,Za(x,Mb(r.concat([n]),s),{scroll:!1,origin:"*mouse"})):1<r.length&&r[s].empty()&&"single"==f&&!b.shiftKey?(Za(x,Mb(r.slice(0,s).concat(r.slice(s+1)),0),{scroll:!1,origin:"*mouse"}),
q=x.sel):Ob(x,s,n,lg):(s=0,Za(x,new yb([n],0),lg),q=x.sel);var E=c,A=z.wrapper.getBoundingClientRect(),fc=0,F=tb(a,function(a){kb(a)?e(a):g(a)}),I=tb(a,g);a.state.selectingText=I;ha(document,"mousemove",F);ha(document,"mouseup",I)}function Qd(a,b,c,f){var d,k;try{d=b.clientX,k=b.clientY}catch(e){return!1}if(d>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;f&&za(b);f=a.display;var g=f.lineDiv.getBoundingClientRect();if(k>g.bottom||!ob(a,c))return ca(b);k-=g.top-f.viewOffset;
for(g=0;g<a.options.gutters.length;++g){var z=f.gutters.childNodes[g];if(z&&z.getBoundingClientRect().right>=d)return d=Ia(a.doc,k),La(a,c,a,d,a.options.gutters[g],b),ca(b)}}function kg(a,b){var c;(c=Ya(a.display,b))||(c=ob(a,"gutterContextMenu")?Qd(a,b,"gutterContextMenu",!1):!1);if(!c&&!Aa(a,b,"contextmenu"))a.display.input.onContextMenu(b)}function mg(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-");dd(a)}function Xe(a){Uc(a);
xb(a);ge(a)}function nh(a,b,c){!b!=!(c&&c!=ne)&&(c=a.display.dragFunctions,b=b?ha:ab,b(a.display.scroller,"dragstart",c.start),b(a.display.scroller,"dragenter",c.enter),b(a.display.scroller,"dragover",c.over),b(a.display.scroller,"dragleave",c.leave),b(a.display.scroller,"drop",c.drop))}function Qg(a){a.options.lineWrapping?(n(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(fd(a.display.wrapper,"CodeMirror-wrap"),pa(a));be(a);xb(a);dd(a);setTimeout(function(){return Rc(a)},
100)}function bb(a,b){var c=this;if(!(this instanceof bb))return new bb(a,b);this.options=b=b?s(b):{};s(Rg,b,!1);je(b);var f=b.value;"string"==typeof f&&(f=new Qb(f,b.mode,null,b.lineSeparator,b.direction));this.doc=f;var d=new bb.inputStyles[b.inputStyle](this),d=this.display=new Ta(a,f,d);d.wrapper.CodeMirror=this;Uc(this);mg(this);b.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");Cg(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,
suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Rd,keySeq:null,specialChars:null};b.autofocus&&!td&&d.input.focus();Da&&11>Wa&&setTimeout(function(){return c.display.input.reset(!0)},20);oh(this);Sg||(Fg(),Sg=!0);Sc(this);this.curOp.forceUpdate=!0;Dg(this,f);b.autofocus&&!td||this.hasFocus()?setTimeout(E(ce,this),20):Pc(this);for(var k in ng)if(ng.hasOwnProperty(k))ng[k](c,b[k],ne);Ag(this);b.finishInit&&b.finishInit(this);for(f=0;f<rd.length;++f)rd[f](c);
Ed(this);vb&&b.lineWrapping&&"optimizelegibility"==getComputedStyle(d.lineDiv).textRendering&&(d.lineDiv.style.textRendering="auto")}function oh(a){function b(){h.activeTouch&&(k=setTimeout(function(){return h.activeTouch=null},1E3),e=h.activeTouch,e.end=+new Date)}function f(a,b){if(null==b.left)return!0;var c=b.left-a.left,m=b.top-a.top;return 400<c*c+m*m}var h=a.display;ha(h.scroller,"mousedown",tb(a,Ng));Da&&11>Wa?ha(h.scroller,"dblclick",tb(a,function(b){if(!Aa(a,b)){var c=sb(a,b);!c||Qd(a,b,
"gutterClick",!0)||Ya(a.display,b)||(za(b),b=a.findWordAt(c),$b(a.doc,b.anchor,b.head))}})):ha(h.scroller,"dblclick",function(b){return Aa(a,b)||za(b)});Lf||ha(h.scroller,"contextmenu",function(b){return kg(a,b)});var k,e={end:0};ha(h.scroller,"touchstart",function(b){var c;if(c=!Aa(a,b))1!=b.touches.length?c=!1:(c=b.touches[0],c=1>=c.radiusX&&1>=c.radiusY),c=!c;c&&(h.input.ensurePolled(),clearTimeout(k),c=+new Date,h.activeTouch={start:c,moved:!1,prev:300>=c-e.end?e:null},1==b.touches.length&&(h.activeTouch.left=
b.touches[0].pageX,h.activeTouch.top=b.touches[0].pageY))});ha(h.scroller,"touchmove",function(){h.activeTouch&&(h.activeTouch.moved=!0)});ha(h.scroller,"touchend",function(c){var d=h.activeTouch;if(d&&!Ya(h,c)&&null!=d.left&&!d.moved&&300>new Date-d.start){var k=a.coordsChar(h.activeTouch,"page"),d=!d.prev||f(d,d.prev)?new wa(k,k):!d.prev.prev||f(d,d.prev.prev)?a.findWordAt(k):new wa(J(k.line,0),K(a.doc,J(k.line+1,0)));a.setSelection(d.anchor,d.head);a.focus();za(c)}b()});ha(h.scroller,"touchcancel",
b);ha(h.scroller,"scroll",function(){h.scroller.clientHeight&&(Dd(a,h.scroller.scrollTop),gc(a,h.scroller.scrollLeft,!0),La(a,"scroll",a))});ha(h.scroller,"mousewheel",function(b){return ke(a,b)});ha(h.scroller,"DOMMouseScroll",function(b){return ke(a,b)});ha(h.wrapper,"scroll",function(){return h.wrapper.scrollTop=h.wrapper.scrollLeft=0});h.dragFunctions={enter:function(b){Aa(a,b)||gb(b)},over:function(b){if(!Aa(a,b)){var f=sb(a,b);if(f){var h=document.createDocumentFragment();yd(a,f,h);a.display.dragCursor||
(a.display.dragCursor=d("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),a.display.lineSpace.insertBefore(a.display.dragCursor,a.display.cursorDiv));c(a.display.dragCursor,h)}gb(b)}},start:function(b){if(Da&&(!a.state.draggingText||100>+new Date-Qe))gb(b);else if(!Aa(a,b)&&!Ya(a.display,b)&&(b.dataTransfer.setData("Text",a.getSelection()),b.dataTransfer.effectAllowed="copyMove",b.dataTransfer.setDragImage&&!og)){var c=d("img",null,null,"position: fixed; left: 0; top: 0;");c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";
rc&&(c.width=c.height=1,a.display.wrapper.appendChild(c),c._top=c.offsetTop);b.dataTransfer.setDragImage(c,0,0);rc&&c.parentNode.removeChild(c)}},drop:tb(a,Pe),leave:function(b){Aa(a,b)||jc(a)}};var g=h.input.getField();ha(g,"keyup",function(b){return Lg.call(a,b)});ha(g,"keydown",tb(a,Jg));ha(g,"keypress",tb(a,Mg));ha(g,"focus",function(b){return ce(a,b)});ha(g,"blur",function(b){return Pc(a,b)})}function Ye(a,b,c,f){var d=a.doc,k;null==c&&(c="add");"smart"==c&&(d.mode.indent?k=G(a,b):c="prev");
var e=a.options.tabSize,g=P(d,b),z=D(g.text,null,e);g.stateAfter&&(g.stateAfter=null);var x=g.text.match(/^\s*/)[0],l;if(!f&&!/\S/.test(g.text))l=0,c="not";else if("smart"==c&&(l=d.mode.indent(k,g.text.slice(x.length),g.text),l==Jf||150<l)){if(!f)return;c="prev"}"prev"==c?l=b>d.first?D(P(d,b-1).text,null,e):0:"add"==c?l=z+a.options.indentUnit:"subtract"==c?l=z-a.options.indentUnit:"number"==typeof c&&(l=z+c);l=Math.max(0,l);c="";f=0;if(a.options.indentWithTabs)for(a=Math.floor(l/e);a;--a)f+=e,c+=
"\t";f<l&&(c+=r(l-f));if(c!=x)return od(d,c,J(b,0),J(b,x.length),"+input"),g.stateAfter=null,!0;for(e=0;e<d.sel.ranges.length;e++)if(g=d.sel.ranges[e],g.head.line==b&&g.head.ch<x.length){b=J(b,x.length);Ob(d,e,new wa(b,b));break}}function pg(a){Ab=a}function oe(a,b,c,f,d){var k=a.doc;a.display.shift=!1;f||(f=k.sel);var e=a.state.pasteIncoming||"paste"==d,g=Ze(b),z=null;if(e&&1<f.ranges.length)if(Ab&&Ab.text.join("\n")==b){if(0==f.ranges.length%Ab.text.length)for(var z=[],x=0;x<Ab.text.length;x++)z.push(k.splitLines(Ab.text[x]))}else g.length==
f.ranges.length&&(z=F(g,function(a){return[a]}));for(var l,x=f.ranges.length-1;0<=x;x--){l=f.ranges[x];var n=l.from(),s=l.to();l.empty()&&(c&&0<c?n=J(n.line,n.ch-c):a.state.overwrite&&!e?s=J(s.line,Math.min(P(k,s.line).text.length,s.ch+I(g).length)):Ab&&Ab.lineWise&&Ab.text.join("\n")==b&&(n=s=J(n.line,0)));l=a.curOp.updateInput;n={from:n,to:s,text:z?z[x%z.length]:g,origin:d||(e?"paste":a.state.cutIncoming?"cut":"+input")};nd(a.doc,n);Db(a,"inputRead",a,n)}b&&!e&&pe(a,b);Ge(a);a.curOp.updateInput=
l;a.curOp.typing=!0;a.state.pasteIncoming=a.state.cutIncoming=!1}function $e(a,b){var c=a.clipboardData&&a.clipboardData.getData("Text");if(c)return a.preventDefault(),b.isReadOnly()||b.options.disableInput||Tb(b,function(){return oe(b,c,0,null,"paste")}),!0}function pe(a,b){if(a.options.electricChars&&a.options.smartIndent)for(var c=a.doc.sel,f=c.ranges.length-1;0<=f;f--){var d=c.ranges[f];if(!(100<d.head.ch||f&&c.ranges[f-1].head.line==d.head.line)){var k=a.getModeAt(d.head),e=!1;if(k.electricChars)for(var g=
0;g<k.electricChars.length;g++){if(-1<b.indexOf(k.electricChars.charAt(g))){e=Ye(a,d.head.line,"smart");break}}else k.electricInput&&k.electricInput.test(P(a.doc,d.head.line).text.slice(0,d.head.ch))&&(e=Ye(a,d.head.line,"smart"));e&&Db(a,"electricInput",a,d.head.line)}}}function Tg(a){for(var b=[],c=[],f=0;f<a.doc.sel.ranges.length;f++){var d=a.doc.sel.ranges[f].head.line,d={anchor:J(d,0),head:J(d+1,0)};c.push(d);b.push(a.getRange(d.anchor,d.head))}return{text:b,ranges:c}}function qe(a,b){a.setAttribute("autocorrect",
"off");a.setAttribute("autocapitalize","off");a.setAttribute("spellcheck",!!b)}function re(){var a=d("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),b=d("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");vb?a.style.width="1000px":a.setAttribute("wrap","off");Gc&&(a.style.border="1px solid black");qe(a);return b}function Sd(a,b,c,f,d){function k(f){var h;h=d?dc(a.cm,z,b,c):Gb(z,b,c);if(null==h){if(f=!f)f=b.line+
c,f<a.first||f>=a.first+a.size?f=!1:(b=new J(f,b.ch,b.sticky),f=z=P(a,f));if(f)b=jb(d,a.cm,z,b.line,c);else return!1}else b=h;return!0}var e=b,g=c,z=P(a,b.line);if("char"==f)k();else if("column"==f)k(!0);else if("word"==f||"group"==f){var x=null;f="group"==f;for(var l=a.cm&&a.cm.getHelper(b,"wordChars"),n=!0;!(0>c)||k(!n);n=!1){var s=z.text.charAt(b.ch)||"\n",s=ka(s,l)?"w":f&&"\n"==s?"n":!f||/\s/.test(s)?null:"p";!f||n||s||(s="s");if(x&&x!=s){0>c&&(c=1,k(),b.sticky="after");break}s&&(x=s);if(0<c&&
!k(!n))break}}g=Me(a,b,e,g,!0);Ga(e,g)&&(g.hitSide=!0);return g}function se(a,b,c,f){var d=a.doc,k=b.left,e;"page"==f?(f=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),f=Math.max(f-0.5*pc(a.display),3),e=(0<c?b.bottom:b.top)+c*f):"line"==f&&(e=0<c?b.bottom+3:b.top-3);for(var g;;){g=xd(a,k,e);if(!g.outside)break;if(0>c?0>=e:e>=d.height){g.hitSide=!0;break}e+=5*c}return g}function af(a,b){var c=vd(a,b.line);if(!c||c.hidden)return null;var f=P(a.doc,
b.line),c=Vf(c,f,b.line),f=ra(f,a.doc.direction),d="left";f&&(d=ma(f,b.ch)%2?"right":"left");c=bd(c.map,b.ch,d);c.offset="right"==c.collapse?c.end:c.start;return c}function qg(a){for(;a;a=a.parentNode)if(/CodeMirror-gutter-wrapper/.test(a.className))return!0;return!1}function Yc(a,b){b&&(a.bad=!0);return a}function bf(a,b,c,f,d){function k(a){return function(b){return b.id==a}}function e(a){a&&(x&&(z+=l,x=!1),z+=a)}function g(b){if(1==b.nodeType){var c=b.getAttribute("cm-text");if(null!=c)e(c||b.textContent.replace(/\u200b/g,
""));else{var c=b.getAttribute("cm-marker"),p;if(c)b=a.findMarks(J(f,0),J(d+1,0),k(+c)),b.length&&(p=b[0].find())&&e(Pa(a.doc,p.from,p.to).join(l));else if("false"!=b.getAttribute("contenteditable")){(p=/^(pre|div|p)$/i.test(b.nodeName))&&x&&(z+=l,x=!1);for(c=0;c<b.childNodes.length;c++)g(b.childNodes[c]);p&&(x=!0)}}}else 3==b.nodeType&&e(b.nodeValue)}for(var z="",x=!1,l=a.doc.lineSeparator();;){g(b);if(b==c)break;b=b.nextSibling}return z}function Td(a,b,c){var f;if(b==a.display.lineDiv){f=a.display.lineDiv.childNodes[c];
if(!f)return Yc(a.clipPos(J(a.display.viewTo-1)),!0);b=null;c=0}else for(f=b;;f=f.parentNode){if(!f||f==a.display.lineDiv)return null;if(f.parentNode&&f.parentNode==a.display.lineDiv)break}for(var d=0;d<a.display.view.length;d++){var k=a.display.view[d];if(k.node==f)return te(k,b,c)}}function te(a,b,c){function f(b,c,h){for(var d=-1;d<(l?l.length:0);d++)for(var k=0>d?x.map:l[d],e=0;e<k.length;e+=3){var p=k[e+2];if(p==b||p==c){c=qa(0>d?a.line:a.rest[d]);d=k[e]+h;if(0>h||p!=b)d=k[e+(h?1:0)];return J(c,
d)}}}var d=a.text.firstChild,k=!1;if(!b||!e(d,b))return Yc(J(qa(a.line),0),!0);if(b==d&&(k=!0,b=d.childNodes[c],c=0,!b))return c=a.rest?I(a.rest):a.line,Yc(J(qa(c),c.text.length),k);var g=3==b.nodeType?b:null,z=b;g||1!=b.childNodes.length||3!=b.firstChild.nodeType||(g=b.firstChild,c&&(c=g.nodeValue.length));for(;z.parentNode!=d;)z=z.parentNode;var x=a.measure,l=x.maps;if(b=f(g,z,c))return Yc(b,k);d=z.nextSibling;for(g=g?g.nodeValue.length-c:0;d;d=d.nextSibling){if(b=f(d,d.firstChild,0))return Yc(J(b.line,
b.ch-g),k);g+=d.textContent.length}for(z=z.previousSibling;z;z=z.previousSibling){if(b=f(z,z.firstChild,-1))return Yc(J(b.line,b.ch+c),k);c+=z.textContent.length}}var ub=navigator.userAgent,cf=navigator.platform,Vb=/gecko\/\d/i.test(ub),df=/MSIE \d/.test(ub),Ug=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ub),ef=/Edge\/(\d+)/.exec(ub),Da=df||Ug||ef,Wa=Da&&(df?document.documentMode||6:+(ef||Ug)[1]),vb=!ef&&/WebKit\//.test(ub),Vg=vb&&/Qt\/\d+\.\d+/.test(ub),rf=!ef&&/Chrome\//.test(ub),rc=/Opera\//.test(ub),
og=/Apple Computer/.test(navigator.vendor),ph=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ub),Zf=/PhantomJS/.test(ub),Gc=!ef&&/AppleWebKit/.test(ub)&&/Mobile\/\w+/.test(ub),ed=/Android/.test(ub),td=Gc||ed||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ub),ec=Gc||/Mac/.test(cf),me=/\bCrOS\b/.test(ub),rg=/win/i.test(cf),Hc=rc&&ub.match(/Version\/(\d*\.\d*)/);Hc&&(Hc=Number(Hc[1]));Hc&&15<=Hc&&(rc=!1,vb=!0);var gg=ec&&(Vg||rc&&(null==Hc||12.11>Hc)),Lf=Vb||Da&&9<=Wa,fd=function(b,c){var f=b.className,
h=a(c).exec(f);if(h){var d=f.slice(h.index+h[0].length);b.className=f.slice(0,h.index)+(d?h[1]+d:"")}},ud;ud=document.createRange?function(a,b,c,f){var d=document.createRange();d.setEnd(f||a,c);d.setStart(a,b);return d}:function(a,b,c){var f=document.body.createTextRange();try{f.moveToElementText(a.parentNode)}catch(d){return f}f.collapse(!0);f.moveEnd("character",c);f.moveStart("character",b);return f};var Ud=function(a){a.select()};Gc?Ud=function(a){a.selectionStart=0;a.selectionEnd=a.value.length}:
Da&&(Ud=function(a){try{a.select()}catch(b){}});var Rd=function(){this.id=null};Rd.prototype.set=function(a,b){clearTimeout(this.id);this.id=setTimeout(b,a)};var tg=30,Jf={toString:function(){return"CodeMirror.Pass"}},vc={scroll:!1},lg={origin:"*mouse"},ff={origin:"+move"},hf=[""],Zg=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,sg=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,
bg=!1,$c=!1,ye=null,$g=function(){function a(b){return 247>=b?c.charAt(b):1424<=b&&1524>=b?"R":1536<=b&&1785>=b?f.charAt(b-1536):1774<=b&&2220>=b?"r":8192<=b&&8203>=b?"w":8204==b?"b":"L"}function b(a,c,f){this.level=a;this.from=c;this.to=f}var c="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",f="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",
d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,k=/[stwN]/,e=/[LRr]/,g=/[Lb1n]/,z=/[1n]/;return function(c,f){var h="ltr"==f?"L":"R";if(0==c.length||"ltr"==f&&!d.test(c))return!1;for(var p=c.length,x=[],l=0;l<p;++l)x.push(a(c.charCodeAt(l)));for(var l=0,n=h;l<p;++l){var s=x[l];"m"==s?x[l]=n:n=s}l=0;for(n=h;l<p;++l)s=x[l],"1"==s&&"r"==n?x[l]="n":e.test(s)&&(n=s,"r"==s&&(x[l]="R"));l=1;for(n=x[0];l<p-1;++l)s=x[l],"+"==s&&"1"==n&&"1"==x[l+1]?x[l]="1":","!=s||n!=x[l+1]||"1"!=n&&"n"!=n||(x[l]=n),n=s;for(l=
0;l<p;++l)if(n=x[l],","==n)x[l]="N";else if("%"==n){n=void 0;for(n=l+1;n<p&&"%"==x[n];++n);for(s=l&&"!"==x[l-1]||n<p&&"1"==x[n]?"1":"N";l<n;++l)x[l]=s;l=n-1}l=0;for(n=h;l<p;++l)s=x[l],"L"==n&&"1"==s?x[l]="L":e.test(s)&&(n=s);for(n=0;n<p;++n)if(k.test(x[n])){l=void 0;for(l=n+1;l<p&&k.test(x[l]);++l);s="L"==(n?x[n-1]:h);for(s=s==("L"==(l<p?x[l]:h))?s?"L":"R":h;n<l;++n)x[n]=s;n=l-1}for(var h=[],q,l=0;l<p;)if(g.test(x[l])){n=l;for(++l;l<p&&g.test(x[l]);++l);h.push(new b(0,n,l))}else{var r=l,n=h.length;
for(++l;l<p&&"L"!=x[l];++l);for(s=r;s<l;)if(z.test(x[s])){r<s&&h.splice(n,0,new b(1,r,s));r=s;for(++s;s<l&&z.test(x[s]);++s);h.splice(n,0,new b(2,r,s));r=s}else++s;r<l&&h.splice(n,0,new b(1,r,l))}1==h[0].level&&(q=c.match(/^\s+/))&&(h[0].from=q[0].length,h.unshift(new b(0,0,q[0].length)));1==I(h).level&&(q=c.match(/\s+$/))&&(I(h).to-=q[0].length,h.push(new b(0,p-q[0].length,p)));return"rtl"==f?h.reverse():h}}(),mf=[],ha=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+
b,c):(a=a._handlers||(a._handlers={}),a[b]=(a[b]||mf).concat(c))},mh=function(){if(Da&&9>Wa)return!1;var a=d("div");return"draggable"in a||"dragDrop"in a}(),Of,Qf,Ze=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c=[],f=a.length;b<=f;){var d=a.indexOf("\n",b);-1==d&&(d=a.length);var k=a.slice(b,"\r"==a.charAt(d-1)?d-1:d),e=k.indexOf("\r");-1!=e?(c.push(k.slice(0,e)),b+=e+1):(c.push(k),b=d+1)}return c}:function(a){return a.split(/\r\n?|\n/)},qh=window.getSelection?function(a){try{return a.selectionStart!=
a.selectionEnd}catch(b){return!1}}:function(a){var b;try{b=a.ownerDocument.selection.createRange()}catch(c){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1},Kg=function(){var a=d("div");if("oncopy"in a)return!0;a.setAttribute("oncopy","return;");return"function"==typeof a.oncopy}(),Wf=null,Pf={},Lc={},Wd={},rb=function(a,b){this.pos=this.start=0;this.string=a;this.tabSize=b||8;this.lineStart=this.lastColumnPos=this.lastColumnValue=0};rb.prototype.eol=function(){return this.pos>=
this.string.length};rb.prototype.sol=function(){return this.pos==this.lineStart};rb.prototype.peek=function(){return this.string.charAt(this.pos)||void 0};rb.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)};rb.prototype.eat=function(a){var b=this.string.charAt(this.pos);if("string"==typeof a?b==a:b&&(a.test?a.test(b):a(b)))return++this.pos,b};rb.prototype.eatWhile=function(a){for(var b=this.pos;this.eat(a););return this.pos>b};rb.prototype.eatSpace=function(){for(var a=
this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a};rb.prototype.skipToEnd=function(){this.pos=this.string.length};rb.prototype.skipTo=function(a){a=this.string.indexOf(a,this.pos);if(-1<a)return this.pos=a,!0};rb.prototype.backUp=function(a){this.pos-=a};rb.prototype.column=function(){this.lastColumnPos<this.start&&(this.lastColumnValue=D(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-
(this.lineStart?D(this.string,this.lineStart,this.tabSize):0)};rb.prototype.indentation=function(){return D(this.string,null,this.tabSize)-(this.lineStart?D(this.string,this.lineStart,this.tabSize):0)};rb.prototype.match=function(a,b,c){if("string"==typeof a){var f=function(a){return c?a.toLowerCase():a},d=this.string.substr(this.pos,a.length);if(f(d)==f(a))return!1!==b&&(this.pos+=a.length),!0}else{if((a=this.string.slice(this.pos).match(a))&&0<a.index)return null;a&&!1!==b&&(this.pos+=a[0].length);
return a}};rb.prototype.current=function(){return this.string.slice(this.start,this.pos)};rb.prototype.hideFirstChars=function(a,b){this.lineStart+=a;try{return b()}finally{this.lineStart-=a}};var jd=function(a,b,c){this.text=a;Jb(this,b);this.height=c?c(this):1};jd.prototype.lineNo=function(){return qa(this)};V(jd);var ug={},bh={},Xd=null,ze=null,pf={left:0,right:0,top:0,bottom:0},Nc,sd=function(a,b,c){this.cm=c;var f=this.vert=d("div",[d("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),
k=this.horiz=d("div",[d("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");a(f);a(k);ha(f,"scroll",function(){f.clientHeight&&b(f.scrollTop,"vertical")});ha(k,"scroll",function(){k.clientWidth&&b(k.scrollLeft,"horizontal")});this.checkedZeroWidth=!1;Da&&8>Wa&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};sd.prototype.update=function(a){var b=a.scrollWidth>a.clientWidth+1,c=a.scrollHeight>a.clientHeight+1,f=a.nativeBarWidth;c?(this.vert.style.display="block",
this.vert.style.bottom=b?f+"px":"0",this.vert.firstChild.style.height=Math.max(0,a.scrollHeight-a.clientHeight+(a.viewHeight-(b?f:0)))+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0");b?(this.horiz.style.display="block",this.horiz.style.right=c?f+"px":"0",this.horiz.style.left=a.barLeft+"px",this.horiz.firstChild.style.width=Math.max(0,a.scrollWidth-a.clientWidth+(a.viewWidth-a.barLeft-(c?f:0)))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0");!this.checkedZeroWidth&&
0<a.clientHeight&&(0==f&&this.zeroWidthHack(),this.checkedZeroWidth=!0);return{right:c?f:0,bottom:b?f:0}};sd.prototype.setScrollLeft=function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a);this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")};sd.prototype.setScrollTop=function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a);this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")};sd.prototype.zeroWidthHack=function(){this.horiz.style.height=
this.vert.style.width=ec&&!ph?"12px":"18px";this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new Rd;this.disableVert=new Rd};sd.prototype.enableZeroWidthBar=function(a,b,c){function f(){var d=a.getBoundingClientRect();("vert"==c?document.elementFromPoint(d.right-1,(d.top+d.bottom)/2):document.elementFromPoint((d.right+d.left)/2,d.bottom-1))!=a?a.style.pointerEvents="none":b.set(1E3,f)}a.style.pointerEvents="auto";b.set(1E3,f)};sd.prototype.clear=function(){var a=
this.horiz.parentNode;a.removeChild(this.horiz);a.removeChild(this.vert)};var Vd=function(){};Vd.prototype.update=function(){return{bottom:0,right:0}};Vd.prototype.setScrollLeft=function(){};Vd.prototype.setScrollTop=function(){};Vd.prototype.clear=function(){};var Xf={"native":sd,"null":Vd},Yf=0,ie=function(a,b,c){var f=a.display;this.viewport=b;this.visible=fe(f,a.doc,b);this.editorIsHidden=!f.wrapper.offsetWidth;this.wrapperHeight=f.wrapper.clientHeight;this.wrapperWidth=f.wrapper.clientWidth;
this.oldDisplayWidth=Zd(a);this.force=c;this.dims=wd(a);this.events=[]};ie.prototype.signal=function(a,b){ob(a,b)&&this.events.push(arguments)};ie.prototype.finish=function(){for(var a=0;a<this.events.length;a++)La.apply(null,this.events[a])};var sc=0,cb=null;Da?cb=-0.53:Vb?cb=15:rf?cb=-0.7:og&&(cb=-1/3);var yb=function(a,b){this.ranges=a;this.primIndex=b};yb.prototype.primary=function(){return this.ranges[this.primIndex]};yb.prototype.equals=function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||
a.ranges.length!=this.ranges.length)return!1;for(var b=0;b<this.ranges.length;b++){var c=this.ranges[b],f=a.ranges[b];if(!Ga(c.anchor,f.anchor)||!Ga(c.head,f.head))return!1}return!0};yb.prototype.deepCopy=function(){for(var a=[],b=0;b<this.ranges.length;b++)a[b]=new wa(Z(this.ranges[b].anchor),Z(this.ranges[b].head));return new yb(a,this.primIndex)};yb.prototype.somethingSelected=function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1};yb.prototype.contains=function(a,
b){b||(b=a);for(var c=0;c<this.ranges.length;c++){var f=this.ranges[c];if(0<=Q(b,f.from())&&0>=Q(a,f.to()))return c}return-1};var wa=function(a,b){this.anchor=a;this.head=b};wa.prototype.from=function(){return xa(this.anchor,this.head)};wa.prototype.to=function(){return nb(this.anchor,this.head)};wa.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};var xc=function(a){this.lines=a;this.parent=null;for(var b=0,c=0;c<a.length;++c)a[c].parent=this,b+=a[c].height;
this.height=b};xc.prototype.chunkSize=function(){return this.lines.length};xc.prototype.removeInner=function(a,b){for(var c=a,f=a+b;c<f;++c){var d=this.lines[c];this.height-=d.height;var k=d;k.parent=null;Fb(k);Db(d,"delete")}this.lines.splice(a,b)};xc.prototype.collapse=function(a){a.push.apply(a,this.lines)};xc.prototype.insertInner=function(a,b,c){this.height+=c;this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a));for(a=0;a<b.length;++a)b[a].parent=this};xc.prototype.iterN=function(a,
b,c){for(b=a+b;a<b;++a)if(c(this.lines[a]))return!0};var lc=function(a){this.children=a;for(var b=0,c=0,f=0;f<a.length;++f){var d=a[f],b=b+d.chunkSize(),c=c+d.height;d.parent=this}this.size=b;this.height=c;this.parent=null};lc.prototype.chunkSize=function(){return this.size};lc.prototype.removeInner=function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var f=this.children[c],d=f.chunkSize();if(a<d){var k=Math.min(b,d-a),e=f.height;f.removeInner(a,k);this.height-=e-f.height;d==k&&(this.children.splice(c--,
1),f.parent=null);if(0==(b-=k))break;a=0}else a-=d}25>this.size-b&&(1<this.children.length||!(this.children[0]instanceof xc))&&(c=[],this.collapse(c),this.children=[new xc(c)],this.children[0].parent=this)};lc.prototype.collapse=function(a){for(var b=0;b<this.children.length;++b)this.children[b].collapse(a)};lc.prototype.insertInner=function(a,b,c){this.size+=b.length;this.height+=c;for(var f=0;f<this.children.length;++f){var d=this.children[f],k=d.chunkSize();if(a<=k){d.insertInner(a,b,c);if(d.lines&&
50<d.lines.length){for(b=a=d.lines.length%25+25;b<d.lines.length;)c=new xc(d.lines.slice(b,b+=25)),d.height-=c.height,this.children.splice(++f,0,c),c.parent=this;d.lines=d.lines.slice(0,a);this.maybeSpill()}break}a-=k}};lc.prototype.maybeSpill=function(){if(!(10>=this.children.length)){var a=this;do{var b=a.children.splice(a.children.length-5,5),b=new lc(b);if(a.parent){a.size-=b.size;a.height-=b.height;var c=q(a.parent.children,a);a.parent.children.splice(c+1,0,b)}else c=new lc(a.children),c.parent=
a,a.children=[c,b],a=c;b.parent=a.parent}while(10<a.children.length);a.parent.maybeSpill()}};lc.prototype.iterN=function(a,b,c){for(var f=0;f<this.children.length;++f){var d=this.children[f],k=d.chunkSize();if(a<k){k=Math.min(b,k-a);if(d.iterN(a,k,c))return!0;if(0==(b-=k))break;a=0}else a-=k}};var Eb=function(a,b,c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.doc=a;this.node=b};Eb.prototype.clear=function(){var a=this.doc.cm,b=this.line.widgets,c=this.line,f=qa(c);if(null!=f&&b){for(var d=
0;d<b.length;++d)b[d]==this&&b.splice(d--,1);b.length||(c.widgets=null);var k=of(this);sa(c,Math.max(0,c.height-k));a&&(Tb(a,function(){var b=-k;U(c)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&Cd(a,b);hc(a,f,"widget")}),Db(a,"lineWidgetCleared",a,this,f))}};Eb.prototype.changed=function(){var a=this,b=this.height,c=this.doc.cm,f=this.line;this.height=null;var d=of(this)-b;d&&(sa(f,f.height+d),c&&Tb(c,function(){c.curOp.forceUpdate=!0;U(f)<(c.curOp&&c.curOp.scrollTop||c.doc.scrollTop)&&Cd(c,d);
Db(c,"lineWidgetChanged",c,a,qa(f))}))};V(Eb);var dg=0,wc=function(a,b){this.lines=[];this.type=b;this.doc=a;this.id=++dg};wc.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,b=a&&!a.curOp;b&&Sc(a);if(ob(this,"clear")){var c=this.find();c&&Db(this,"clear",c.from,c.to)}for(var f=c=null,d=0;d<this.lines.length;++d){var k=this.lines[d],e=X(k.markedSpans,this);a&&!this.collapsed?hc(a,qa(k),"text"):a&&(null!=e.to&&(f=qa(k)),null!=e.from&&(c=qa(k)));for(var g=k,z=k.markedSpans,x=
e,l=void 0,n=0;n<z.length;++n)z[n]!=x&&(l||(l=[])).push(z[n]);g.markedSpans=l;null==e.from&&this.collapsed&&!wb(this.doc,k)&&a&&sa(k,pc(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(d=0;d<this.lines.length;++d)k=Bb(this.lines[d]),e=Na(k),e>a.display.maxLineLength&&(a.display.maxLine=k,a.display.maxLineLength=e,a.display.maxLineChanged=!0);null!=c&&a&&this.collapsed&&xb(a,c,f+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&uc(a.doc));
a&&Db(a,"markerCleared",a,this,c,f);b&&Ed(a);this.parent&&this.parent.clear()}};wc.prototype.find=function(a,b){null==a&&"bookmark"==this.type&&(a=1);for(var c,f,d=0;d<this.lines.length;++d){var k=this.lines[d],e=X(k.markedSpans,this);if(null!=e.from&&(c=J(b?k:qa(k),e.from),-1==a))return c;if(null!=e.to&&(f=J(b?k:qa(k),e.to),1==a))return f}return c&&{from:c,to:f}};wc.prototype.changed=function(){var a=this,b=this.find(-1,!0),c=this,f=this.doc.cm;b&&f&&Tb(f,function(){var d=b.line,k=qa(b.line);if(k=
vd(f,k))Be(k),f.curOp.selectionChanged=f.curOp.forceUpdate=!0;f.curOp.updateMaxLine=!0;wb(c.doc,d)||null==c.height||(k=c.height,c.height=null,(k=of(c)-k)&&sa(d,d.height+k));Db(f,"markerChanged",f,a)})};wc.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;b.maybeHiddenMarkers&&-1!=q(b.maybeHiddenMarkers,this)||(b.maybeUnhiddenMarkers||(b.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)};wc.prototype.detachLine=function(a){this.lines.splice(q(this.lines,
a),1);!this.lines.length&&this.doc.cm&&(a=this.doc.cm.curOp,(a.maybeHiddenMarkers||(a.maybeHiddenMarkers=[])).push(this))};V(wc);var Nd=function(a,b){this.markers=a;this.primary=b;for(var c=0;c<a.length;++c)a[c].parent=this};Nd.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();Db(this,"clear")}};Nd.prototype.find=function(a,b){return this.primary.find(a,b)};V(Nd);var rh=0,Qb=function(a,b,c,f,d){if(!(this instanceof
Qb))return new Qb(a,b,c,f,d);null==c&&(c=0);lc.call(this,[new xc([new jd("",null)])]);this.first=c;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.frontier=c;c=J(c,0);this.sel=Yb(c);this.history=new Ke(null);this.id=++rh;this.modeOption=b;this.lineSep=f;this.direction="rtl"==d?"rtl":"ltr";this.extend=!1;"string"==typeof a&&(a=this.splitLines(a));xf(this,{from:c,to:c,text:a});Za(this,Yb(c),vc)};Qb.prototype=$(lc.prototype,{constructor:Qb,iter:function(a,b,c){c?this.iterN(a-
this.first,b-a,c):this.iterN(this.first,this.first+this.size,a)},insert:function(a,b){for(var c=0,f=0;f<b.length;++f)c+=b[f].height;this.insertInner(a-this.first,b,c)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=ya(this,this.first,this.first+this.size);return!1===a?b:b.join(a||this.lineSeparator())},setValue:Sa(function(a){var b=J(this.first,0),c=this.first+this.size-1;nd(this,{from:b,to:J(c,P(this,c).text.length),text:this.splitLines(a),origin:"setValue",full:!0},
!0);this.cm&&uf(this.cm,0,0);Za(this,Yb(b),vc)}),replaceRange:function(a,b,c,f){b=K(this,b);c=c?K(this,c):b;od(this,a,b,c,f)},getRange:function(a,b,c){a=Pa(this,K(this,a),K(this,b));return!1===c?a:a.join(c||this.lineSeparator())},getLine:function(a){return(a=this.getLineHandle(a))&&a.text},getLineHandle:function(a){if(Fa(this,a))return P(this,a)},getLineNumber:function(a){return qa(a)},getLineHandleVisualStart:function(a){"number"==typeof a&&(a=P(this,a));return Bb(a)},lineCount:function(){return this.size},
firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return K(this,a)},getCursor:function(a){var b=this.sel.primary();return null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||"to"==a||!1===a?b.to():b.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Sa(function(a,b,c){a=K(this,"number"==typeof a?J(a,b||0):a);Za(this,Yb(a,null),c)}),setSelection:Sa(function(a,
b,c){var f=K(this,a);a=K(this,b||a);Za(this,Yb(f,a),c)}),extendSelection:Sa(function(a,b,c){$b(this,K(this,a),b&&K(this,b),c)}),extendSelections:Sa(function(a,b){Ec(this,Qa(this,a),b)}),extendSelectionsBy:Sa(function(a,b){var c=F(this.sel.ranges,a);Ec(this,Qa(this,c),b)}),setSelections:Sa(function(a,b,c){if(a.length){for(var f=[],d=0;d<a.length;d++)f[d]=new wa(K(this,a[d].anchor),K(this,a[d].head));null==b&&(b=Math.min(a.length-1,this.sel.primIndex));Za(this,Mb(f,b),c)}}),addSelection:Sa(function(a,
b,c){var f=this.sel.ranges.slice(0);f.push(new wa(K(this,a),K(this,b||a)));Za(this,Mb(f,f.length-1),c)}),getSelection:function(a){for(var b=this.sel.ranges,c,f=0;f<b.length;f++){var d=Pa(this,b[f].from(),b[f].to());c=c?c.concat(d):d}return!1===a?c:c.join(a||this.lineSeparator())},getSelections:function(a){for(var b=[],c=this.sel.ranges,f=0;f<c.length;f++){var d=Pa(this,c[f].from(),c[f].to());!1!==a&&(d=d.join(a||this.lineSeparator()));b[f]=d}return b},replaceSelection:function(a,b,c){for(var f=[],
d=0;d<this.sel.ranges.length;d++)f[d]=a;this.replaceSelections(f,b,c||"+input")},replaceSelections:Sa(function(a,b,c){for(var f=[],d=this.sel,k=0;k<d.ranges.length;k++){var e=d.ranges[k];f[k]={from:e.from(),to:e.to(),text:this.splitLines(a[k]),origin:c}}if(a=b)if(a="end"!=b){a=[];d=c=J(this.first,0);for(k=0;k<f.length;k++){var g=f[k],e=Id(g.from,c,d),z=Id(Hb(g),c,d);c=g.to;d=z;"around"==b?(g=this.sel.ranges[k],g=0>Q(g.head,g.anchor),a[k]=new wa(g?z:e,g?e:z)):a[k]=new wa(e,e)}a=new yb(a,this.sel.primIndex)}b=
a;for(a=f.length-1;0<=a;a--)nd(this,f[a]);b?tc(this,b):this.cm&&Ge(this.cm)}),undo:Sa(function(){le(this,"undo")}),redo:Sa(function(){le(this,"redo")}),undoSelection:Sa(function(){le(this,"undo",!0)}),redoSelection:Sa(function(){le(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=this.history,b=0,c=0,f=0;f<a.done.length;f++)a.done[f].ranges||++b;for(f=0;f<a.undone.length;f++)a.undone[f].ranges||++c;return{undo:b,
redo:c}},clearHistory:function(){this.history=new Ke(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null);return this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:Vc(this.history.done),undone:Vc(this.history.undone)}},setHistory:function(a){var b=this.history=new Ke(this.history.maxGeneration);
b.done=Vc(a.done.slice(0),null,!0);b.undone=Vc(a.undone.slice(0),null,!0)},setGutterMarker:Sa(function(a,b,c){return Md(this,a,"gutter",function(a){var f=a.gutterMarkers||(a.gutterMarkers={});f[b]=c;!c&&na(f)&&(a.gutterMarkers=null);return!0})}),clearGutter:Sa(function(a){var b=this;this.iter(function(c){c.gutterMarkers&&c.gutterMarkers[a]&&Md(b,c,"gutter",function(){c.gutterMarkers[a]=null;na(c.gutterMarkers)&&(c.gutterMarkers=null);return!0})})}),lineInfo:function(a){var b;if("number"==typeof a){if(!Fa(this,
a))return null;b=a;a=P(this,a);if(!a)return null}else if(b=qa(a),null==b)return null;return{line:b,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},addLineClass:Sa(function(b,c,f){return Md(this,b,"gutter"==c?"gutter":"class",function(b){var d="text"==c?"textClass":"background"==c?"bgClass":"gutter"==c?"gutterClass":"wrapClass";if(b[d]){if(a(f).test(b[d]))return!1;b[d]+=" "+f}else b[d]=f;return!0})}),removeLineClass:Sa(function(b,
c,f){return Md(this,b,"gutter"==c?"gutter":"class",function(b){var d="text"==c?"textClass":"background"==c?"bgClass":"gutter"==c?"gutterClass":"wrapClass",k=b[d];if(k)if(null==f)b[d]=null;else{var m=k.match(a(f));if(!m)return!1;var e=m.index+m[0].length;b[d]=k.slice(0,m.index)+(m.index&&e!=k.length?" ":"")+k.slice(e)||null}else return!1;return!0})}),addLineWidget:Sa(function(a,b,c){return Oe(this,a,b,c)}),removeLineWidget:function(a){a.clear()},markText:function(a,b,c){return pd(this,K(this,a),K(this,
b),c,c&&c.type||"range")},setBookmark:function(a,b){var c={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft,clearWhenEmpty:!1,shared:b&&b.shared,handleMouseEvents:b&&b.handleMouseEvents};a=K(this,a);return pd(this,a,a,c,"bookmark")},findMarksAt:function(a){a=K(this,a);var b=[],c=P(this,a.line).markedSpans;if(c)for(var f=0;f<c.length;++f){var d=c[f];(null==d.from||d.from<=a.ch)&&(null==d.to||d.to>=a.ch)&&b.push(d.marker.parent||d.marker)}return b},findMarks:function(a,b,c){a=
K(this,a);b=K(this,b);var f=[],d=a.line;this.iter(a.line,b.line+1,function(k){if(k=k.markedSpans)for(var e=0;e<k.length;e++){var g=k[e];null!=g.to&&d==a.line&&a.ch>=g.to||null==g.from&&d!=a.line||null!=g.from&&d==b.line&&g.from>=b.ch||c&&!c(g.marker)||f.push(g.marker.parent||g.marker)}++d});return f},getAllMarks:function(){var a=[];this.iter(function(b){if(b=b.markedSpans)for(var c=0;c<b.length;++c)null!=b[c].from&&a.push(b[c].marker)});return a},posFromIndex:function(a){var b,c=this.first,f=this.lineSeparator().length;
this.iter(function(d){d=d.text.length+f;if(d>a)return b=a,!0;a-=d;++c});return K(this,J(c,b))},indexFromPos:function(a){a=K(this,a);var b=a.ch;if(a.line<this.first||0>a.ch)return 0;var c=this.lineSeparator().length;this.iter(this.first,a.line,function(a){b+=a.text.length+c});return b},copy:function(a){var b=new Qb(ya(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);b.scrollTop=this.scrollTop;b.scrollLeft=this.scrollLeft;b.sel=this.sel;b.extend=!1;a&&(b.history.undoDepth=
this.history.undoDepth,b.setHistory(this.getHistory()));return b},linkedDoc:function(a){a||(a={});var b=this.first,c=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from);null!=a.to&&a.to<c&&(c=a.to);b=new Qb(ya(this,b,c),a.mode||this.modeOption,b,this.lineSep,this.direction);a.sharedHist&&(b.history=this.history);(this.linked||(this.linked=[])).push({doc:b,sharedHist:a.sharedHist});b.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}];a=Ff(this);for(c=0;c<a.length;c++){var f=a[c],d=f.find(),
k=b.clipPos(d.from),d=b.clipPos(d.to);Q(k,d)&&(k=pd(b,k,d,f.primary,f.primary.type),f.markers.push(k),k.parent=f)}return b},unlinkDoc:function(a){a instanceof bb&&(a=a.doc);if(this.linked)for(var b=0;b<this.linked.length;++b)if(this.linked[b].doc==a){this.linked.splice(b,1);a.unlinkDoc(this);zb(Ff(this));break}if(a.history==this.history){var c=[a.id];Ib(a,function(a){return c.push(a.id)},!0);a.history=new Ke(null);a.history.done=Vc(this.history.done,c);a.history.undone=Vc(this.history.undone,c)}},
iterLinkedDocs:function(a){Ib(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?a.split(this.lineSep):Ze(a)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Sa(function(a){"rtl"!=a&&(a="ltr");a!=this.direction&&(this.direction=a,this.iter(function(a){return a.order=null}),this.cm&&yf(this.cm))})});Qb.prototype.eachLine=Qb.prototype.iter;for(var Qe=0,Sg=!1,Xc={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",
17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",
63302:"Insert"},Zc=0;10>Zc;Zc++)Xc[Zc+48]=Xc[Zc+96]=String(Zc);for(var ue=65;90>=ue;ue++)Xc[ue]=String.fromCharCode(ue);for(var gf=1;12>=gf;gf++)Xc[gf+111]=Xc[gf+63235]="F"+gf;var Se={basic:{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",
Esc:"singleSelection"},pcDefault:{"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll",
"Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},emacsy:{"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars",
"Ctrl-O":"openLine"},macDefault:{"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace",
"Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]}};Se["default"]=ec?Se.macDefault:Se.pcDefault;var If={selectAll:zf,singleSelection:function(a){return a.setSelection(a.getCursor("anchor"),a.getCursor("head"),vc)},killLine:function(a){return Pd(a,function(b){if(b.empty()){var c=
P(a.doc,b.head.line).text.length;return b.head.ch==c&&b.head.line<a.lastLine()?{from:b.head,to:J(b.head.line+1,0)}:{from:b.head,to:J(b.head.line,c)}}return{from:b.from(),to:b.to()}})},deleteLine:function(a){return Pd(a,function(b){return{from:J(b.from().line,0),to:K(a.doc,J(b.to().line+1,0))}})},delLineLeft:function(a){return Pd(a,function(a){return{from:J(a.from().line,0),to:a.from()}})},delWrappedLineLeft:function(a){return Pd(a,function(b){var c=a.charCoords(b.head,"div").top+5;return{from:a.coordsChar({left:0,
top:c},"div"),to:b.from()}})},delWrappedLineRight:function(a){return Pd(a,function(b){var c=a.charCoords(b.head,"div").top+5,c=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:c},"div");return{from:b.from(),to:c}})},undo:function(a){return a.undo()},redo:function(a){return a.redo()},undoSelection:function(a){return a.undoSelection()},redoSelection:function(a){return a.redoSelection()},goDocStart:function(a){return a.extendSelection(J(a.firstLine(),0))},goDocEnd:function(a){return a.extendSelection(J(a.lastLine()))},
goLineStart:function(a){return a.extendSelectionsBy(function(b){return Hg(a,b.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){return a.extendSelectionsBy(function(b){return Te(a,b.head)},{origin:"+move",bias:1})},goLineEnd:function(a){return a.extendSelectionsBy(function(b){b=b.head.line;var c=P(a.doc,b),f;f=c;for(var d;d=hb(f,!1);)f=d.find(1,!0).line;f!=c&&(b=qa(f));return jb(!0,a,c,b,-1)},{origin:"+move",bias:-1})},goLineRight:function(a){return a.extendSelectionsBy(function(b){b=
a.charCoords(b.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div")},ff)},goLineLeft:function(a){return a.extendSelectionsBy(function(b){b=a.charCoords(b.head,"div").top+5;return a.coordsChar({left:0,top:b},"div")},ff)},goLineLeftSmart:function(a){return a.extendSelectionsBy(function(b){var c=a.charCoords(b.head,"div").top+5,c=a.coordsChar({left:0,top:c},"div");return c.ch<a.getLine(c.line).search(/\S/)?Te(a,b.head):c},ff)},goLineUp:function(a){return a.moveV(-1,
"line")},goLineDown:function(a){return a.moveV(1,"line")},goPageUp:function(a){return a.moveV(-1,"page")},goPageDown:function(a){return a.moveV(1,"page")},goCharLeft:function(a){return a.moveH(-1,"char")},goCharRight:function(a){return a.moveH(1,"char")},goColumnLeft:function(a){return a.moveH(-1,"column")},goColumnRight:function(a){return a.moveH(1,"column")},goWordLeft:function(a){return a.moveH(-1,"word")},goGroupRight:function(a){return a.moveH(1,"group")},goGroupLeft:function(a){return a.moveH(-1,
"group")},goWordRight:function(a){return a.moveH(1,"word")},delCharBefore:function(a){return a.deleteH(-1,"char")},delCharAfter:function(a){return a.deleteH(1,"char")},delWordBefore:function(a){return a.deleteH(-1,"word")},delWordAfter:function(a){return a.deleteH(1,"word")},delGroupBefore:function(a){return a.deleteH(-1,"group")},delGroupAfter:function(a){return a.deleteH(1,"group")},indentAuto:function(a){return a.indentSelection("smart")},indentMore:function(a){return a.indentSelection("add")},
indentLess:function(a){return a.indentSelection("subtract")},insertTab:function(a){return a.replaceSelection("\t")},insertSoftTab:function(a){for(var b=[],c=a.listSelections(),f=a.options.tabSize,d=0;d<c.length;d++){var k=c[d].from(),k=D(a.getLine(k.line),k.ch,f);b.push(r(f-k%f))}a.replaceSelections(b)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){return Tb(a,function(){for(var b=a.listSelections(),c=[],f=0;f<b.length;f++)if(b[f].empty()){var d=
b[f].head,k=P(a.doc,d.line).text;if(k)if(d.ch==k.length&&(d=new J(d.line,d.ch-1)),0<d.ch)d=new J(d.line,d.ch+1),a.replaceRange(k.charAt(d.ch-1)+k.charAt(d.ch-2),J(d.line,d.ch-2),d,"+transpose");else if(d.line>a.doc.first){var e=P(a.doc,d.line-1).text;e&&(d=new J(d.line,1),a.replaceRange(k.charAt(0)+a.doc.lineSeparator()+e.charAt(e.length-1),J(d.line-1,e.length-1),d,"+transpose"))}c.push(new wa(d,d))}a.setSelections(c)})},newlineAndIndent:function(a){return Tb(a,function(){for(var b=a.listSelections(),
c=b.length-1;0<=c;c--)a.replaceRange(a.doc.lineSeparator(),b[c].anchor,b[c].head,"+input");b=a.listSelections();for(c=0;c<b.length;c++)a.indentLine(b[c].from().line,null,!0);Ge(a)})},openLine:function(a){return a.replaceSelection("\n","start")},toggleOverwrite:function(a){return a.toggleOverwrite()}},Kf=new Rd,ig=null,qd,kc,ne={toString:function(){return"CodeMirror.Init"}},Rg={},ng={};bb.defaults=Rg;bb.optionHandlers=ng;var rd=[];bb.defineInitHook=function(a){return rd.push(a)};var Ab=null,Ma=function(a){this.cm=
a;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new Rd;this.composing=null;this.gracePeriod=!1;this.readDOMTimeout=null};Ma.prototype.init=function(a){function b(a){if(!Aa(d,a)){if(d.somethingSelected())pg({lineWise:!1,text:d.getSelections()}),"cut"==a.type&&d.replaceSelection("",null,"cut");else if(d.options.lineWiseCopyCut){var c=Tg(d);pg({lineWise:!0,text:c.text});"cut"==a.type&&d.operation(function(){d.setSelections(c.ranges,0,vc);d.replaceSelection("",
null,"cut")})}else return;if(a.clipboardData){a.clipboardData.clearData();var e=Ab.text.join("\n");a.clipboardData.setData("Text",e);if(a.clipboardData.getData("Text")==e){a.preventDefault();return}}var m=re();a=m.firstChild;d.display.lineSpace.insertBefore(m,d.display.lineSpace.firstChild);a.value=Ab.text.join("\n");var g=document.activeElement;Ud(a);setTimeout(function(){d.display.lineSpace.removeChild(m);g.focus();g==k&&f.showPrimarySelection()},50)}}var c=this,f=this,d=f.cm,k=f.div=a.lineDiv;
qe(k,d.options.spellcheck);ha(k,"paste",function(a){Aa(d,a)||$e(a,d)||11>=Wa&&setTimeout(tb(d,function(){return c.updateFromDOM()}),20)});ha(k,"compositionstart",function(a){c.composing={data:a.data,done:!1}});ha(k,"compositionupdate",function(a){c.composing||(c.composing={data:a.data,done:!1})});ha(k,"compositionend",function(a){c.composing&&(a.data!=c.composing.data&&c.readFromDOMSoon(),c.composing.done=!0)});ha(k,"touchstart",function(){return f.forceCompositionEnd()});ha(k,"input",function(){c.composing||
c.readFromDOMSoon()});ha(k,"copy",b);ha(k,"cut",b)};Ma.prototype.prepareSelection=function(){var a=De(this.cm,!1);a.focus=this.cm.state.focused;return a};Ma.prototype.showSelection=function(a,b){a&&this.cm.display.view.length&&((a.focus||b)&&this.showPrimarySelection(),this.showMultipleSelections(a))};Ma.prototype.showPrimarySelection=function(){var a=window.getSelection(),b=this.cm,c=b.doc.sel.primary(),f=c.from(),c=c.to();if(b.display.viewTo==b.display.viewFrom||f.line>=b.display.viewTo||c.line<
b.display.viewFrom)a.removeAllRanges();else{var d=Td(b,a.anchorNode,a.anchorOffset),k=Td(b,a.focusNode,a.focusOffset);if(!d||d.bad||!k||k.bad||0!=Q(xa(d,k),f)||0!=Q(nb(d,k),c))if(d=b.display.view,f=f.line>=b.display.viewFrom&&af(b,f)||{node:d[0].measure.map[2],offset:0},c=c.line<b.display.viewTo&&af(b,c),c||(c=d[d.length-1].measure,c=c.maps?c.maps[c.maps.length-1]:c.map,c={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}),f&&c){var d=a.rangeCount&&a.getRangeAt(0),e;try{e=ud(f.node,f.offset,
c.offset,c.node)}catch(g){}e&&(!Vb&&b.state.focused?(a.collapse(f.node,f.offset),e.collapsed||(a.removeAllRanges(),a.addRange(e))):(a.removeAllRanges(),a.addRange(e)),d&&null==a.anchorNode?a.addRange(d):Vb&&this.startGracePeriod());this.rememberSelection()}else a.removeAllRanges()}};Ma.prototype.startGracePeriod=function(){var a=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){a.gracePeriod=!1;a.selectionChanged()&&a.cm.operation(function(){return a.cm.curOp.selectionChanged=
!0})},20)};Ma.prototype.showMultipleSelections=function(a){c(this.cm.display.cursorDiv,a.cursors);c(this.cm.display.selectionDiv,a.selection)};Ma.prototype.rememberSelection=function(){var a=window.getSelection();this.lastAnchorNode=a.anchorNode;this.lastAnchorOffset=a.anchorOffset;this.lastFocusNode=a.focusNode;this.lastFocusOffset=a.focusOffset};Ma.prototype.selectionInEditor=function(){var a=window.getSelection();if(!a.rangeCount)return!1;a=a.getRangeAt(0).commonAncestorContainer;return e(this.div,
a)};Ma.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())};Ma.prototype.blur=function(){this.div.blur()};Ma.prototype.getField=function(){return this.div};Ma.prototype.supportsTouch=function(){return!0};Ma.prototype.receivedFocus=function(){function a(){b.cm.state.focused&&(b.pollSelection(),b.polling.set(b.cm.options.pollInterval,a))}var b=this;this.selectionInEditor()?this.pollSelection():Tb(this.cm,
function(){return b.cm.curOp.selectionChanged=!0});this.polling.set(this.cm.options.pollInterval,a)};Ma.prototype.selectionChanged=function(){var a=window.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset};Ma.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var a=window.getSelection(),b=this.cm;if(ed&&rf&&this.cm.options.gutters.length&&
qg(a.anchorNode))this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();else if(!this.composing){this.rememberSelection();var c=Td(b,a.anchorNode,a.anchorOffset),f=Td(b,a.focusNode,a.focusOffset);c&&f&&Tb(b,function(){Za(b.doc,Yb(c,f),vc);if(c.bad||f.bad)b.curOp.selectionChanged=!0})}}};Ma.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var a=this.cm,b=a.display,c=a.doc.sel.primary(),
f=c.from(),d=c.to();0==f.ch&&f.line>a.firstLine()&&(f=J(f.line-1,P(a.doc,f.line-1).length));d.ch==P(a.doc,d.line).text.length&&d.line<a.lastLine()&&(d=J(d.line+1,0));if(f.line<b.viewFrom||d.line>b.viewTo-1)return!1;var k;f.line==b.viewFrom||0==(k=Cc(a,f.line))?(c=qa(b.view[0].line),k=b.view[0].node):(c=qa(b.view[k].line),k=b.view[k-1].node.nextSibling);var e=Cc(a,d.line);e==b.view.length-1?(d=b.viewTo-1,b=b.lineDiv.lastChild):(d=qa(b.view[e+1].line)-1,b=b.view[e+1].node.previousSibling);if(!k)return!1;
b=a.doc.splitLines(bf(a,k,b,c,d));for(k=Pa(a.doc,J(c,0),J(d,P(a.doc,d).text.length));1<b.length&&1<k.length;)if(I(b)==I(k))b.pop(),k.pop(),d--;else if(b[0]==k[0])b.shift(),k.shift(),c++;else break;for(var g=0,e=0,z=b[0],x=k[0],l=Math.min(z.length,x.length);g<l&&z.charCodeAt(g)==x.charCodeAt(g);)++g;z=I(b);x=I(k);for(l=Math.min(z.length-(1==b.length?g:0),x.length-(1==k.length?g:0));e<l&&z.charCodeAt(z.length-e-1)==x.charCodeAt(x.length-e-1);)++e;if(1==b.length&&1==k.length&&c==f.line)for(;g&&g>f.ch&&
z.charCodeAt(z.length-e-1)==x.charCodeAt(x.length-e-1);)g--,e++;b[b.length-1]=z.slice(0,z.length-e).replace(/^\u200b+/,"");b[0]=b[0].slice(g).replace(/\u200b+$/,"");f=J(c,g);c=J(d,k.length?I(k).length-e:0);if(1<b.length||b[0]||Q(f,c))return od(a.doc,b,f,c,"+input"),!0};Ma.prototype.ensurePolled=function(){this.forceCompositionEnd()};Ma.prototype.reset=function(){this.forceCompositionEnd()};Ma.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=
null,this.updateFromDOM(),this.div.blur(),this.div.focus())};Ma.prototype.readFromDOMSoon=function(){var a=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){a.readDOMTimeout=null;if(a.composing)if(a.composing.done)a.composing=null;else return;a.updateFromDOM()},80))};Ma.prototype.updateFromDOM=function(){var a=this;!this.cm.isReadOnly()&&this.pollContent()||Tb(this.cm,function(){return xb(a.cm)})};Ma.prototype.setUneditable=function(a){a.contentEditable="false"};Ma.prototype.onKeyPress=
function(a){0!=a.charCode&&(a.preventDefault(),this.cm.isReadOnly()||tb(this.cm,oe)(this.cm,String.fromCharCode(null==a.charCode?a.keyCode:a.charCode),0))};Ma.prototype.readOnlyChanged=function(a){this.div.contentEditable=String("nocursor"!=a)};Ma.prototype.onContextMenu=function(){};Ma.prototype.resetPosition=function(){};Ma.prototype.needsContentAttribute=!0;var mb=function(a){this.cm=a;this.prevInput="";this.pollingFast=!1;this.polling=new Rd;this.hasSelection=this.inaccurateSelection=!1;this.composing=
null};mb.prototype.init=function(a){function b(a){if(!Aa(d,a)){if(d.somethingSelected())Ab={lineWise:!1,text:d.getSelections()},f.inaccurateSelection&&(f.prevInput="",f.inaccurateSelection=!1,e.value=Ab.text.join("\n"),Ud(e));else if(d.options.lineWiseCopyCut){var c=Tg(d);Ab={lineWise:!0,text:c.text};"cut"==a.type?d.setSelections(c.ranges,null,vc):(f.prevInput="",e.value=c.text.join("\n"),Ud(e))}else return;"cut"==a.type&&(d.state.cutIncoming=!0)}}var c=this,f=this,d=this.cm,k=this.wrapper=re(),e=
this.textarea=k.firstChild;a.wrapper.insertBefore(k,a.wrapper.firstChild);Gc&&(e.style.width="0px");ha(e,"input",function(){Da&&9<=Wa&&c.hasSelection&&(c.hasSelection=null);f.poll()});ha(e,"paste",function(a){Aa(d,a)||$e(a,d)||(d.state.pasteIncoming=!0,f.fastPoll())});ha(e,"cut",b);ha(e,"copy",b);ha(a.scroller,"paste",function(b){Ya(a,b)||Aa(d,b)||(d.state.pasteIncoming=!0,f.focus())});ha(a.lineSpace,"selectstart",function(b){Ya(a,b)||za(b)});ha(e,"compositionstart",function(){var a=d.getCursor("from");
f.composing&&f.composing.range.clear();f.composing={start:a,range:d.markText(a,d.getCursor("to"),{className:"CodeMirror-composing"})}});ha(e,"compositionend",function(){f.composing&&(f.poll(),f.composing.range.clear(),f.composing=null)})};mb.prototype.prepareSelection=function(){var a=this.cm,b=a.display,c=a.doc,f=De(a);if(a.options.moveInputWithCursor){var a=Xb(a,c.sel.primary().head,"div"),c=b.wrapper.getBoundingClientRect(),d=b.lineDiv.getBoundingClientRect();f.teTop=Math.max(0,Math.min(b.wrapper.clientHeight-
10,a.top+d.top-c.top));f.teLeft=Math.max(0,Math.min(b.wrapper.clientWidth-10,a.left+d.left-c.left))}return f};mb.prototype.showSelection=function(a){var b=this.cm.display;c(b.cursorDiv,a.cursors);c(b.selectionDiv,a.selection);null!=a.teTop&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")};mb.prototype.reset=function(a){if(!this.contextMenuPending&&!this.composing){var b,c,f=this.cm,d=f.doc;f.somethingSelected()?(this.prevInput="",b=d.sel.primary(),c=(b=Kg&&(100<b.to().line-
b.from().line||1E3<(c=f.getSelection()).length))?"-":c||f.getSelection(),this.textarea.value=c,f.state.focused&&Ud(this.textarea),Da&&9<=Wa&&(this.hasSelection=c)):a||(this.prevInput=this.textarea.value="",Da&&9<=Wa&&(this.hasSelection=null));this.inaccurateSelection=b}};mb.prototype.getField=function(){return this.textarea};mb.prototype.supportsTouch=function(){return!1};mb.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!td||l()!=this.textarea))try{this.textarea.focus()}catch(a){}};
mb.prototype.blur=function(){this.textarea.blur()};mb.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};mb.prototype.receivedFocus=function(){this.slowPoll()};mb.prototype.slowPoll=function(){var a=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){a.poll();a.cm.state.focused&&a.slowPoll()})};mb.prototype.fastPoll=function(){function a(){c.poll()||b?(c.pollingFast=!1,c.slowPoll()):(b=!0,c.polling.set(60,a))}var b=!1,c=this;c.pollingFast=
!0;c.polling.set(20,a)};mb.prototype.poll=function(){var a=this,b=this.cm,c=this.textarea,f=this.prevInput;if(this.contextMenuPending||!b.state.focused||qh(c)&&!f&&!this.composing||b.isReadOnly()||b.options.disableInput||b.state.keySeq)return!1;var d=c.value;if(d==f&&!b.somethingSelected())return!1;if(Da&&9<=Wa&&this.hasSelection===d||ec&&/[\uf700-\uf7ff]/.test(d))return b.display.input.reset(),!1;if(b.doc.sel==b.display.selForContextMenu){var k=d.charCodeAt(0);8203!=k||f||(f="\u200b");if(8666==k)return this.reset(),
this.cm.execCommand("undo")}for(var e=0,k=Math.min(f.length,d.length);e<k&&f.charCodeAt(e)==d.charCodeAt(e);)++e;Tb(b,function(){oe(b,d.slice(e),f.length-e,null,a.composing?"*compose":null);1E3<d.length||-1<d.indexOf("\n")?c.value=a.prevInput="":a.prevInput=d;a.composing&&(a.composing.range.clear(),a.composing.range=b.markText(a.composing.start,b.getCursor("to"),{className:"CodeMirror-composing"}))});return!0};mb.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)};
mb.prototype.onKeyPress=function(){Da&&9<=Wa&&(this.hasSelection=null);this.fastPoll()};mb.prototype.onContextMenu=function(a){function b(){if(null!=e.selectionStart){var a=d.somethingSelected(),c="\u200b"+(a?e.value:"");e.value="\u21da";e.value=c;f.prevInput=a?"":"\u200b";e.selectionStart=1;e.selectionEnd=c.length;k.selForContextMenu=d.doc.sel}}function c(){f.contextMenuPending=!1;f.wrapper.style.cssText=l;e.style.cssText=x;Da&&9>Wa&&k.scrollbars.setScrollTop(k.scroller.scrollTop=z);if(null!=e.selectionStart){(!Da||
Da&&9>Wa)&&b();var a=0,g=function(){k.selForContextMenu==d.doc.sel&&0==e.selectionStart&&0<e.selectionEnd&&"\u200b"==f.prevInput?tb(d,zf)(d):10>a++?k.detectingSelectAll=setTimeout(g,500):(k.selForContextMenu=null,k.input.reset())};k.detectingSelectAll=setTimeout(g,200)}}var f=this,d=f.cm,k=d.display,e=f.textarea,g=sb(d,a),z=k.scroller.scrollTop;if(g&&!rc){d.options.resetSelectionOnContextMenu&&-1==d.doc.sel.contains(g)&&tb(d,Za)(d.doc,Yb(g),vc);var x=e.style.cssText,l=f.wrapper.style.cssText;f.wrapper.style.cssText=
"position: absolute";g=f.wrapper.getBoundingClientRect();e.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(a.clientY-g.top-5)+"px; left: "+(a.clientX-g.left-5)+"px;\n      z-index: 1000; background: "+(Da?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var n;vb&&(n=window.scrollY);k.input.focus();vb&&window.scrollTo(null,n);k.input.reset();d.somethingSelected()||
(e.value=f.prevInput=" ");f.contextMenuPending=!0;k.selForContextMenu=d.doc.sel;clearTimeout(k.detectingSelectAll);Da&&9<=Wa&&b();if(Lf){gb(a);var s=function(){ab(window,"mouseup",s);setTimeout(c,20)};ha(window,"mouseup",s)}else setTimeout(c,50)}};mb.prototype.readOnlyChanged=function(a){a||this.reset()};mb.prototype.setUneditable=function(){};mb.prototype.needsContentAttribute=!1;(function(a){function b(f,d,k,e){a.defaults[f]=d;k&&(c[f]=e?function(a,b,c){c!=ne&&k(a,b,c)}:k)}var c=a.optionHandlers;
a.defineOption=b;a.Init=ne;b("value","",function(a,b){return a.setValue(b)},!0);b("mode",null,function(a,b){a.doc.modeOption=b;id(a)},!0);b("indentUnit",2,id,!0);b("indentWithTabs",!1);b("smartIndent",!0);b("tabSize",4,function(a){Dc(a);dd(a);xb(a)},!0);b("lineSeparator",null,function(a,b){if(a.doc.lineSep=b){var c=[],f=a.doc.first;a.doc.iter(function(a){for(var d=0;;){var k=a.text.indexOf(b,d);if(-1==k)break;d=k+b.length;c.push(J(f,k))}f++});for(var d=c.length-1;0<=d;d--)od(a.doc,b,c[d],J(c[d].line,
c[d].ch+b.length))}});b("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(a,b,c){a.state.specialChars=RegExp(b.source+(b.test("\t")?"":"|\t"),"g");c!=ne&&a.refresh()});b("specialCharPlaceholder",yh,function(a){return a.refresh()},!0);b("electricChars",!0);b("inputStyle",td?"contenteditable":"textarea",function(){throw Error("inputStyle can not (yet) be changed in a running editor");},!0);b("spellcheck",!1,function(a,b){return a.getInputField().spellcheck=
b},!0);b("rtlMoveVisually",!rg);b("wholeLineUpdateBefore",!0);b("theme","default",function(a){mg(a);Xe(a)},!0);b("keyMap","default",function(a,b,c){b=Hf(b);(c=c!=ne&&Hf(c))&&c.detach&&c.detach(a,b);b.attach&&b.attach(a,c||null)});b("extraKeys",null);b("lineWrapping",!1,Qg,!0);b("gutters",[],function(a){je(a.options);Xe(a)},!0);b("fixedGutter",!0,function(a,b){a.display.gutters.style.left=b?$d(a.display)+"px":"0";a.refresh()},!0);b("coverGutterNextToScrollbar",!1,function(a){return Rc(a)},!0);b("scrollbarStyle",
"native",function(a){Cg(a);Rc(a);a.display.scrollbars.setScrollTop(a.doc.scrollTop);a.display.scrollbars.setScrollLeft(a.doc.scrollLeft)},!0);b("lineNumbers",!1,function(a){je(a.options);Xe(a)},!0);b("firstLineNumber",1,Xe,!0);b("lineNumberFormatter",function(a){return a},Xe,!0);b("showCursorWhenSelecting",!1,Oc,!0);b("resetSelectionOnContextMenu",!0);b("lineWiseCopyCut",!0);b("readOnly",!1,function(a,b){"nocursor"==b?(Pc(a),a.display.input.blur(),a.display.disabled=!0):a.display.disabled=!1;a.display.input.readOnlyChanged(b)});
b("disableInput",!1,function(a,b){b||a.display.input.reset()},!0);b("dragDrop",!0,nh);b("allowDropFileTypes",null);b("cursorBlinkRate",530);b("cursorScrollMargin",0);b("cursorHeight",1,Oc,!0);b("singleCursorHeightPerLine",!0,Oc,!0);b("workTime",100);b("workDelay",100);b("flattenSpans",!0,Dc,!0);b("addModeClass",!1,Dc,!0);b("pollInterval",100);b("undoDepth",200,function(a,b){return a.doc.history.undoDepth=b});b("historyEventDelay",1250);b("viewportMargin",10,function(a){return a.refresh()},!0);b("maxHighlightLength",
1E4,Dc,!0);b("moveInputWithCursor",!0,function(a,b){b||a.display.input.resetPosition()});b("tabindex",null,function(a,b){return a.display.input.getField().tabIndex=b||""});b("autofocus",null);b("direction","ltr",function(a,b){return a.doc.setDirection(b)},!0)})(bb);(function(a){var b=a.optionHandlers,c=a.helpers={};a.prototype={constructor:a,focus:function(){window.focus();this.display.input.focus()},setOption:function(a,c){var f=this.options,d=f[a];if(f[a]!=c||"mode"==a)f[a]=c,b.hasOwnProperty(a)&&
tb(this,b[a])(this,c,d),La(this,"optionChange",this,a)},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,b){this.state.keyMaps[b?"push":"unshift"](Hf(a))},removeKeyMap:function(a){for(var b=this.state.keyMaps,c=0;c<b.length;++c)if(b[c]==a||b[c].name==a)return b.splice(c,1),!0},addOverlay:lb(function(b,c){var f=b.token?b:a.getMode(this.options,b);if(f.startState)throw Error("Overlays may not be stateful.");T(this.state.overlays,{mode:f,modeSpec:b,
opaque:c&&c.opaque,priority:c&&c.priority||0},function(a){return a.priority});this.state.modeGen++;xb(this)}),removeOverlay:lb(function(a){for(var b=this.state.overlays,c=0;c<b.length;++c){var f=b[c].modeSpec;if(f==a||"string"==typeof a&&f.name==a){b.splice(c,1);this.state.modeGen++;xb(this);break}}}),indentLine:lb(function(a,b,c){"string"!=typeof b&&"number"!=typeof b&&(b=null==b?this.options.smartIndent?"smart":"prev":b?"add":"subtract");Fa(this.doc,a)&&Ye(this,a,b,c)}),indentSelection:lb(function(a){for(var b=
this.doc.sel.ranges,c=-1,f=0;f<b.length;f++){var d=b[f];if(d.empty())d.head.line>c&&(Ye(this,d.head.line,a,!0),c=d.head.line,f==this.doc.sel.primIndex&&Ge(this));else{for(var k=d.from(),d=d.to(),e=Math.max(c,k.line),c=Math.min(this.lastLine(),d.line-(d.ch?0:1))+1,d=e;d<c;++d)Ye(this,d,a);d=this.doc.sel.ranges;0==k.ch&&b.length==d.length&&0<d[f].from().ch&&Ob(this.doc,f,new wa(k,d[f].to()),vc)}}}),getTokenAt:function(a,b){return x(this,a,b)},getLineTokens:function(a,b){return x(this,J(a),b,!0)},getTokenTypeAt:function(a){a=
K(this.doc,a);var b=H(this,P(this.doc,a.line)),c=0,f=(b.length-1)/2;a=a.ch;var d;if(0==a)d=b[2];else for(;;){var k=c+f>>1;if((k?b[2*k-1]:0)>=a)f=k;else if(b[2*k+1]<a)c=k+1;else{d=b[2*k+2];break}}b=d?d.indexOf("overlay "):-1;return 0>b?d:0==b?null:d.slice(0,b-1)},getModeAt:function(b){var c=this.doc.mode;return c.innerMode?a.innerMode(c,this.getTokenAt(b).state).mode:c},getHelper:function(a,b){return this.getHelpers(a,b)[0]},getHelpers:function(a,b){var f=[];if(!c.hasOwnProperty(b))return f;var d=
c[b],k=this.getModeAt(a);if("string"==typeof k[b])d[k[b]]&&f.push(d[k[b]]);else if(k[b])for(var e=0;e<k[b].length;e++){var g=d[k[b][e]];g&&f.push(g)}else k.helperType&&d[k.helperType]?f.push(d[k.helperType]):d[k.name]&&f.push(d[k.name]);for(e=0;e<d._global.length;e++)g=d._global[e],g.pred(k,this)&&-1==q(f,g.val)&&f.push(g.val);return f},getStateAfter:function(a,b){var c=this.doc;a=Math.max(c.first,Math.min(null==a?c.first+c.size-1:a,c.first+c.size-1));return G(this,a+1,b)},cursorCoords:function(a,
b){var c;c=this.doc.sel.primary();c=null==a?c.head:"object"==typeof a?K(this.doc,a):a?c.from():c.to();return Xb(this,c,b||"page")},charCoords:function(a,b){return Ra(this,K(this.doc,a),b||"page")},coordsChar:function(a,b){a=Sb(this,a,b||"page");return xd(this,a.left,a.top)},lineAtHeight:function(a,b){a=Sb(this,{top:a,left:0},b||"page").top;return Ia(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,b,c){var f=!1;if("number"==typeof a){var d=this.doc.first+this.doc.size-1;a<this.doc.first?
a=this.doc.first:a>d&&(a=d,f=!0);a=P(this.doc,a)}return Ka(this,a,{top:0,left:0},b||"page",c||f).top+(f?this.doc.height-U(a):0)},defaultTextHeight:function(){return pc(this.display)},defaultCharWidth:function(){return cd(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(a,b,c,f,d){var k=this.display;a=Xb(this,K(this.doc,a));var e=a.bottom,g=a.left;b.style.position="absolute";b.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(b);
k.sizer.appendChild(b);if("over"==f)e=a.top;else if("above"==f||"near"==f){var m=Math.max(k.wrapper.clientHeight,this.doc.height),z=Math.max(k.sizer.clientWidth,k.lineSpace.clientWidth);("above"==f||a.bottom+b.offsetHeight>m)&&a.top>b.offsetHeight?e=a.top-b.offsetHeight:a.bottom+b.offsetHeight<=m&&(e=a.bottom);g+b.offsetWidth>z&&(g=z-b.offsetWidth)}b.style.top=e+"px";b.style.left=b.style.right="";"right"==d?(g=k.sizer.clientWidth-b.offsetWidth,b.style.right="0px"):("left"==d?g=0:"middle"==d&&(g=(k.sizer.clientWidth-
b.offsetWidth)/2),b.style.left=g+"px");c&&(a=he(this,{left:g,top:e,right:g+b.offsetWidth,bottom:e+b.offsetHeight}),null!=a.scrollTop&&Dd(this,a.scrollTop),null!=a.scrollLeft&&gc(this,a.scrollLeft))},triggerOnKeyDown:lb(Jg),triggerOnKeyPress:lb(Mg),triggerOnKeyUp:Lg,execCommand:function(a){if(If.hasOwnProperty(a))return If[a].call(null,this)},triggerElectric:lb(function(a){pe(this,a)}),findPosH:function(a,b,c,f){var d=1;0>b&&(d=-1,b=-b);a=K(this.doc,a);for(var k=0;k<b&&(a=Sd(this.doc,a,d,c,f),!a.hitSide);++k);
return a},moveH:lb(function(a,b){var c=this;this.extendSelectionsBy(function(f){return c.display.shift||c.doc.extend||f.empty()?Sd(c.doc,f.head,a,b,c.options.rtlMoveVisually):0>a?f.from():f.to()},ff)}),deleteH:lb(function(a,b){var c=this.doc;this.doc.sel.somethingSelected()?c.replaceSelection("",null,"+delete"):Pd(this,function(f){var d=Sd(c,f.head,a,b,!1);return 0>a?{from:d,to:f.head}:{from:f.head,to:d}})}),findPosV:function(a,b,c,f){var d=1;0>b&&(d=-1,b=-b);var k=K(this.doc,a);for(a=0;a<b&&(k=Xb(this,
k,"div"),null==f?f=k.left:k.left=f,k=se(this,k,d,c),!k.hitSide);++a);return k},moveV:lb(function(a,b){var c=this,f=this.doc,d=[],k=!this.display.shift&&!f.extend&&f.sel.somethingSelected();f.extendSelectionsBy(function(e){if(k)return 0>a?e.from():e.to();var g=Xb(c,e.head,"div");null!=e.goalColumn&&(g.left=e.goalColumn);d.push(g.left);var m=se(c,g,a,b);"page"==b&&e==f.sel.primary()&&Cd(c,Ra(c,m,"div").top-g.top);return m},ff);if(d.length)for(var e=0;e<f.sel.ranges.length;e++)f.sel.ranges[e].goalColumn=
d[e]}),findWordAt:function(a){var b=P(this.doc,a.line).text,c=a.ch,f=a.ch;if(b){var d=this.getHelper(a,"wordChars");"before"!=a.sticky&&f!=b.length||!c?++f:--c;for(var k=b.charAt(c),k=ka(k,d)?function(a){return ka(a,d)}:/\s/.test(k)?function(a){return/\s/.test(a)}:function(a){return!/\s/.test(a)&&!ka(a)};0<c&&k(b.charAt(c-1));)--c;for(;f<b.length&&k(b.charAt(f));)++f}return new wa(J(a.line,c),J(a.line,f))},toggleOverwrite:function(a){if(null==a||a!=this.state.overwrite)(this.state.overwrite=!this.state.overwrite)?
n(this.display.cursorDiv,"CodeMirror-overwrite"):fd(this.display.cursorDiv,"CodeMirror-overwrite"),La(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==l()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:lb(function(a,b){uf(this,a,b)}),getScrollInfo:function(){var a=this.display.scroller;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-Mc(this)-this.display.barHeight,width:a.scrollWidth-Mc(this)-
this.display.barWidth,clientHeight:Uf(this),clientWidth:Zd(this)}},scrollIntoView:lb(function(a,b){null==a?(a={from:this.doc.sel.primary().head,to:null},null==b&&(b=this.options.cursorScrollMargin)):"number"==typeof a?a={from:J(a,0),to:null}:null==a.from&&(a={from:a,to:null});a.to||(a.to=a.from);a.margin=b||0;if(null!=a.from.line){var c=a;Fe(this);this.curOp.scrollToPos=c}else jh(this,a.from,a.to,a.margin)}),setSize:lb(function(a,b){var c=this,f=function(a){return"number"==typeof a||/^\d+$/.test(String(a))?
a+"px":a};null!=a&&(this.display.wrapper.style.width=f(a));null!=b&&(this.display.wrapper.style.height=f(b));this.options.lineWrapping&&Ce(this);var d=this.display.viewFrom;this.doc.iter(d,this.display.viewTo,function(a){if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(a.widgets[b].noHScroll){hc(c,d,"widget");break}++d});this.curOp.forceUpdate=!0;La(this,"refresh",this)}),operation:function(a){return Tb(this,a)},refresh:lb(function(){var a=this.display.cachedTextHeight;xb(this);this.curOp.forceUpdate=
!0;dd(this);uf(this,this.doc.scrollLeft,this.doc.scrollTop);Bd(this);(null==a||0.5<Math.abs(a-pc(this.display)))&&be(this);La(this,"refresh",this)}),swapDoc:lb(function(a){var b=this.doc;b.cm=null;Dg(this,a);dd(this);this.display.input.reset();uf(this,a.scrollLeft,a.scrollTop);this.curOp.forceScroll=!0;Db(this,"swapDoc",this,b);return b}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},
getGutterElement:function(){return this.display.gutters}};V(a);a.registerHelper=function(b,f,d){c.hasOwnProperty(b)||(c[b]=a[b]={_global:[]});c[b][f]=d};a.registerGlobalHelper=function(b,f,d,k){a.registerHelper(b,f,k);c[b]._global.push({pred:d,val:k})}})(bb);var Wg="iter insert remove copy getEditor constructor".split(" "),ve;for(ve in Qb.prototype)Qb.prototype.hasOwnProperty(ve)&&0>q(Wg,ve)&&(bb.prototype[ve]=function(a){return function(){return a.apply(this.doc,arguments)}}(Qb.prototype[ve]));V(Qb);
bb.inputStyles={textarea:mb,contenteditable:Ma};bb.defineMode=function(a){bb.defaults.mode||"null"==a||(bb.defaults.mode=a);pb.apply(this,arguments)};bb.defineMIME=function(a,b){Lc[a]=b};bb.defineMode("null",function(){return{token:function(a){return a.skipToEnd()}}});bb.defineMIME("text/plain","null");bb.defineExtension=function(a,b){bb.prototype[a]=b};bb.defineDocExtension=function(a,b){Qb.prototype[a]=b};bb.fromTextArea=function(a,b){function c(){a.value=z.getValue()}b=b?s(b):{};b.value=a.value;
!b.tabindex&&a.tabIndex&&(b.tabindex=a.tabIndex);!b.placeholder&&a.placeholder&&(b.placeholder=a.placeholder);if(null==b.autofocus){var f=l();b.autofocus=f==a||null!=a.getAttribute("autofocus")&&f==document.body}var d;if(a.form&&(ha(a.form,"submit",c),!b.leaveSubmitMethodAlone)){var k=a.form;d=k.submit;try{var e=k.submit=function(){c();k.submit=d;k.submit();k.submit=e}}catch(g){}}b.finishInit=function(b){b.save=c;b.getTextArea=function(){return a};b.toTextArea=function(){b.toTextArea=isNaN;c();a.parentNode.removeChild(b.getWrapperElement());
a.style.display="";a.form&&(ab(a.form,"submit",c),"function"==typeof a.form.submit&&(a.form.submit=d))}};a.style.display="none";var z=bb(function(b){return a.parentNode.insertBefore(b,a.nextSibling)},b);return z};(function(a){a.off=ab;a.on=ha;a.wheelEventPixels=wf;a.Doc=Qb;a.splitLines=Ze;a.countColumn=D;a.findColumn=O;a.isWordChar=L;a.Pass=Jf;a.signal=La;a.Line=jd;a.changeEnd=Hb;a.scrollbarModel=Xf;a.Pos=J;a.cmpPos=Q;a.modes=Pf;a.mimeModes=Lc;a.resolveMode=R;a.getMode=oa;a.modeExtensions=Wd;a.extendMode=
A;a.copyState=fa;a.startState=Ha;a.innerMode=ga;a.commands=If;a.keyMap=Se;a.keyName=fg;a.isModifierKey=eg;a.lookupKey=Od;a.normalizeKeyMap=lh;a.StringStream=rb;a.SharedTextMarker=Nd;a.TextMarker=wc;a.LineWidget=Eb;a.e_preventDefault=za;a.e_stopPropagation=ba;a.e_stop=gb;a.addClass=n;a.contains=e;a.rmClass=fd;a.keyNames=Xc})(bb);bb.version="5.26.0";return bb});(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function b(a){var b={};a=a.split(" ");for(var c=0;c<a.length;++c)b[a[c]]=!0;return b}a.defineMode("glsl",function(a,e){function l(a,b){var c=a.next();if(T[c]){var d=T[c](a,b);if(!1!==d)return d}if('"'==c||"'"==c)return b.tokenize=n(c),b.tokenize(a,b);if(/[\[\]{}\(\),;\:\.]/.test(c))return L=c,"bracket";
if(/\d/.test(c))return a.eatWhile(/[\w\.]/),"number";if("/"==c){if(a.eat("*"))return b.tokenize=B,B(a,b);if(a.eat("/"))return a.skipToEnd(),"comment"}if("#"==c)return a.eatWhile(/[\S]+/),a.eatWhile(/[\s]+/),a.eatWhile(/[\S]+/),a.eatWhile(/[\s]+/),"comment";if($.test(c))return a.eatWhile($),"operator";a.eatWhile(/[\w\$_]/);c=a.current();return O.propertyIsEnumerable(c)?(I.propertyIsEnumerable(c)&&(L="newstatement"),"keyword"):r.propertyIsEnumerable(c)?"builtin":F.propertyIsEnumerable(c)?"atom":"word"}
function n(a){return function(b,c){for(var d=!1,e,g=!1;null!=(e=b.next());){if(e==a&&!d){g=!0;break}d=!d&&"\\"==e}if(g||!d&&!N)c.tokenize=l;return"string"}}function B(a,b){for(var c=!1,d;d=a.next();){if("/"==d&&c){b.tokenize=l;break}c="*"==d}return"comment"}function E(a,b,c,d,e){this.indented=a;this.column=b;this.type=c;this.align=d;this.prev=e}function s(a,b,c){return a.context=new E(a.indented,b,c,null,a.context)}function D(a){var b=a.context.type;if(")"==b||"]"==b||"}"==b)a.indented=a.context.indented;
return a.context=a.context.prev}var q=a.indentUnit,O=e.keywords||b(c),r=e.builtins||b(d),I=e.blockKeywords||b("case do else for if switch while struct"),F=e.atoms||b("null"),T=e.hooks||{},N=e.multiLineStrings,$=/[+\-*&%=<>!?|\/]/,L;return{startState:function(a){return{tokenize:null,context:new E((a||0)-q,0,"top",!1),indented:0,startOfLine:!0}},token:function(a,b){var c=b.context;a.sol()&&(null==c.align&&(c.align=!1),b.indented=a.indentation(),b.startOfLine=!0);if(a.eatSpace())return null;L=null;var d=
(b.tokenize||l)(a,b);if("comment"==d||"meta"==d)return d;null==c.align&&(c.align=!0);if(";"!=L&&":"!=L||"statement"!=c.type)if("{"==L)s(b,a.column(),"}");else if("["==L)s(b,a.column(),"]");else if("("==L)s(b,a.column(),")");else if("}"==L){for(;"statement"==c.type;)c=D(b);for("}"==c.type&&(c=D(b));"statement"==c.type;)c=D(b)}else L==c.type?D(b):("}"==c.type||"top"==c.type||"statement"==c.type&&"newstatement"==L)&&s(b,a.column(),"statement");else D(b);b.startOfLine=!1;return d},indent:function(a,b){if(a.tokenize!=
l&&null!=a.tokenize)return 0;var c=b&&b.charAt(0),d=a.context,e=c==d.type;return"statement"==d.type?d.indented+("{"==c?0:q):d.align?d.column+(e?0:1):d.indented+(e?0:q)},electricChars:"{}"}});var c="attribute const uniform varying break continue do for while if else in out inout float int void bool true false lowp mediump highp precision invariant discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler2D samplerCube struct gl_FragCoord gl_FragColor",d="radians degrees sin cos tan asin acos atan pow exp log exp2 log2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not dFdx dFdy fwidth texture2D texture2DProj texture2DLod texture2DProjLod textureCube textureCubeLod require export";
a.defineMIME("text/x-glsl",{name:"glsl",keywords:b(c),builtins:b(d),blockKeywords:b("case do else for if switch while struct"),atoms:b("null"),hooks:{"#":function(a,b){if(!b.startOfLine)return!1;a.skipToEnd();return"meta"}}})});(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function b(a,b,g){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(b.lastType)||"quasi"==b.lastType&&/\{\s*$/.test(a.string.slice(0,a.pos-(g||0)))}a.defineMode("javascript",function(c,d){function g(a,b,c){fa=a;ga=c;return b}function e(a,c){var d=a.next();if('"'==d||"'"==
d)return c.tokenize=l(d),c.tokenize(a,c);if("."==d&&a.match(/^\d+(?:[eE][+\-]?\d+)?/))return g("number","number");if("."==d&&a.match(".."))return g("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(d))return g(d);if("="==d&&a.eat(">"))return g("=>","operator");if("0"==d&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),g("number","number");if("0"==d&&a.eat(/o/i))return a.eatWhile(/[0-7]/i),g("number","number");if("0"==d&&a.eat(/b/i))return a.eatWhile(/[01]/i),g("number","number");if(/\d/.test(d))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),
g("number","number");if("/"==d){if(a.eat("*"))return c.tokenize=n,n(a,c);if(a.eat("/"))return a.skipToEnd(),g("comment","comment");if(b(a,c,1)){a:for(var d=!1,e,s=!1;null!=(e=a.next());){if(!d){if("/"==e&&!s)break a;"["==e?s=!0:s&&"]"==e&&(s=!1)}d=!d&&"\\"==e}a.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);return g("regexp","string-2")}a.eatWhile(oa);return g("operator","operator",a.current())}if("`"==d)return c.tokenize=B,B(a,c);if("#"==d)return a.skipToEnd(),g("error","error");if(oa.test(d))return">"==
d&&c.lexical&&">"==c.lexical.type||a.eatWhile(oa),g("operator","operator",a.current());if(pb.test(d))return a.eatWhile(pb),d=a.current(),(e=R.propertyIsEnumerable(d)&&R[d])&&"."!=c.lastType?g(e.type,e.style,d):g("variable","variable",d)}function l(a){return function(b,c){var d=!1,l;if(gb&&"@"==b.peek()&&b.match(A))return c.tokenize=e,g("jsonld-keyword","meta");for(;null!=(l=b.next())&&(l!=a||d);)d=!d&&"\\"==l;d||(c.tokenize=e);return g("string","string")}}function n(a,b){for(var c=!1,d;d=a.next();){if("/"==
d&&c){b.tokenize=e;break}c="*"==d}return g("comment","comment")}function B(a,b){for(var c=!1,d;null!=(d=a.next());){if(!c&&("`"==d||"$"==d&&a.eat("{"))){b.tokenize=e;break}c=!c&&"\\"==d}return g("quasi","string-2",a.current())}function E(a,b){b.fatArrowAt&&(b.fatArrowAt=null);var c=a.string.indexOf("=>",a.start);if(!(0>c)){if(M){var d=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(a.string.slice(a.start,c));d&&(c=d.index)}for(var d=0,e=!1,c=c-1;0<=c;--c){var g=a.string.charAt(c),l=Ha.indexOf(g);
if(0<=l&&3>l){if(!d){++c;break}if(0==--d){"("==g&&(e=!0);break}}else if(3<=l&&6>l)++d;else if(pb.test(g))e=!0;else{if(/["'\/]/.test(g))return;if(e&&!d){++c;break}}}e&&!d&&(b.fatArrowAt=c)}}function s(a,b,c,d,e,g){this.indented=a;this.column=b;this.type=c;this.prev=e;this.info=g;null!=d&&(this.align=d)}function D(){for(var a=arguments.length-1;0<=a;a--)H.cc.push(arguments[a])}function q(){D.apply(null,arguments);return!0}function O(a){function b(c){for(;c;c=c.next)if(c.name==a)return!0;return!1}var c=
H.state;H.marked="def";c.context?b(c.localVars)||(c.localVars={name:a,next:c.localVars}):!b(c.globalVars)&&d.globalVars&&(c.globalVars={name:a,next:c.globalVars})}function r(){H.state.context={prev:H.state.context,vars:H.state.localVars};H.state.localVars=G}function I(){H.state.localVars=H.state.context.vars;H.state.context=H.state.context.prev}function F(a,b){var c=function(){var c=H.state,d=c.indented;if("stat"==c.lexical.type)d=c.lexical.indented;else for(var e=c.lexical;e&&")"==e.type&&e.align;e=
e.prev)d=e.indented;c.lexical=new s(d,H.stream.column(),a,null,c.lexical,b)};c.lex=!0;return c}function T(){var a=H.state;a.lexical.prev&&(")"==a.lexical.type&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function N(a){function b(c){return c==a?q():";"==a?D():q(b)}return b}function $(a,b){return"var"==a?q(F("vardef",b.length),Jb,N(";"),T):"keyword a"==a?q(F("form"),na,$,T):"keyword b"==a?q(F("form"),$,T):"{"==a?q(F("}"),Qa,T):";"==a?q():"if"==a?("else"==H.state.lexical.info&&H.state.cc[H.state.cc.length-
1]==T&&H.state.cc.pop()(),q(F("form"),na,$,T,Kc)):"function"==a?q(pa):"for"==a?q(F("form"),Ac,$,T):"variable"==a?M&&"type"==b?(H.marked="keyword",q(X,N("operator"),X,N(";"))):q(F("stat"),J):"switch"==a?q(F("form"),na,N("{"),F("}","switch"),Qa,T,T):"case"==a?q(L,N(":")):"default"==a?q(N(":")):"catch"==a?q(F("form"),r,N("("),Cb,N(")"),$,T,I):"class"==a?q(F("form"),ra,T):"export"==a?q(F("stat"),dc,T):"import"==a?q(F("stat"),La,T):"module"==a?q(F("form"),fb,N("{"),F("}"),Qa,T,T):"async"==a?q($):"@"==
b?q(L,$):D(F("stat"),L,N(";"),T)}function L(a){return Ja(a,!1)}function ka(a){return Ja(a,!0)}function na(a){return"("!=a?D():q(F(")"),L,N(")"),T)}function Ja(a,b){if(H.state.fatArrowAt==H.stream.start){var c=b?qa:sa;if("("==a)return q(r,F(")"),xa(fb,")"),T,N("=>"),c,I);if("variable"==a)return D(r,fb,N("=>"),c,I)}c=b?P:Ta;return ia.hasOwnProperty(a)?q(c):"function"==a?q(pa,c):"class"==a?q(F("form"),ma,T):"keyword c"==a||"async"==a?q(b?eb:ea):"("==a?q(F(")"),ea,N(")"),T,c):"operator"==a||"spread"==
a?q(b?ka:L):"["==a?q(F("]"),za,T,c):"{"==a?K(Ga,"}",null,c):"quasi"==a?D(Pa,c):"new"==a?q(Ia(b)):q()}function ea(a){return a.match(/[;\}\)\],]/)?D():D(L)}function eb(a){return a.match(/[;\}\)\],]/)?D():D(ka)}function Ta(a,b){return","==a?q(L):P(a,b,!1)}function P(a,b,c){var d=!1==c?Ta:P,e=!1==c?L:ka;if("=>"==a)return q(r,c?qa:sa,I);if("operator"==a)return/\+\+|--/.test(b)?q(d):"?"==b?q(L,N(":"),e):q(e);if("quasi"==a)return D(Pa,d);if(";"!=a){if("("==a)return K(ka,")","call",d);if("."==a)return q(Q,
d);if("["==a)return q(F("]"),ea,N("]"),T,d)}}function Pa(a,b){return"quasi"!=a?D():"${"!=b.slice(b.length-2)?q(Pa):q(L,ya)}function ya(a){if("}"==a)return H.marked="string-2",H.state.tokenize=B,q(Pa)}function sa(a){E(H.stream,H.state);return D("{"==a?$:L)}function qa(a){E(H.stream,H.state);return D("{"==a?$:ka)}function Ia(a){return function(b){return"."==b?q(a?Ea:Fa):D(a?ka:L)}}function Fa(a,b){if("target"==b)return H.marked="keyword",q(Ta)}function Ea(a,b){if("target"==b)return H.marked="keyword",
q(P)}function J(a){return":"==a?q(T,$):D(Ta,N(";"),T)}function Q(a){if("variable"==a)return H.marked="property",q()}function Ga(a,b){if("async"==a)return H.marked="property",q(Ga);if("variable"==a||"keyword"==H.style)return H.marked="property","get"==b||"set"==b?q(Z):q(nb);if("number"==a||"string"==a)return H.marked=gb?"property":H.style+" property",q(nb);if("jsonld-keyword"==a)return q(nb);if("modifier"==a)return q(Ga);if("["==a)return q(L,N("]"),nb);if("spread"==a)return q(L);if(":"==a)return D(nb)}
function Z(a){if("variable"!=a)return D(nb);H.marked="property";return q(pa)}function nb(a){if(":"==a)return q(ka);if("("==a)return D(pa)}function xa(a,b,c){function d(e,g){if(c?-1<c.indexOf(e):","==e){var l=H.state.lexical;"call"==l.info&&(l.pos=(l.pos||0)+1);return q(function(c,d){return c==b||d==b?D():D(a)},d)}return e==b||g==b?q():q(N(b))}return function(c,e){return c==b||e==b?q():D(a,d)}}function K(a,b,c){for(var d=3;d<arguments.length;d++)H.cc.push(arguments[d]);return q(F(b,c),xa(a,b),T)}function Qa(a){return"}"==
a?q():D($,Qa)}function Xa(a,b){if(M){if(":"==a)return q(X);if("?"==b)return q(Xa)}}function X(a){if("variable"==a)return H.marked="variable-3",q(Fb);if("string"==a||"number"==a||"atom"==a)return q(Fb);if("{"==a)return q(F("}"),xa(Jc,"}",",;"),T,Fb);if("("==a)return q(xa(aa,")"),Wb)}function Wb(a){if("=>"==a)return q(X)}function Jc(a,b){if("variable"==a||"keyword"==H.style)return H.marked="property",q(Jc);if("?"==b)return q(Jc);if(":"==a)return q(X);if("["==a)return q(L,Xa,N("]"),Jc)}function aa(a){if("variable"==
a)return q(aa);if(":"==a)return q(X)}function Fb(a,b){if("<"==b)return q(F(">"),xa(X,">"),T,Fb);if("|"==b||"."==a)return q(X);if("["==a)return q(N("]"),Fb);if("extends"==b)return q(X)}function Jb(){return D(fb,Xa,ib,Bb)}function fb(a,b){if("modifier"==a)return q(fb);if("variable"==a)return O(b),q();if("spread"==a)return q(fb);if("["==a)return K(fb,"]");if("{"==a)return K(hb,"}")}function hb(a,b){if("variable"==a&&!H.stream.match(/^\s*:/,!1))return O(b),q(ib);"variable"==a&&(H.marked="property");return"spread"==
a?q(fb):"}"==a?D():q(N(":"),fb,ib)}function ib(a,b){if("="==b)return q(ka)}function Bb(a){if(","==a)return q(Jb)}function Kc(a,b){if("keyword b"==a&&"else"==b)return q(F("form","else"),$,T)}function Ac(a){if("("==a)return q(F(")"),wb,N(")"),T)}function wb(a){return"var"==a?q(Jb,N(";"),U):";"==a?q(U):"variable"==a?q(ad):D(L,N(";"),U)}function ad(a,b){return"in"==b||"of"==b?(H.marked="keyword",q(L)):q(Ta,U)}function U(a,b){return";"==a?q(Na):"in"==b||"of"==b?(H.marked="keyword",q(L)):D(L,N(";"),Na)}
function Na(a){")"!=a&&q(L)}function pa(a,b){if("*"==b)return H.marked="keyword",q(pa);if("variable"==a)return O(b),q(pa);if("("==a)return q(r,F(")"),xa(Cb,")"),T,Xa,$,I);if(M&&"<"==b)return q(F(">"),xa(X,">"),T,pa)}function Cb(a){return"spread"==a?q(Cb):D(fb,Xa,ib)}function ma(a,b){return"variable"==a?ra(a,b):Kb(a,b)}function ra(a,b){if("variable"==a)return O(b),q(Kb)}function Kb(a,b){if("<"==b)return q(F(">"),xa(X,">"),T,Kb);if("extends"==b||"implements"==b||M&&","==a)return q(M?X:L,Kb);if("{"==
a)return q(F("}"),Gb,T)}function Gb(a,b){if("variable"==a||"keyword"==H.style){if(("async"==b||"static"==b||"get"==b||"set"==b||M&&("public"==b||"private"==b||"protected"==b||"readonly"==b||"abstract"==b))&&H.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return H.marked="keyword",q(Gb);H.marked="property";return q(M?jb:pa,Gb)}if("["==a)return q(L,N("]"),M?jb:pa,Gb);if("*"==b)return H.marked="keyword",q(Gb);if(";"==a)return q(Gb);if("}"==a)return q();if("@"==b)return q(L,Gb)}function jb(a,b){return"?"==
b?q(jb):":"==a?q(X,ib):"="==b?q(ka):D(pa)}function dc(a,b){return"*"==b?(H.marked="keyword",q(V,N(";"))):"default"==b?(H.marked="keyword",q(L,N(";"))):"{"==a?q(xa(ab,"}"),V,N(";")):D($)}function ab(a,b){if("as"==b)return H.marked="keyword",q(N("variable"));if("variable"==a)return D(ka,ab)}function La(a){return"string"==a?q():D(Aa,da,V)}function Aa(a,b){if("{"==a)return K(Aa,"}");"variable"==a&&O(b);"*"==b&&(H.marked="keyword");return q(ob)}function da(a){if(","==a)return q(Aa,da)}function ob(a,b){if("as"==
b)return H.marked="keyword",q(Aa)}function V(a,b){if("from"==b)return H.marked="keyword",q(L)}function za(a){return"]"==a?q():D(xa(ka,"]"))}var ba=c.indentUnit,ca=d.statementIndent,gb=d.jsonld,kb=d.json||gb,M=d.typescript,pb=d.wordCharacters||/[\w$\xa1-\uffff]/,R=function(){function a(b){return{type:b,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),g={type:"atom",style:"atom"},b={"if":a("if"),"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,
"break":d,"continue":d,"new":a("new"),"delete":d,"throw":d,"debugger":d,"var":a("var"),"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":g,"false":g,"null":g,undefined:g,NaN:g,Infinity:g,"this":a("this"),"class":a("class"),"super":a("atom"),yield:d,"export":a("export"),"import":a("import"),"extends":d,await:d,async:a("async")};if(M){var c={type:"variable",style:"variable-3"},
d={"interface":a("class"),"implements":d,namespace:d,module:a("module"),"enum":a("module"),"public":a("modifier"),"private":a("modifier"),"protected":a("modifier"),"abstract":a("modifier"),as:e,string:c,number:c,"boolean":c,any:c},l;for(l in d)b[l]=d[l]}return b}(),oa=/[+\-*&%=<>!?|~^@]/,A=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,fa,ga,Ha="([{}])",ia={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},H={state:null,column:null,
marked:null,cc:null},G={name:"this",next:{name:"arguments"}};T.lex=!0;return{startState:function(a){a={tokenize:e,lastType:"sof",cc:[],lexical:new s((a||0)-ba,0,"block",!1),localVars:d.localVars,context:d.localVars&&{vars:d.localVars},indented:a||0};d.globalVars&&"object"==typeof d.globalVars&&(a.globalVars=d.globalVars);return a},token:function(a,b){a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation(),E(a,b));if(b.tokenize!=n&&a.eatSpace())return null;var c=
b.tokenize(a,b);if("comment"==fa)return c;b.lastType="operator"!=fa||"++"!=ga&&"--"!=ga?fa:"incdec";a:{var d=fa,e=ga,g=b.cc;H.state=b;H.stream=a;H.marked=null;H.cc=g;H.style=c;b.lexical.hasOwnProperty("align")||(b.lexical.align=!0);for(;;)if((g.length?g.pop():kb?L:$)(d,e)){for(;g.length&&g[g.length-1].lex;)g.pop()();if(H.marked){c=H.marked;break a}if(d="variable"==d)b:{for(d=b.localVars;d;d=d.next)if(d.name==e){d=!0;break b}for(g=b.context;g;g=g.prev)for(d=g.vars;d;d=d.next)if(d.name==e){d=!0;break b}d=
void 0}if(d){c="variable-2";break a}break a}c=void 0}return c},indent:function(b,c){if(b.tokenize==n)return a.Pass;if(b.tokenize!=e)return 0;var g=c&&c.charAt(0),l=b.lexical,s;if(!/^\s*else\b/.test(c))for(var q=b.cc.length-1;0<=q;--q){var r=b.cc[q];if(r==T)l=l.prev;else if(r!=Kc)break}for(;!("stat"!=l.type&&"form"!=l.type||"}"!=g&&(!(s=b.cc[b.cc.length-1])||s!=Ta&&s!=P||/^[,\.=+\-*:?[\(]/.test(c)));)l=l.prev;ca&&")"==l.type&&"stat"==l.prev.type&&(l=l.prev);s=l.type;q=g==s;return"vardef"==s?l.indented+
("operator"==b.lastType||","==b.lastType?l.info+1:0):"form"==s&&"{"==g?l.indented:"form"==s?l.indented+ba:"stat"==s?(g=l.indented,l="operator"==b.lastType||","==b.lastType||oa.test(c.charAt(0))||/[,.]/.test(c.charAt(0)),g+(l?ca||ba:0)):"switch"!=l.info||q||!1==d.doubleIndentSwitch?l.align?l.column+(q?0:1):l.indented+(q?0:ba):l.indented+(/^(?:case|default)\b/.test(c)?ba:2*ba)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:kb?null:"/*",blockCommentEnd:kb?null:"*/",lineComment:kb?
null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:kb?"json":"javascript",jsonldMode:gb,jsonMode:kb,expressionAllowed:b,skipExpression:function(a){var b=a.cc[a.cc.length-1];b!=L&&b!=ka||a.cc.pop()}}});a.registerHelper("wordChars","javascript",/[\w$]/);a.defineMIME("text/javascript","javascript");a.defineMIME("text/ecmascript","javascript");a.defineMIME("application/javascript","javascript");a.defineMIME("application/x-javascript","javascript");a.defineMIME("application/ecmascript","javascript");
a.defineMIME("application/json",{name:"javascript",json:!0});a.defineMIME("application/x-json",{name:"javascript",json:!0});a.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});a.defineMIME("text/typescript",{name:"javascript",typescript:!0});a.defineMIME("application/typescript",{name:"javascript",typescript:!0})});(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function b(a){for(var b=0;b<a.state.activeLines.length;b++)a.removeLineClass(a.state.activeLines[b],"wrap",e),a.removeLineClass(a.state.activeLines[b],"background",l),a.removeLineClass(a.state.activeLines[b],"gutter",n)}function c(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=
b[c])return!1;return!0}function d(a,d){for(var g=[],D=0;D<d.length;D++){var q=d[D],O=a.getOption("styleActiveLine");if("object"==typeof O&&O.nonEmpty?q.anchor.line==q.head.line:q.empty())q=a.getLineHandleVisualStart(q.head.line),g[g.length-1]!=q&&g.push(q)}c(a.state.activeLines,g)||a.operation(function(){b(a);for(var c=0;c<g.length;c++)a.addLineClass(g[c],"wrap",e),a.addLineClass(g[c],"background",l),a.addLineClass(g[c],"gutter",n);a.state.activeLines=g})}function g(a,b){d(a,b.ranges)}var e="CodeMirror-activeline",
l="CodeMirror-activeline-background",n="CodeMirror-activeline-gutter";a.defineOption("styleActiveLine",!1,function(c,e,l){l=l==a.Init?!1:l;e!=l&&(l&&(c.off("beforeSelectionChange",g),b(c),delete c.state.activeLines),e&&(c.state.activeLines=[],d(c,c.listSelections()),c.on("beforeSelectionChange",g)))})});(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function b(a,b,d,e){var g=a.getLineHandle(b.line),r=b.ch-1,g=0<=r&&n[g.text.charAt(r)]||n[g.text.charAt(++r)];if(!g)return null;var B=">"==g.charAt(1)?1:-1;if(d&&0<B!=(r==b.ch))return null;d=a.getTokenTypeAt(l(b.line,r+1));a=c(a,l(b.line,r+(0<B?1:0)),B,d||null,e);return null==a?null:{from:l(b.line,r),
to:a&&a.pos,match:a&&a.ch==g.charAt(0),forward:0<B}}function c(a,b,c,d,e){var g=e&&e.maxScanLineLength||1E4,B=e&&e.maxScanLines||1E3,F=[];e=e&&e.bracketRegex?e.bracketRegex:/[(){}[\]]/;for(var B=0<c?Math.min(b.line+B,a.lastLine()+1):Math.max(a.firstLine()-1,b.line-B),T=b.line;T!=B;T+=c){var N=a.getLine(T);if(N){var $=0<c?0:N.length-1,L=0<c?N.length:-1;if(!(N.length>g))for(T==b.line&&($=b.ch-(0>c?1:0));$!=L;$+=c){var ka=N.charAt($);if(e.test(ka)&&(void 0===d||a.getTokenTypeAt(l(T,$+1))==d))if(">"==
n[ka].charAt(1)==0<c)F.push(ka);else if(F.length)F.pop();else return{pos:l(T,$),ch:ka}}}}return T-c==(0<c?a.lastLine():a.firstLine())?!1:null}function d(a,c,d){for(var g=a.state.matchBrackets.maxHighlightLineLength||1E3,n=[],r=a.listSelections(),B=0;B<r.length;B++){var F=r[B].empty()&&b(a,r[B].head,!1,d);if(F&&a.getLine(F.from.line).length<=g){var T=F.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";n.push(a.markText(F.from,l(F.from.line,F.from.ch+1),{className:T}));F.to&&a.getLine(F.to.line).length<=
g&&n.push(a.markText(F.to,l(F.to.line,F.to.ch+1),{className:T}))}}if(n.length)if(e&&a.state.focused&&a.focus(),d=function(){a.operation(function(){for(var a=0;a<n.length;a++)n[a].clear()})},c)setTimeout(d,800);else return d}function g(a){a.operation(function(){B&&(B(),B=null);B=d(a,!1,a.state.matchBrackets)})}var e=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),l=a.Pos,n={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},B=null;a.defineOption("matchBrackets",
!1,function(b,c,d){d&&d!=a.Init&&(b.off("cursorActivity",g),B&&(B(),B=null));c&&(b.state.matchBrackets="object"==typeof c?c:{},b.on("cursorActivity",g))});a.defineExtension("matchBrackets",function(){d(this,!0)});a.defineExtension("findMatchingBracket",function(a,c,d){return b(this,a,c,d)});a.defineExtension("scanForBracket",function(a,b,d,e){return c(this,a,b,d,e)})});(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./matchesonscrollbar"],a):a(CodeMirror)})(function(a){function b(a){this.options={};for(var b in E)this.options[b]=(a&&a.hasOwnProperty(b)?a:E)[b];this.matchesonscroll=this.overlay=this.timeout=null;this.active=!1}function c(a){var b=a.state.matchHighlighter;(b.active||a.hasFocus())&&g(a,b)}function d(a){var b=
a.state.matchHighlighter;b.active||(b.active=!0,g(a,b))}function g(a,b){clearTimeout(b.timeout);b.timeout=setTimeout(function(){n(a)},b.options.delay)}function e(a,b,c,d){var e=a.state.matchHighlighter;a.addOverlay(e.overlay=B(b,c,d));e.options.annotateScrollbar&&a.showMatchesOnScrollbar&&(e.matchesonscroll=a.showMatchesOnScrollbar(c?RegExp("\\b"+b+"\\b"):b,!1,{className:"CodeMirror-selection-highlight-scrollbar"}))}function l(a){var b=a.state.matchHighlighter;b.overlay&&(a.removeOverlay(b.overlay),
b.overlay=null,b.matchesonscroll&&(b.matchesonscroll.clear(),b.matchesonscroll=null))}function n(a){a.operation(function(){var b=a.state.matchHighlighter;l(a);if(!a.somethingSelected()&&b.options.showToken){for(var c=!0===b.options.showToken?/[\w$]/:b.options.showToken,d=a.getCursor(),g=a.getLine(d.line),n=d=d.ch;d&&c.test(g.charAt(d-1));)--d;for(;n<g.length&&c.test(g.charAt(n));)++n;d<n&&e(a,g.slice(d,n),c,b.options.style)}else if(c=a.getCursor("from"),g=a.getCursor("to"),c.line==g.line){if(d=b.options.wordsOnly){a:if(null!==
a.getRange(c,g).match(/^\w+$/)){if(0<c.ch&&(d={line:c.line,ch:c.ch-1},d=a.getRange(d,c),null===d.match(/\W/))){d=!1;break a}if(g.ch<a.getLine(c.line).length&&(d={line:g.line,ch:g.ch+1},d=a.getRange(g,d),null===d.match(/\W/))){d=!1;break a}d=!0}else d=!1;d=!d}d||(c=a.getRange(c,g),b.options.trim&&(c=c.replace(/^\s+|\s+$/g,"")),c.length>=b.options.minChars&&e(a,c,!1,b.options.style))}})}function B(a,b,c){return{token:function(d){var e;if(e=d.match(a))(e=!b)||(e=(!d.start||!b.test(d.string.charAt(d.start-
1)))&&(d.pos==d.string.length||!b.test(d.string.charAt(d.pos))));if(e)return c;d.next();d.skipTo(a.charAt(0))||d.skipToEnd()}}}var E={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};a.defineOption("highlightSelectionMatches",!1,function(e,g,q){q&&q!=a.Init&&(l(e),clearTimeout(e.state.matchHighlighter.timeout),e.state.matchHighlighter=null,e.off("cursorActivity",c),e.off("focus",d));if(g){g=e.state.matchHighlighter=new b(g);if(e.hasFocus())g.active=
!0,n(e);else e.on("focus",d);e.on("cursorActivity",c)}})});(function(a,b){"function"===typeof define&&define.amd?define(["exports"],b):"undefined"!==typeof exports?b(exports):b(a.esprima={})})(this,function(a){function b(a,b){if(!a)throw Error("ASSERT: "+b);}function c(a){return 48<=a&&57>=a}function d(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function g(a){return 0<="01234567".indexOf(a)}function e(a){return 10===a||13===a||8232===a||8233===a}function l(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&pb.NonAsciiIdentifierStart.test(String.fromCharCode(a))}
function n(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&pb.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function B(a){switch(a){case "implements":case "interface":case "package":case "private":case "protected":case "public":case "static":case "yield":case "let":return!0;default:return!1}}function E(a){return"eval"===a||"arguments"===a}function s(a){if(oa&&B(a))return!0;switch(a.length){case 2:return"if"===a||"in"===a||"do"===a;case 3:return"var"===a||
"for"===a||"new"===a||"try"===a||"let"===a;case 4:return"this"===a||"else"===a||"case"===a||"void"===a||"with"===a||"enum"===a;case 5:return"while"===a||"break"===a||"catch"===a||"throw"===a||"const"===a||"yield"===a||"class"===a||"super"===a;case 6:return"return"===a||"typeof"===a||"delete"===a||"switch"===a||"export"===a||"import"===a;case 7:return"default"===a||"finally"===a||"extends"===a;case 8:return"function"===a||"continue"===a||"debugger"===a;case 10:return"instanceof"===a;default:return!1}}
function D(a,c,d,e,g){b("number"===typeof d,"Comment must have valid position");H.lastCommentStart>=d||(H.lastCommentStart=d,a={type:a,value:c},G.range&&(a.range=[d,e]),G.loc&&(a.loc=g),G.comments.push(a),G.attachComment&&(G.leadingComments.push(a),G.trailingComments.push(a)))}function q(a){var b,c,d;b=A-a;for(c={start:{line:fa,column:A-ga-a}};A<Ha;)if(d=R.charCodeAt(A),++A,e(d)){G.comments&&(a=R.slice(b+a,A-1),c.end={line:fa,column:A-ga-1},D("Line",a,b,A-1,c));13===d&&10===R.charCodeAt(A)&&++A;++fa;
ga=A;return}G.comments&&(a=R.slice(b+a,A),c.end={line:fa,column:A-ga},D("Line",a,b,A,c))}function O(){var a,b;for(b=0===A;A<Ha;)if(a=R.charCodeAt(A),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++A;else if(e(a))++A,13===a&&10===R.charCodeAt(A)&&++A,++fa,ga=A,b=!0;else if(47===a)if(a=R.charCodeAt(A+1),47===a)++A,++A,q(2),b=!0;else if(42===a){++A;++A;a:{var c=a=void 0,d=void 0,d=void 0;G.comments&&
(a=A-2,c={start:{line:fa,column:A-ga-2}});for(;A<Ha;)if(d=R.charCodeAt(A),e(d))13===d&&10===R.charCodeAt(A+1)&&++A,++fa,++A,ga=A,A>=Ha&&Q();else{if(42===d&&47===R.charCodeAt(A+1)){++A;++A;G.comments&&(d=R.slice(a+2,A-2),c.end={line:fa,column:A-ga},D("Block",d,a,A,c));break a}++A}Q()}}else break;else if(b&&45===a)if(45===R.charCodeAt(A+1)&&62===R.charCodeAt(A+2))A+=3,q(3);else break;else if(60===a)if("!--"===R.slice(A+1,A+4))++A,++A,++A,++A,q(4);else break;else break}function r(a){var b,c,e=0;b="u"===
a?4:2;for(a=0;a<b;++a)if(A<Ha&&d(R[A]))c=R[A++],e=16*e+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(e)}function I(){var a,b;a=R.charCodeAt(A++);b=String.fromCharCode(a);92===a&&(117!==R.charCodeAt(A)&&Q(),++A,(a=r("u"))&&"\\"!==a&&l(a.charCodeAt(0))||Q(),b=a);for(;A<Ha;){a=R.charCodeAt(A);if(!n(a))break;++A;b+=String.fromCharCode(a);92===a&&(b=b.substr(0,b.length-1),117!==R.charCodeAt(A)&&Q(),++A,(a=r("u"))&&"\\"!==a&&n(a.charCodeAt(0))||Q(),b+=a)}return b}
function F(){var a=A,b=R.charCodeAt(A),c,d=R[A];switch(b){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++A,G.tokenize&&(40===b?G.openParenToken=G.tokens.length:123===b&&(G.openCurlyToken=G.tokens.length)),{type:V.Punctuator,value:String.fromCharCode(b),lineNumber:fa,lineStart:ga,start:a,end:A};default:if(c=R.charCodeAt(A+1),61===c)switch(b){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return A+=2,{type:V.Punctuator,
value:String.fromCharCode(b)+String.fromCharCode(c),lineNumber:fa,lineStart:ga,start:a,end:A};case 33:case 61:return A+=2,61===R.charCodeAt(A)&&++A,{type:V.Punctuator,value:R.slice(a,A),lineNumber:fa,lineStart:ga,start:a,end:A}}}b=R.substr(A,4);if(">>>="===b)return A+=4,{type:V.Punctuator,value:b,lineNumber:fa,lineStart:ga,start:a,end:A};b=b.substr(0,3);if(">>>"===b||"<<="===b||">>="===b)return A+=3,{type:V.Punctuator,value:b,lineNumber:fa,lineStart:ga,start:a,end:A};b=b.substr(0,2);if(d===b[1]&&
0<="+-<>&|".indexOf(d)||"=>"===b)return A+=2,{type:V.Punctuator,value:b,lineNumber:fa,lineStart:ga,start:a,end:A};if(0<="<>=!+-*%&|^/".indexOf(d))return++A,{type:V.Punctuator,value:d,lineNumber:fa,lineStart:ga,start:a,end:A};Q()}function T(){var a,e,z;z=R[A];b(c(z.charCodeAt(0))||"."===z,"Numeric literal must start with a decimal digit or a decimal point");e=A;a="";if("."!==z){a=R[A++];z=R[A];if("0"===a){if("x"===z||"X"===z){++A;for(a="";A<Ha&&d(R[A]);)a+=R[A++];0===a.length&&Q();l(R.charCodeAt(A))&&
Q();return{type:V.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:fa,lineStart:ga,start:e,end:A}}if("b"===z||"B"===z){++A;for(z="";A<Ha;){a=R[A];if("0"!==a&&"1"!==a)break;z+=R[A++]}0===z.length&&Q();A<Ha&&(a=R.charCodeAt(A),(l(a)||c(a))&&Q());return{type:V.NumericLiteral,value:parseInt(z,2),lineNumber:fa,lineStart:ga,start:e,end:A}}var n;if(!(n="o"===z||"O"===z)&&(n=g(z)))a:{var s;for(n=A+1;n<Ha;++n){s=R[n];if("8"===s||"9"===s){n=!1;break a}if(!g(s))break}n=!0}if(n){g(z)?(z=!0,a="0"+R[A++]):(z=
!1,++A,a="");for(;A<Ha&&g(R[A]);)a+=R[A++];z||0!==a.length||Q();(l(R.charCodeAt(A))||c(R.charCodeAt(A)))&&Q();return{type:V.NumericLiteral,value:parseInt(a,8),octal:z,lineNumber:fa,lineStart:ga,start:e,end:A}}}for(;c(R.charCodeAt(A));)a+=R[A++];z=R[A]}if("."===z){for(a+=R[A++];c(R.charCodeAt(A));)a+=R[A++];z=R[A]}if("e"===z||"E"===z){a+=R[A++];z=R[A];if("+"===z||"-"===z)a+=R[A++];if(c(R.charCodeAt(A)))for(;c(R.charCodeAt(A));)a+=R[A++];else Q()}l(R.charCodeAt(A))&&Q();return{type:V.NumericLiteral,
value:parseFloat(a),lineNumber:fa,lineStart:ga,start:e,end:A}}function N(a,b){var c=a;0<=b.indexOf("u")&&(c=c.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(a,b){if(1114111>=parseInt(b,16))return"x";Fa(M.InvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return RegExp(a,b)}catch(d){return null}}function $(){var a,c,d,g,l,s;ia=null;O();l=A;d=R[A];b("/"===d,"Regular expression literal must start with a slash");g=R[A++];for(a=c=!1;A<Ha;)if(d=R[A++],g+=d,"\\"===d)d=R[A++],e(d.charCodeAt(0))&&
Fa(M.UnterminatedRegExp),g+=d;else if(e(d.charCodeAt(0)))Fa(M.UnterminatedRegExp);else if(c)"]"===d&&(c=!1);else if("/"===d){a=!0;break}else"["===d&&(c=!0);a||Fa(M.UnterminatedRegExp);d=g.substr(1,g.length-2);var q;for(s=c="";A<Ha;){a=R[A];if(!n(a.charCodeAt(0)))break;++A;if("\\"===a&&A<Ha){a=R[A];if("u"===a)if(++A,q=A,a=r("u"))for(s+=a,c+="\\u";q<A;++q)c+=R[q];else A=q,s+="u",c+="\\u";else c+="\\";Ga()}else s+=a,c+=a}a=s;s=N(d,a);return G.tokenize?{type:V.RegularExpression,value:s,regex:{pattern:d,
flags:a},lineNumber:fa,lineStart:ga,start:l,end:A}:{literal:g+c,value:s,regex:{pattern:d,flags:a},start:l,end:A}}function L(){var a,b,c,d;O();a=A;b={start:{line:fa,column:A-ga}};c=$();b.end={line:fa,column:A-ga};G.tokenize||(0<G.tokens.length&&(d=G.tokens[G.tokens.length-1],d.range[0]===a&&"Punctuator"===d.type&&("/"!==d.value&&"/="!==d.value||G.tokens.pop())),G.tokens.push({type:"RegularExpression",value:c.literal,regex:c.regex,range:[a,A],loc:b}));return c}function ka(){var a;a=G.tokens[G.tokens.length-
1];if(!a)return L();if("Punctuator"===a.type){if("]"===a.value)return F();if(")"===a.value)return a=G.tokens[G.openParenToken-1],!a||"Keyword"!==a.type||"if"!==a.value&&"while"!==a.value&&"for"!==a.value&&"with"!==a.value?F():L();if("}"===a.value){if(G.tokens[G.openCurlyToken-3]&&"Keyword"===G.tokens[G.openCurlyToken-3].type){if(a=G.tokens[G.openCurlyToken-4],!a)return F()}else if(G.tokens[G.openCurlyToken-4]&&"Keyword"===G.tokens[G.openCurlyToken-4].type){if(a=G.tokens[G.openCurlyToken-5],!a)return L()}else return F();
if(0<=ba.indexOf(a.value))return F()}return L()}return"Keyword"===a.type&&"this"!==a.value?L():F()}function na(){var a;O();if(A>=Ha)return{type:V.EOF,lineNumber:fa,lineStart:ga,start:A,end:A};a=R.charCodeAt(A);if(l(a)){var k;a=A;if(92===R.charCodeAt(A))k=I();else a:{var z;for(k=A++;A<Ha;){z=R.charCodeAt(A);if(92===z){A=k;k=I();break a}if(n(z))++A;else break}k=R.slice(k,A)}return{type:1===k.length?V.Identifier:s(k)?V.Keyword:"null"===k?V.NullLiteral:"true"===k||"false"===k?V.BooleanLiteral:V.Identifier,
value:k,lineNumber:fa,lineStart:ga,start:a,end:A}}if(40===a||41===a||59===a)return F();if(39===a||34===a){var x="",q,B,E;z=!1;var D,P;D=fa;P=ga;a=R[A];b("'"===a||'"'===a,"String literal must starts with a quote");k=A;for(++A;A<Ha;)if(q=R[A++],q===a){a="";break}else if("\\"===q)if((q=R[A++])&&e(q.charCodeAt(0)))++fa,"\r"===q&&"\n"===R[A]&&++A,ga=A;else switch(q){case "u":case "x":if("{"===R[A]){++A;B=q=B=void 0;B=R[A];q=0;for("}"===B&&Q();A<Ha;){B=R[A++];if(!d(B))break;q=16*q+"0123456789abcdef".indexOf(B.toLowerCase())}(1114111<
q||"}"!==B)&&Q();65535>=q?q=String.fromCharCode(q):(B=(q-65536>>10)+55296,q=String.fromCharCode(B,(q-65536&1023)+56320));x+=q}else E=A,(B=r(q))?x+=B:(A=E,x+=q);break;case "n":x+="\n";break;case "r":x+="\r";break;case "t":x+="\t";break;case "b":x+="\b";break;case "f":x+="\f";break;case "v":x+="\x0B";break;default:g(q)?(B="01234567".indexOf(q),0!==B&&(z=!0),A<Ha&&g(R[A])&&(z=!0,B=8*B+"01234567".indexOf(R[A++]),0<="0123".indexOf(q)&&A<Ha&&g(R[A])&&(B=8*B+"01234567".indexOf(R[A++]))),x+=String.fromCharCode(B)):
x+=q}else if(e(q.charCodeAt(0)))break;else x+=q;""!==a&&Q();return{type:V.StringLiteral,value:x,octal:z,startLineNumber:D,startLineStart:P,lineNumber:fa,lineStart:ga,start:k,end:A}}return 46===a?c(R.charCodeAt(A+1))?T():F():c(a)?T():G.tokenize&&47===a?ka():F()}function Ja(){var a,b,c;O();a={start:{line:fa,column:A-ga}};b=na();a.end={line:fa,column:A-ga};b.type!==V.EOF&&(c=R.slice(b.start,b.end),a={type:za[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(a.regex={pattern:b.regex.pattern,flags:b.regex.flags}),
G.tokens.push(a));return b}function ea(){var a;a=ia;A=a.end;fa=a.lineNumber;ga=a.lineStart;ia="undefined"!==typeof G.tokens?Ja():na();A=a.end;fa=a.lineNumber;ga=a.lineStart;return a}function eb(){var a,b,c;a=A;b=fa;c=ga;ia="undefined"!==typeof G.tokens?Ja():na();A=a;fa=b;ga=c}function Ta(){this.line=fa;this.column=A-ga}function P(){this.start=new Ta;this.end=null}function Pa(a){this.start=a.type===V.StringLiteral?{line:a.startLineNumber,column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-
a.lineStart};this.end=null}function ya(){A=ia.start;ia.type===V.StringLiteral?(fa=ia.startLineNumber,ga=ia.startLineStart):(fa=ia.lineNumber,ga=ia.lineStart);G.range&&(this.range=[A,0]);G.loc&&(this.loc=new P)}function sa(a){G.range&&(this.range=[a.start,0]);G.loc&&(this.loc=new Pa(a))}function qa(){var a,b,c,d;a=A;b=fa;c=ga;O();d=fa!==b;A=a;fa=b;ga=c;return d}function Ia(a,b,c){var d=Error("Line "+a+": "+c);d.index=b;d.lineNumber=a;d.column=b-ga+1;d.description=c;return d}function Fa(a){var c,d;
c=Array.prototype.slice.call(arguments,1);d=a.replace(/%(\d)/g,function(a,d){b(d<c.length,"Message reference must be in range");return c[d]});throw Ia(fa,A,d);}function Ea(a){var c,d;c=Array.prototype.slice.call(arguments,1);d=a.replace(/%(\d)/g,function(a,d){b(d<c.length,"Message reference must be in range");return c[d]});d=Ia(fa,A,d);if(G.errors)G.errors.push(d);else throw d;}function J(a,b){var c=M.UnexpectedToken;if(a&&(c=b?b:a.type===V.EOF?M.UnexpectedEOS:a.type===V.Identifier?M.UnexpectedIdentifier:
a.type===V.NumericLiteral?M.UnexpectedNumber:a.type===V.StringLiteral?M.UnexpectedString:M.UnexpectedToken,a.type===V.Keyword)){var d;a:switch(a.value){case "class":case "enum":case "export":case "extends":case "import":case "super":d=!0;break a;default:d=!1}d?c=M.UnexpectedReserved:oa&&B(a.value)&&(c=M.StrictReservedWord)}c=c.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?Ia(a.lineNumber,a.start,c):Ia(fa,A,c)}function Q(a,b){throw J(a,b);}function Ga(a,b){var c=J(a,b);
if(G.errors)G.errors.push(c);else throw c;}function Z(a){var b=ea();b.type===V.Punctuator&&b.value===a||Q(b)}function nb(){var a;G.errors?(a=ia,a.type===V.Punctuator&&","===a.value?ea():a.type===V.Punctuator&&";"===a.value?(ea(),Ga(a)):Ga(a,M.UnexpectedToken)):Z(",")}function xa(a){var b=ea();b.type===V.Keyword&&b.value===a||Q(b)}function K(a){return ia.type===V.Punctuator&&ia.value===a}function Qa(a){return ia.type===V.Keyword&&ia.value===a}function Xa(){var a,b=A,c=fa,d=ga,e=ia;59===R.charCodeAt(A)||
K(";")?ea():(a=fa,O(),fa!==a?(A=b,fa=c,ga=d,ia=e):ia.type===V.EOF||K("}")||Q(ia))}function X(a){return a.type===ca.Identifier||a.type===ca.MemberExpression}function Wb(a,b){var c,d,e=new ya;c=oa;d=dc();b&&oa&&E(a[0].name)&&Ga(b,M.StrictParamName);oa=c;return e.finishFunctionExpression(null,a,[],d)}function Jc(){var a,b;a=oa;oa=!0;b=La();b=Wb(b.params);oa=a;return b}function aa(){var a,b=new ya;a=ea();return a.type===V.StringLiteral||a.type===V.NumericLiteral?(oa&&a.octal&&Ga(a,M.StrictOctalLiteral),
b.finishLiteral(a)):b.finishIdentifier(a.value)}function Fb(){var a,b,c,d=new ya;a=ia;if(a.type===V.Identifier)return b=aa(),"get"!==a.value||K(":")||K("(")?"set"!==a.value||K(":")||K("(")?K(":")?(ea(),a=Na(),d.finishProperty("init",b,a,!1,!1)):K("(")?(a=Jc(),d.finishProperty("init",b,a,!0,!1)):d.finishProperty("init",b,b,!1,!0):(b=aa(),Z("("),a=ia,a.type!==V.Identifier?(Z(")"),Ga(a),a=Wb([])):(c=[ma()],Z(")"),a=Wb(c,a)),d.finishProperty("set",b,a,!1,!1)):(b=aa(),Z("("),Z(")"),a=Wb([]),d.finishProperty("get",
b,a,!1,!1));if(a.type===V.EOF||a.type===V.Punctuator)Q(a);else{b=aa();if(K(":"))return ea(),a=Na(),d.finishProperty("init",b,a,!1,!1);if(K("("))return a=Jc(),d.finishProperty("init",b,a,!0,!1);Q(ea())}}function Jb(){var a,b,c,d;if(K("("))return Z("("),K(")")?(ea(),b=gb.ArrowParameterPlaceHolder):(++H.parenthesisCount,b=pa(),Z(")")),b;if(K("[")){b=[];var e=new ya;for(Z("[");!K("]");)K(",")?(ea(),b.push(null)):(b.push(Na()),K("]")||Z(","));ea();return e.finishArrayExpression(b)}if(K("{")){b=[];var g;
a={};c=String;var l=new ya;for(Z("{");!K("}");)e=Fb(),g=e.key.type===ca.Identifier?e.key.name:c(e.key.value),d="init"===e.kind?kb.Data:"get"===e.kind?kb.Get:kb.Set,g="$"+g,Object.prototype.hasOwnProperty.call(a,g)?(a[g]===kb.Data?oa&&d===kb.Data?Ea(M.StrictDuplicateProperty):d!==kb.Data&&Ea(M.AccessorDataProperty):d===kb.Data?Ea(M.AccessorDataProperty):a[g]&d&&Ea(M.AccessorGetSet),a[g]|=d):a[g]=d,b.push(e),K("}")||nb();Z("}");return l.finishObjectExpression(b)}a=ia.type;d=new ya;if(a===V.Identifier)c=
d.finishIdentifier(ea().value);else if(a===V.StringLiteral||a===V.NumericLiteral)oa&&ia.octal&&Ga(ia,M.StrictOctalLiteral),c=d.finishLiteral(ea());else if(a===V.Keyword){if(Qa("function")){d=null;var n,l=[];g=[];var s;a=new ya;xa("function");K("(")||(c=ia,d=ma(),oa?E(c.value)&&Ga(c,M.StrictFunctionName):E(c.value)?(b=c,e=M.StrictFunctionName):B(c.value)&&(b=c,e=M.StrictReservedWord));n=La(b);l=n.params;g=n.defaults;c=n.stricted;b=n.firstRestricted;n.message&&(e=n.message);s=oa;n=dc();oa&&b&&Q(b,e);
oa&&c&&Ga(c,e);oa=s;return a.finishFunctionExpression(d,l,g,n)}Qa("this")?(ea(),c=d.finishThisExpression()):Q(ea())}else a===V.BooleanLiteral?(b=ea(),b.value="true"===b.value,c=d.finishLiteral(b)):a===V.NullLiteral?(b=ea(),b.value=null,c=d.finishLiteral(b)):K("/")||K("/=")?(c="undefined"!==typeof G.tokens?d.finishLiteral(L()):d.finishLiteral($()),eb()):Q(ea());return c}function fb(){var a=[];Z("(");if(!K(")"))for(;A<Ha;){a.push(Na());if(K(")"))break;nb()}Z(")");return a}function hb(){Z(".");var a,
b=new ya;a=ea();a.type===V.Identifier||a.type===V.Keyword||a.type===V.BooleanLiteral||a.type===V.NullLiteral||Q(a);return b.finishIdentifier(a.value)}function ib(){var a;Z("[");a=pa();Z("]");return a}function Bb(){var a,c,d=new ya;xa("new");var e;b(H.allowIn,"callee of new expression always allow in keyword.");e=ia;for(a=Qa("new")?Bb():Jb();;)if(K("["))c=ib(),a=(new sa(e)).finishMemberExpression("[",a,c);else if(K("."))c=hb(),a=(new sa(e)).finishMemberExpression(".",a,c);else break;c=K("(")?fb():
[];return d.finishNewExpression(a,c)}function Kc(){var a,b,c=ia,d,e=H.allowIn;b=ia;H.allowIn=!0;for(a=Qa("new")?Bb():Jb();;)if(K("."))d=hb(),a=(new sa(b)).finishMemberExpression(".",a,d);else if(K("("))d=fb(),a=(new sa(b)).finishCallExpression(a,d);else if(K("["))d=ib(),a=(new sa(b)).finishMemberExpression("[",a,d);else break;H.allowIn=e;ia.type!==V.Punctuator||!K("++")&&!K("--")||qa()||(oa&&a.type===ca.Identifier&&E(a.name)&&Ea(M.StrictLHSPostfix),X(a)||Ea(M.InvalidLHSInAssignment),b=ea(),a=(new sa(c)).finishPostfixExpression(b.value,
a));return a}function Ac(){var a,b,c;ia.type!==V.Punctuator&&ia.type!==V.Keyword?b=Kc():K("++")||K("--")?(c=ia,a=ea(),b=Ac(),oa&&b.type===ca.Identifier&&E(b.name)&&Ea(M.StrictLHSPrefix),X(b)||Ea(M.InvalidLHSInAssignment),b=(new sa(c)).finishUnaryExpression(a.value,b)):K("+")||K("-")||K("~")||K("!")?(c=ia,a=ea(),b=Ac(),b=(new sa(c)).finishUnaryExpression(a.value,b)):Qa("delete")||Qa("void")||Qa("typeof")?(c=ia,a=ea(),b=Ac(),b=(new sa(c)).finishUnaryExpression(a.value,b),oa&&"delete"===b.operator&&
b.argument.type===ca.Identifier&&Ea(M.StrictDelete)):b=Kc();return b}function wb(a,b){var c=0;if(a.type!==V.Punctuator&&a.type!==V.Keyword)return 0;switch(a.value){case "||":c=1;break;case "&&":c=2;break;case "|":c=3;break;case "^":c=4;break;case "&":c=5;break;case "==":case "!=":case "===":case "!==":c=6;break;case "<":case ">":case "<=":case ">=":case "instanceof":c=7;break;case "in":c=b?7:0;break;case "<<":case ">>":case ">>>":c=8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=
11}return c}function ad(){var a,b,c,d,e,g;a=ia;b=Ac();if(b===gb.ArrowParameterPlaceHolder)return b;c=ia;d=wb(c,H.allowIn);if(0===d)return b;c.prec=d;ea();a=[a,ia];g=Ac();for(e=[b,c,g];0<(d=wb(ia,H.allowIn));){for(;2<e.length&&d<=e[e.length-2].prec;)g=e.pop(),c=e.pop().value,b=e.pop(),a.pop(),b=(new sa(a[a.length-1])).finishBinaryExpression(c,b,g),e.push(b);c=ea();c.prec=d;e.push(c);a.push(ia);b=Ac();e.push(b)}d=e.length-1;b=e[d];for(a.pop();1<d;)b=(new sa(a.pop())).finishBinaryExpression(e[d-1].value,
e[d-2],b),d-=2;return b}function U(a){var b,c,d,e,g,l,n;e=[];g=[];l=0;n={paramSet:{}};b=0;for(c=a.length;b<c;b+=1)if(d=a[b],d.type===ca.Identifier)e.push(d),g.push(null),ab(n,d,d.name);else if(d.type===ca.AssignmentExpression)e.push(d.left),g.push(d.right),++l,ab(n,d.left,d.left.name);else return null;n.message===M.StrictParamDupe&&(a=oa?n.stricted:n.firstRestricted,Q(a,n.message));0===l&&(g=[]);return{params:e,defaults:g,rest:null,stricted:n.stricted,firstRestricted:n.firstRestricted,message:n.message}}
function Na(){var a,b,c,d,e;a=H.parenthesisCount;b=e=ia;var g,l,n;n=ia;c=ad();c!==gb.ArrowParameterPlaceHolder&&K("?")&&(ea(),g=H.allowIn,H.allowIn=!0,l=Na(),H.allowIn=g,Z(":"),g=Na(),c=(new sa(n)).finishConditionalExpression(c,l,g));if(c===gb.ArrowParameterPlaceHolder||K("=>"))if(H.parenthesisCount===a||H.parenthesisCount===a+1)if(c.type===ca.Identifier?d=U([c]):c.type===ca.AssignmentExpression?d=U([c]):c.type===ca.SequenceExpression?d=U(c.expressions):c===gb.ArrowParameterPlaceHolder&&(d=U([])),
d)return b=d,e=new sa(e),Z("=>"),a=oa,d=K("{")?dc():Na(),oa&&b.firstRestricted&&Q(b.firstRestricted,b.message),oa&&b.stricted&&Ga(b.stricted,b.message),oa=a,e.finishArrowFunctionExpression(b.params,b.defaults,d,d.type!==ca.BlockStatement);ia.type!==V.Punctuator?a=!1:(a=ia.value,a="="===a||"*="===a||"/="===a||"%="===a||"+="===a||"-="===a||"<<="===a||">>="===a||">>>="===a||"&="===a||"^="===a||"|="===a);a&&(X(c)||Ea(M.InvalidLHSInAssignment),oa&&c.type===ca.Identifier&&E(c.name)&&Ga(b,M.StrictLHSAssignment),
b=ea(),a=Na(),c=(new sa(e)).finishAssignmentExpression(b.value,c,a));return c}function pa(){var a,b=ia;a=Na();if(K(",")){for(a=[a];A<Ha&&K(",");)ea(),a.push(Na());a=(new sa(b)).finishSequenceExpression(a)}return a}function Cb(){var a=new ya;Z("{");for(var b=[],c;A<Ha&&!K("}");){c=da();if("undefined"===typeof c)break;b.push(c)}Z("}");return a.finishBlockStatement(b)}function ma(){var a,b=new ya;a=ea();a.type!==V.Identifier&&(oa&&a.type===V.Keyword&&B(a.value)?Ga(a,M.StrictReservedWord):Q(a));return b.finishIdentifier(a.value)}
function ra(a){var b=null,c,d=new ya;c=ma();oa&&E(c.name)&&Ea(M.StrictVarName);"const"===a?(Z("="),b=Na()):K("=")&&(ea(),b=Na());return d.finishVariableDeclarator(c,b)}function Kb(a){var b=[];do{b.push(ra(a));if(!K(","))break;ea()}while(A<Ha);return b}function Gb(){var a,b,c=new ya;xa("catch");Z("(");K(")")&&Q(ia);a=ma();oa&&E(a.name)&&Ea(M.StrictCatchVariable);Z(")");b=Cb();return c.finishCatchClause(a,b)}function jb(){var a=ia.type,b,c,d;a===V.EOF&&Q(ia);if(a===V.Punctuator&&"{"===ia.value)return Cb();
d=new ya;if(a===V.Punctuator)switch(ia.value){case ";":return d=new ya,Z(";"),d.finishEmptyStatement();case "(":return b=pa(),Xa(),d.finishExpressionStatement(b)}else if(a===V.Keyword)switch(ia.value){case "break":return b=null,xa("break"),59===R.charCodeAt(A)?(ea(),H.inIteration||H.inSwitch||Fa(M.IllegalBreak),d=d.finishBreakStatement(null)):qa()?(H.inIteration||H.inSwitch||Fa(M.IllegalBreak),d=d.finishBreakStatement(null)):(ia.type===V.Identifier&&(b=ma(),c="$"+b.name,Object.prototype.hasOwnProperty.call(H.labelSet,
c)||Fa(M.UnknownLabel,b.name)),Xa(),null!==b||H.inIteration||H.inSwitch||Fa(M.IllegalBreak),d=d.finishBreakStatement(b)),d;case "continue":return b=null,xa("continue"),59===R.charCodeAt(A)?(ea(),H.inIteration||Fa(M.IllegalContinue),d=d.finishContinueStatement(null)):qa()?(H.inIteration||Fa(M.IllegalContinue),d=d.finishContinueStatement(null)):(ia.type===V.Identifier&&(b=ma(),c="$"+b.name,Object.prototype.hasOwnProperty.call(H.labelSet,c)||Fa(M.UnknownLabel,b.name)),Xa(),null!==b||H.inIteration||Fa(M.IllegalContinue),
d=d.finishContinueStatement(b)),d;case "debugger":return xa("debugger"),Xa(),d.finishDebuggerStatement();case "do":return xa("do"),c=H.inIteration,H.inIteration=!0,b=jb(),H.inIteration=c,xa("while"),Z("("),c=pa(),Z(")"),K(";")&&ea(),d.finishDoWhileStatement(b,c);case "for":var e,g,n,s;n=H.allowIn;e=a=g=null;xa("for");Z("(");if(K(";"))ea();else{if(Qa("var")||Qa("let")){H.allowIn=!1;var q=new ya;e=ea();s=Kb();e=q.finishVariableDeclaration(s,e.value);H.allowIn=n;1===e.declarations.length&&Qa("in")&&
(ea(),b=e,c=pa(),e=null)}else H.allowIn=!1,e=pa(),H.allowIn=n,Qa("in")&&(X(e)||Ea(M.InvalidLHSInForIn),ea(),b=e,c=pa(),e=null);"undefined"===typeof b&&Z(";")}"undefined"===typeof b&&(K(";")||(a=pa()),Z(";"),K(")")||(g=pa()));Z(")");s=H.inIteration;H.inIteration=!0;n=jb();H.inIteration=s;return"undefined"===typeof b?d.finishForStatement(e,a,g,n):d.finishForInStatement(b,c,n);case "function":return Aa(d);case "if":return xa("if"),Z("("),b=pa(),Z(")"),c=jb(),Qa("else")?(ea(),a=jb()):a=null,d.finishIfStatement(b,
c,a);case "return":return b=null,xa("return"),H.inFunctionBody||Ea(M.IllegalReturn),32===R.charCodeAt(A)&&l(R.charCodeAt(A+1))?(b=pa(),Xa(),d=d.finishReturnStatement(b)):qa()?d=d.finishReturnStatement(null):(K(";")||K("}")||ia.type===V.EOF||(b=pa()),Xa(),d=d.finishReturnStatement(b)),d;case "switch":xa("switch");Z("(");b=pa();Z(")");Z("{");c=[];if(K("}"))ea();else{a=H.inSwitch;H.inSwitch=!0;for(g=!1;A<Ha&&!K("}");){n=void 0;e=[];s=void 0;q=new ya;Qa("default")?(ea(),n=null):(xa("case"),n=pa());for(Z(":");A<
Ha&&!(K("}")||Qa("default")||Qa("case"));)s=jb(),e.push(s);n=q.finishSwitchCase(n,e);null===n.test&&(g&&Fa(M.MultipleDefaultsInSwitch),g=!0);c.push(n)}H.inSwitch=a;Z("}")}d=d.finishSwitchStatement(b,c);return d;case "throw":return xa("throw"),qa()&&Fa(M.NewlineAfterThrow),b=pa(),Xa(),d.finishThrowStatement(b);case "try":return c=[],a=null,xa("try"),b=Cb(),Qa("catch")&&c.push(Gb()),Qa("finally")&&(ea(),a=Cb()),0!==c.length||a||Fa(M.NoCatchOrFinally),d.finishTryStatement(b,[],c,a);case "var":return xa("var"),
b=Kb(),Xa(),d.finishVariableDeclaration(b,"var");case "while":return xa("while"),Z("("),b=pa(),Z(")"),a=H.inIteration,H.inIteration=!0,c=jb(),H.inIteration=a,d.finishWhileStatement(b,c);case "with":return oa&&(O(),Ea(M.StrictModeWith)),xa("with"),Z("("),b=pa(),Z(")"),c=jb(),d.finishWithStatement(b,c)}b=pa();if(b.type===ca.Identifier&&K(":"))return ea(),a="$"+b.name,Object.prototype.hasOwnProperty.call(H.labelSet,a)&&Fa(M.Redeclaration,"Label",b.name),H.labelSet[a]=!0,c=jb(),delete H.labelSet[a],d.finishLabeledStatement(b,
c);Xa();return d.finishExpressionStatement(b)}function dc(){var a,b=[],c,d,e,g,l,n=new ya;for(Z("{");A<Ha&&ia.type===V.StringLiteral;){c=ia;a=da();b.push(a);if(a.expression.type!==ca.Literal)break;a=R.slice(c.start+1,c.end-1);"use strict"===a?(oa=!0,d&&Ga(d,M.StrictOctalLiteral)):!d&&c.octal&&(d=c)}c=H.labelSet;d=H.inIteration;e=H.inSwitch;g=H.inFunctionBody;l=H.parenthesizedCount;H.labelSet={};H.inIteration=!1;H.inSwitch=!1;H.inFunctionBody=!0;for(H.parenthesizedCount=0;A<Ha&&!K("}");){a=da();if("undefined"===
typeof a)break;b.push(a)}Z("}");H.labelSet=c;H.inIteration=d;H.inSwitch=e;H.inFunctionBody=g;H.parenthesizedCount=l;return n.finishBlockStatement(b)}function ab(a,b,c){var d="$"+c;oa?(E(c)&&(a.stricted=b,a.message=M.StrictParamName),Object.prototype.hasOwnProperty.call(a.paramSet,d)&&(a.stricted=b,a.message=M.StrictParamDupe)):a.firstRestricted||(E(c)?(a.firstRestricted=b,a.message=M.StrictParamName):B(c)?(a.firstRestricted=b,a.message=M.StrictReservedWord):Object.prototype.hasOwnProperty.call(a.paramSet,
d)&&(a.firstRestricted=b,a.message=M.StrictParamDupe));a.paramSet[d]=!0}function La(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};Z("(");if(!K(")"))for(a.paramSet={};A<Ha;){var b=a,c=void 0,d=void 0,e=void 0,c=ia,d=ma();ab(b,c,c.value);K("=")&&(ea(),e=Na(),++b.defaultCount);b.params.push(d);b.defaults.push(e);if(K(")"))break;Z(",")}Z(")");0===a.defaultCount&&(a.defaults=[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}
function Aa(){var a,b=[],c=[],d,e,g,l,n,s=new ya;xa("function");b=ia;a=ma();oa?E(b.value)&&Ga(b,M.StrictFunctionName):E(b.value)?(g=b,l=M.StrictFunctionName):B(b.value)&&(g=b,l=M.StrictReservedWord);d=La(g);b=d.params;c=d.defaults;e=d.stricted;g=d.firstRestricted;d.message&&(l=d.message);n=oa;d=dc();oa&&g&&Q(g,l);oa&&e&&Ga(e,l);oa=n;return s.finishFunctionDeclaration(a,b,c,d)}function da(){if(ia.type===V.Keyword)switch(ia.value){case "const":case "let":var a=ia.value,b,c=new ya;xa(a);b=Kb(a);Xa();
return c.finishVariableDeclaration(b,a);case "function":return Aa();default:return jb()}if(ia.type!==V.EOF)return jb()}function ob(){var a,b,c,d=[];for(a=0;a<G.tokens.length;++a)b=G.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),G.range&&(c.range=b.range),G.loc&&(c.loc=b.loc),d.push(c);G.tokens=d}var V,za,ba,ca,gb,kb,M,pb,R,oa,A,fa,ga,Ha,ia,H,G;V={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,
RegularExpression:9};za={};za[V.BooleanLiteral]="Boolean";za[V.EOF]="<end>";za[V.Identifier]="Identifier";za[V.Keyword]="Keyword";za[V.NullLiteral]="Null";za[V.NumericLiteral]="Numeric";za[V.Punctuator]="Punctuator";za[V.StringLiteral]="String";za[V.RegularExpression]="RegularExpression";ba="( { [ in typeof instanceof new return case delete throw void = += -= *= /= %= <<= >>= >>>= &= |= ^= , + - * / % ++ -- << >> >>> & | ^ ! ~ && || ? : === == >= <= < > != !==".split(" ");ca={AssignmentExpression:"AssignmentExpression",
ArrayExpression:"ArrayExpression",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",
ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",
SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"};gb={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};kb={Data:1,Get:2,Set:4};M={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",
UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",
UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",
StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",
StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};pb={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
sa.prototype=ya.prototype={processComment:function(){var a,b,c,d=G.bottomRightStack,e,g,l=d[d.length-1];if(!(this.type===ca.Program&&0<this.body.length)){if(0<G.trailingComments.length){c=[];for(e=G.trailingComments.length-1;0<=e;--e)g=G.trailingComments[e],g.range[0]>=this.range[1]&&(c.unshift(g),G.trailingComments.splice(e,1));G.trailingComments=[]}else l&&l.trailingComments&&l.trailingComments[0].range[0]>=this.range[1]&&(c=l.trailingComments,delete l.trailingComments);if(l)for(;l&&l.range[0]>=
this.range[0];)a=l,l=d.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<G.leadingComments.length)for(b=[],e=G.leadingComments.length-1;0<=e;--e)g=G.leadingComments[e],g.range[1]<=this.range[0]&&(b.unshift(g),G.leadingComments.splice(e,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);d.push(this)}},finish:function(){G.range&&(this.range[1]=
A);G.loc&&(this.loc.end=new Ta,G.source&&(this.loc.source=G.source));G.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=ca.ArrayExpression;this.elements=a;this.finish();return this},finishArrowFunctionExpression:function(a,b,c,d){this.type=ca.ArrowFunctionExpression;this.id=null;this.params=a;this.defaults=b;this.body=c;this.rest=null;this.generator=!1;this.expression=d;this.finish();return this},finishAssignmentExpression:function(a,b,c){this.type=ca.AssignmentExpression;
this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBinaryExpression:function(a,b,c){this.type="||"===a||"&&"===a?ca.LogicalExpression:ca.BinaryExpression;this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBlockStatement:function(a){this.type=ca.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=ca.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,b){this.type=ca.CallExpression;
this.callee=a;this.arguments=b;this.finish();return this},finishCatchClause:function(a,b){this.type=ca.CatchClause;this.param=a;this.body=b;this.finish();return this},finishConditionalExpression:function(a,b,c){this.type=ca.ConditionalExpression;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishContinueStatement:function(a){this.type=ca.ContinueStatement;this.label=a;this.finish();return this},finishDebuggerStatement:function(){this.type=ca.DebuggerStatement;this.finish();
return this},finishDoWhileStatement:function(a,b){this.type=ca.DoWhileStatement;this.body=a;this.test=b;this.finish();return this},finishEmptyStatement:function(){this.type=ca.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=ca.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,b,c,d){this.type=ca.ForStatement;this.init=a;this.test=b;this.update=c;this.body=d;this.finish();return this},finishForInStatement:function(a,
b,c){this.type=ca.ForInStatement;this.left=a;this.right=b;this.body=c;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,b,c,d){this.type=ca.FunctionDeclaration;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,b,c,d){this.type=ca.FunctionExpression;this.id=a;this.params=b;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();
return this},finishIdentifier:function(a){this.type=ca.Identifier;this.name=a;this.finish();return this},finishIfStatement:function(a,b,c){this.type=ca.IfStatement;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishLabeledStatement:function(a,b){this.type=ca.LabeledStatement;this.label=a;this.body=b;this.finish();return this},finishLiteral:function(a){this.type=ca.Literal;this.value=a.value;this.raw=R.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},
finishMemberExpression:function(a,b,c){this.type=ca.MemberExpression;this.computed="["===a;this.object=b;this.property=c;this.finish();return this},finishNewExpression:function(a,b){this.type=ca.NewExpression;this.callee=a;this.arguments=b;this.finish();return this},finishObjectExpression:function(a){this.type=ca.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,b){this.type=ca.UpdateExpression;this.operator=a;this.argument=b;this.prefix=!1;this.finish();
return this},finishProgram:function(a){this.type=ca.Program;this.body=a;this.finish();return this},finishProperty:function(a,b,c,d,e){this.type=ca.Property;this.key=b;this.value=c;this.kind=a;this.method=d;this.shorthand=e;this.finish();return this},finishReturnStatement:function(a){this.type=ca.ReturnStatement;this.argument=a;this.finish();return this},finishSequenceExpression:function(a){this.type=ca.SequenceExpression;this.expressions=a;this.finish();return this},finishSwitchCase:function(a,b){this.type=
ca.SwitchCase;this.test=a;this.consequent=b;this.finish();return this},finishSwitchStatement:function(a,b){this.type=ca.SwitchStatement;this.discriminant=a;this.cases=b;this.finish();return this},finishThisExpression:function(){this.type=ca.ThisExpression;this.finish();return this},finishThrowStatement:function(a){this.type=ca.ThrowStatement;this.argument=a;this.finish();return this},finishTryStatement:function(a,b,c,d){this.type=ca.TryStatement;this.block=a;this.guardedHandlers=b;this.handlers=c;
this.finalizer=d;this.finish();return this},finishUnaryExpression:function(a,b){this.type="++"===a||"--"===a?ca.UpdateExpression:ca.UnaryExpression;this.operator=a;this.argument=b;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,b){this.type=ca.VariableDeclaration;this.declarations=a;this.kind=b;this.finish();return this},finishVariableDeclarator:function(a,b){this.type=ca.VariableDeclarator;this.id=a;this.init=b;this.finish();return this},finishWhileStatement:function(a,
b){this.type=ca.WhileStatement;this.test=a;this.body=b;this.finish();return this},finishWithStatement:function(a,b){this.type=ca.WithStatement;this.object=a;this.body=b;this.finish();return this}};a.version="2.0.0";a.tokenize=function(a,b){var c,d;c=String;"string"===typeof a||a instanceof String||(a=c(a));R=a;A=0;fa=0<R.length?1:0;ga=0;Ha=R.length;ia=null;H={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};G={};b=b||{};b.tokens=!0;G.tokens=[];G.tokenize=!0;
G.openParenToken=-1;G.openCurlyToken=-1;G.range="boolean"===typeof b.range&&b.range;G.loc="boolean"===typeof b.loc&&b.loc;"boolean"===typeof b.comment&&b.comment&&(G.comments=[]);"boolean"===typeof b.tolerant&&b.tolerant&&(G.errors=[]);try{eb();if(ia.type===V.EOF)return G.tokens;for(ea();ia.type!==V.EOF;)try{ea()}catch(e){if(G.errors){G.errors.push(e);break}else throw e;}ob();d=G.tokens;"undefined"!==typeof G.comments&&(d.comments=G.comments);"undefined"!==typeof G.errors&&(d.errors=G.errors)}catch(g){throw g;
}finally{G={}}return d};a.parse=function(a,b){var c,d;d=String;"string"===typeof a||a instanceof String||(a=d(a));R=a;A=0;fa=0<R.length?1:0;ga=0;Ha=R.length;ia=null;H={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};G={};"undefined"!==typeof b&&(G.range="boolean"===typeof b.range&&b.range,G.loc="boolean"===typeof b.loc&&b.loc,G.attachComment="boolean"===typeof b.attachComment&&b.attachComment,G.loc&&null!==b.source&&void 0!==b.source&&(G.source=
d(b.source)),"boolean"===typeof b.tokens&&b.tokens&&(G.tokens=[]),"boolean"===typeof b.comment&&b.comment&&(G.comments=[]),"boolean"===typeof b.tolerant&&b.tolerant&&(G.errors=[]),G.attachComment&&(G.range=!0,G.comments=[],G.bottomRightStack=[],G.trailingComments=[],G.leadingComments=[]));try{var e;O();eb();e=new ya;oa=!1;var g;d=[];for(var l,n,s;A<Ha;){l=ia;if(l.type!==V.StringLiteral)break;g=da();d.push(g);if(g.expression.type!==ca.Literal)break;n=R.slice(l.start+1,l.end-1);"use strict"===n?(oa=
!0,s&&Ga(s,M.StrictOctalLiteral)):!s&&l.octal&&(s=l)}for(;A<Ha;){g=da();if("undefined"===typeof g)break;d.push(g)}c=e.finishProgram(d);"undefined"!==typeof G.comments&&(c.comments=G.comments);"undefined"!==typeof G.tokens&&(ob(),c.tokens=G.tokens);"undefined"!==typeof G.errors&&(c.errors=G.errors)}catch(q){throw q;}finally{G={}}return c};a.Syntax=function(){var a,b={};"function"===typeof Object.create&&(b=Object.create(null));for(a in ca)ca.hasOwnProperty(a)&&(b[a]=ca[a]);"function"===typeof Object.freeze&&
Object.freeze(b);return b}()});(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?b(exports):"function"===typeof define&&define.amd?define(["exports"],b):b(a.THREE={})})(this,function(a){function b(){}function c(a,b){this.x=a||0;this.y=b||0}function d(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function g(a,b,y,c){this._x=a||0;this._y=b||0;this._z=y||0;this._w=void 0!==c?c:1}function e(a,b,
y){this.x=a||0;this.y=b||0;this.z=y||0}function l(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function n(a,b,y,t,d,u,e,W,f,g){Object.defineProperty(this,"id",{value:oi++});this.uuid=Ba.generateUUID();this.name="";this.image=void 0!==a?a:n.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:n.DEFAULT_MAPPING;this.wrapS=void 0!==y?y:cb;this.wrapT=void 0!==t?t:cb;this.magFilter=void 0!==d?d:
Eb;this.minFilter=void 0!==u?u:wc;this.anisotropy=void 0!==f?f:1;this.format=void 0!==e?e:kc;this.type=void 0!==W?W:Nd;this.offset=new c(0,0);this.repeat=new c(1,1);this.center=new c(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new l;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==g?g:vg;this.version=0;this.onUpdate=null}function B(a,b,y,c){this.x=a||0;this.y=b||0;this.z=y||0;this.w=void 0!==c?c:1}function E(a,b,y){this.uuid=
Ba.generateUUID();this.width=a;this.height=b;this.scissor=new B(0,0,a,b);this.scissorTest=!1;this.viewport=new B(0,0,a,b);y=y||{};void 0===y.minFilter&&(y.minFilter=Eb);this.texture=new n(void 0,void 0,y.wrapS,y.wrapT,y.magFilter,y.minFilter,y.format,y.type,y.anisotropy,y.encoding);this.depthBuffer=void 0!==y.depthBuffer?y.depthBuffer:!0;this.stencilBuffer=void 0!==y.stencilBuffer?y.stencilBuffer:!0;this.depthTexture=void 0!==y.depthTexture?y.depthTexture:null}function s(a,b,y){E.call(this,a,b,y);
this.activeMipMapLevel=this.activeCubeFace=0}function D(a,b,y,c,d,u,e,W,f,g,h,k){n.call(this,null,u,e,W,f,g,c,d,h,k);this.image={data:a,width:b,height:y};this.magFilter=void 0!==f?f:wa;this.minFilter=void 0!==g?g:wa;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function q(a,b,y,c,d,u,e,W,f,g){a=void 0!==a?a:[];b=void 0!==b?b:pf;n.call(this,a,b,y,c,d,u,e,W,f,g);this.flipY=!1}function O(a,b,y){var c=a[0];if(0>=c||0<c)return a;var d=b*y,u=$h[d];void 0===u&&(u=new Float32Array(d),$h[d]=u);
if(0!==b)for(c.toArray(u,0),c=1,d=0;c!==b;++c)d+=y,a[c].toArray(u,d);return u}function r(a,b){var y=ai[b];void 0===y&&(y=new Int32Array(b),ai[b]=y);for(var c=0;c!==b;++c)y[c]=a.allocTextureUnit();return y}function I(a,b){a.uniform1f(this.addr,b)}function F(a,b){a.uniform1i(this.addr,b)}function T(a,b){void 0===b.x?a.uniform2fv(this.addr,b):a.uniform2f(this.addr,b.x,b.y)}function N(a,b){void 0!==b.x?a.uniform3f(this.addr,b.x,b.y,b.z):void 0!==b.r?a.uniform3f(this.addr,b.r,b.g,b.b):a.uniform3fv(this.addr,
b)}function $(a,b){void 0===b.x?a.uniform4fv(this.addr,b):a.uniform4f(this.addr,b.x,b.y,b.z,b.w)}function L(a,b){a.uniformMatrix2fv(this.addr,!1,b.elements||b)}function ka(a,b){void 0===b.elements?a.uniformMatrix3fv(this.addr,!1,b):(bi.set(b.elements),a.uniformMatrix3fv(this.addr,!1,bi))}function na(a,b){void 0===b.elements?a.uniformMatrix4fv(this.addr,!1,b):(ci.set(b.elements),a.uniformMatrix4fv(this.addr,!1,ci))}function Ja(a,b,y){var c=y.allocTextureUnit();a.uniform1i(this.addr,c);y.setTexture2D(b||
di,c)}function ea(a,b,y){var c=y.allocTextureUnit();a.uniform1i(this.addr,c);y.setTextureCube(b||ei,c)}function eb(a,b){a.uniform2iv(this.addr,b)}function Ta(a,b){a.uniform3iv(this.addr,b)}function P(a,b){a.uniform4iv(this.addr,b)}function Pa(a){switch(a){case 5126:return I;case 35664:return T;case 35665:return N;case 35666:return $;case 35674:return L;case 35675:return ka;case 35676:return na;case 35678:case 36198:return Ja;case 35680:return ea;case 5124:case 35670:return F;case 35667:case 35671:return eb;
case 35668:case 35672:return Ta;case 35669:case 35673:return P}}function ya(a,b){a.uniform1fv(this.addr,b)}function sa(a,b){a.uniform1iv(this.addr,b)}function qa(a,b){a.uniform2fv(this.addr,O(b,this.size,2))}function Ia(a,b){a.uniform3fv(this.addr,O(b,this.size,3))}function Fa(a,b){a.uniform4fv(this.addr,O(b,this.size,4))}function Ea(a,b){a.uniformMatrix2fv(this.addr,!1,O(b,this.size,4))}function J(a,b){a.uniformMatrix3fv(this.addr,!1,O(b,this.size,9))}function Q(a,b){a.uniformMatrix4fv(this.addr,
!1,O(b,this.size,16))}function Ga(a,b,y){var c=b.length,d=r(y,c);a.uniform1iv(this.addr,d);for(a=0;a!==c;++a)y.setTexture2D(b[a]||di,d[a])}function Z(a,b,y){var c=b.length,d=r(y,c);a.uniform1iv(this.addr,d);for(a=0;a!==c;++a)y.setTextureCube(b[a]||ei,d[a])}function nb(a){switch(a){case 5126:return ya;case 35664:return qa;case 35665:return Ia;case 35666:return Fa;case 35674:return Ea;case 35675:return J;case 35676:return Q;case 35678:return Ga;case 35680:return Z;case 5124:case 35670:return sa;case 35667:case 35671:return eb;
case 35668:case 35672:return Ta;case 35669:case 35673:return P}}function xa(a,b,y){this.id=a;this.addr=y;this.setValue=Pa(b.type)}function K(a,b,y){this.id=a;this.addr=y;this.size=b.size;this.setValue=nb(b.type)}function Qa(a){this.id=a;this.seq=[];this.map={}}function Xa(a,b,y){this.seq=[];this.map={};this.renderer=y;y=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(var c=0;c<y;++c){var d=a.getActiveUniform(b,c),u=a.getUniformLocation(b,d.name),e=this,W=d.name,f=W.length;for(Bh.lastIndex=0;;){var g=
Bh.exec(W),h=Bh.lastIndex,k=g[1],l=g[3];"]"===g[2]&&(k|=0);if(void 0===l||"["===l&&h+2===f){W=e;d=void 0===l?new xa(k,d,u):new K(k,d,u);W.seq.push(d);W.map[d.id]=d;break}else l=e.map[k],void 0===l&&(l=new Qa(k),k=e,e=l,k.seq.push(e),k.map[e.id]=e),e=l}}}function X(a,b,y){return void 0===b&&void 0===y?this.set(a):this.setRGB(a,b,y)}function Wb(a,b,y,c,d,u,e,W,f){n.call(this,a,b,y,c,d,u,e,W,f);this.needsUpdate=!0}function Jc(a,b,y,c,d){var u,ua,W,f,h,k,Ca,l,m,n,p,s,q,w,B,Ub,r,z;function x(a,v){return a.renderOrder!==
v.renderOrder?a.renderOrder-v.renderOrder:a.z!==v.z?v.z-a.z:v.id-a.id}var A,E,D,F,P=new e,Z=new g,I=new e;this.render=function(e,g,K){if(0!==e.length){if(void 0===D){var H=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),G=new Uint16Array([0,1,2,0,2,3]);A=b.createBuffer();E=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,A);b.bufferData(b.ARRAY_BUFFER,H,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,E);b.bufferData(b.ELEMENT_ARRAY_BUFFER,G,b.STATIC_DRAW);var H=b.createProgram(),
G=b.createShader(b.VERTEX_SHADER),J=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(G,["precision "+d.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 center;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvUV = uvOffset + uv * uvScale;\n\tvec2 alignedPosition = ( position - center ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\tfogDepth = - mvPosition.z;\n}"].join("\n"));
b.shaderSource(J,["precision "+d.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvec4 texture = texture2D( map, vUV );\n\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n\tif ( gl_FragColor.a < alphaTest ) discard;\n\tif ( fogType > 0 ) {\n\t\tfloat fogFactor = 0.0;\n\t\tif ( fogType == 1 ) {\n\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t\t} else {\n\t\t\tconst float LOG2 = 1.442695;\n\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );\n\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\t\t}\n\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\t}\n}"].join("\n"));
b.compileShader(G);b.compileShader(J);b.attachShader(H,G);b.attachShader(H,J);b.linkProgram(H);D=H;r=b.getAttribLocation(D,"position");z=b.getAttribLocation(D,"uv");u=b.getUniformLocation(D,"uvOffset");ua=b.getUniformLocation(D,"uvScale");W=b.getUniformLocation(D,"rotation");f=b.getUniformLocation(D,"center");h=b.getUniformLocation(D,"scale");k=b.getUniformLocation(D,"color");Ca=b.getUniformLocation(D,"map");l=b.getUniformLocation(D,"opacity");m=b.getUniformLocation(D,"modelViewMatrix");n=b.getUniformLocation(D,
"projectionMatrix");p=b.getUniformLocation(D,"fogType");s=b.getUniformLocation(D,"fogDensity");q=b.getUniformLocation(D,"fogNear");w=b.getUniformLocation(D,"fogFar");B=b.getUniformLocation(D,"fogColor");b.getUniformLocation(D,"fogDepth");Ub=b.getUniformLocation(D,"alphaTest");H=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");H.width=8;H.height=8;G=H.getContext("2d");G.fillStyle="white";G.fillRect(0,0,8,8);F=new Wb(H)}y.useProgram(D);y.initAttributes();y.enableAttribute(r);y.enableAttribute(z);
y.disableUnusedAttributes();y.disable(b.CULL_FACE);y.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,A);b.vertexAttribPointer(r,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(z,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,E);b.uniformMatrix4fv(n,!1,K.projectionMatrix.elements);y.activeTexture(b.TEXTURE0);b.uniform1i(Ca,0);G=H=0;(J=g.fog)?(b.uniform3f(B,J.color.r,J.color.g,J.color.b),J.isFog?(b.uniform1f(q,J.near),b.uniform1f(w,J.far),b.uniform1i(p,1),G=H=1):J.isFogExp2&&(b.uniform1f(s,J.density),
b.uniform1i(p,2),G=H=2)):(b.uniform1i(p,0),G=H=0);for(var J=0,N=e.length;J<N;J++){var L=e[J];L.modelViewMatrix.multiplyMatrices(K.matrixWorldInverse,L.matrixWorld);L.z=-L.modelViewMatrix.elements[14]}e.sort(x);for(var R=[],$=[],J=0,N=e.length;J<N;J++){var L=e[J],db=L.material;if(!1!==db.visible){L.onBeforeRender(a,g,K,void 0,db,void 0);b.uniform1f(Ub,db.alphaTest);b.uniformMatrix4fv(m,!1,L.modelViewMatrix.elements);L.matrixWorld.decompose(P,Z,I);R[0]=I.x;R[1]=I.y;$[0]=L.center.x-0.5;$[1]=L.center.y-
0.5;var O=0;g.fog&&db.fog&&(O=G);H!==O&&(b.uniform1i(p,O),H=O);null!==db.map?(b.uniform2f(u,db.map.offset.x,db.map.offset.y),b.uniform2f(ua,db.map.repeat.x,db.map.repeat.y)):(b.uniform2f(u,0,0),b.uniform2f(ua,1,1));b.uniform1f(l,db.opacity);b.uniform3f(k,db.color.r,db.color.g,db.color.b);b.uniform1f(W,db.rotation);b.uniform2fv(f,$);b.uniform2fv(h,R);y.setBlending(db.blending,db.blendEquation,db.blendSrc,db.blendDst,db.blendEquationAlpha,db.blendSrcAlpha,db.blendDstAlpha,db.premultipliedAlpha);y.buffers.depth.setTest(db.depthTest);
y.buffers.depth.setMask(db.depthWrite);y.buffers.color.setMask(db.colorWrite);c.setTexture2D(db.map||F,0);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);L.onAfterRender(a,g,K,void 0,db,void 0)}}y.enable(b.CULL_FACE);y.reset()}}}function aa(){Object.defineProperty(this,"id",{value:pi++});this.uuid=Ba.generateUUID();this.name="";this.type="Material";this.lights=this.fog=!0;this.blending=Hc;this.side=Zf;this.flatShading=!1;this.vertexColors=td;this.opacity=1;this.transparent=!1;this.blendSrc=sg;this.blendDst=
bg;this.blendEquation=Ud;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=Ze;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.overdraw=0;this.visible=!0;this.userData={};this.needsUpdate=!0}function Fb(a){aa.call(this);
this.type="MeshDepthMaterial";this.depthPacking=fi;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a)}function Jb(a){aa.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new e;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=
1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function fb(a,b){this.min=void 0!==a?a:new e(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new e(-Infinity,-Infinity,-Infinity)}function hb(a,b){this.center=void 0!==a?a:new e;this.radius=void 0!==b?b:0}function ib(a,b){this.normal=void 0!==a?a:new e(1,0,0);this.constant=void 0!==b?b:0}function Bb(a,b,y,c,d,u){this.planes=[void 0!==a?a:new ib,void 0!==b?b:new ib,void 0!==y?y:new ib,void 0!==c?c:new ib,void 0!==d?d:new ib,void 0!==
u?u:new ib]}function Kc(a,b,y){function t(b,C,y,c,t,d){var S=b.geometry,u=null,u=m,e=b.customDepthMaterial;y&&(u=n,e=b.customDistanceMaterial);e?u=e:(e=!1,C.morphTargets&&(S&&S.isBufferGeometry?e=S.morphAttributes&&S.morphAttributes.position&&0<S.morphAttributes.position.length:S&&S.isGeometry&&(e=S.morphTargets&&0<S.morphTargets.length)),b.isSkinnedMesh&&!1===C.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",b),b=b.isSkinnedMesh&&C.skinning,S=
0,e&&(S|=k),b&&(S|=l),u=u[S]);a.localClippingEnabled&&!0===C.clipShadows&&0!==C.clippingPlanes.length&&(e=u.uuid,b=C.uuid,S=p[e],void 0===S&&(S={},p[e]=S),e=S[b],void 0===e&&(e=u.clone(),S[b]=e),u=e);u.visible=C.visible;u.wireframe=C.wireframe;u.side=null!=C.shadowSide?C.shadowSide:s[C.side];u.clipShadows=C.clipShadows;u.clippingPlanes=C.clippingPlanes;u.clipIntersection=C.clipIntersection;u.wireframeLinewidth=C.wireframeLinewidth;u.linewidth=C.linewidth;y&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(c),
u.nearDistance=t,u.farDistance=d);return u}function S(y,c,d,e){if(!1!==y.visible){if(y.layers.test(c.layers)&&(y.isMesh||y.isLine||y.isPoints)&&y.castShadow&&(!y.frustumCulled||u.intersectsObject(y))){y.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,y.matrixWorld);var ua=b.update(y),W=y.material;if(Array.isArray(W))for(var f=ua.groups,va=0,g=f.length;va<g;va++){var Xg=f[va],k=W[Xg.materialIndex];k&&k.visible&&(k=t(y,k,e,h,d.near,d.far),a.renderBufferDirect(d,null,ua,k,y,Xg))}else W.visible&&
(k=t(y,W,e,h,d.near,d.far),a.renderBufferDirect(d,null,ua,k,y,null))}y=y.children;ua=0;for(W=y.length;ua<W;ua++)S(y[ua],c,d,e)}}var u=new Bb,ua=new d,W=new c,f=new c(y,y),g=new e,h=new e,k=1,l=2;y=(k|l)+1;for(var m=Array(y),n=Array(y),p={},s={0:Gc,1:Zf,2:ed},q=[new e(1,0,0),new e(-1,0,0),new e(0,0,1),new e(0,0,-1),new e(0,1,0),new e(0,-1,0)],w=[new e(0,1,0),new e(0,1,0),new e(0,1,0),new e(0,1,0),new e(0,0,1),new e(0,0,-1)],r=[new B,new B,new B,new B,new B,new B],Ub=0;Ub!==y;++Ub){var z=0!==(Ub&k),
A=0!==(Ub&l),x=new Fb({depthPacking:gi,morphTargets:z,skinning:A});m[Ub]=x;z=new Jb({morphTargets:z,skinning:A});n[Ub]=z}var D=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=og;this.render=function(b,C,y){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==b.length){var c=a.state;c.disable(a.context.BLEND);c.buffers.color.setClear(1,1,1,1);c.buffers.depth.setTest(!0);c.setScissorTest(!1);for(var t,d=0,e=b.length;d<e;d++){var k=b[d];t=k.shadow;var Ca=k&&k.isPointLight;
if(void 0===t)console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");else{var l=t.camera;W.copy(t.mapSize);W.min(f);if(Ca){var m=W.x,mc=W.y;r[0].set(2*m,mc,m,mc);r[1].set(0,mc,m,mc);r[2].set(3*m,mc,m,mc);r[3].set(m,mc,m,mc);r[4].set(3*m,0,m,mc);r[5].set(m,0,m,mc);W.x*=4;W.y*=2}null===t.map&&(t.map=new E(W.x,W.y,{minFilter:wa,magFilter:wa,format:kc}),t.map.texture.name=k.name+".shadowMap",l.updateProjectionMatrix());t.isSpotLightShadow&&t.update(k);m=t.map;mc=t.matrix;h.setFromMatrixPosition(k.matrixWorld);
l.position.copy(h);Ca?(t=6,mc.makeTranslation(-h.x,-h.y,-h.z)):(t=1,g.setFromMatrixPosition(k.target.matrixWorld),l.lookAt(g),l.updateMatrixWorld(),mc.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),mc.multiply(l.projectionMatrix),mc.multiply(l.matrixWorldInverse));a.setRenderTarget(m);a.clear();for(k=0;k<t;k++)Ca&&(g.copy(l.position),g.add(q[k]),l.up.copy(w[k]),l.lookAt(g),l.updateMatrixWorld(),c.viewport(r[k])),ua.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),u.setFromMatrix(ua),S(C,
y,l,Ca)}}D.needsUpdate=!1}}}function Ac(a){var b={};return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return b[a.uuid]},remove:function(y){y.isInterleavedBufferAttribute&&(y=y.data);var c=b[y.uuid];c&&(a.deleteBuffer(c.buffer),delete b[y.uuid])},update:function(y,c){y.isInterleavedBufferAttribute&&(y=y.data);var d=b[y.uuid];if(void 0===d){var d=y.uuid,u=y,e=u.array,W=u.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW,f=a.createBuffer();a.bindBuffer(c,f);a.bufferData(c,e,W);u.onUploadCallback();
W=a.FLOAT;e instanceof Float32Array?W=a.FLOAT:e instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):e instanceof Uint16Array?W=a.UNSIGNED_SHORT:e instanceof Int16Array?W=a.SHORT:e instanceof Uint32Array?W=a.UNSIGNED_INT:e instanceof Int32Array?W=a.INT:e instanceof Int8Array?W=a.BYTE:e instanceof Uint8Array&&(W=a.UNSIGNED_BYTE);b[d]={buffer:f,type:W,bytesPerElement:e.BYTES_PER_ELEMENT,version:u.version}}else d.version<y.version&&(u=y,e=u.array,
f=u.updateRange,a.bindBuffer(c,d.buffer),!1===u.dynamic?a.bufferData(c,e,a.STATIC_DRAW):-1===f.count?a.bufferSubData(c,0,e):0===f.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(a.bufferSubData(c,f.offset*e.BYTES_PER_ELEMENT,e.subarray(f.offset,f.offset+f.count)),f.count=-1),d.version=y.version)}}}function wb(a,b,y,c){this._x=a||0;this._y=b||0;this._z=y||
0;this._order=c||wb.DefaultOrder}function ad(){this.mask=1}function U(){Object.defineProperty(this,"id",{value:qi++});this.uuid=Ba.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=U.DefaultUp.clone();var a=new e,b=new wb,y=new g,c=new e(1,1,1);b.onChange(function(){y.setFromEuler(b,!1)});y.onChange(function(){b.setFromQuaternion(y,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,
value:y},scale:{enumerable:!0,value:c},modelViewMatrix:{value:new d},normalMatrix:{value:new l}});this.matrix=new d;this.matrixWorld=new d;this.matrixAutoUpdate=U.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new ad;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}}function Na(){U.call(this);this.type="Camera";this.matrixWorldInverse=new d;this.projectionMatrix=new d}function pa(a,b,y,c,d,u){Na.call(this);this.type=
"OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=y;this.bottom=c;this.near=void 0!==d?d:0.1;this.far=void 0!==u?u:2E3;this.updateProjectionMatrix()}function Cb(a,b,y,c,d,u){this.a=a;this.b=b;this.c=y;this.normal=c&&c.isVector3?c:new e;this.vertexNormals=Array.isArray(c)?c:[];this.color=d&&d.isColor?d:new X;this.vertexColors=Array.isArray(d)?d:[];this.materialIndex=void 0!==u?u:0}function ma(){Object.defineProperty(this,"id",{value:hi+=2});this.uuid=Ba.generateUUID();
this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function ra(a,b,y){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
this.uuid=Ba.generateUUID();this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===y;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.onUploadCallback=function(){};this.version=0}function Kb(a,b,y){ra.call(this,new Int8Array(a),b,y)}function Gb(a,b,y){ra.call(this,new Uint8Array(a),b,y)}function jb(a,b,y){ra.call(this,new Uint8ClampedArray(a),b,y)}function dc(a,b,y){ra.call(this,new Int16Array(a),b,y)}function ab(a,b,y){ra.call(this,new Uint16Array(a),
b,y)}function La(a,b,y){ra.call(this,new Int32Array(a),b,y)}function Aa(a,b,y){ra.call(this,new Uint32Array(a),b,y)}function da(a,b,y){ra.call(this,new Float32Array(a),b,y)}function ob(a,b,y){ra.call(this,new Float64Array(a),b,y)}function V(){this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=
this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function za(a){if(0===a.length)return-Infinity;for(var b=a[0],y=1,c=a.length;y<c;++y)a[y]>b&&(b=a[y]);return b}function ba(){Object.defineProperty(this,"id",{value:ii+=2});this.uuid=Ba.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}}function ca(a,b,y,c,d,u){ma.call(this);this.type="BoxGeometry";
this.parameters={width:a,height:b,depth:y,widthSegments:c,heightSegments:d,depthSegments:u};this.fromBufferGeometry(new gb(a,b,y,c,d,u));this.mergeVertices()}function gb(a,b,y,c,d,u){function ua(a,v,b,C,c,y,t,d,S,u,ua){var n=y/S,p=t/u,s=y/2,q=t/2,w=d/2;t=S+1;var B=u+1,r=y=0,z,A,x=new e;for(A=0;A<B;A++){var D=A*p-q;for(z=0;z<t;z++)x[a]=(z*n-s)*C,x[v]=D*c,x[b]=w,g.push(x.x,x.y,x.z),x[a]=0,x[v]=0,x[b]=0<d?1:-1,h.push(x.x,x.y,x.z),k.push(z/S),k.push(1-A/u),y+=1}for(A=0;A<u;A++)for(z=0;z<S;z++)a=l+z+t*
(A+1),v=l+(z+1)+t*(A+1),b=l+(z+1)+t*A,f.push(l+z+t*A,a,b),f.push(a,v,b),r+=6;W.addGroup(m,r,ua);m+=r;l+=y}ba.call(this);this.type="BoxBufferGeometry";this.parameters={width:a,height:b,depth:y,widthSegments:c,heightSegments:d,depthSegments:u};var W=this;a=a||1;b=b||1;y=y||1;c=Math.floor(c)||1;d=Math.floor(d)||1;u=Math.floor(u)||1;var f=[],g=[],h=[],k=[],l=0,m=0;ua("z","y","x",-1,-1,y,b,a,u,d,0);ua("z","y","x",1,-1,y,b,-a,u,d,1);ua("x","z","y",1,1,a,y,b,c,u,2);ua("x","z","y",1,-1,a,y,-b,c,u,3);ua("x",
"y","z",1,-1,a,b,y,c,d,4);ua("x","y","z",-1,-1,a,b,-y,c,d,5);this.setIndex(f);this.addAttribute("position",new da(g,3));this.addAttribute("normal",new da(h,3));this.addAttribute("uv",new da(k,2))}function kb(a,b,c,t){ma.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:t};this.fromBufferGeometry(new M(a,b,c,t));this.mergeVertices()}function M(a,b,c,t){ba.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,
heightSegments:t};a=a||1;b=b||1;var d=a/2,u=b/2;c=Math.floor(c)||1;t=Math.floor(t)||1;var e=c+1,W=t+1,f=a/c,g=b/t,h=[],k=[],l=[],m=[];for(a=0;a<W;a++){var n=a*g-u;for(b=0;b<e;b++)k.push(b*f-d,-n,0),l.push(0,0,1),m.push(b/c),m.push(1-a/t)}for(a=0;a<t;a++)for(b=0;b<c;b++)d=b+e*(a+1),u=b+1+e*(a+1),W=b+1+e*a,h.push(b+e*a,d,W),h.push(d,u,W);this.setIndex(h);this.addAttribute("position",new da(k,3));this.addAttribute("normal",new da(l,3));this.addAttribute("uv",new da(m,2))}function pb(a){aa.call(this);
this.type="MeshBasicMaterial";this.color=new X(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=Lc;this.reflectivity=1;this.refractionRatio=0.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function R(a){aa.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms=
{};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=
void 0;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}function oa(a,b){this.origin=void 0!==a?a:new e;this.direction=void 0!==b?b:new e}function A(a,b){this.start=void 0!==a?a:new e;this.end=void 0!==b?b:new e}function fa(a,b,c){this.a=void 0!==a?a:new e;this.b=void 0!==b?b:new e;this.c=void 0!==c?c:new e}function ga(a,b){U.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new ba;
this.material=void 0!==b?b:new pb({color:16777215*Math.random()});this.drawMode=vh;this.updateMorphTargets()}function Ha(a,b,c,t){function d(a,v){b.buffers.color.setClear(a.r,a.g,a.b,v,t)}var u=new X(0),e=0,W,f,g;return{getClearColor:function(){return u},setClearColor:function(a,v){u.set(a);e=void 0!==v?v:1;d(u,e)},getClearAlpha:function(){return e},setClearAlpha:function(a){e=a;d(u,e)},render:function(b,C,t,h){C=C.background;null===C?d(u,e):C&&C.isColor&&(d(C,1),h=!0);(a.autoClear||h)&&a.clear(a.autoClearColor,
a.autoClearDepth,a.autoClearStencil);C&&C.isCubeTexture?(void 0===g&&(g=new ga(new gb(1,1,1),new R({uniforms:Mf.cube.uniforms,vertexShader:Mf.cube.vertexShader,fragmentShader:Mf.cube.fragmentShader,side:Gc,depthTest:!0,depthWrite:!1,fog:!1})),g.geometry.removeAttribute("normal"),g.geometry.removeAttribute("uv"),g.onBeforeRender=function(a,v,b){this.matrixWorld.copyPosition(b.matrixWorld)},c.update(g.geometry)),g.material.uniforms.tCube.value=C,b.push(g,g.geometry,g.material,0,null)):C&&C.isTexture&&
(void 0===W&&(W=new pa(-1,1,1,-1,0,1),f=new ga(new M(2,2),new pb({depthTest:!1,depthWrite:!1,fog:!1})),c.update(f.geometry)),f.material.map=C,a.renderBufferDirect(W,null,f.geometry,f.material,f,null))}}}function ia(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function H(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-
b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function G(){var a=[],b=0,c=[],t=[];return{opaque:c,transparent:t,init:function(){b=0;c.length=0;t.length=0},push:function(d,u,e,W,f){var g=a[b];void 0===g?(g={id:d.id,object:d,geometry:u,material:e,program:e.program,renderOrder:d.renderOrder,z:W,group:f},a[b]=g):(g.id=d.id,g.object=d,g.geometry=u,g.material=e,g.program=e.program,g.renderOrder=d.renderOrder,g.z=W,g.group=f);(!0===e.transparent?t:c).push(g);b++},sort:function(){1<c.length&&c.sort(ia);1<t.length&&
t.sort(H)}}}function f(){var a={};return{get:function(b,c){var t=b.id+","+c.id,d=a[t];void 0===d&&(d=new G,a[t]=d);return d},dispose:function(){a={}}}}function k(a,b){return Math.abs(b[1])-Math.abs(a[1])}function z(a){var b={},c=new Float32Array(8);return{update:function(t,d,u,e){var W=t.morphTargetInfluences,f=W.length;t=b[d.id];if(void 0===t){t=[];for(var g=0;g<f;g++)t[g]=[g,0];b[d.id]=t}var h=u.morphTargets&&d.morphAttributes.position;u=u.morphNormals&&d.morphAttributes.normal;for(g=0;g<f;g++){var l=
t[g];0!==l[1]&&(h&&d.removeAttribute("morphTarget"+g),u&&d.removeAttribute("morphNormal"+g))}for(g=0;g<f;g++)l=t[g],l[0]=g,l[1]=W[g];t.sort(k);for(g=0;8>g;g++){if(l=t[g])if(W=l[0],f=l[1]){h&&d.addAttribute("morphTarget"+g,h[W]);u&&d.addAttribute("morphNormal"+g,u[W]);c[g]=f;continue}c[g]=0}e.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function x(a,b,c){var t,d,u;this.setMode=function(a){t=a};this.setIndex=function(a){d=a.type;u=a.bytesPerElement};this.render=function(b,C){a.drawElements(t,
C,d,b*u);c.calls++;c.vertices+=C;t===a.TRIANGLES?c.faces+=C/3:t===a.POINTS&&(c.points+=C)};this.renderInstances=function(e,W,f){var g=b.get("ANGLE_instanced_arrays");null===g?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(g.drawElementsInstancedANGLE(t,f,d,W*u,e.maxInstancedCount),c.calls++,c.vertices+=f*e.maxInstancedCount,t===a.TRIANGLES?c.faces+=e.maxInstancedCount*f/3:t===a.POINTS&&(c.points+=
e.maxInstancedCount*f))}}function fc(a,b,c){var t;this.setMode=function(a){t=a};this.render=function(b,C){a.drawArrays(t,b,C);c.calls++;c.vertices+=C;t===a.TRIANGLES?c.faces+=C/3:t===a.POINTS&&(c.points+=C)};this.renderInstances=function(d,u,e){var W=b.get("ANGLE_instanced_arrays");if(null===W)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var f=d.attributes.position;f.isInterleavedBufferAttribute?
(e=f.data.count,W.drawArraysInstancedANGLE(t,0,e,d.maxInstancedCount)):W.drawArraysInstancedANGLE(t,u,e,d.maxInstancedCount);c.calls++;c.vertices+=e*d.maxInstancedCount;t===a.TRIANGLES?c.faces+=d.maxInstancedCount*e/3:t===a.POINTS&&(c.points+=d.maxInstancedCount*e)}}}function qb(a,b,c){function t(a){a=a.target;var v=d[a.id];null!==v.index&&b.remove(v.index);for(var e in v.attributes)b.remove(v.attributes[e]);a.removeEventListener("dispose",t);delete d[a.id];if(e=u[a.id])b.remove(e),delete u[a.id];
if(e=u[v.id])b.remove(e),delete u[v.id];c.geometries--}var d={},u={};return{get:function(a,v){var b=d[v.id];if(b)return b;v.addEventListener("dispose",t);v.isBufferGeometry?b=v:v.isGeometry&&(void 0===v._bufferGeometry&&(v._bufferGeometry=(new ba).setFromObject(a)),b=v._bufferGeometry);d[v.id]=b;c.geometries++;return b},update:function(c){var y=c.index,t=c.attributes;null!==y&&b.update(y,a.ELEMENT_ARRAY_BUFFER);for(var d in t)b.update(t[d],a.ARRAY_BUFFER);c=c.morphAttributes;for(d in c)for(var y=
c[d],t=0,S=y.length;t<S;t++)b.update(y[t],a.ARRAY_BUFFER)},getWireframeAttribute:function(c){var y=u[c.id];if(y)return y;var y=[],t=c.index,d=c.attributes;if(null!==t)for(var t=t.array,d=0,S=t.length;d<S;d+=3){var e=t[d+0],f=t[d+1],g=t[d+2];y.push(e,f,f,g,g,e)}else for(t=d.position.array,d=0,S=t.length/3-1;d<S;d+=3)e=d+0,f=d+1,g=d+2,y.push(e,f,f,g,g,e);y=new (65535<za(y)?Aa:ab)(y,1);b.update(y,a.ELEMENT_ARRAY_BUFFER);return u[c.id]=y}}}function wh(){var a={};return{get:function(b){if(void 0!==a[b.id])return a[b.id];
var y;switch(b.type){case "DirectionalLight":y={direction:new e,color:new X,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c};break;case "SpotLight":y={position:new e,direction:new e,color:new X,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c};break;case "PointLight":y={position:new e,color:new X,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c,shadowCameraNear:1,shadowCameraFar:1E3};break;case "HemisphereLight":y=
{direction:new e,skyColor:new X,groundColor:new X};break;case "RectAreaLight":y={color:new X,position:new e,halfWidth:new e,halfHeight:new e}}return a[b.id]=y}}}function ah(){var a=new wh,b={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=new e,t=new d,S=new d;return{setup:function(d,e,f){var g=0,h=0,k=0,l=0,m=0,n=0,p=0,s=0;f=f.matrixWorldInverse;
for(var q=0,w=d.length;q<w;q++){var r=d[q],B=r.color,Ub=r.intensity,z=r.distance,A=r.shadow&&r.shadow.map?r.shadow.map.texture:null;if(r.isAmbientLight)g+=B.r*Ub,h+=B.g*Ub,k+=B.b*Ub;else if(r.isDirectionalLight){var x=a.get(r);x.color.copy(r.color).multiplyScalar(r.intensity);x.direction.setFromMatrixPosition(r.matrixWorld);c.setFromMatrixPosition(r.target.matrixWorld);x.direction.sub(c);x.direction.transformDirection(f);if(x.shadow=r.castShadow)B=r.shadow,x.shadowBias=B.bias,x.shadowRadius=B.radius,
x.shadowMapSize=B.mapSize;b.directionalShadowMap[l]=A;b.directionalShadowMatrix[l]=r.shadow.matrix;b.directional[l]=x;l++}else if(r.isSpotLight){x=a.get(r);x.position.setFromMatrixPosition(r.matrixWorld);x.position.applyMatrix4(f);x.color.copy(B).multiplyScalar(Ub);x.distance=z;x.direction.setFromMatrixPosition(r.matrixWorld);c.setFromMatrixPosition(r.target.matrixWorld);x.direction.sub(c);x.direction.transformDirection(f);x.coneCos=Math.cos(r.angle);x.penumbraCos=Math.cos(r.angle*(1-r.penumbra));
x.decay=0===r.distance?0:r.decay;if(x.shadow=r.castShadow)B=r.shadow,x.shadowBias=B.bias,x.shadowRadius=B.radius,x.shadowMapSize=B.mapSize;b.spotShadowMap[n]=A;b.spotShadowMatrix[n]=r.shadow.matrix;b.spot[n]=x;n++}else if(r.isRectAreaLight)x=a.get(r),x.color.copy(B).multiplyScalar(Ub),x.position.setFromMatrixPosition(r.matrixWorld),x.position.applyMatrix4(f),S.identity(),t.copy(r.matrixWorld),t.premultiply(f),S.extractRotation(t),x.halfWidth.set(0.5*r.width,0,0),x.halfHeight.set(0,0.5*r.height,0),
x.halfWidth.applyMatrix4(S),x.halfHeight.applyMatrix4(S),b.rectArea[p]=x,p++;else if(r.isPointLight){x=a.get(r);x.position.setFromMatrixPosition(r.matrixWorld);x.position.applyMatrix4(f);x.color.copy(r.color).multiplyScalar(r.intensity);x.distance=r.distance;x.decay=0===r.distance?0:r.decay;if(x.shadow=r.castShadow)B=r.shadow,x.shadowBias=B.bias,x.shadowRadius=B.radius,x.shadowMapSize=B.mapSize,x.shadowCameraNear=B.camera.near,x.shadowCameraFar=B.camera.far;b.pointShadowMap[m]=A;b.pointShadowMatrix[m]=
r.shadow.matrix;b.point[m]=x;m++}else r.isHemisphereLight&&(x=a.get(r),x.direction.setFromMatrixPosition(r.matrixWorld),x.direction.transformDirection(f),x.direction.normalize(),x.skyColor.copy(r.color).multiplyScalar(Ub),x.groundColor.copy(r.groundColor).multiplyScalar(Ub),b.hemi[s]=x,s++)}b.ambient[0]=g;b.ambient[1]=h;b.ambient[2]=k;b.directional.length=l;b.spot.length=n;b.rectArea.length=p;b.point.length=m;b.hemi.length=s;b.hash=l+","+m+","+n+","+p+","+s+","+e.length},state:b}}function ch(a,b){var c=
{};return{update:function(t){var d=b.frame,u=t.geometry,e=a.get(t,u);c[e.id]!==d&&(u.isGeometry&&e.updateFromObject(t),a.update(e),c[e.id]=d);return e},dispose:function(){c={}}}}function yh(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function dh(a,b,c){var t=a.createShader(b);a.shaderSource(t,c);a.compileShader(t);!1===a.getShaderParameter(t,a.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==a.getShaderInfoLog(t)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",
b===a.VERTEX_SHADER?"vertex":"fragment",a.getShaderInfoLog(t),yh(c));return t}function eh(a){switch(a){case vg:return["Linear","( value )"];case Wh:return["sRGB","( value )"];case Xh:return["RGBE","( value )"];case Yh:return["RGBM","( value, 7.0 )"];case ji:return["RGBM","( value, 16.0 )"];case ki:return["RGBD","( value, 256.0 )"];case xh:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function Rf(a,b){var c=eh(b);return"vec4 "+a+"( vec4 value ) { return "+
c[0]+"ToLinear"+c[1]+"; }"}function fh(a,b){var c=eh(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function Sf(a,b){var c;switch(b){case ug:c="Linear";break;case bh:c="Reinhard";break;case Xd:c="Uncharted2";break;case ze:c="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+a+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function zh(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":
"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(nf).join("\n")}function Db(a){var b=[],c;for(c in a){var t=a[c];!1!==t&&b.push("#define "+c+" "+t)}return b.join("\n")}function nf(a){return""!==a}function wg(a,b){return a.replace(/NUM_DIR_LIGHTS/g,
b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function Yd(a){return a.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(a,v){var b=Ua[v];if(void 0===b)throw Error("Can not resolve #include <"+v+">");return Yd(b)})}function xg(a){return a.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,v,b,c){a="";for(v=
parseInt(v);v<parseInt(b);v++)a+=c.replace(/\[ i \]/g,"[ "+v+" ]");return a})}function yg(a,b,c,t,d,u){var e=a.context,f=t.defines,g=d.vertexShader,h=d.fragmentShader,k="SHADOWMAP_TYPE_BASIC";u.shadowMapType===og?k="SHADOWMAP_TYPE_PCF":u.shadowMapType===ph&&(k="SHADOWMAP_TYPE_PCF_SOFT");var l="ENVMAP_TYPE_CUBE",m="ENVMAP_MODE_REFLECTION",n="ENVMAP_BLENDING_MULTIPLY";if(u.envMap){switch(t.envMap.mapping){case pf:case Nc:l="ENVMAP_TYPE_CUBE";break;case Yf:case ie:l="ENVMAP_TYPE_CUBE_UV";break;case sd:case Vd:l=
"ENVMAP_TYPE_EQUIREC";break;case Xf:l="ENVMAP_TYPE_SPHERE"}switch(t.envMap.mapping){case Nc:case Vd:m="ENVMAP_MODE_REFRACTION"}switch(t.combine){case Lc:n="ENVMAP_BLENDING_MULTIPLY";break;case Wd:n="ENVMAP_BLENDING_MIX";break;case rb:n="ENVMAP_BLENDING_ADD"}}var p=0<a.gammaFactor?a.gammaFactor:1,s=zh(t.extensions,u,b),r=Db(f),q=e.createProgram();t.isRawShaderMaterial?(f=[r].filter(nf).join("\n"),0<f.length&&(f+="\n"),b=[s,r].filter(nf).join("\n"),0<b.length&&(b+="\n")):(f=["precision "+u.precision+
" float;","precision "+u.precision+" int;","#define SHADER_NAME "+d.name,r,u.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+u.maxBones,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+m:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?
"#define USE_NORMALMAP":"",u.displacementMap&&u.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.flatShading?"#define FLAT_SHADED":"",u.skinning?"#define USE_SKINNING":"",u.useVertexTexture?"#define BONE_TEXTURE":"",u.morphTargets?"#define USE_MORPHTARGETS":"",u.morphNormals&&!1===u.flatShading?
"#define USE_MORPHNORMALS":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+u.numClippingPlanes,u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+k:"",u.sizeAttenuation?"#define USE_SIZEATTENUATION":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&b.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;",
"uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;",
"\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(nf).join("\n"),b=[s,"precision "+u.precision+" float;","precision "+u.precision+" int;","#define SHADER_NAME "+d.name,r,u.alphaTest?"#define ALPHATEST "+u.alphaTest:"","#define GAMMA_FACTOR "+
p,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+l:"",u.envMap?"#define "+m:"",u.envMap?"#define "+n:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?
"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.gradientMap?"#define USE_GRADIENTMAP":"",u.flatShading?"#define FLAT_SHADED":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+u.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(u.numClippingPlanes-u.numClipIntersection),u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+k:"",u.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":
"",u.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&b.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",u.envMap&&b.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",u.toneMapping!==jd?"#define TONE_MAPPING":"",u.toneMapping!==jd?Ua.tonemapping_pars_fragment:"",u.toneMapping!==jd?Sf("toneMapping",u.toneMapping):"",u.dithering?"#define DITHERING":
"",u.outputEncoding||u.mapEncoding||u.envMapEncoding||u.emissiveMapEncoding?Ua.encodings_pars_fragment:"",u.mapEncoding?Rf("mapTexelToLinear",u.mapEncoding):"",u.envMapEncoding?Rf("envMapTexelToLinear",u.envMapEncoding):"",u.emissiveMapEncoding?Rf("emissiveMapTexelToLinear",u.emissiveMapEncoding):"",u.outputEncoding?fh("linearToOutputTexel",u.outputEncoding):"",u.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(nf).join("\n"));g=Yd(g);g=wg(g,u);h=Yd(h);h=wg(h,u);t.isShaderMaterial||
(g=xg(g),h=xg(h));h=b+h;g=dh(e,e.VERTEX_SHADER,f+g);h=dh(e,e.FRAGMENT_SHADER,h);e.attachShader(q,g);e.attachShader(q,h);void 0!==t.index0AttributeName?e.bindAttribLocation(q,0,t.index0AttributeName):!0===u.morphTargets&&e.bindAttribLocation(q,0,"position");e.linkProgram(q);u=e.getProgramInfoLog(q).trim();d=e.getShaderInfoLog(g).trim();k=e.getShaderInfoLog(h).trim();m=l=!0;if(!1===e.getProgramParameter(q,e.LINK_STATUS))l=!1,console.error("THREE.WebGLProgram: shader error: ",e.getError(),"gl.VALIDATE_STATUS",
e.getProgramParameter(q,e.VALIDATE_STATUS),"gl.getProgramInfoLog",u,d,k);else if(""!==u)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",u);else if(""===d||""===k)m=!1;m&&(this.diagnostics={runnable:l,material:t,programLog:u,vertexShader:{log:d,prefix:f},fragmentShader:{log:k,prefix:b}});e.deleteShader(g);e.deleteShader(h);var x;this.getUniforms=function(){void 0===x&&(x=new Xa(e,q,a));return x};var w;this.getAttributes=function(){if(void 0===w){for(var a={},v=e.getProgramParameter(q,e.ACTIVE_ATTRIBUTES),
b=0;b<v;b++){var C=e.getActiveAttrib(q,b).name;a[C]=e.getAttribLocation(q,C)}w=a}return w};this.destroy=function(){e.deleteProgram(q);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.id=ri++;this.code=c;this.usedTimes=1;this.program=q;this.vertexShader=
g;this.fragmentShader=h;return this}function gh(a,b,c){function t(a,v){var b;a?a.isTexture?b=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),b=a.texture.encoding):b=vg;b===vg&&v&&(b=xh);return b}var d=[],u={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",
MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},e="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
this.getParameters=function(b,C,d,S,e,f,ua){var g=u[b.type],h;if(ua.isSkinnedMesh)if(h=ua.skeleton.bones,c.floatVertexTextures)h=1024;else{var k=Math.min(Math.floor((c.maxVertexUniforms-20)/4),h.length);k<h.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+h.length+" bones. This GPU supports "+k+"."),h=0):h=k}else h=0;k=c.precision;null!==b.precision&&(k=c.getMaxPrecision(b.precision),k!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",k,"instead."));
var l=a.getRenderTarget();return{shaderID:g,precision:k,supportsVertexTextures:c.vertexTextures,outputEncoding:t(l?l.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:t(b.map,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:t(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(b.envMap.mapping===Yf||b.envMap.mapping===ie),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:t(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,
displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!S,useFog:b.fog,fogExp:S&&S.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:b.skinning&&0<h,maxBones:h,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,morphNormals:b.morphNormals,
maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numClippingPlanes:e,numClipIntersection:f,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&ua.receiveShadow&&0<d.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,
alphaTest:b.alphaTest,doubleSided:b.side===ed,flipSided:b.side===Gc,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(b,C){var c=[];C.shaderID?c.push(C.shaderID):(c.push(b.fragmentShader),c.push(b.vertexShader));if(void 0!==b.defines)for(var y in b.defines)c.push(y),c.push(b.defines[y]);for(y=0;y<e.length;y++)c.push(C[e[y]]);c.push(b.onBeforeCompile.toString());c.push(a.gammaOutput);return c.join()};this.acquireProgram=function(c,y,t,u){for(var e,f=0,ua=d.length;f<
ua;f++){var g=d[f];if(g.code===u){e=g;++e.usedTimes;break}}void 0===e&&(e=new yg(a,b,u,c,y,t),d.push(e));return e};this.releaseProgram=function(a){if(0===--a.usedTimes){var v=d.indexOf(a);d[v]=d[d.length-1];d.pop();a.destroy()}};this.programs=d}function Ah(a,b,c,t,d,u,e,f){function g(a,v){if(a.width>v||a.height>v){var b=v/Math.max(a.width,a.height),C=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");C.width=Math.floor(a.width*b);C.height=Math.floor(a.height*b);C.getContext("2d").drawImage(a,
0,0,a.width,a.height,0,0,C.width,C.height);console.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+C.width+"x"+C.height,a);return C}return a}function h(a){return Ba.isPowerOfTwo(a.width)&&Ba.isPowerOfTwo(a.height)}function k(a,v){return a.generateMipmaps&&v&&a.minFilter!==wa&&a.minFilter!==Eb}function l(b){return b===wa||b===xc||b===lc?a.NEAREST:a.LINEAR}function m(b){b=b.target;b.removeEventListener("dispose",m);a:{var C=t.get(b);if(b.image&&C.__image__webglTextureCube)a.deleteTexture(C.__image__webglTextureCube);
else{if(void 0===C.__webglInit)break a;a.deleteTexture(C.__webglTexture)}t.remove(b)}b.isVideoTexture&&delete w[b.id];e.textures--}function n(b){b=b.target;b.removeEventListener("dispose",n);var C=t.get(b),c=t.get(b.texture);if(b){void 0!==c.__webglTexture&&a.deleteTexture(c.__webglTexture);b.depthTexture&&b.depthTexture.dispose();if(b.isWebGLRenderTargetCube)for(c=0;6>c;c++)a.deleteFramebuffer(C.__webglFramebuffer[c]),C.__webglDepthbuffer&&a.deleteRenderbuffer(C.__webglDepthbuffer[c]);else a.deleteFramebuffer(C.__webglFramebuffer),
C.__webglDepthbuffer&&a.deleteRenderbuffer(C.__webglDepthbuffer);t.remove(b.texture);t.remove(b)}e.textures--}function p(b,C){var l=t.get(b);if(b.isVideoTexture){var Ca=b.id,n=f.frame;w[Ca]!==n&&(w[Ca]=n,b.update())}if(0<b.version&&l.__version!==b.version)if(Ca=b.image,void 0===Ca)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",b);else if(!1===Ca.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",b);else{void 0===l.__webglInit&&
(l.__webglInit=!0,b.addEventListener("dispose",m),l.__webglTexture=a.createTexture(),e.textures++);c.activeTexture(a.TEXTURE0+C);c.bindTexture(a.TEXTURE_2D,l.__webglTexture);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,b.unpackAlignment);var Oa=g(b.image,d.maxTextureSize);(b.wrapS!==cb||b.wrapT!==cb||b.minFilter!==wa&&b.minFilter!==Eb)&&!1===h(Oa)&&(Ca=Oa,Ca instanceof HTMLImageElement||Ca instanceof
HTMLCanvasElement||Ca instanceof ImageBitmap?(n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n.width=Ba.floorPowerOfTwo(Ca.width),n.height=Ba.floorPowerOfTwo(Ca.height),n.getContext("2d").drawImage(Ca,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+Ca.width+"x"+Ca.height+"). Resized to "+n.width+"x"+n.height,Ca),Oa=n):Oa=Ca);var Ca=h(Oa),n=u.convert(b.format),r=u.convert(b.type);s(a.TEXTURE_2D,b,Ca);var q=b.mipmaps;if(b.isDepthTexture){q=
a.DEPTH_COMPONENT;if(b.type===Zc){if(!x)throw Error("Float Depth Texture only supported in WebGL2.0");q=a.DEPTH_COMPONENT32F}else x&&(q=a.DEPTH_COMPONENT16);b.format===rd&&q===a.DEPTH_COMPONENT&&b.type!==Qe&&b.type!==Xc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),b.type=Qe,r=u.convert(b.type));b.format===Ab&&(q=a.DEPTH_STENCIL,b.type!==Kf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),
b.type=Kf,r=u.convert(b.type)));c.texImage2D(a.TEXTURE_2D,0,q,Oa.width,Oa.height,0,n,r,null)}else if(b.isDataTexture)if(0<q.length&&Ca){for(var B=0,Yg=q.length;B<Yg;B++)Oa=q[B],c.texImage2D(a.TEXTURE_2D,B,n,Oa.width,Oa.height,0,n,r,Oa.data);b.generateMipmaps=!1}else c.texImage2D(a.TEXTURE_2D,0,n,Oa.width,Oa.height,0,n,r,Oa.data);else if(b.isCompressedTexture)for(B=0,Yg=q.length;B<Yg;B++)Oa=q[B],b.format!==kc&&b.format!==qd?-1<c.getCompressedTextureFormats().indexOf(n)?c.compressedTexImage2D(a.TEXTURE_2D,
B,n,Oa.width,Oa.height,0,Oa.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(a.TEXTURE_2D,B,n,Oa.width,Oa.height,0,n,r,Oa.data);else if(0<q.length&&Ca){B=0;for(Yg=q.length;B<Yg;B++)Oa=q[B],c.texImage2D(a.TEXTURE_2D,B,n,n,r,Oa);b.generateMipmaps=!1}else c.texImage2D(a.TEXTURE_2D,0,n,n,r,Oa);k(b,Ca)&&a.generateMipmap(a.TEXTURE_2D);l.__version=b.version;if(b.onUpdate)b.onUpdate(b);return}c.activeTexture(a.TEXTURE0+C);c.bindTexture(a.TEXTURE_2D,
l.__webglTexture)}function s(c,y,e){e?(a.texParameteri(c,a.TEXTURE_WRAP_S,u.convert(y.wrapS)),a.texParameteri(c,a.TEXTURE_WRAP_T,u.convert(y.wrapT)),a.texParameteri(c,a.TEXTURE_MAG_FILTER,u.convert(y.magFilter)),a.texParameteri(c,a.TEXTURE_MIN_FILTER,u.convert(y.minFilter))):(a.texParameteri(c,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(c,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),y.wrapS===cb&&y.wrapT===cb||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",
y),a.texParameteri(c,a.TEXTURE_MAG_FILTER,l(y.magFilter)),a.texParameteri(c,a.TEXTURE_MIN_FILTER,l(y.minFilter)),y.minFilter!==wa&&y.minFilter!==Eb&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",y));!(e=b.get("EXT_texture_filter_anisotropic"))||y.type===Zc&&null===b.get("OES_texture_float_linear")||y.type===ue&&null===b.get("OES_texture_half_float_linear")||!(1<y.anisotropy||t.get(y).__currentAnisotropy)||
(a.texParameterf(c,e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(y.anisotropy,d.getMaxAnisotropy())),t.get(y).__currentAnisotropy=y.anisotropy)}function r(b,C,d,S){var e=u.convert(C.texture.format),f=u.convert(C.texture.type);c.texImage2D(S,0,e,C.width,C.height,0,e,f,null);a.bindFramebuffer(a.FRAMEBUFFER,b);a.framebufferTexture2D(a.FRAMEBUFFER,d,S,t.get(C.texture).__webglTexture,0);a.bindFramebuffer(a.FRAMEBUFFER,null)}function q(b,C){a.bindRenderbuffer(a.RENDERBUFFER,b);C.depthBuffer&&!C.stencilBuffer?(a.renderbufferStorage(a.RENDERBUFFER,
a.DEPTH_COMPONENT16,C.width,C.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b)):C.depthBuffer&&C.stencilBuffer?(a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,C.width,C.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,b)):a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,C.width,C.height);a.bindRenderbuffer(a.RENDERBUFFER,null)}var x="undefined"!==typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,w={};this.setTexture2D=
p;this.setTextureCube=function(b,C){var f=t.get(b);if(6===b.image.length)if(0<b.version&&f.__version!==b.version){f.__image__webglTextureCube||(b.addEventListener("dispose",m),f.__image__webglTextureCube=a.createTexture(),e.textures++);c.activeTexture(a.TEXTURE0+C);c.bindTexture(a.TEXTURE_CUBE_MAP,f.__image__webglTextureCube);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b.flipY);for(var W=b&&b.isCompressedTexture,l=b.image[0]&&b.image[0].isDataTexture,Ca=[],n=0;6>n;n++)Ca[n]=W||l?l?b.image[n].image:b.image[n]:
g(b.image[n],d.maxCubemapSize);var p=h(Ca[0]),Oa=u.convert(b.format),q=u.convert(b.type);s(a.TEXTURE_CUBE_MAP,b,p);for(n=0;6>n;n++)if(W)for(var r,B=Ca[n].mipmaps,x=0,w=B.length;x<w;x++)r=B[x],b.format!==kc&&b.format!==qd?-1<c.getCompressedTextureFormats().indexOf(Oa)?c.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+n,x,Oa,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+
n,x,Oa,r.width,r.height,0,Oa,q,r.data);else l?c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,Oa,Ca[n].width,Ca[n].height,0,Oa,q,Ca[n].data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,Oa,Oa,q,Ca[n]);k(b,p)&&a.generateMipmap(a.TEXTURE_CUBE_MAP);f.__version=b.version;if(b.onUpdate)b.onUpdate(b)}else c.activeTexture(a.TEXTURE0+C),c.bindTexture(a.TEXTURE_CUBE_MAP,f.__image__webglTextureCube)};this.setTextureCubeDynamic=function(b,C){c.activeTexture(a.TEXTURE0+C);c.bindTexture(a.TEXTURE_CUBE_MAP,t.get(b).__webglTexture)};
this.setupRenderTarget=function(b){var C=t.get(b),d=t.get(b.texture);b.addEventListener("dispose",n);d.__webglTexture=a.createTexture();e.textures++;var S=!0===b.isWebGLRenderTargetCube,u=h(b);if(S){C.__webglFramebuffer=[];for(var f=0;6>f;f++)C.__webglFramebuffer[f]=a.createFramebuffer()}else C.__webglFramebuffer=a.createFramebuffer();if(S){c.bindTexture(a.TEXTURE_CUBE_MAP,d.__webglTexture);s(a.TEXTURE_CUBE_MAP,b.texture,u);for(f=0;6>f;f++)r(C.__webglFramebuffer[f],b,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+
f);k(b.texture,u)&&a.generateMipmap(a.TEXTURE_CUBE_MAP);c.bindTexture(a.TEXTURE_CUBE_MAP,null)}else c.bindTexture(a.TEXTURE_2D,d.__webglTexture),s(a.TEXTURE_2D,b.texture,u),r(C.__webglFramebuffer,b,a.COLOR_ATTACHMENT0,a.TEXTURE_2D),k(b.texture,u)&&a.generateMipmap(a.TEXTURE_2D),c.bindTexture(a.TEXTURE_2D,null);if(b.depthBuffer){C=t.get(b);d=!0===b.isWebGLRenderTargetCube;if(b.depthTexture){if(d)throw Error("target.depthTexture not supported in Cube render targets");if(b&&b.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");
a.bindFramebuffer(a.FRAMEBUFFER,C.__webglFramebuffer);if(!b.depthTexture||!b.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");t.get(b.depthTexture).__webglTexture&&b.depthTexture.image.width===b.width&&b.depthTexture.image.height===b.height||(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0);p(b.depthTexture,0);C=t.get(b.depthTexture).__webglTexture;if(b.depthTexture.format===rd)a.framebufferTexture2D(a.FRAMEBUFFER,
a.DEPTH_ATTACHMENT,a.TEXTURE_2D,C,0);else if(b.depthTexture.format===Ab)a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,C,0);else throw Error("Unknown depthTexture format");}else if(d)for(C.__webglDepthbuffer=[],d=0;6>d;d++)a.bindFramebuffer(a.FRAMEBUFFER,C.__webglFramebuffer[d]),C.__webglDepthbuffer[d]=a.createRenderbuffer(),q(C.__webglDepthbuffer[d],b);else a.bindFramebuffer(a.FRAMEBUFFER,C.__webglFramebuffer),C.__webglDepthbuffer=a.createRenderbuffer(),q(C.__webglDepthbuffer,
b);a.bindFramebuffer(a.FRAMEBUFFER,null)}};this.updateRenderTargetMipmap=function(b){var C=b.texture,d=h(b);k(C,d)&&(b=b.isWebGLRenderTargetCube?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D,C=t.get(C).__webglTexture,c.bindTexture(b,C),a.generateMipmap(b),c.bindTexture(b,null))}}function hh(){var a={};return{get:function(b){b=b.uuid;var c=a[b];void 0===c&&(c={},a[b]=c);return c},remove:function(b){delete a[b.uuid]},dispose:function(){a={}}}}function ih(a,b,c){function t(b,C,c){var y=new Uint8Array(4),t=a.createTexture();
a.bindTexture(b,t);a.texParameteri(b,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(b,a.TEXTURE_MAG_FILTER,a.NEAREST);for(b=0;b<c;b++)a.texImage2D(C+b,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,y);return t}function d(b){!0!==x[b]&&(a.enable(b),x[b]=!0)}function u(b){!1!==x[b]&&(a.disable(b),x[b]=!1)}function e(b,C,t,f,ua,g,W,h){b!==rg?d(a.BLEND):u(a.BLEND);if(b!==ud){if(b!==A||h!==H)switch(b){case gg:h?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),
a.blendFunc(a.SRC_ALPHA,a.ONE));break;case Lf:h?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR));break;case fd:h?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR));break;default:h?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,
a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA))}I=Z=P=F=E=D=null}else{ua=ua||C;g=g||t;W=W||f;if(C!==D||ua!==P)a.blendEquationSeparate(c.convert(C),c.convert(ua)),D=C,P=ua;if(t!==E||f!==F||g!==Z||W!==I)a.blendFuncSeparate(c.convert(t),c.convert(f),c.convert(g),c.convert(W)),E=t,F=f,Z=g,I=W}A=b;H=h}function f(b){K!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),K=b)}function g(b){b!==
vb?(d(a.CULL_FACE),b!==J&&(b===Vg?a.cullFace(a.BACK):b===rf?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):u(a.CULL_FACE);J=b}function h(b,C,c){if(b){if(d(a.POLYGON_OFFSET_FILL),L!==C||N!==c)a.polygonOffset(C,c),L=C,N=c}else u(a.POLYGON_OFFSET_FILL)}function k(b){void 0===b&&(b=a.TEXTURE0+R-1);O!==b&&(a.activeTexture(b),O=b)}var l=new function(){var b=!1,C=new B,c=null,y=new B(0,0,0,0);return{setMask:function(C){c===C||b||(a.colorMask(C,C,C,C),c=C)},setLocked:function(a){b=a},setClear:function(b,
c,t,d,S){!0===S&&(b*=d,c*=d,t*=d);C.set(b,c,t,d);!1===y.equals(C)&&(a.clearColor(b,c,t,d),y.copy(C))},reset:function(){b=!1;c=null;y.set(-1,0,0,0)}}},m=new function(){var b=!1,C=null,c=null,y=null;return{setTest:function(b){b?d(a.DEPTH_TEST):u(a.DEPTH_TEST)},setMask:function(c){C===c||b||(a.depthMask(c),C=c)},setFunc:function(b){if(c!==b){if(b)switch(b){case mh:a.depthFunc(a.NEVER);break;case Of:a.depthFunc(a.ALWAYS);break;case Qf:a.depthFunc(a.LESS);break;case Ze:a.depthFunc(a.LEQUAL);break;case qh:a.depthFunc(a.EQUAL);
break;case Kg:a.depthFunc(a.GEQUAL);break;case Wf:a.depthFunc(a.GREATER);break;case Pf:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);c=b}},setLocked:function(a){b=a},setClear:function(b){y!==b&&(a.clearDepth(b),y=b)},reset:function(){b=!1;y=c=C=null}}},n=new function(){var b=!1,C=null,c=null,y=null,t=null,e=null,f=null,ua=null,g=null;return{setTest:function(b){b?d(a.STENCIL_TEST):u(a.STENCIL_TEST)},setMask:function(c){C===c||b||(a.stencilMask(c),C=c)},setFunc:function(b,
C,d){if(c!==b||y!==C||t!==d)a.stencilFunc(b,C,d),c=b,y=C,t=d},setOp:function(b,C,c){if(e!==b||f!==C||ua!==c)a.stencilOp(b,C,c),e=b,f=C,ua=c},setLocked:function(a){b=a},setClear:function(b){g!==b&&(a.clearStencil(b),g=b)},reset:function(){b=!1;g=ua=f=e=t=y=c=C=null}}},p=a.getParameter(a.MAX_VERTEX_ATTRIBS),s=new Uint8Array(p),q=new Uint8Array(p),r=new Uint8Array(p),x={},w=null,z=null,A=null,D=null,E=null,F=null,P=null,Z=null,I=null,H=!1,K=null,J=null,G=null,L=null,N=null,R=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),
p=parseFloat(/^WebGL\ ([0-9])/.exec(a.getParameter(a.VERSION))[1]),$=1<=parseFloat(p),O=null,T={},V=new B,U=new B,Q={};Q[a.TEXTURE_2D]=t(a.TEXTURE_2D,a.TEXTURE_2D,1);Q[a.TEXTURE_CUBE_MAP]=t(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);l.setClear(0,0,0,1);m.setClear(1);n.setClear(0);d(a.DEPTH_TEST);m.setFunc(Ze);f(!1);g(Vg);d(a.CULL_FACE);d(a.BLEND);e(Hc);return{buffers:{color:l,depth:m,stencil:n},initAttributes:function(){for(var a=0,v=s.length;a<v;a++)s[a]=0},enableAttribute:function(c){s[c]=
1;0===q[c]&&(a.enableVertexAttribArray(c),q[c]=1);0!==r[c]&&(b.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(c,0),r[c]=0)},enableAttributeAndDivisor:function(c,y){s[c]=1;0===q[c]&&(a.enableVertexAttribArray(c),q[c]=1);r[c]!==y&&(b.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(c,y),r[c]=y)},disableUnusedAttributes:function(){for(var b=0,C=q.length;b!==C;++b)q[b]!==s[b]&&(a.disableVertexAttribArray(b),q[b]=0)},enable:d,disable:u,getCompressedTextureFormats:function(){if(null===w&&
(w=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),y=0;y<c.length;y++)w.push(c[y]);return w},useProgram:function(b){return z!==b?(a.useProgram(b),z=b,!0):!1},setBlending:e,setMaterial:function(b,C){b.side===ed?u(a.CULL_FACE):d(a.CULL_FACE);var c=b.side===Gc;C&&(c=!c);f(c);!0===b.transparent?e(b.blending,b.blendEquation,b.blendSrc,
b.blendDst,b.blendEquationAlpha,b.blendSrcAlpha,b.blendDstAlpha,b.premultipliedAlpha):e(rg);m.setFunc(b.depthFunc);m.setTest(b.depthTest);m.setMask(b.depthWrite);l.setMask(b.colorWrite);h(b.polygonOffset,b.polygonOffsetFactor,b.polygonOffsetUnits)},setFlipSided:f,setCullFace:g,setLineWidth:function(b){b!==G&&($&&a.lineWidth(b),G=b)},setPolygonOffset:h,setScissorTest:function(b){b?d(a.SCISSOR_TEST):u(a.SCISSOR_TEST)},activeTexture:k,bindTexture:function(b,C){null===O&&k();var c=T[O];void 0===c&&(c=
{type:void 0,texture:void 0},T[O]=c);if(c.type!==b||c.texture!==C)a.bindTexture(b,C||Q[b]),c.type=b,c.texture=C},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(b){console.error("THREE.WebGLState:",b)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(b){console.error("THREE.WebGLState:",b)}},scissor:function(b){!1===V.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),V.copy(b))},viewport:function(b){!1===U.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),U.copy(b))},
reset:function(){for(var b=0;b<q.length;b++)1===q[b]&&(a.disableVertexAttribArray(b),q[b]=0);x={};O=w=null;T={};J=K=A=z=null;l.reset();m.reset();n.reset()}}}function of(a,b,c){function t(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,
a.MEDIUM_FLOAT).precision?"mediump":"lowp"}var d,u=void 0!==c.precision?c.precision:"highp",e=t(u);e!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",e,"instead."),u=e);c=!0===c.logarithmicDepthBuffer;var e=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),f=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=a.getParameter(a.MAX_TEXTURE_SIZE),h=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),k=a.getParameter(a.MAX_VERTEX_ATTRIBS),l=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),m=a.getParameter(a.MAX_VARYING_VECTORS),
n=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),p=0<f,s=!!b.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==d)return d;var c=b.get("EXT_texture_filter_anisotropic");return d=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:t,precision:u,logarithmicDepthBuffer:c,maxTextures:e,maxVertexTextures:f,maxTextureSize:g,maxCubemapSize:h,maxAttributes:k,maxVertexUniforms:l,maxVaryings:m,maxFragmentUniforms:n,vertexTextures:p,floatFragmentTextures:s,floatVertexTextures:p&&
s}}function Ya(a,b,c,t){Na.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:0.1;this.far=void 0!==t?t:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function Ae(a){Ya.call(this);this.cameras=a||[]}function Tf(a){function b(){if(null!==t&&t.isPresenting){var C=t.getEyeParameters("left"),d=C.renderWidth,C=C.renderHeight;l=a.getPixelRatio();k=a.getSize();a.setDrawingBufferSize(2*
d,C,1)}else c.enabled&&a.setDrawingBufferSize(k.width,k.height,l)}var c=this,t=null,S=null,u=null;"undefined"!==typeof window&&"VRFrameData"in window&&(S=new window.VRFrameData);var e=new d,f=new Ya;f.bounds=new B(0,0,0.5,1);f.layers.enable(1);var g=new Ya;g.bounds=new B(0.5,0,0.5,1);g.layers.enable(2);var h=new Ae([f,g]);h.layers.enable(1);h.layers.enable(2);var k,l;"undefined"!==typeof window&&window.addEventListener("vrdisplaypresentchange",b,!1);this.enabled=!1;this.getDevice=function(){return t};
this.setDevice=function(a){void 0!==a&&(t=a)};this.setPoseTarget=function(a){void 0!==a&&(u=a)};this.getCamera=function(a){if(null===t)return a;t.depthNear=a.near;t.depthFar=a.far;t.getFrameData(S);var v=S.pose,b=null!==u?u:a;null!==v.position?b.position.fromArray(v.position):b.position.set(0,0,0);null!==v.orientation&&b.quaternion.fromArray(v.orientation);b.updateMatrixWorld();if(!1===t.isPresenting)return a;f.near=a.near;g.near=a.near;f.far=a.far;g.far=a.far;h.matrixWorld.copy(a.matrixWorld);h.matrixWorldInverse.copy(a.matrixWorldInverse);
f.matrixWorldInverse.fromArray(S.leftViewMatrix);g.matrixWorldInverse.fromArray(S.rightViewMatrix);a=b.parent;null!==a&&(e.getInverse(a.matrixWorld),f.matrixWorldInverse.multiply(e),g.matrixWorldInverse.multiply(e));f.matrixWorld.getInverse(f.matrixWorldInverse);g.matrixWorld.getInverse(g.matrixWorldInverse);f.projectionMatrix.fromArray(S.leftProjectionMatrix);g.projectionMatrix.fromArray(S.rightProjectionMatrix);h.projectionMatrix.copy(f.projectionMatrix);a=t.getLayers();a.length&&(a=a[0],null!==
a.leftBounds&&4===a.leftBounds.length&&f.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&g.bounds.fromArray(a.rightBounds));return h};this.submitFrame=function(){t&&t.isPresenting&&t.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",b)}}function Mc(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];var t;switch(c){case "WEBGL_depth_texture":t=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||
a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":t=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":t=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":t=a.getExtension("WEBGL_compressed_texture_pvrtc")||
a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case "WEBGL_compressed_texture_etc1":t=a.getExtension("WEBGL_compressed_texture_etc1");break;default:t=a.getExtension(c)}null===t&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=t}}}function Zd(){function a(){h.value!==t&&(h.value=t,h.needsUpdate=0<d);c.numPlanes=d;c.numIntersection=0}function b(a,v,C,t){var d=null!==a?a.length:0,S=null;if(0!==d){S=h.value;if(!0!==t||null===S){t=C+4*d;v=v.matrixWorldInverse;
g.getNormalMatrix(v);if(null===S||S.length<t)S=new Float32Array(t);for(t=0;t!==d;++t,C+=4)f.copy(a[t]).applyMatrix4(v,g),f.normal.toArray(S,C),S[C+3]=f.constant}h.value=S;h.needsUpdate=!0}c.numPlanes=d;return S}var c=this,t=null,d=0,u=!1,e=!1,f=new ib,g=new l,h={value:null,needsUpdate:!1};this.uniform=h;this.numIntersection=this.numPlanes=0;this.init=function(a,v,c){var y=0!==a.length||v||0!==d||u;u=v;t=b(a,c,0);d=a.length;return y};this.beginShadows=function(){e=!0;b(null)};this.endShadows=function(){e=
!1;a()};this.setState=function(c,y,f,g,W,va){if(!u||null===c||0===c.length||e&&!f)e?b(null):a();else{f=e?0:d;var k=4*f,l=W.clippingState||null;h.value=l;l=b(c,g,k,va);for(c=0;c!==k;++c)l[c]=t[c];W.clippingState=l;this.numIntersection=y?this.numPlanes:0;this.numPlanes+=f}}}function Uf(a,b){return{convert:function(c){var t;if(c===sc)return a.REPEAT;if(c===cb)return a.CLAMP_TO_EDGE;if(c===yb)return a.MIRRORED_REPEAT;if(c===wa)return a.NEAREST;if(c===xc)return a.NEAREST_MIPMAP_NEAREST;if(c===lc)return a.NEAREST_MIPMAP_LINEAR;
if(c===Eb)return a.LINEAR;if(c===dg)return a.LINEAR_MIPMAP_NEAREST;if(c===wc)return a.LINEAR_MIPMAP_LINEAR;if(c===Nd)return a.UNSIGNED_BYTE;if(c===gf)return a.UNSIGNED_SHORT_4_4_4_4;if(c===Se)return a.UNSIGNED_SHORT_5_5_5_1;if(c===If)return a.UNSIGNED_SHORT_5_6_5;if(c===rh)return a.BYTE;if(c===Qb)return a.SHORT;if(c===Qe)return a.UNSIGNED_SHORT;if(c===Sg)return a.INT;if(c===Xc)return a.UNSIGNED_INT;if(c===Zc)return a.FLOAT;if(c===ue&&(t=b.get("OES_texture_half_float"),null!==t))return t.HALF_FLOAT_OES;
if(c===ig)return a.ALPHA;if(c===qd)return a.RGB;if(c===kc)return a.RGBA;if(c===ne)return a.LUMINANCE;if(c===Rg)return a.LUMINANCE_ALPHA;if(c===rd)return a.DEPTH_COMPONENT;if(c===Ab)return a.DEPTH_STENCIL;if(c===Ud)return a.FUNC_ADD;if(c===Rd)return a.FUNC_SUBTRACT;if(c===tg)return a.FUNC_REVERSE_SUBTRACT;if(c===lg)return a.ZERO;if(c===ff)return a.ONE;if(c===hf)return a.SRC_COLOR;if(c===Zg)return a.ONE_MINUS_SRC_COLOR;if(c===sg)return a.SRC_ALPHA;if(c===bg)return a.ONE_MINUS_SRC_ALPHA;if(c===$c)return a.DST_ALPHA;
if(c===ye)return a.ONE_MINUS_DST_ALPHA;if(c===$g)return a.DST_COLOR;if(c===mf)return a.ONE_MINUS_DST_COLOR;if(c===ha)return a.SRC_ALPHA_SATURATE;if(c===Ma||c===mb||c===Wg||c===ve)if(t=b.get("WEBGL_compressed_texture_s3tc"),null!==t){if(c===Ma)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===mb)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===Wg)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===ve)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(c===m||c===ja||c===p||c===h)if(t=b.get("WEBGL_compressed_texture_pvrtc"),
null!==t){if(c===m)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===ja)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===p)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===h)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(c===w&&(t=b.get("WEBGL_compressed_texture_etc1"),null!==t))return t.COMPRESSED_RGB_ETC1_WEBGL;if(c===Va||c===Rb||c===jf||c===Ih||c===Jh||c===Kh||c===Lh||c===Mh||c===Nh||c===Oh||c===Ph||c===Qh||c===Rh||c===Sh)if(t=b.get("WEBGL_compressed_texture_astc"),null!==t)return c;if(c===Jf||c===
vc)if(t=b.get("EXT_blend_minmax"),null!==t){if(c===Jf)return t.MIN_EXT;if(c===vc)return t.MAX_EXT}return c===Kf&&(t=b.get("WEBGL_depth_texture"),null!==t)?t.UNSIGNED_INT_24_8_WEBGL:0}}}function Vf(a){function b(){ha=new Mc(Y);ha.get("WEBGL_depth_texture");ha.get("OES_texture_float");ha.get("OES_texture_float_linear");ha.get("OES_texture_half_float");ha.get("OES_texture_half_float_linear");ha.get("OES_standard_derivatives");ha.get("OES_element_index_uint");ha.get("ANGLE_instanced_arrays");Aa=new Uf(Y,
ha);oa=new of(Y,ha,a);aa=new ih(Y,ha,Aa);aa.scissor(da.copy(ka).multiplyScalar(ba));aa.viewport(U.copy(fa).multiplyScalar(ba));sa=new hh;xa=new Ah(Y,ha,aa,sa,oa,Aa,ya,la);wa=new Ac(Y);Ia=new qb(Y,wa,ya);Fa=new ch(Ia,la);Ga=new z(Y);nb=new gh(L,ha,oa);pa=new ah;Da=new f;Ea=new Ha(L,aa,Ia,P);Qa=new fc(Y,ha,la);Ja=new x(Y,ha,la);Ka=new Jc(L,Y,aa,xa,oa);L.info.programs=nb.programs;L.context=Y;L.capabilities=oa;L.extensions=ha;L.properties=sa;L.renderLists=Da;L.state=aa}function c(a){a.preventDefault();
console.log("THREE.WebGLRenderer: Context Lost.");O=!0}function t(){console.log("THREE.WebGLRenderer: Context Restored.");O=!1;b()}function S(a){a=a.target;a.removeEventListener("dispose",S);u(a);sa.remove(a)}function u(a){var v=sa.get(a).program;a.program=void 0;void 0!==v&&nb.releaseProgram(v)}function ua(a,v,b){a.render(function(a){L.renderBufferImmediate(a,v,b)})}function g(a){null!==Ma&&Ma(a);(a=za.getDevice())&&a.isPresenting?a.requestAnimationFrame(g):window.requestAnimationFrame(g)}function h(a,
v,b){if(!1!==a.visible){if(a.layers.test(v.layers))if(a.isLight)H.push(a),a.castShadow&&K.push(a);else if(a.isSprite)a.frustumCulled&&!ja.intersectsSprite(a)||G.push(a);else if(a.isImmediateRenderObject)b&&na.setFromMatrixPosition(a.matrixWorld).applyMatrix4(qa),J.push(a,null,a.material,na.z,null);else if(a.isMesh||a.isLine||a.isPoints)if(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||ja.intersectsObject(a)){b&&na.setFromMatrixPosition(a.matrixWorld).applyMatrix4(qa);var C=Fa.update(a),c=
a.material;if(Array.isArray(c))for(var y=C.groups,t=0,d=y.length;t<d;t++){var S=y[t],u=c[S.materialIndex];u&&u.visible&&J.push(a,C,u,na.z,S)}else c.visible&&J.push(a,C,c,na.z,null)}a=a.children;t=0;for(d=a.length;t<d;t++)h(a[t],v,b)}}function k(a,v,b,C){for(var c=0,y=a.length;c<y;c++){var t=a[c],d=t.object,S=t.geometry,u=void 0===C?t.material:C,t=t.group;if(b.isArrayCamera){Q=b;for(var e=b.cameras,f=0,g=e.length;f<g;f++){var ua=e[f];if(d.layers.test(ua.layers)){var W=ua.bounds;aa.viewport(U.set(W.x*
X,W.y*ca,W.z*X,W.w*ca).multiplyScalar(ba));l(d,v,ua,S,u,t)}}}else Q=null,l(d,v,b,S,u,t)}}function l(a,v,b,C,c,y){a.onBeforeRender(L,v,b,C,c,y);a.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,a.matrixWorld);a.normalMatrix.getNormalMatrix(a.modelViewMatrix);if(a.isImmediateRenderObject){var t=a.isMesh&&0>a.matrixWorld.determinant();aa.setMaterial(c,t);t=n(b,v.fog,c,a);T="";ua(a,t,c)}else L.renderBufferDirect(b,v.fog,C,c,a,y);a.onAfterRender(L,v,b,C,c,y)}function m(a,v,b){var C=sa.get(a);b=nb.getParameters(a,
pa.state,K,v,ga.numPlanes,ga.numIntersection,b);var c=nb.getProgramCode(a,b),y=C.program,t=!0;if(void 0===y)a.addEventListener("dispose",S);else if(y.code!==c)u(a);else{if(void 0!==b.shaderID)return;t=!1}t&&(b.shaderID?(y=Mf[b.shaderID],C.shader={name:a.type,uniforms:yc.clone(y.uniforms),vertexShader:y.vertexShader,fragmentShader:y.fragmentShader}):C.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(C.shader),y=nb.acquireProgram(a,
C.shader,b,c),C.program=y,a.program=y);b=y.getAttributes();if(a.morphTargets)for(c=a.numSupportedMorphTargets=0;c<L.maxMorphTargets;c++)0<=b["morphTarget"+c]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(c=a.numSupportedMorphNormals=0;c<L.maxMorphNormals;c++)0<=b["morphNormal"+c]&&a.numSupportedMorphNormals++;b=C.shader.uniforms;if(!a.isShaderMaterial&&!a.isRawShaderMaterial||!0===a.clipping)C.numClippingPlanes=ga.numPlanes,C.numIntersection=ga.numIntersection,b.clippingPlanes=ga.uniform;C.fog=
v;C.lightsHash=pa.state.hash;a.lights&&(b.ambientLightColor.value=pa.state.ambient,b.directionalLights.value=pa.state.directional,b.spotLights.value=pa.state.spot,b.rectAreaLights.value=pa.state.rectArea,b.pointLights.value=pa.state.point,b.hemisphereLights.value=pa.state.hemi,b.directionalShadowMap.value=pa.state.directionalShadowMap,b.directionalShadowMatrix.value=pa.state.directionalShadowMatrix,b.spotShadowMap.value=pa.state.spotShadowMap,b.spotShadowMatrix.value=pa.state.spotShadowMatrix,b.pointShadowMap.value=
pa.state.pointShadowMap,b.pointShadowMatrix.value=pa.state.pointShadowMatrix);a=C.program.getUniforms();a=Xa.seqWithValue(a.seq,b);C.uniformsList=a}function n(a,b,v,C){M=0;var c=sa.get(v);Pa&&(ma||a!==V)&&ga.setState(v.clippingPlanes,v.clipIntersection,v.clipShadows,a,c,a===V&&v.id===$);!1===v.needsUpdate&&(void 0===c.program?v.needsUpdate=!0:v.fog&&c.fog!==b?v.needsUpdate=!0:v.lights&&c.lightsHash!==pa.state.hash?v.needsUpdate=!0:void 0===c.numClippingPlanes||c.numClippingPlanes===ga.numPlanes&&
c.numIntersection===ga.numIntersection||(v.needsUpdate=!0));v.needsUpdate&&(m(v,b,C),v.needsUpdate=!1);var y=!1,t=!1,d=!1,S=c.program,u=S.getUniforms(),e=c.shader.uniforms;aa.useProgram(S.program)&&(d=t=y=!0);v.id!==$&&($=v.id,t=!0);if(y||a!==V){u.setValue(Y,"projectionMatrix",a.projectionMatrix);oa.logarithmicDepthBuffer&&u.setValue(Y,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));V!==(Q||a)&&(V=Q||a,d=t=!0);if(v.isShaderMaterial||v.isMeshPhongMaterial||v.isMeshStandardMaterial||v.envMap)y=u.map.cameraPosition,
void 0!==y&&y.setValue(Y,na.setFromMatrixPosition(a.matrixWorld));(v.isMeshPhongMaterial||v.isMeshLambertMaterial||v.isMeshBasicMaterial||v.isMeshStandardMaterial||v.isShaderMaterial||v.skinning)&&u.setValue(Y,"viewMatrix",a.matrixWorldInverse)}if(v.skinning&&(u.setOptional(Y,C,"bindMatrix"),u.setOptional(Y,C,"bindMatrixInverse"),a=C.skeleton))if(y=a.bones,oa.floatVertexTextures){if(void 0===a.boneTexture){var y=Math.sqrt(4*y.length),y=Ba.ceilPowerOfTwo(y),y=Math.max(y,4),f=new Float32Array(y*y*4);
f.set(a.boneMatrices);var ua=new D(f,y,y,kc,Zc);a.boneMatrices=f;a.boneTexture=ua;a.boneTextureSize=y}u.setValue(Y,"boneTexture",a.boneTexture);u.setValue(Y,"boneTextureSize",a.boneTextureSize)}else u.setOptional(Y,a,"boneMatrices");t&&(u.setValue(Y,"toneMappingExposure",L.toneMappingExposure),u.setValue(Y,"toneMappingWhitePoint",L.toneMappingWhitePoint),v.lights&&(t=d,e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=
t,e.hemisphereLights.needsUpdate=t),b&&v.fog&&(e.fogColor.value=b.color,b.isFog?(e.fogNear.value=b.near,e.fogFar.value=b.far):b.isFogExp2&&(e.fogDensity.value=b.density)),v.isMeshBasicMaterial?p(e,v):v.isMeshLambertMaterial?(p(e,v),v.emissiveMap&&(e.emissiveMap.value=v.emissiveMap)):v.isMeshPhongMaterial?(p(e,v),v.isMeshToonMaterial?(s(e,v),v.gradientMap&&(e.gradientMap.value=v.gradientMap)):s(e,v)):v.isMeshStandardMaterial?(p(e,v),v.isMeshPhysicalMaterial&&(e.clearCoat.value=v.clearCoat,e.clearCoatRoughness.value=
v.clearCoatRoughness),e.roughness.value=v.roughness,e.metalness.value=v.metalness,v.roughnessMap&&(e.roughnessMap.value=v.roughnessMap),v.metalnessMap&&(e.metalnessMap.value=v.metalnessMap),v.emissiveMap&&(e.emissiveMap.value=v.emissiveMap),v.bumpMap&&(e.bumpMap.value=v.bumpMap,e.bumpScale.value=v.bumpScale),v.normalMap&&(e.normalMap.value=v.normalMap,e.normalScale.value.copy(v.normalScale)),v.displacementMap&&(e.displacementMap.value=v.displacementMap,e.displacementScale.value=v.displacementScale,
e.displacementBias.value=v.displacementBias),v.envMap&&(e.envMapIntensity.value=v.envMapIntensity)):v.isMeshDepthMaterial?(p(e,v),v.displacementMap&&(e.displacementMap.value=v.displacementMap,e.displacementScale.value=v.displacementScale,e.displacementBias.value=v.displacementBias)):v.isMeshDistanceMaterial?(p(e,v),v.displacementMap&&(e.displacementMap.value=v.displacementMap,e.displacementScale.value=v.displacementScale,e.displacementBias.value=v.displacementBias),e.referencePosition.value.copy(v.referencePosition),
e.nearDistance.value=v.nearDistance,e.farDistance.value=v.farDistance):v.isMeshNormalMaterial?(p(e,v),v.bumpMap&&(e.bumpMap.value=v.bumpMap,e.bumpScale.value=v.bumpScale),v.normalMap&&(e.normalMap.value=v.normalMap,e.normalScale.value.copy(v.normalScale)),v.displacementMap&&(e.displacementMap.value=v.displacementMap,e.displacementScale.value=v.displacementScale,e.displacementBias.value=v.displacementBias)):v.isLineBasicMaterial?(e.diffuse.value=v.color,e.opacity.value=v.opacity,v.isLineDashedMaterial&&
(e.dashSize.value=v.dashSize,e.totalSize.value=v.dashSize+v.gapSize,e.scale.value=v.scale)):v.isPointsMaterial?(e.diffuse.value=v.color,e.opacity.value=v.opacity,e.size.value=v.size*ba,e.scale.value=0.5*ca,e.map.value=v.map,null!==v.map&&(!0===v.map.matrixAutoUpdate&&(b=v.map.offset,t=v.map.repeat,d=v.map.center,v.map.matrix.setUvTransform(b.x,b.y,t.x,t.y,v.map.rotation,d.x,d.y)),e.uvTransform.value.copy(v.map.matrix))):v.isShadowMaterial&&(e.color.value=v.color,e.opacity.value=v.opacity),void 0!==
e.ltc_1&&(e.ltc_1.value=ta.LTC_1),void 0!==e.ltc_2&&(e.ltc_2.value=ta.LTC_2),Xa.upload(Y,c.uniformsList,e,L));u.setValue(Y,"modelViewMatrix",C.modelViewMatrix);u.setValue(Y,"normalMatrix",C.normalMatrix);u.setValue(Y,"modelMatrix",C.matrixWorld);return S}function p(a,v){a.opacity.value=v.opacity;v.color&&(a.diffuse.value=v.color);v.emissive&&a.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity);v.map&&(a.map.value=v.map);v.alphaMap&&(a.alphaMap.value=v.alphaMap);v.specularMap&&(a.specularMap.value=
v.specularMap);v.envMap&&(a.envMap.value=v.envMap,a.flipEnvMap.value=v.envMap&&v.envMap.isCubeTexture?-1:1,a.reflectivity.value=v.reflectivity,a.refractionRatio.value=v.refractionRatio);v.lightMap&&(a.lightMap.value=v.lightMap,a.lightMapIntensity.value=v.lightMapIntensity);v.aoMap&&(a.aoMap.value=v.aoMap,a.aoMapIntensity.value=v.aoMapIntensity);var b;v.map?b=v.map:v.specularMap?b=v.specularMap:v.displacementMap?b=v.displacementMap:v.normalMap?b=v.normalMap:v.bumpMap?b=v.bumpMap:v.roughnessMap?b=v.roughnessMap:
v.metalnessMap?b=v.metalnessMap:v.alphaMap?b=v.alphaMap:v.emissiveMap&&(b=v.emissiveMap);if(void 0!==b){b.isWebGLRenderTarget&&(b=b.texture);if(!0===b.matrixAutoUpdate){var C=b.offset,c=b.repeat,y=b.center;b.matrix.setUvTransform(C.x,C.y,c.x,c.y,b.rotation,y.x,y.y)}a.uvTransform.value.copy(b.matrix)}}function s(a,v){a.specular.value=v.specular;a.shininess.value=Math.max(v.shininess,1E-4);v.emissiveMap&&(a.emissiveMap.value=v.emissiveMap);v.bumpMap&&(a.bumpMap.value=v.bumpMap,a.bumpScale.value=v.bumpScale);
v.normalMap&&(a.normalMap.value=v.normalMap,a.normalScale.value.copy(v.normalScale));v.displacementMap&&(a.displacementMap.value=v.displacementMap,a.displacementScale.value=v.displacementScale,a.displacementBias.value=v.displacementBias)}console.log("THREE.WebGLRenderer",Wa);a=a||{};var q=void 0!==a.canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==a.context?a.context:null,w=void 0!==a.alpha?a.alpha:!1,A=void 0!==a.depth?a.depth:!0,E=void 0!==a.stencil?a.stencil:
!0,F=void 0!==a.antialias?a.antialias:!1,P=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,Z=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,I=void 0!==a.powerPreference?a.powerPreference:"default",H=[],K=[],J=null,G=[];this.domElement=q;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=
!1;this.toneMapping=ug;this.toneMappingWhitePoint=this.toneMappingExposure=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var L=this,O=!1,N=null,R=null,$=-1,T="",V=null,Q=null,U=new B,da=new B,ea=null,M=0,X=q.width,ca=q.height,ba=1,fa=new B(0,0,X,ca),ka=new B(0,0,X,ca),ia=!1,ja=new Bb,ga=new Zd,Pa=!1,ma=!1,qa=new d,na=new e,ya={geometries:0,textures:0},la={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:la,memory:ya,programs:null,autoReset:!0,reset:function(){la.frame++;la.calls=0;
la.vertices=0;la.faces=0;la.points=0}};var Y;try{w={alpha:w,depth:A,stencil:E,antialias:F,premultipliedAlpha:P,preserveDrawingBuffer:Z,powerPreference:I};q.addEventListener("webglcontextlost",c,!1);q.addEventListener("webglcontextrestored",t,!1);Y=r||q.getContext("webgl",w)||q.getContext("experimental-webgl",w);if(null===Y){if(null!==q.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}void 0===Y.getShaderPrecisionFormat&&
(Y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ra){console.error("THREE.WebGLRenderer: "+ra.message)}var ha,oa,aa,sa,xa,wa,Ia,Fa,pa,nb,Da,Ea,Ga,Qa,Ja,Ka,Aa;b();var za=new Tf(L);this.vr=za;var La=new Kc(L,Fa,oa.maxTextureSize);this.shadowMap=La;this.getContext=function(){return Y};this.getContextAttributes=function(){return Y.getContextAttributes()};this.forceContextLoss=function(){var a=ha.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=
function(){var a=ha.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return ba};this.setPixelRatio=function(a){void 0!==a&&(ba=a,this.setSize(X,ca,!1))};this.getSize=function(){return{width:X,height:ca}};this.setSize=function(a,v,b){var C=za.getDevice();C&&C.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(X=a,ca=v,q.width=a*ba,q.height=v*ba,!1!==b&&(q.style.width=a+"px",q.style.height=v+"px"),this.setViewport(0,0,a,
v))};this.getDrawingBufferSize=function(){return{width:X*ba,height:ca*ba}};this.setDrawingBufferSize=function(a,v,b){X=a;ca=v;ba=b;q.width=a*b;q.height=v*b;this.setViewport(0,0,a,v)};this.getCurrentViewport=function(){return U};this.setViewport=function(a,v,b,C){fa.set(a,ca-v-C,b,C);aa.viewport(U.copy(fa).multiplyScalar(ba))};this.setScissor=function(a,v,b,C){ka.set(a,ca-v-C,b,C);aa.scissor(da.copy(ka).multiplyScalar(ba))};this.setScissorTest=function(a){aa.setScissorTest(ia=a)};this.getClearColor=
function(){return Ea.getClearColor()};this.setClearColor=function(){Ea.setClearColor.apply(Ea,arguments)};this.getClearAlpha=function(){return Ea.getClearAlpha()};this.setClearAlpha=function(){Ea.setClearAlpha.apply(Ea,arguments)};this.clear=function(a,v,b){var C=0;if(void 0===a||a)C|=Y.COLOR_BUFFER_BIT;if(void 0===v||v)C|=Y.DEPTH_BUFFER_BIT;if(void 0===b||b)C|=Y.STENCIL_BUFFER_BIT;Y.clear(C)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=
function(){this.clear(!1,!1,!0)};this.clearTarget=function(a,v,b,C){this.setRenderTarget(a);this.clear(v,b,C)};this.dispose=function(){q.removeEventListener("webglcontextlost",c,!1);q.removeEventListener("webglcontextrestored",t,!1);Da.dispose();sa.dispose();Fa.dispose();za.dispose()};this.renderBufferImmediate=function(a,v,b){aa.initAttributes();var C=sa.get(a);a.hasPositions&&!C.position&&(C.position=Y.createBuffer());a.hasNormals&&!C.normal&&(C.normal=Y.createBuffer());a.hasUvs&&!C.uv&&(C.uv=Y.createBuffer());
a.hasColors&&!C.color&&(C.color=Y.createBuffer());v=v.getAttributes();a.hasPositions&&(Y.bindBuffer(Y.ARRAY_BUFFER,C.position),Y.bufferData(Y.ARRAY_BUFFER,a.positionArray,Y.DYNAMIC_DRAW),aa.enableAttribute(v.position),Y.vertexAttribPointer(v.position,3,Y.FLOAT,!1,0,0));if(a.hasNormals){Y.bindBuffer(Y.ARRAY_BUFFER,C.normal);if(!b.isMeshPhongMaterial&&!b.isMeshStandardMaterial&&!b.isMeshNormalMaterial&&!0===b.flatShading)for(var c=0,y=3*a.count;c<y;c+=9){var t=a.normalArray,d=(t[c+0]+t[c+3]+t[c+6])/
3,S=(t[c+1]+t[c+4]+t[c+7])/3,e=(t[c+2]+t[c+5]+t[c+8])/3;t[c+0]=d;t[c+1]=S;t[c+2]=e;t[c+3]=d;t[c+4]=S;t[c+5]=e;t[c+6]=d;t[c+7]=S;t[c+8]=e}Y.bufferData(Y.ARRAY_BUFFER,a.normalArray,Y.DYNAMIC_DRAW);aa.enableAttribute(v.normal);Y.vertexAttribPointer(v.normal,3,Y.FLOAT,!1,0,0)}a.hasUvs&&b.map&&(Y.bindBuffer(Y.ARRAY_BUFFER,C.uv),Y.bufferData(Y.ARRAY_BUFFER,a.uvArray,Y.DYNAMIC_DRAW),aa.enableAttribute(v.uv),Y.vertexAttribPointer(v.uv,2,Y.FLOAT,!1,0,0));a.hasColors&&b.vertexColors!==td&&(Y.bindBuffer(Y.ARRAY_BUFFER,
C.color),Y.bufferData(Y.ARRAY_BUFFER,a.colorArray,Y.DYNAMIC_DRAW),aa.enableAttribute(v.color),Y.vertexAttribPointer(v.color,3,Y.FLOAT,!1,0,0));aa.disableUnusedAttributes();Y.drawArrays(Y.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,v,b,C,c,y){var t=c.isMesh&&0>c.matrixWorld.determinant();aa.setMaterial(C,t);var d=n(a,v,C,c);a=b.id+"_"+d.id+"_"+(!0===C.wireframe);var S=!1;a!==T&&(T=a,S=!0);c.morphTargetInfluences&&(Ga.update(c,b,C,d),S=!0);var t=b.index,e=b.attributes.position;
v=1;!0===C.wireframe&&(t=Ia.getWireframeAttribute(b),v=2);var u;a=Qa;null!==t&&(u=wa.get(t),a=Ja,a.setIndex(u));if(S){S=void 0;if(b&&b.isInstancedBufferGeometry&&null===ha.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===S&&(S=0);aa.initAttributes();var f=b.attributes,d=d.getAttributes(),ua=C.defaultAttributeValues,g;for(g in d){var W=d[g];if(0<=
W){var h=f[g];if(void 0!==h){var va=h.normalized,k=h.itemSize,l=wa.get(h);if(void 0!==l){var Xg=l.buffer,m=l.type,l=l.bytesPerElement;if(h.isInterleavedBufferAttribute){var Ca=h.data,Zh=Ca.stride,h=h.offset;Ca&&Ca.isInstancedInterleavedBuffer?(aa.enableAttributeAndDivisor(W,Ca.meshPerAttribute),void 0===b.maxInstancedCount&&(b.maxInstancedCount=Ca.meshPerAttribute*Ca.count)):aa.enableAttribute(W);Y.bindBuffer(Y.ARRAY_BUFFER,Xg);Y.vertexAttribPointer(W,k,m,va,Zh*l,(S*Zh+h)*l)}else h.isInstancedBufferAttribute?
(aa.enableAttributeAndDivisor(W,h.meshPerAttribute),void 0===b.maxInstancedCount&&(b.maxInstancedCount=h.meshPerAttribute*h.count)):aa.enableAttribute(W),Y.bindBuffer(Y.ARRAY_BUFFER,Xg),Y.vertexAttribPointer(W,k,m,va,0,S*k*l)}}else if(void 0!==ua&&(va=ua[g],void 0!==va))switch(va.length){case 2:Y.vertexAttrib2fv(W,va);break;case 3:Y.vertexAttrib3fv(W,va);break;case 4:Y.vertexAttrib4fv(W,va);break;default:Y.vertexAttrib1fv(W,va)}}}aa.disableUnusedAttributes()}null!==t&&Y.bindBuffer(Y.ELEMENT_ARRAY_BUFFER,
u.buffer)}u=Infinity;null!==t?u=t.count:void 0!==e&&(u=e.count);g=b.drawRange.start*v;t=b.drawRange.count*v;e=null!==y?y.start*v:0;v=null!==y?y.count*v:Infinity;y=Math.max(g,e);v=Math.min(u,g+t,e+v)-1;v=Math.max(0,v-y+1);if(0!==v){if(c.isMesh)if(!0===C.wireframe)aa.setLineWidth(C.wireframeLinewidth*(null===N?ba:1)),a.setMode(Y.LINES);else switch(c.drawMode){case vh:a.setMode(Y.TRIANGLES);break;case Uh:a.setMode(Y.TRIANGLE_STRIP);break;case Vh:a.setMode(Y.TRIANGLE_FAN)}else c.isLine?(C=C.linewidth,
void 0===C&&(C=1),aa.setLineWidth(C*(null===N?ba:1)),c.isLineSegments?a.setMode(Y.LINES):c.isLineLoop?a.setMode(Y.LINE_LOOP):a.setMode(Y.LINE_STRIP)):c.isPoints&&a.setMode(Y.POINTS);b&&b.isInstancedBufferGeometry?0<b.maxInstancedCount&&a.renderInstances(b,y,v):a.render(y,v)}};this.compile=function(a,v){H.length=0;K.length=0;a.traverse(function(a){a.isLight&&(H.push(a),a.castShadow&&K.push(a))});pa.setup(H,K,v);a.traverse(function(v){if(v.material)if(Array.isArray(v.material))for(var b=0;b<v.material.length;b++)m(v.material[b],
a.fog,v);else m(v.material,a.fog,v)})};var Na=!1,Ma=null;this.animate=function(a){Ma=a;Na||((a=za.getDevice())&&a.isPresenting?a.requestAnimationFrame(g):window.requestAnimationFrame(g),Na=!0)};this.render=function(a,v,b,C){if(!v||!v.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!O){T="";$=-1;V=null;!0===a.autoUpdate&&a.updateMatrixWorld();null===v.parent&&v.updateMatrixWorld();za.enabled&&(v=za.getCamera(v));a.onBeforeRender(L,a,v,b);qa.multiplyMatrices(v.projectionMatrix,
v.matrixWorldInverse);ja.setFromMatrix(qa);H.length=0;K.length=0;G.length=0;ma=this.localClippingEnabled;Pa=ga.init(this.clippingPlanes,ma,v);J=Da.get(a,v);J.init();h(a,v,L.sortObjects);!0===L.sortObjects&&J.sort();Pa&&ga.beginShadows();La.render(K,a,v);pa.setup(H,K,v);Pa&&ga.endShadows();this.info.autoReset&&this.info.reset();void 0===b&&(b=null);this.setRenderTarget(b);Ea.render(J,a,v,C);C=J.opaque;var c=J.transparent;if(a.overrideMaterial){var y=a.overrideMaterial;C.length&&k(C,a,v,y);c.length&&
k(c,a,v,y)}else C.length&&k(C,a,v),c.length&&k(c,a,v);Ka.render(G,a,v);b&&xa.updateRenderTargetMipmap(b);aa.buffers.depth.setTest(!0);aa.buffers.depth.setMask(!0);aa.buffers.color.setMask(!0);aa.setPolygonOffset(!1);a.onAfterRender(L,a,v);za.enabled&&za.submitFrame();J=null}};this.setFaceCulling=function(a,v){aa.setCullFace(a);aa.setFlipSided(v===rc)};this.allocTextureUnit=function(){var a=M;a>=oa.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+a+" texture units while this GPU supports only "+
oa.maxTextures);M+=1;return a};this.setTexture2D=function(){var a=!1;return function(v,b){v&&v.isWebGLRenderTarget&&(a||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),a=!0),v=v.texture);xa.setTexture2D(v,b)}}();this.setTexture=function(){var a=!1;return function(v,b){a||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),a=!0);xa.setTexture2D(v,b)}}();this.setTextureCube=function(){var a=
!1;return function(v,b){v&&v.isWebGLRenderTargetCube&&(a||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),a=!0),v=v.texture);v&&v.isCubeTexture||Array.isArray(v.image)&&6===v.image.length?xa.setTextureCube(v,b):xa.setTextureCubeDynamic(v,b)}}();this.getRenderTarget=function(){return N};this.setRenderTarget=function(a){(N=a)&&void 0===sa.get(a).__webglFramebuffer&&xa.setupRenderTarget(a);var v=null,b=!1;a?(v=sa.get(a).__webglFramebuffer,
a.isWebGLRenderTargetCube&&(v=v[a.activeCubeFace],b=!0),U.copy(a.viewport),da.copy(a.scissor),ea=a.scissorTest):(U.copy(fa).multiplyScalar(ba),da.copy(ka).multiplyScalar(ba),ea=ia);R!==v&&(Y.bindFramebuffer(Y.FRAMEBUFFER,v),R=v);aa.viewport(U);aa.scissor(da);aa.setScissorTest(ea);b&&(b=sa.get(a.texture),Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,b.__webglTexture,a.activeMipMapLevel))};this.readRenderTargetPixels=function(a,v,b,C,c,y){if(a&&
a.isWebGLRenderTarget){var t=sa.get(a).__webglFramebuffer;if(t){var d=!1;t!==R&&(Y.bindFramebuffer(Y.FRAMEBUFFER,t),d=!0);try{var S=a.texture,e=S.format,u=S.type;e!==kc&&Aa.convert(e)!==Y.getParameter(Y.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):u===Nd||Aa.convert(u)===Y.getParameter(Y.IMPLEMENTATION_COLOR_READ_TYPE)||u===Zc&&(ha.get("OES_texture_float")||ha.get("WEBGL_color_buffer_float"))||
u===ue&&ha.get("EXT_color_buffer_half_float")?Y.checkFramebufferStatus(Y.FRAMEBUFFER)===Y.FRAMEBUFFER_COMPLETE?0<=v&&v<=a.width-C&&0<=b&&b<=a.height-c&&Y.readPixels(v,b,C,c,Aa.convert(e),Aa.convert(u),y):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{d&&Y.bindFramebuffer(Y.FRAMEBUFFER,
R)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=function(a,v,b){var C=v.image.width,c=v.image.height,y=Aa.convert(v.format);this.setTexture2D(v,0);Y.copyTexImage2D(Y.TEXTURE_2D,b||0,y,a.x,a.y,C,c,0)}}function vd(a,b){this.name="";this.color=new X(a);this.density=void 0!==b?b:2.5E-4}function Bc(a,b,c){this.name="";this.color=new X(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function nc(){U.call(this);
this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function bd(a){aa.call(this);this.type="SpriteMaterial";this.color=new X(16777215);this.map=null;this.rotation=0;this.lights=this.fog=!1;this.setValues(a)}function Be(a){U.call(this);this.type="Sprite";this.material=void 0!==a?a:new bd;this.center=new c(0.5,0.5)}function Ce(){U.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function dd(a,b){a=a||[];this.bones=a.slice(0);
this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length.");this.boneInverses=[];for(var c=0,t=this.bones.length;c<t;c++)this.boneInverses.push(new d)}}function qf(){U.call(this);this.type="Bone"}function sf(a,b){ga.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new d;this.bindMatrixInverse=new d;
var c=this.initBones(),c=new dd(c);this.bind(c,this.matrixWorld);this.normalizeSkinWeights()}function Ka(a){aa.call(this);this.type="LineBasicMaterial";this.color=new X(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=!1;this.setValues(a)}function Sb(a,b,c){if(1===c)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ra(a,b);U.call(this);this.type="Line";this.geometry=void 0!==a?a:new ba;this.material=
void 0!==b?b:new Ka({color:16777215*Math.random()})}function Ra(a,b){Sb.call(this,a,b);this.type="LineSegments"}function Xb(a,b){Sb.call(this,a,b);this.type="LineLoop"}function oc(a){aa.call(this);this.type="PointsMaterial";this.color=new X(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.lights=!1;this.setValues(a)}function xd(a,b){U.call(this);this.type="Points";this.geometry=void 0!==a?a:new ba;this.material=void 0!==b?b:new oc({color:16777215*Math.random()})}function kf(){U.call(this);
this.type="Group"}function zg(a,b,c,t,d,e,f,g,h){n.call(this,a,b,c,t,d,e,f,g,h);this.generateMipmaps=!1}function pc(a,b,c,t,d,e,f,g,h,k,l,m){n.call(this,null,e,f,g,h,k,t,d,l,m);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function cd(a,b,c,t,d,e,f,g,h,k){k=void 0!==k?k:rd;if(k!==rd&&k!==Ab)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&k===rd&&(c=Qe);void 0===c&&k===Ab&&(c=Kf);n.call(this,null,t,d,e,f,
g,k,c,h);this.image={width:a,height:b};this.magFilter=void 0!==f?f:wa;this.minFilter=void 0!==g?g:wa;this.generateMipmaps=this.flipY=!1}function wd(a){ba.call(this);this.type="WireframeGeometry";var b=[],c,t,d,u,f=[0,0],g={},h,k,l=["a","b","c"];if(a&&a.isGeometry){var m=a.faces;c=0;for(d=m.length;c<d;c++){var n=m[c];for(t=0;3>t;t++)h=n[l[t]],k=n[l[(t+1)%3]],f[0]=Math.min(h,k),f[1]=Math.max(h,k),h=f[0]+","+f[1],void 0===g[h]&&(g[h]={index1:f[0],index2:f[1]})}for(h in g)c=g[h],l=a.vertices[c.index1],
b.push(l.x,l.y,l.z),l=a.vertices[c.index2],b.push(l.x,l.y,l.z)}else if(a&&a.isBufferGeometry){var p,l=new e;if(null!==a.index){m=a.attributes.position;n=a.index;p=a.groups;0===p.length&&(p=[{start:0,count:n.count,materialIndex:0}]);a=0;for(u=p.length;a<u;++a)for(c=p[a],t=c.start,d=c.count,c=t,d=t+d;c<d;c+=3)for(t=0;3>t;t++)h=n.getX(c+t),k=n.getX(c+(t+1)%3),f[0]=Math.min(h,k),f[1]=Math.max(h,k),h=f[0]+","+f[1],void 0===g[h]&&(g[h]={index1:f[0],index2:f[1]});for(h in g)c=g[h],l.fromBufferAttribute(m,
c.index1),b.push(l.x,l.y,l.z),l.fromBufferAttribute(m,c.index2),b.push(l.x,l.y,l.z)}else for(m=a.attributes.position,c=0,d=m.count/3;c<d;c++)for(t=0;3>t;t++)g=3*c+t,l.fromBufferAttribute(m,g),b.push(l.x,l.y,l.z),g=3*c+(t+1)%3,l.fromBufferAttribute(m,g),b.push(l.x,l.y,l.z)}this.addAttribute("position",new da(b,3))}function $d(a,b,c){ma.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};this.fromBufferGeometry(new ae(a,b,c));this.mergeVertices()}function ae(a,b,c){ba.call(this);
this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var t=[],d=[],u=[],f=[],g=new e,h=new e,k=new e,l=new e,m=new e,n,p,s=b+1;for(n=0;n<=c;n++){var q=n/c;for(p=0;p<=b;p++){var r=p/b,h=a(r,q,h);d.push(h.x,h.y,h.z);0<=r-1E-5?(k=a(r-1E-5,q,k),l.subVectors(h,k)):(k=a(r+1E-5,q,k),l.subVectors(k,h));0<=q-1E-5?(k=a(r,q-1E-5,k),m.subVectors(h,k)):(k=a(r,q+1E-5,k),m.subVectors(k,h));g.crossVectors(l,m).normalize();u.push(g.x,g.y,g.z);f.push(r,q)}}for(n=0;n<c;n++)for(p=0;p<b;p++)a=
n*s+p+1,g=(n+1)*s+p+1,h=(n+1)*s+p,t.push(n*s+p,a,h),t.push(a,g,h);this.setIndex(t);this.addAttribute("position",new da(d,3));this.addAttribute("normal",new da(u,3));this.addAttribute("uv",new da(f,2))}function be(a,b,c,t){ma.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:t};this.fromBufferGeometry(new sb(a,b,c,t));this.mergeVertices()}function sb(a,b,y,t){function d(a){g.push(a.x,a.y,a.z)}function u(b,c){var C=3*b;c.x=a[C+0];c.y=a[C+1];c.z=a[C+2]}function f(a,
v,b,c){0>c&&1===a.x&&(h[v]=a.x-1);0===b.x&&0===b.z&&(h[v]=c/2/Math.PI+0.5)}ba.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,indices:b,radius:y,detail:t};y=y||1;t=t||0;var g=[],h=[];(function(a){for(var v=new e,c=new e,y=new e,t=0;t<b.length;t+=3){u(b[t+0],v);u(b[t+1],c);u(b[t+2],y);for(var f=v,g=c,ua=y,h=Math.pow(2,a),W=[],va=void 0,k=void 0,va=0;va<=h;va++){W[va]=[];for(var l=f.clone().lerp(ua,va/h),m=g.clone().lerp(ua,va/h),n=h-va,k=0;k<=n;k++)W[va][k]=0===k&&va===
h?l:l.clone().lerp(m,k/n)}for(va=0;va<h;va++)for(k=0;k<2*(h-va)-1;k++)f=Math.floor(k/2),0===k%2?(d(W[va][f+1]),d(W[va+1][f]),d(W[va][f])):(d(W[va][f+1]),d(W[va+1][f+1]),d(W[va+1][f]))}})(t);(function(a){for(var v=new e,b=0;b<g.length;b+=3)v.x=g[b+0],v.y=g[b+1],v.z=g[b+2],v.normalize().multiplyScalar(a),g[b+0]=v.x,g[b+1]=v.y,g[b+2]=v.z})(y);(function(){for(var a=new e,v=0;v<g.length;v+=3){a.x=g[v+0];a.y=g[v+1];a.z=g[v+2];var b=Math.atan2(a.z,-a.x)/2/Math.PI+0.5,C=Math.atan2(-a.y,Math.sqrt(a.x*a.x+
a.z*a.z))/Math.PI+0.5;h.push(b,1-C)}for(var a=new e,v=new e,b=new e,C=new e,y=new c,t=new c,d=new c,S=0,u=0;S<g.length;S+=9,u+=6){a.set(g[S+0],g[S+1],g[S+2]);v.set(g[S+3],g[S+4],g[S+5]);b.set(g[S+6],g[S+7],g[S+8]);y.set(h[u+0],h[u+1]);t.set(h[u+2],h[u+3]);d.set(h[u+4],h[u+5]);C.copy(a).add(v).add(b).divideScalar(3);var k=Math.atan2(C.z,-C.x);f(y,u+0,a,k);f(t,u+2,v,k);f(d,u+4,b,k)}for(a=0;a<h.length;a+=6)v=h[a+0],b=h[a+2],C=h[a+4],y=Math.max(v,b,C),t=Math.min(v,b,C),0.9<y&&0.1>t&&(0.2>v&&(h[a+0]+=
1),0.2>b&&(h[a+2]+=1),0.2>C&&(h[a+4]+=1))})();this.addAttribute("position",new da(g,3));this.addAttribute("normal",new da(g.slice(),3));this.addAttribute("uv",new da(h,2));0===t?this.computeVertexNormals():this.normalizeNormals()}function Cc(a,b){ma.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Oc(a,b));this.mergeVertices()}function Oc(a,b){sb.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";
this.parameters={radius:a,detail:b}}function De(a,b){ma.call(this);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new yd(a,b));this.mergeVertices()}function yd(a,b){sb.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function tf(a,b){ma.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new zd(a,
b));this.mergeVertices()}function zd(a,b){var c=(1+Math.sqrt(5))/2;sb.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Ee(a,b){ma.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new de(a,
b));this.mergeVertices()}function de(a,b){var c=(1+Math.sqrt(5))/2,t=1/c;sb.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-t,-c,0,-t,c,0,t,-c,0,t,c,-t,-c,0,-t,c,0,t,-c,0,t,c,0,-c,0,-t,c,0,-t,-c,0,t,c,0,t],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,
b);this.type="DodecahedronBufferGeometry";this.parameters={radius:a,detail:b}}function ce(a,b,c,t,d,e){ma.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:t,closed:d};void 0!==e&&console.warn("THREE.TubeGeometry: taper has been removed.");a=new Pc(a,b,c,t,d);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function Pc(a,b,y,t,d){function u(c){l=a.getPointAt(c/b,l);var d=f.normals[c];
c=f.binormals[c];for(n=0;n<=t;n++){var S=n/t*Math.PI*2,e=Math.sin(S),S=-Math.cos(S);h.x=S*d.x+e*c.x;h.y=S*d.y+e*c.y;h.z=S*d.z+e*c.z;h.normalize();s.push(h.x,h.y,h.z);g.x=l.x+y*h.x;g.y=l.y+y*h.y;g.z=l.z+y*h.z;p.push(g.x,g.y,g.z)}}ba.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:y,radialSegments:t,closed:d};b=b||64;y=y||1;t=t||8;d=d||!1;var f=a.computeFrenetFrames(b,d);this.tangents=f.tangents;this.normals=f.normals;this.binormals=f.binormals;var g=new e,
h=new e,k=new c,l=new e,m,n,p=[],s=[],q=[],r=[];for(m=0;m<b;m++)u(m);u(!1===d?b:0);for(m=0;m<=b;m++)for(n=0;n<=t;n++)k.x=m/b,k.y=n/t,q.push(k.x,k.y);(function(){for(n=1;n<=b;n++)for(m=1;m<=t;m++){var a=(t+1)*n+(m-1),v=(t+1)*n+m,c=(t+1)*(n-1)+m;r.push((t+1)*(n-1)+(m-1),a,c);r.push(a,v,c)}})();this.setIndex(r);this.addAttribute("position",new da(p,3));this.addAttribute("normal",new da(s,3));this.addAttribute("uv",new da(q,2))}function Ad(a,b,c,t,d,e,f){ma.call(this);this.type="TorusKnotGeometry";this.parameters=
{radius:a,tube:b,tubularSegments:c,radialSegments:t,p:d,q:e};void 0!==f&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new ee(a,b,c,t,d,e));this.mergeVertices()}function ee(a,b,c,t,d,u){function f(a,b,v,c,C){var y=Math.cos(a),t=Math.sin(a);a*=v/b;b=Math.cos(a);C.x=c*(2+b)*0.5*y;C.y=c*(2+b)*t*0.5;C.z=c*Math.sin(a)*0.5}ba.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,
radialSegments:t,p:d,q:u};a=a||1;b=b||0.4;c=Math.floor(c)||64;t=Math.floor(t)||8;d=d||2;u=u||3;var g=[],h=[],k=[],l=[],m,n,p=new e,s=new e,q=new e,r=new e,w=new e,x=new e,B=new e;for(m=0;m<=c;++m)for(n=m/c*d*Math.PI*2,f(n,d,u,a,q),f(n+0.01,d,u,a,r),x.subVectors(r,q),B.addVectors(r,q),w.crossVectors(x,B),B.crossVectors(w,x),w.normalize(),B.normalize(),n=0;n<=t;++n){var z=n/t*Math.PI*2,A=-b*Math.cos(z),z=b*Math.sin(z);p.x=q.x+(A*B.x+z*w.x);p.y=q.y+(A*B.y+z*w.y);p.z=q.z+(A*B.z+z*w.z);h.push(p.x,p.y,
p.z);s.subVectors(p,q).normalize();k.push(s.x,s.y,s.z);l.push(m/c);l.push(n/t)}for(n=1;n<=c;n++)for(m=1;m<=t;m++)a=(t+1)*n+(m-1),b=(t+1)*n+m,d=(t+1)*(n-1)+m,g.push((t+1)*(n-1)+(m-1),a,d),g.push(a,b,d);this.setIndex(g);this.addAttribute("position",new da(h,3));this.addAttribute("normal",new da(k,3));this.addAttribute("uv",new da(l,2))}function fe(a,b,c,t,d){ma.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:t,arc:d};this.fromBufferGeometry(new ge(a,
b,c,t,d));this.mergeVertices()}function ge(a,b,c,t,d){ba.call(this);this.type="TorusBufferGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:t,arc:d};a=a||1;b=b||0.4;c=Math.floor(c)||8;t=Math.floor(t)||6;d=d||2*Math.PI;var u=[],f=[],g=[],h=[],k=new e,l=new e,m=new e,n,p;for(n=0;n<=c;n++)for(p=0;p<=t;p++){var q=p/t*d,s=n/c*Math.PI*2;l.x=(a+b*Math.cos(s))*Math.cos(q);l.y=(a+b*Math.cos(s))*Math.sin(q);l.z=b*Math.sin(s);f.push(l.x,l.y,l.z);k.x=a*Math.cos(q);k.y=a*Math.sin(q);
m.subVectors(l,k).normalize();g.push(m.x,m.y,m.z);h.push(p/t);h.push(n/c)}for(n=1;n<=c;n++)for(p=1;p<=t;p++)a=(t+1)*(n-1)+p-1,b=(t+1)*(n-1)+p,d=(t+1)*n+p,u.push((t+1)*n+p-1,a,d),u.push(a,b,d);this.setIndex(u);this.addAttribute("position",new da(f,3));this.addAttribute("normal",new da(g,3));this.addAttribute("uv",new da(h,2))}function Ag(a,b,c,t,d){for(var e,f=0,g=b,h=c-t;g<c;g+=t)f+=(a[h]-a[g])*(a[g+1]+a[h+1]),h=g;if(d===0<f)for(d=b;d<c;d+=t)e=Cg(d,a[d],a[d+1],e);else for(d=c-t;d>=b;d-=t)e=Cg(d,a[d],
a[d+1],e);e&&gc(e,e.next)&&(Sc(e),e=e.next);return e}function he(a,b){if(!a)return a;b||(b=a);var c=a,t;do if(t=!1,c.steiner||!gc(c,c.next)&&0!==Lb(c.prev,c,c.next))c=c.next;else{Sc(c);c=b=c.prev;if(c===c.next)break;t=!0}while(t||c!==b);return b}function Cd(a,b,c,t,d,e,f){if(a){if(!f&&e){var g=a,h=g;do null===h.z&&(h.z=Fe(h.x,h.y,t,d,e)),h.prevZ=h.prev,h=h.nextZ=h.next;while(h!==g);h.prevZ.nextZ=null;h.prevZ=null;var g=h,k,l,m,n,p,q,s=1;do{h=g;m=g=null;for(n=0;h;){n++;l=h;for(k=p=0;k<s&&(p++,l=l.nextZ,
l);k++);for(q=s;0<p||0<q&&l;)0!==p&&(0===q||!l||h.z<=l.z)?(k=h,h=h.nextZ,p--):(k=l,l=l.nextZ,q--),m?m.nextZ=k:g=k,k.prevZ=m,m=k;h=l}m.nextZ=null;s*=2}while(1<n)}for(g=a;a.prev!==a.next;){h=a.prev;l=a.next;if(e)a:{m=a;q=t;var r=d,w=e;n=m.prev;p=m;s=m.next;if(0<=Lb(n,p,s))m=!1;else{var x=n.x>p.x?n.x>s.x?n.x:s.x:p.x>s.x?p.x:s.x,B=n.y>p.y?n.y>s.y?n.y:s.y:p.y>s.y?p.y:s.y;k=Fe(n.x<p.x?n.x<s.x?n.x:s.x:p.x<s.x?p.x:s.x,n.y<p.y?n.y<s.y?n.y:s.y:p.y<s.y?p.y:s.y,q,r,w);q=Fe(x,B,q,r,w);for(r=m.nextZ;r&&r.z<=q;){if(r!==
m.prev&&r!==m.next&&Dd(n.x,n.y,p.x,p.y,s.x,s.y,r.x,r.y)&&0<=Lb(r.prev,r,r.next)){m=!1;break a}r=r.nextZ}for(r=m.prevZ;r&&r.z>=k;){if(r!==m.prev&&r!==m.next&&Dd(n.x,n.y,p.x,p.y,s.x,s.y,r.x,r.y)&&0<=Lb(r.prev,r,r.next)){m=!1;break a}r=r.prevZ}m=!0}}else a:if(m=a,n=m.prev,p=m,s=m.next,0<=Lb(n,p,s))m=!1;else{for(k=m.next.next;k!==m.prev;){if(Dd(n.x,n.y,p.x,p.y,s.x,s.y,k.x,k.y)&&0<=Lb(k.prev,k,k.next)){m=!1;break a}k=k.next}m=!0}if(m)b.push(h.i/c),b.push(a.i/c),b.push(l.i/c),Sc(a),g=a=l.next;else if(a=
l,a===g){if(!f)Cd(he(a),b,c,t,d,e,1);else if(1===f){f=b;g=c;h=a;do l=h.prev,m=h.next.next,!gc(l,m)&&He(l,h,h.next,m)&&Rc(l,m)&&Rc(m,l)&&(f.push(l.i/g),f.push(h.i/g),f.push(m.i/g),Sc(h),Sc(h.next),h=a=m),h=h.next;while(h!==a);a=h;Cd(a,b,c,t,d,e,2)}else if(2===f)a:{f=a;do{for(g=f.next.next;g!==f.prev;){if(h=f.i!==g.i){h=f;l=g;m=void 0;if(m=h.next.i!==l.i)if(m=void 0,m=h.prev.i!==l.i){m=m=void 0;b:{m=h;do{if(m.i!==h.i&&m.next.i!==h.i&&m.i!==l.i&&m.next.i!==l.i&&He(m,m.next,h,l)){m=!0;break b}m=m.next}while(m!==
h);m=!1}if(m=!m)if(m=void 0,m=Rc(h,l))if(m=void 0,m=Rc(l,h)){m=h;n=!1;p=(h.x+l.x)/2;l=(h.y+l.y)/2;do m.y>l!==m.next.y>l&&m.next.y!==m.y&&p<(m.next.x-m.x)*(l-m.y)/(m.next.y-m.y)+m.x&&(n=!n),m=m.next;while(m!==h);m=n}}h=m}if(h){a=Bg(f,g);f=he(f,f.next);a=he(a,a.next);Cd(f,b,c,t,d,e);Cd(a,b,c,t,d,e);break a}g=g.next}f=f.next}while(f!==a)}break}}}}function Ge(a,b){return a.x-b.x}function uf(a,b){var c=b,t=a.x,d=a.y,e=-Infinity,f;do{if(d<=c.y&&d>=c.next.y&&c.next.y!==c.y){var g=c.x+(d-c.y)*(c.next.x-c.x)/
(c.next.y-c.y);if(g<=t&&g>e){e=g;if(g===t){if(d===c.y)return c;if(d===c.next.y)return c.next}f=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!f)return null;if(t===e)return f.prev;for(var g=f,h=f.x,k=f.y,l=Infinity,m,c=f.next;c!==g;)t>=c.x&&c.x>=h&&t!==c.x&&Dd(d<k?t:e,d,h,k,d<k?e:t,d,c.x,c.y)&&(m=Math.abs(d-c.y)/(t-c.x),(m<l||m===l&&c.x>f.x)&&Rc(c,a)&&(f=c,l=m)),c=c.next;return f}function Fe(a,b,c,t,d){a=32767*(a-c)*d;b=32767*(b-t)*d;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;
b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function jh(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function Dd(a,b,c,t,d,e,f,g){return 0<=(d-f)*(b-g)-(a-f)*(e-g)&&0<=(a-f)*(t-g)-(c-f)*(b-g)&&0<=(c-f)*(e-g)-(d-f)*(t-g)}function Lb(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function gc(a,b){return a.x===b.x&&a.y===b.y}function He(a,b,c,t){return gc(a,b)&&gc(c,t)||gc(a,t)&&gc(c,b)?!0:0<Lb(a,b,c)!==0<Lb(a,
b,t)&&0<Lb(c,t,a)!==0<Lb(c,t,b)}function Rc(a,b){return 0>Lb(a.prev,a,a.next)?0<=Lb(a,b,a.next)&&0<=Lb(a,a.prev,b):0>Lb(a,b,a.prev)||0>Lb(a,a.next,b)}function Bg(a,b){var c=new Ed(a.i,a.x,a.y),t=new Ed(b.i,b.x,b.y),d=a.next,e=b.prev;a.next=b;b.prev=a;c.next=d;d.prev=c;t.next=c;c.prev=t;e.next=t;t.prev=e;return t}function Cg(a,b,c,t){a=new Ed(a,b,c);t?(a.next=t.next,a.prev=t,t.next.prev=a,t.next=a):(a.prev=a,a.next=a);return a}function Sc(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=
a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Ed(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function Tb(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function tb(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}function lb(a,b){ma.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new Sa(a,b));this.mergeVertices()}function Sa(a,b){"undefined"!==typeof a&&(ba.call(this),
this.type="ExtrudeBufferGeometry",a=Array.isArray(a)?a:[a],this.addShapeList(a,b),this.computeVertexNormals())}function xb(a,b){ma.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new hc(a,b));this.mergeVertices()}function hc(a,b){b=b||{};var c=b.font;if(!c||!c.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ma;c=c.generateShapes(a,b.size,b.curveSegments);b.amount=void 0!==b.height?b.height:50;
void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);Sa.call(this,c,b);this.type="TextBufferGeometry"}function qc(a,b,c,t,d,e,f){ma.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:t,phiLength:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new Tc(a,b,c,t,d,e,f));this.mergeVertices()}function Tc(a,b,c,t,d,u,f){ba.call(this);this.type="SphereBufferGeometry";
this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:t,phiLength:d,thetaStart:u,thetaLength:f};a=a||1;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);t=void 0!==t?t:0;d=void 0!==d?d:2*Math.PI;u=void 0!==u?u:0;f=void 0!==f?f:Math.PI;var g=u+f,h,k,l=0,m=[],n=new e,p=new e,s=[],q=[],r=[],w=[];for(k=0;k<=c;k++){var x=[],B=k/c;for(h=0;h<=b;h++){var z=h/b;n.x=-a*Math.cos(t+z*d)*Math.sin(u+B*f);n.y=a*Math.cos(u+B*f);n.z=a*Math.sin(t+z*d)*Math.sin(u+B*f);q.push(n.x,n.y,n.z);p.set(n.x,
n.y,n.z).normalize();r.push(p.x,p.y,p.z);w.push(z,1-B);x.push(l++)}m.push(x)}for(k=0;k<c;k++)for(h=0;h<b;h++)a=m[k][h+1],t=m[k][h],d=m[k+1][h],f=m[k+1][h+1],(0!==k||0<u)&&s.push(a,t,f),(k!==c-1||g<Math.PI)&&s.push(t,d,f);this.setIndex(s);this.addAttribute("position",new da(q,3));this.addAttribute("normal",new da(r,3));this.addAttribute("uv",new da(w,2))}function Ie(a,b,c,t,d,e){ma.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:t,thetaStart:d,
thetaLength:e};this.fromBufferGeometry(new Qc(a,b,c,t,d,e));this.mergeVertices()}function Qc(a,b,y,t,d,u){ba.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:y,phiSegments:t,thetaStart:d,thetaLength:u};a=a||0.5;b=b||1;d=void 0!==d?d:0;u=void 0!==u?u:2*Math.PI;y=void 0!==y?Math.max(3,y):8;t=void 0!==t?Math.max(1,t):1;var f=[],g=[],h=[],k=[],l=a,m=(b-a)/t,n=new e,p=new c,s,q;for(s=0;s<=t;s++){for(q=0;q<=y;q++)a=d+q/y*u,n.x=l*Math.cos(a),n.y=l*Math.sin(a),
g.push(n.x,n.y,n.z),h.push(0,0,1),p.x=(n.x/b+1)/2,p.y=(n.y/b+1)/2,k.push(p.x,p.y);l+=m}for(s=0;s<t;s++)for(b=s*(y+1),q=0;q<y;q++)a=q+b,d=a+y+1,u=a+y+2,l=a+1,f.push(a,d,l),f.push(d,u,l);this.setIndex(f);this.addAttribute("position",new da(g,3));this.addAttribute("normal",new da(h,3));this.addAttribute("uv",new da(k,2))}function vf(a,b,c,t){ma.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:t};this.fromBufferGeometry(new Fd(a,b,c,t));this.mergeVertices()}
function Fd(a,b,y,t){ba.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:y,phiLength:t};b=Math.floor(b)||12;y=y||0;t=t||2*Math.PI;t=Ba.clamp(t,0,2*Math.PI);var d=[],u=[],f=[],g=1/b,h=new e,k=new c,l,m;for(l=0;l<=b;l++){m=y+l*g*t;var n=Math.sin(m),p=Math.cos(m);for(m=0;m<=a.length-1;m++)h.x=a[m].x*n,h.y=a[m].y,h.z=a[m].x*p,u.push(h.x,h.y,h.z),k.x=l/b,k.y=m/(a.length-1),f.push(k.x,k.y)}for(l=0;l<b;l++)for(m=0;m<a.length-1;m++)y=m+l*a.length,g=y+a.length,h=y+a.length+
1,k=y+1,d.push(y,g,k),d.push(g,h,k);this.setIndex(d);this.addAttribute("position",new da(u,3));this.addAttribute("uv",new da(f,2));this.computeVertexNormals();if(t===2*Math.PI)for(t=this.attributes.normal.array,d=new e,u=new e,f=new e,y=b*a.length*3,m=l=0;l<a.length;l++,m+=3)d.x=t[m+0],d.y=t[m+1],d.z=t[m+2],u.x=t[y+m+0],u.y=t[y+m+1],u.z=t[y+m+2],f.addVectors(d,u).normalize(),t[m+0]=t[y+m+0]=f.x,t[m+1]=t[y+m+1]=f.y,t[m+2]=t[y+m+2]=f.z}function Gd(a,b){ma.call(this);this.type="ShapeGeometry";"object"===
typeof b&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),b=b.curveSegments);this.parameters={shapes:a,curveSegments:b};this.fromBufferGeometry(new gd(a,b));this.mergeVertices()}function gd(a,b){function c(a){var v,y,g=d.length/3;a=a.extractPoints(b);var W=a.shape,k=a.holes;if(!1===we.isClockWise(W))for(W=W.reverse(),a=0,v=k.length;a<v;a++)y=k[a],!0===we.isClockWise(y)&&(k[a]=y.reverse());var l=we.triangulateShape(W,k);a=0;for(v=k.length;a<v;a++)y=k[a],W=W.concat(y);a=0;
for(v=W.length;a<v;a++)y=W[a],d.push(y.x,y.y,0),e.push(0,0,1),f.push(y.x,y.y);a=0;for(v=l.length;a<v;a++)W=l[a],t.push(W[0]+g,W[1]+g,W[2]+g),h+=3}ba.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var t=[],d=[],e=[],f=[],g=0,h=0;if(!1===Array.isArray(a))c(a);else for(var k=0;k<a.length;k++)c(a[k]),this.addGroup(g,h,k),g+=h,h=0;this.setIndex(t);this.addAttribute("position",new da(d,3));this.addAttribute("normal",new da(e,3));this.addAttribute("uv",new da(f,
2))}function kh(a,b){b.shapes=[];if(Array.isArray(a))for(var c=0,t=a.length;c<t;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);return b}function Bd(a,b){ba.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c=[],t=Math.cos(Ba.DEG2RAD*(void 0!==b?b:1)),d=[0,0],e={},f,g,h=["a","b","c"],k;a.isBufferGeometry?(k=new ma,k.fromBufferGeometry(a)):k=a.clone();k.mergeVertices();k.computeFaceNormals();var l=k.vertices;k=k.faces;for(var m=0,n=k.length;m<n;m++)for(var p=k[m],
s=0;3>s;s++)f=p[h[s]],g=p[h[(s+1)%3]],d[0]=Math.min(f,g),d[1]=Math.max(f,g),f=d[0]+","+d[1],void 0===e[f]?e[f]={index1:d[0],index2:d[1],face1:m,face2:void 0}:e[f].face2=m;for(f in e)if(d=e[f],void 0===d.face2||k[d.face1].normal.dot(k[d.face2].normal)<=t)h=l[d.index1],c.push(h.x,h.y,h.z),h=l[d.index2],c.push(h.x,h.y,h.z);this.addAttribute("position",new da(c,3))}function hd(a,b,c,t,d,e,f,g){ma.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:t,
heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new Uc(a,b,c,t,d,e,f,g));this.mergeVertices()}function Uc(a,b,y,t,d,u,f,g){function h(y){var d,S,u,va=new c,q=new e,x=0,B=!0===y?a:b,z=!0===y?1:-1;S=s;for(d=1;d<=t;d++)m.push(0,r*z,0),n.push(0,z,0),p.push(0.5,0.5),s++;u=s;for(d=0;d<=t;d++){var A=d/t*g+f,D=Math.cos(A),A=Math.sin(A);q.x=B*A;q.y=r*z;q.z=B*D;m.push(q.x,q.y,q.z);n.push(0,z,0);va.x=0.5*D+0.5;va.y=0.5*A*z+0.5;p.push(va.x,va.y);s++}for(d=0;d<t;d++)va=S+d,q=u+
d,!0===y?l.push(q,q+1,va):l.push(q+1,q,va),x+=3;k.addGroup(w,x,!0===y?1:2);w+=x}ba.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:y,radialSegments:t,heightSegments:d,openEnded:u,thetaStart:f,thetaLength:g};var k=this;a=void 0!==a?a:1;b=void 0!==b?b:1;y=y||1;t=Math.floor(t)||8;d=Math.floor(d)||1;u=void 0!==u?u:!1;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;var l=[],m=[],n=[],p=[],s=0,q=[],r=y/2,w=0;(function(){var c,u,h=new e,va=new e,x=0,B=(b-a)/y;for(u=
0;u<=d;u++){var z=[],A=u/d,D=A*(b-a)+a;for(c=0;c<=t;c++){var E=c/t,F=E*g+f,P=Math.sin(F),F=Math.cos(F);va.x=D*P;va.y=-A*y+r;va.z=D*F;m.push(va.x,va.y,va.z);h.set(P,B,F).normalize();n.push(h.x,h.y,h.z);p.push(E,1-A);z.push(s++)}q.push(z)}for(c=0;c<t;c++)for(u=0;u<d;u++)h=q[u+1][c],va=q[u+1][c+1],B=q[u][c+1],l.push(q[u][c],h,B),l.push(h,va,B),x+=6;k.addGroup(w,x,0);w+=x})();!1===u&&(0<a&&h(!0),0<b&&h(!1));this.setIndex(l);this.addAttribute("position",new da(m,3));this.addAttribute("normal",new da(n,
3));this.addAttribute("uv",new da(p,2))}function je(a,b,c,d,e,u,f){hd.call(this,0,a,b,c,d,e,u,f);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:u,thetaLength:f}}function Je(a,b,c,d,e,u,f){Uc.call(this,0,a,b,c,d,e,u,f);this.type="ConeBufferGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:u,thetaLength:f}}function wf(a,b,c,d){ma.call(this);this.type="CircleGeometry";this.parameters=
{radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new ke(a,b,c,d));this.mergeVertices()}function ke(a,b,y,d){ba.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:y,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;y=void 0!==y?y:0;d=void 0!==d?d:2*Math.PI;var S=[],u=[],f=[],g=[],h,k,l=new e,m=new c;u.push(0,0,0);f.push(0,0,1);g.push(0.5,0.5);k=0;for(h=3;k<=b;k++,h+=3){var n=y+k/b*d;l.x=a*Math.cos(n);l.y=a*Math.sin(n);u.push(l.x,l.y,
l.z);f.push(0,0,1);m.x=(u[h]/a+1)/2;m.y=(u[h+1]/a+1)/2;g.push(m.x,m.y)}for(h=1;h<=b;h++)S.push(h,h+1,0);this.setIndex(S);this.addAttribute("position",new da(u,3));this.addAttribute("normal",new da(f,3));this.addAttribute("uv",new da(g,2))}function Mb(a){aa.call(this);this.type="ShadowMaterial";this.color=new X(0);this.opacity=1;this.transparent=this.lights=!0;this.setValues(a)}function Yb(a){R.call(this,a);this.type="RawShaderMaterial"}function Hb(a){aa.call(this);this.defines={STANDARD:""};this.type=
"MeshStandardMaterial";this.color=new X(16777215);this.metalness=this.roughness=0.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new X(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new c(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=
0.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Hd(a){Hb.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=0.5;this.clearCoatRoughness=this.clearCoat=0;this.setValues(a)}function ic(a){aa.call(this);this.type="MeshPhongMaterial";this.color=new X(16777215);this.specular=new X(1118481);this.shininess=30;this.lightMap=this.map=null;
this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new X(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new c(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=Lc;this.reflectivity=1;this.refractionRatio=0.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=
this.morphTargets=this.skinning=!1;this.setValues(a)}function Id(a){ic.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}function id(a){aa.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new c(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=
!1;this.setValues(a)}function Dc(a){aa.call(this);this.type="MeshLambertMaterial";this.color=new X(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new X(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=Lc;this.reflectivity=1;this.refractionRatio=0.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=
this.skinning=!1;this.setValues(a)}function Jd(a){Ka.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}function xf(a,b,c){var d=this,e=!1,u=0,f=0,g=void 0;this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){f++;if(!1===e&&void 0!==d.onStart)d.onStart(a,u,f);e=!0};this.itemEnd=function(a){u++;if(void 0!==d.onProgress)d.onProgress(a,u,f);if(u===f&&(e=!1,void 0!==d.onLoad))d.onLoad()};this.itemError=function(a){if(void 0!==
d.onError)d.onError(a)};this.resolveURL=function(a){return g?g(a):a};this.setURLModifier=function(a){g=a;return this}}function Ib(a){this.manager=void 0!==a?a:zc}function Dg(a){this.manager=void 0!==a?a:zc;this._parser=null}function $f(a){this.manager=void 0!==a?a:zc;this._parser=null}function yf(a){this.manager=void 0!==a?a:zc}function Ke(a){this.manager=void 0!==a?a:zc}function Le(a){this.manager=void 0!==a?a:zc}function la(){this.type="Curve";this.arcLengthDivisions=200}function Zb(a,b,c,d,e,u,
f,g){la.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=u||2*Math.PI;this.aClockwise=f||!1;this.aRotation=g||0}function kd(a,b,c,d,e,u){Zb.call(this,a,b,c,c,d,e,u);this.type="ArcCurve"}function ag(){var a=0,b=0,c=0,d=0;return{initCatmullRom:function(e,u,f,g,h){e=h*(f-e);g=h*(g-u);a=u;b=e;c=-3*u+3*f-2*e-g;d=2*u-2*f+e+g},initNonuniformCatmullRom:function(e,u,f,g,h,k,l){e=((u-e)/h-(f-e)/(h+k)+(f-u)/k)*k;g=((f-u)/k-
(g-u)/(k+l)+(g-f)/l)*k;k=e;a=u;b=k;c=-3*u+3*f-2*k-g;d=2*u-2*f+k+g},calc:function(e){var u=e*e;return a+b*e+c*u+d*u*e}}}function Nb(a,b,c,d){la.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||0.5}function Eg(a,b,c,d,e){b=0.5*(d-b);e=0.5*(e-c);var u=a*a;return(2*c-2*d+b+e)*a*u+(-3*c+3*d-2*b-e)*u+b*a+c}function Vc(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function ld(a,b,c,d,e){var u=1-a,f=1-a;return u*u*u*b+3*f*f*a*
c+3*(1-a)*a*a*d+a*a*a*e}function $b(a,b,y,d){la.call(this);this.type="CubicBezierCurve";this.v0=a||new c;this.v1=b||new c;this.v2=y||new c;this.v3=d||new c}function Ec(a,b,c,d){la.call(this);this.type="CubicBezierCurve3";this.v0=a||new e;this.v1=b||new e;this.v2=c||new e;this.v3=d||new e}function Ob(a,b){la.call(this);this.type="LineCurve";this.v1=a||new c;this.v2=b||new c}function Fc(a,b){la.call(this);this.type="LineCurve3";this.v1=a||new e;this.v2=b||new e}function tc(a,b,y){la.call(this);this.type=
"QuadraticBezierCurve";this.v0=a||new c;this.v1=b||new c;this.v2=y||new c}function Za(a,b,c){la.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new e;this.v1=b||new e;this.v2=c||new e}function ac(a){la.call(this);this.type="SplineCurve";this.points=a||[]}function Wc(){la.call(this);this.type="CurvePath";this.curves=[];this.autoClose=!1}function uc(a){Wc.call(this);this.type="Path";this.currentPoint=new c;a&&this.setFromPoints(a)}function md(a){uc.call(this,a);this.uuid=Ba.generateUUID();this.type=
"Shape";this.holes=[]}function $a(a,b){U.call(this);this.type="Light";this.color=new X(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function Me(a,b,c){$a.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(U.DefaultUp);this.updateMatrix();this.groundColor=new X(b)}function Kd(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new c(512,512);this.map=null;this.matrix=new d}function zf(){Kd.call(this,new Ya(50,1,0.5,500))}function Af(a,b,c,d,e,u){$a.call(this,
a,b);this.type="SpotLight";this.position.copy(U.DefaultUp);this.updateMatrix();this.target=new U;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==e?e:0;this.decay=void 0!==u?u:1;this.shadow=new zf}function nd(a,b,c,d){$a.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},
set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new Kd(new Ya(90,1,0.5,500))}function Bf(){Kd.call(this,new pa(-5,5,5,-5,0.5,500))}function le(a,b){$a.call(this,a,b);this.type="DirectionalLight";this.position.copy(U.DefaultUp);this.updateMatrix();this.target=new U;this.shadow=new Bf}function Cf(a,b){$a.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0}function Ld(a,b,c,d){$a.call(this,a,b);this.type="RectAreaLight";this.width=
void 0!==c?c:10;this.height=void 0!==d?d:10}function cg(a,b,c,d){zb.call(this,a,b,c,d)}function od(a,b,c){zb.call(this,a,b,c)}function bc(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Df(a,b,c,d){bc.call(this,a,b,c,d)}function Ne(a,b,c,d){zb.call(this,a,b,c,d)}function Md(a,b,c,d){zb.call(this,a,b,c,d)}function Oe(a,b,c,d){zb.call(this,a,b,c,d)}function pd(a,b,c,d){bc.call(this,a,b,c,d);this._offsetNext=
this._weightNext=this._offsetPrev=this._weightPrev=-0}function Ef(a,b,c,d){bc.call(this,a,b,c,d)}function Ff(a,b,c,d){bc.call(this,a,b,c,d)}function zb(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=cc.convertArray(b,this.TimeBufferType);this.values=cc.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation);this.validate();
this.optimize()}function Pe(a,b,c,d){zb.call(this,a,b,c,d)}function jc(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;this.uuid=Ba.generateUUID();0>this.duration&&this.resetDuration();this.optimize()}function Gf(a){this.manager=void 0!==a?a:zc;this.textures={}}function Fg(a){this.manager=void 0!==a?a:zc}function Re(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}}function Gg(a){"boolean"===typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),
a=void 0);this.manager=void 0!==a?a:zc;this.withCredentials=!1}function lh(a){this.manager=void 0!==a?a:zc;this.texturePath=""}function Od(a){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.manager=void 0!==a?a:zc;this.options=void 0}function eg(){this.type="ShapePath";this.subPaths=[];this.currentPath=null}function fg(a){this.type="Font";
this.data=a}function Hf(a){this.manager=void 0!==a?a:zc}function Pd(a){this.manager=void 0!==a?a:zc}function Hg(){this.type="StereoCamera";this.aspect=1;this.eyeSep=0.064;this.cameraL=new Ya;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new Ya;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1}function Te(a,b,c){U.call(this);this.type="CubeCamera";var d=new Ya(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new e(1,0,0));this.add(d);var S=new Ya(90,1,a,b);S.up.set(0,
-1,0);S.lookAt(new e(-1,0,0));this.add(S);var u=new Ya(90,1,a,b);u.up.set(0,0,1);u.lookAt(new e(0,1,0));this.add(u);var f=new Ya(90,1,a,b);f.up.set(0,0,-1);f.lookAt(new e(0,-1,0));this.add(f);var g=new Ya(90,1,a,b);g.up.set(0,-1,0);g.lookAt(new e(0,0,1));this.add(g);var h=new Ya(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new e(0,0,-1));this.add(h);this.renderTarget=new s(c,c,{format:qd,magFilter:Eb,minFilter:Eb});this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();
var v=this.renderTarget,c=v.texture.generateMipmaps;v.texture.generateMipmaps=!1;v.activeCubeFace=0;a.render(b,d,v);v.activeCubeFace=1;a.render(b,S,v);v.activeCubeFace=2;a.render(b,u,v);v.activeCubeFace=3;a.render(b,f,v);v.activeCubeFace=4;a.render(b,g,v);v.texture.generateMipmaps=c;v.activeCubeFace=5;a.render(b,h,v);a.setRenderTarget(null)};this.clear=function(a,b,v,c){for(var C=this.renderTarget,y=0;6>y;y++)C.activeCubeFace=y,a.setRenderTarget(C),a.clear(b,v,c);a.setRenderTarget(null)}}function Ue(){U.call(this);
this.type="AudioListener";this.context=Ch.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null}function Ve(a){U.call(this);this.type="Audio";this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.loop=!1;this.offset=this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function We(a){Ve.call(this,a);
this.panner=this.context.createPanner();this.panner.connect(this.gain)}function hg(a,b){this.analyser=a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function Ig(a,b,c){this.binding=a;this.valueSize=c;a=Float64Array;switch(b){case "quaternion":b=this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;
this.referenceCount=this.useCount=this.cumulativeWeight=0}function Jg(a,b,c){c=c||Pb.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function Pb(a,b,c){this.path=b;this.parsedPath=c||Pb.parseTrackName(b);this.node=Pb.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function Lg(){this.uuid=Ba.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=
b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function Mg(a,b,c){this._mixer=a;this._clip=b;this._localRoot=c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:lf,endingEnd:lf},e=0;e!==b;++e){var u=a[e].createInterpolant(null);c[e]=u;u.settings=d}this._interpolantSettings=d;this._interpolants=
c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=Th;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Ng(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function jg(a,
b){"string"===typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=b);this.value=a}function Og(){ba.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}function Pg(a,b,c,d){this.uuid=Ba.generateUUID();this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function Qd(a,b){this.uuid=Ba.generateUUID();this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.onUploadCallback=function(){};
this.version=0}function kg(a,b,c){Qd.call(this,a,b);this.meshPerAttribute=c||1}function mg(a,b,c){ra.call(this,a,b);this.meshPerAttribute=c||1}function Xe(a,b,c,d){this.ray=new oa(a,b);this.near=c||0;this.far=d||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function nh(a,b){return a.distance-b.distance}
function Qg(a,b,c,d){if(!1!==a.visible&&(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=a.length;d<e;d++)Qg(a[d],b,c,!0)}}function bb(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function oh(a,b,c){this.radius=void 0!==a?a:1;this.phi=void 0!==b?b:0;this.theta=void 0!==c?c:0;return this}function Ye(a,b,c){this.radius=void 0!==a?a:1;this.theta=void 0!==b?b:0;this.y=void 0!==c?c:0;return this}function pg(a,b){this.min=void 0!==a?a:new c(Infinity,
Infinity);this.max=void 0!==b?b:new c(-Infinity,-Infinity)}function oe(a){U.call(this);this.material=a;this.render=function(){}}function $e(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new ba;b=new da(6*b,3);c.addAttribute("position",b);Ra.call(this,c,new Ka({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function pe(a,b){U.call(this);
this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;for(var c=new ba,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],e=0,u=1;32>e;e++,u++){var f=e/32*Math.PI*2,g=u/32*Math.PI*2;d.push(Math.cos(f),Math.sin(f),1,Math.cos(g),Math.sin(g),1)}c.addAttribute("position",new da(d,3));d=new Ka({fog:!1});this.cone=new Ra(c,d);this.add(this.cone);this.update()}function Tg(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,
Tg(a.children[c]));return b}function qe(a){for(var b=Tg(a),c=new ba,d=[],e=[],u=new X(0,0,1),f=new X(0,1,0),g=0;g<b.length;g++){var h=b[g];h.parent&&h.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(u.r,u.g,u.b),e.push(f.r,f.g,f.b))}c.addAttribute("position",new da(d,3));c.addAttribute("color",new da(e,3));d=new Ka({vertexColors:me,depthTest:!1,depthWrite:!1,transparent:!0});Ra.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function re(a,b,c){this.light=
a;this.light.updateMatrixWorld();this.color=c;a=new Tc(b,4,2);b=new pb({wireframe:!0,fog:!1});ga.call(this,a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function Sd(a,b){U.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;var c=new Ka({fog:!1}),d=new ba;d.addAttribute("position",new ra(new Float32Array(15),3));this.line=new Sb(d,c);this.add(this.line);this.update()}function se(a,b,c){U.call(this);
this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;a=new yd(b);a.rotateY(0.5*Math.PI);this.material=new pb({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=me);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new ra(b,3));this.add(new ga(a,this.material));this.update()}function af(a,b,c,d){a=a||10;b=b||10;c=new X(void 0!==c?c:4473924);d=new X(void 0!==d?d:8947848);var e=b/2,u=a/b,f=a/2;
a=[];for(var g=[],h=0,k=0,l=-f;h<=b;h++,l+=u){a.push(-f,0,l,f,0,l);a.push(l,0,-f,l,0,f);var m=h===e?c:d;m.toArray(g,k);k+=3;m.toArray(g,k);k+=3;m.toArray(g,k);k+=3;m.toArray(g,k);k+=3}b=new ba;b.addAttribute("position",new da(a,3));b.addAttribute("color",new da(g,3));c=new Ka({vertexColors:me});Ra.call(this,b,c)}function qg(a,b,c,d,e,u){a=a||10;b=b||16;c=c||8;d=d||64;e=new X(void 0!==e?e:4473924);u=new X(void 0!==u?u:8947848);var f=[],g=[],h,k,l,m,n;for(l=0;l<=b;l++)k=l/b*2*Math.PI,h=Math.sin(k)*
a,k=Math.cos(k)*a,f.push(0,0,0),f.push(h,0,k),n=l&1?e:u,g.push(n.r,n.g,n.b),g.push(n.r,n.g,n.b);for(l=0;l<=c;l++)for(n=l&1?e:u,m=a-a/c*l,b=0;b<d;b++)k=b/d*2*Math.PI,h=Math.sin(k)*m,k=Math.cos(k)*m,f.push(h,0,k),g.push(n.r,n.g,n.b),k=(b+1)/d*2*Math.PI,h=Math.sin(k)*m,k=Math.cos(k)*m,f.push(h,0,k),g.push(n.r,n.g,n.b);a=new ba;a.addAttribute("position",new da(f,3));a.addAttribute("color",new da(g,3));f=new Ka({vertexColors:me});Ra.call(this,a,f)}function Yc(a,b,c,d){this.object=a;this.size=void 0!==
b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");c=new ba;b=new da(6*b,3);c.addAttribute("position",b);Ra.call(this,c,new Ka({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function bf(a,b,c){U.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;
void 0===b&&(b=1);a=new ba;a.addAttribute("position",new da([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new Ka({fog:!1});this.lightPlane=new Sb(a,b);this.add(this.lightPlane);a=new ba;a.addAttribute("position",new da([0,0,0,0,0,1],3));this.targetLine=new Sb(a,b);this.add(this.targetLine);this.update()}function Td(a){function b(a,v,C){c(a,C);c(v,C)}function c(a,b){u.push(0,0,0);f.push(b.r,b.g,b.b);void 0===g[a]&&(g[a]=[]);g[a].push(u.length/3-1)}var d=new ba,e=new Ka({color:16777215,vertexColors:ec}),
u=[],f=[],g={},h=new X(16755200),k=new X(16711680),l=new X(43775),m=new X(16777215),n=new X(3355443);b("n1","n2",h);b("n2","n4",h);b("n4","n3",h);b("n3","n1",h);b("f1","f2",h);b("f2","f4",h);b("f4","f3",h);b("f3","f1",h);b("n1","f1",h);b("n2","f2",h);b("n3","f3",h);b("n4","f4",h);b("p","n1",k);b("p","n2",k);b("p","n3",k);b("p","n4",k);b("u1","u2",l);b("u2","u3",l);b("u3","u1",l);b("c","t",m);b("p","c",n);b("cn1","cn2",n);b("cn3","cn4",n);b("cf1","cf2",n);b("cf3","cf4",n);d.addAttribute("position",
new da(u,3));d.addAttribute("color",new da(f,3));Ra.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=g;this.update()}function te(a,b){this.object=a;void 0===b&&(b=16776960);var c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(24),e=new ba;e.setIndex(new ra(c,1));e.addAttribute("position",new ra(d,3));Ra.call(this,e,new Ka({color:b}));this.matrixAutoUpdate=
!1;this.update()}function ub(a,b){this.type="Box3Helper";this.box=a;var c=void 0!==b?b:16776960,d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),e=new ba;e.setIndex(new ra(d,1));e.addAttribute("position",new da([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));Ra.call(this,e,new Ka({color:c}));this.geometry.computeBoundingSphere()}function cf(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new ba;b.addAttribute("position",
new da([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();Sb.call(this,b,new Ka({color:a}));b=new ba;b.addAttribute("position",new da([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));b.computeBoundingSphere();this.add(new ga(b,new pb({color:a,opacity:0.2,transparent:!0,depthWrite:!1})))}function Vb(a,b,c,d,e,u){U.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);void 0===e&&(e=0.2*c);void 0===u&&(u=0.2*e);void 0===sh&&(sh=new ba,sh.addAttribute("position",
new da([0,0,0,0,1,0],3)),Dh=new Uc(0,0.5,1,5,1),Dh.translate(0,-0.5,0));this.position.copy(b);this.line=new Sb(sh,new Ka({color:d}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new ga(Dh,new pb({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,u)}function df(a){a=a||1;var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new ba;a.addAttribute("position",new da(b,3));a.addAttribute("color",new da([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],
3));b=new Ka({vertexColors:me});Ra.call(this,a,b)}function Ug(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");Nb.call(this,a);this.type="catmullrom";this.closed=!0}function ef(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");Nb.call(this,a);this.type="catmullrom"}function Da(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");Nb.call(this,a);this.type="catmullrom"}void 0===
Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a});void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});!1==="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");
for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b}}();Object.assign(b.prototype,{addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},removeEventListener:function(a,
b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var b=b.slice(0),c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}});var Wa="90dev",vb=0,Vg=1,rf=2,rc=0,og=1,ph=2,Zf=0,Gc=1,ed=2,td=0,ec=1,me=2,rg=0,Hc=1,gg=2,Lf=3,fd=4,ud=5,Ud=100,Rd=101,tg=102,Jf=103,vc=104,lg=200,ff=201,hf=202,Zg=203,sg=204,bg=205,$c=206,ye=207,$g=208,mf=
209,ha=210,mh=0,Of=1,Qf=2,Ze=3,qh=4,Kg=5,Wf=6,Pf=7,Lc=0,Wd=1,rb=2,jd=0,ug=1,bh=2,Xd=3,ze=4,pf=301,Nc=302,sd=303,Vd=304,Xf=305,Yf=306,ie=307,sc=1E3,cb=1001,yb=1002,wa=1003,xc=1004,lc=1005,Eb=1006,dg=1007,wc=1008,Nd=1009,rh=1010,Qb=1011,Qe=1012,Sg=1013,Xc=1014,Zc=1015,ue=1016,gf=1017,Se=1018,If=1019,Kf=1020,ig=1021,qd=1022,kc=1023,ne=1024,Rg=1025,ng=kc,rd=1026,Ab=1027,Ma=33776,mb=33777,Wg=33778,ve=33779,m=35840,ja=35841,p=35842,h=35843,w=36196,Va=37808,Rb=37809,jf=37810,Ih=37811,Jh=37812,Kh=37813,Lh=
37814,Mh=37815,Nh=37816,Oh=37817,Ph=37818,Qh=37819,Rh=37820,Sh=37821,Th=2201,lf=2400,vh=0,Uh=1,Vh=2,vg=3E3,Wh=3001,xh=3007,Xh=3002,Yh=3004,ji=3005,ki=3006,fi=3200,gi=3201,Ba={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var a=[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16).toUpperCase();return function(){var b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,C=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return a[b&255]+a[b>>8&255]+a[b>>16&255]+a[b>>24&
255]+"-"+a[c&255]+a[c>>8&255]+"-"+a[c>>16&15|64]+a[c>>24&255]+"-"+a[C&63|128]+a[C>>8&255]+"-"+a[C>>16&255]+a[C>>24&255]+a[d&255]+a[d>>8&255]+a[d>>16&255]+a[d>>24&255]}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=
b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},degToRad:function(a){return a*Ba.DEG2RAD},radToDeg:function(a){return a*Ba.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,
Math.floor(Math.log(a)/Math.LN2))}};Object.defineProperties(c.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(c.prototype,{isVector2:!0,set:function(a,b){this.x=a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;
default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},
addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;
return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=a[1]*b+a[4]*c+a[7];return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=
Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a=new c,b=new c;return function(c,d){a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);
this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+
Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=
(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);
return this},rotateAround:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,u=this.y-a.y;this.x=e*c-u*d+a.x;this.y=e*d+u*c+a.y;return this}});Object.assign(d.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,u,f,g,h,k,l,m,n,p,s,q){var r=this.elements;r[0]=a;r[4]=b;r[8]=c;r[12]=d;r[1]=e;r[5]=u;r[9]=f;r[13]=g;r[2]=h;r[6]=k;r[10]=l;r[14]=m;r[3]=n;r[7]=p;r[11]=s;r[15]=q;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new d).fromArray(this.elements)},
copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,
b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new e;return function(b){var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),u=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,2).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[4]=d[4]*u;c[5]=d[5]*u;c[6]=d[6]*u;c[8]=d[8]*b;c[9]=d[9]*b;c[10]=d[10]*b;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var b=this.elements,c=a.x,d=a.y,e=a.z,u=Math.cos(c),c=Math.sin(c),f=Math.cos(d),d=Math.sin(d),g=Math.cos(e),e=Math.sin(e);if("XYZ"===a.order){a=u*g;var h=u*e,k=c*g,l=c*e;b[0]=f*g;b[4]=-f*e;b[8]=d;b[1]=h+k*d;b[5]=a-l*d;b[9]=-c*f;b[2]=l-a*d;b[6]=k+h*d;b[10]=u*f}else"YXZ"===a.order?(a=f*g,h=f*e,k=d*g,l=d*e,b[0]=a+l*c,b[4]=k*c-h,b[8]=u*d,b[1]=u*e,b[5]=u*g,b[9]=-c,b[2]=h*c-k,b[6]=l+a*c,b[10]=u*f):"ZXY"===a.order?(a=f*g,h=f*e,k=d*g,l=d*e,b[0]=a-l*c,b[4]=-u*e,b[8]=k+h*c,b[1]=h+k*c,b[5]=u*g,b[9]=l-a*c,b[2]=
-u*d,b[6]=c,b[10]=u*f):"ZYX"===a.order?(a=u*g,h=u*e,k=c*g,l=c*e,b[0]=f*g,b[4]=k*d-h,b[8]=a*d+l,b[1]=f*e,b[5]=l*d+a,b[9]=h*d-k,b[2]=-d,b[6]=c*f,b[10]=u*f):"YZX"===a.order?(a=u*f,h=u*d,k=c*f,l=c*d,b[0]=f*g,b[4]=l-a*e,b[8]=k*e+h,b[1]=e,b[5]=u*g,b[9]=-c*g,b[2]=-d*g,b[6]=h*e+k,b[10]=a-l*e):"XZY"===a.order&&(a=u*f,h=u*d,k=c*f,l=c*d,b[0]=f*g,b[4]=-e,b[8]=d*g,b[1]=a*e+l,b[5]=u*g,b[9]=h*e-k,b[2]=k*e-h,b[6]=c*g,b[10]=l*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(a){var b=
this.elements,c=a._x,d=a._y,e=a._z,u=a._w,f=c+c,g=d+d,h=e+e;a=c*f;var k=c*g,c=c*h,l=d*g,d=d*h,e=e*h,f=u*f,g=u*g,u=u*h;b[0]=1-(l+e);b[4]=k-u;b[8]=c+g;b[1]=k+u;b[5]=1-(a+e);b[9]=d-f;b[2]=c-g;b[6]=d+f;b[10]=1-(a+l);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new e,b=new e,c=new e;return function(d,e,u){var f=this.elements;c.subVectors(d,e);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(u,c);0===a.lengthSq()&&(1===Math.abs(u.z)?c.x+=1E-4:c.z+=1E-4,
c.normalize(),a.crossVectors(u,c));a.normalize();b.crossVectors(c,a);f[0]=a.x;f[4]=b.x;f[8]=c.x;f[1]=a.y;f[5]=b.y;f[9]=c.y;f[2]=a.z;f[6]=b.z;f[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,
e=this.elements,u=c[0],f=c[4],g=c[8],h=c[12],k=c[1],l=c[5],m=c[9],n=c[13],p=c[2],s=c[6],q=c[10],r=c[14],w=c[3],x=c[7],B=c[11],c=c[15],z=d[0],A=d[4],D=d[8],E=d[12],F=d[1],P=d[5],Z=d[9],H=d[13],I=d[2],K=d[6],L=d[10],J=d[14],G=d[3],N=d[7],O=d[11],d=d[15];e[0]=u*z+f*F+g*I+h*G;e[4]=u*A+f*P+g*K+h*N;e[8]=u*D+f*Z+g*L+h*O;e[12]=u*E+f*H+g*J+h*d;e[1]=k*z+l*F+m*I+n*G;e[5]=k*A+l*P+m*K+n*N;e[9]=k*D+l*Z+m*L+n*O;e[13]=k*E+l*H+m*J+n*d;e[2]=p*z+s*F+q*I+r*G;e[6]=p*A+s*P+q*K+r*N;e[10]=p*D+s*Z+q*L+r*O;e[14]=p*E+s*H+q*
J+r*d;e[3]=w*z+x*F+B*I+c*G;e[7]=w*A+x*P+B*K+c*N;e[11]=w*D+x*Z+B*L+c*O;e[15]=w*E+x*H+B*J+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=new e;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),determinant:function(){var a=
this.elements,b=a[0],c=a[4],d=a[8],e=a[12],u=a[1],f=a[5],g=a[9],h=a[13],k=a[2],l=a[6],m=a[10],n=a[14];return a[3]*(+e*g*l-d*h*l-e*f*m+c*h*m+d*f*n-c*g*n)+a[7]*(+b*g*n-b*h*m+e*u*m-d*u*n+d*h*k-e*g*k)+a[11]*(+b*h*l-b*f*n-e*u*l+c*u*n+e*f*k-c*h*k)+a[15]*(-d*f*k-b*g*l+b*f*m+d*u*l-c*u*m+c*g*k)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},setPosition:function(a){var b=
this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],u=d[1],f=d[2],g=d[3],h=d[4],k=d[5],l=d[6],m=d[7],n=d[8],p=d[9],s=d[10],q=d[11],r=d[12],w=d[13],x=d[14],d=d[15],B=p*x*m-w*s*m+w*l*q-k*x*q-p*l*d+k*s*d,z=r*s*m-n*x*m-r*l*q+h*x*q+n*l*d-h*s*d,A=n*w*m-r*p*m+r*k*q-h*w*q-n*k*d+h*p*d,D=r*p*l-n*w*l-r*k*s+h*w*s+n*k*x-h*p*x,E=e*B+u*z+f*A+g*D;if(0===E){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");
console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}E=1/E;c[0]=B*E;c[1]=(w*s*g-p*x*g-w*f*q+u*x*q+p*f*d-u*s*d)*E;c[2]=(k*x*g-w*l*g+w*f*m-u*x*m-k*f*d+u*l*d)*E;c[3]=(p*l*g-k*s*g-p*f*m+u*s*m+k*f*q-u*l*q)*E;c[4]=z*E;c[5]=(n*x*g-r*s*g+r*f*q-e*x*q-n*f*d+e*s*d)*E;c[6]=(r*l*g-h*x*g-r*f*m+e*x*m+h*f*d-e*l*d)*E;c[7]=(h*s*g-n*l*g+n*f*m-e*s*m-h*f*q+e*l*q)*E;c[8]=A*E;c[9]=(r*p*g-n*w*g-r*u*q+e*w*q+n*u*d-e*p*d)*E;c[10]=(h*w*g-r*k*g+r*u*m-e*w*m-h*u*d+e*k*d)*E;c[11]=
(n*k*g-h*p*g-n*u*m+e*p*m+h*u*q-e*k*q)*E;c[12]=D*E;c[13]=(n*w*f-r*p*f+r*u*s-e*w*s-n*u*x+e*p*x)*E;c[14]=(r*k*f-h*w*f-r*u*l+e*w*l+h*u*x-e*k*x)*E;c[15]=(h*p*f-n*k*f+n*u*l-e*p*l-h*u*s+e*k*s)*E;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],
a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=
Math.cos(b),d=Math.sin(b),e=1-c,u=a.x,f=a.y,g=a.z,h=e*u,k=e*f;this.set(h*u+c,h*f-d*g,h*g+d*f,0,h*f+d*g,k*f+c,k*g-d*u,0,h*g-d*f,k*g+d*u,e*g*g+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new e,b=new d;return function(c,d,e){var u=
this.elements,f=a.set(u[0],u[1],u[2]).length(),g=a.set(u[4],u[5],u[6]).length(),h=a.set(u[8],u[9],u[10]).length();0>this.determinant()&&(f=-f);c.x=u[12];c.y=u[13];c.z=u[14];b.copy(this);c=1/f;var u=1/g,k=1/h;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=u;b.elements[5]*=u;b.elements[6]*=u;b.elements[8]*=k;b.elements[9]*=k;b.elements[10]*=k;d.setFromRotationMatrix(b);e.x=f;e.y=g;e.z=h;return this}}(),makePerspective:function(a,b,c,d,e,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(c-d);g[9]=(c+d)/(c-d);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),l=1/(f-e);g[0]=2*h;g[4]=0;g[8]=0;g[12]=-((b+a)*h);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+d)*k);g[2]=0;g[6]=0;g[10]=-2*l;g[14]=-((f+e)*l);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;
a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(g,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,
d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],l=c[d+2];c=c[d+3];d=e[f+0];var m=e[f+1],n=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==m||l!==n){f=1-g;var p=h*d+k*m+l*n+c*e,s=0<=p?1:-1,q=1-p*p;q>Number.EPSILON&&(q=Math.sqrt(q),p=Math.atan2(q,p*s),f=Math.sin(f*p)/q,g=Math.sin(g*p)/q);s*=g;h=h*f+d*s;k=k*f+m*s;l=l*f+n*s;c=c*f+e*s;f===1-g&&(g=1/Math.sqrt(h*h+k*k+l*l+c*c),h*=g,k*=g,l*=g,c*=g)}a[b]=h;a[b+1]=k;a[b+2]=l;a[b+3]=c}});Object.defineProperties(g.prototype,{x:{get:function(){return this._x},
set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(g.prototype,{set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,
this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,d=a._y,e=a._z,f=a.order,g=Math.cos,h=Math.sin,k=g(c/2),l=g(d/2),g=g(e/2),c=h(c/2),d=h(d/2),e=h(e/2);"XYZ"===f?(this._x=c*l*g+k*d*e,this._y=k*d*g-c*l*e,this._z=k*l*e+c*d*g,this._w=k*l*g-c*d*e):"YXZ"===f?(this._x=c*l*g+k*d*
e,this._y=k*d*g-c*l*e,this._z=k*l*e-c*d*g,this._w=k*l*g+c*d*e):"ZXY"===f?(this._x=c*l*g-k*d*e,this._y=k*d*g+c*l*e,this._z=k*l*e+c*d*g,this._w=k*l*g-c*d*e):"ZYX"===f?(this._x=c*l*g-k*d*e,this._y=k*d*g+c*l*e,this._z=k*l*e-c*d*g,this._w=k*l*g+c*d*e):"YZX"===f?(this._x=c*l*g+k*d*e,this._y=k*d*g+c*l*e,this._z=k*l*e-c*d*g,this._w=k*l*g-c*d*e):"XZY"===f&&(this._x=c*l*g-k*d*e,this._y=k*d*g-c*l*e,this._z=k*l*e+c*d*g,this._w=k*l*g+c*d*e);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6],b=b[10],l=c+f+b;0<l?(c=0.5/Math.sqrt(l+1),this._w=0.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=0.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
0.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=0.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new e,b;return function(c,d){void 0===a&&(a=new e);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=
-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,
b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,k=b._z,l=b._w;this._x=c*l+f*g+d*k-e*h;this._y=d*l+f*h+e*g-c*k;this._z=e*l+f*k+c*h-d*g;this._w=f*l-c*g-d*h-e*k;this.onChangeCallback();return this},slerp:function(a,
b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.sqrt(1-g*g);if(0.001>Math.abs(h))return this._w=0.5*(f+this._w),this._x=0.5*(c+this._x),this._y=0.5*(d+this._y),this._z=0.5*(e+this._z),this;var k=Math.atan2(h,g),g=Math.sin((1-b)*k)/h,h=Math.sin(b*k)/h;this._w=f*g+this._w*
h;this._x=c*g+this._x*h;this._y=d*g+this._y*h;this._z=e*g+this._z*h;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){}});Object.assign(e.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=
a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new g;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");
return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new g;return function(b,c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*
d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,l=a*d+e*c-f*b,b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-l*-f;this.y=k*a+b*-f+l*-e-h*-g;this.z=l*a+b*-g+h*-f-k*-e;return this},project:function(){var a=new d;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new d;return function(b){a.multiplyMatrices(b.matrixWorld,
a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=
Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a=new e,b=new e;return function(c,d){a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=
Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-
this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;this.x=d*h-e*g;this.y=e*f-c*h;this.z=c*g-d*f;return this},projectOnVector:function(a){var b=
a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new e;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new e;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(Ba.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=
this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];
this.y=a[13];this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===
a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(l.prototype,{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var l=this.elements;l[0]=a;l[1]=d;l[2]=g;l[3]=b;l[4]=e;l[5]=h;l[6]=c;l[7]=f;l[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},
clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new e;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,
a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[3],h=c[6],k=c[1],l=c[4],m=c[7],n=c[2],p=c[5],c=c[8],s=d[0],q=d[3],r=d[6],w=d[1],x=d[4],B=d[7],z=d[2],A=d[5],d=d[8];e[0]=f*s+g*w+h*z;e[3]=f*q+g*x+h*A;e[6]=f*r+g*B+h*d;e[1]=k*s+l*w+m*z;e[4]=k*q+l*x+m*A;e[7]=k*r+l*B+m*d;e[2]=n*s+p*w+c*z;e[5]=n*q+p*x+c*A;e[8]=n*r+p*B+c*
d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements,d=this.elements,e=c[0],f=c[1],g=c[2],h=c[3],k=c[4],l=c[5],m=c[6],
n=c[7],c=c[8],p=c*k-l*n,s=l*m-c*h,q=n*h-k*m,r=e*p+f*s+g*q;if(0===r){if(!0===b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}r=1/r;d[0]=p*r;d[1]=(g*n-c*f)*r;d[2]=(l*f-g*k)*r;d[3]=s*r;d[4]=(c*e-g*m)*r;d[5]=(g*h-l*e)*r;d[6]=q*r;d[7]=(f*m-n*e)*r;d[8]=(k*e-f*h)*r;return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=
a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=b;c[4]*=b;
c[7]*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],k=c[7];c[0]=b*d+a*g;c[3]=b*e+a*h;c[6]=b*f+a*k;c[1]=-a*d+b*g;c[4]=-a*e+b*h;c[7]=-a*f+b*k;return this},translate:function(a,b){var c=this.elements;c[0]+=a*c[2];c[3]+=a*c[5];c[6]+=a*c[8];c[1]+=b*c[2];c[4]+=b*c[5];c[7]+=b*c[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===
b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var oi=0;n.DEFAULT_IMAGE=void 0;n.DEFAULT_MAPPING=300;n.prototype=Object.assign(Object.create(b.prototype),{constructor:n,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.image=
a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=
a.unpackAlignment;this.encoding=a.encoding;return this},toJSON:function(a){var b=void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,
anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var d=this.image;void 0===d.uuid&&(d.uuid=Ba.generateUUID());if(!b&&void 0===a.images[d.uuid]){var e=a.images,f=d.uuid,g=d.uuid,h;if(d instanceof HTMLCanvasElement)h=d;else{h=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");h.width=d.width;h.height=d.height;var k=h.getContext("2d");d instanceof ImageData?k.putImageData(d,0,0):k.drawImage(d,0,0,d.width,d.height)}h=2048<h.width||2048<h.height?h.toDataURL("image/jpeg",
0.6):h.toDataURL("image/png");e[f]={uuid:g,url:h}}c.image=d.uuid}b||(a.textures[this.uuid]=c);return c},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(300===this.mapping){a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case sc:a.x-=Math.floor(a.x);break;case cb:a.x=0>a.x?0:1;break;case yb:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case sc:a.y-=Math.floor(a.y);break;case cb:a.y=0>
a.y?0:1;break;case yb:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}});Object.defineProperty(n.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(B.prototype,{isVector4:!0,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},
setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;
this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;
this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=
a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,
c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],k=a[9];c=a[2];b=a[6];var l=a[10];if(0.01>Math.abs(d-g)&&0.01>Math.abs(f-c)&&0.01>Math.abs(k-b)){if(0.1>Math.abs(d+g)&&0.1>Math.abs(f+c)&&0.1>Math.abs(k+b)&&0.1>Math.abs(e+h+l-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;l=(l+1)/2;d=(d+g)/4;f=(f+c)/4;k=(k+b)/4;e>h&&e>l?0.01>e?(b=0,d=c=0.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):h>l?0.01>h?(b=0.707106781,c=0,d=0.707106781):(c=Math.sqrt(h),b=d/c,d=k/c):0.01>l?(c=b=0.707106781,
d=0):(d=Math.sqrt(l),b=f/d,c=k/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-k)*(b-k)+(f-c)*(f-c)+(g-d)*(g-d));0.001>Math.abs(a)&&(a=1);this.x=(b-k)/a;this.y=(f-c)/a;this.z=(g-d)/a;this.w=Math.acos((e+h+l-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},
clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new B,b=new B);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);
this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):
Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+
Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+
1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});E.prototype=Object.assign(Object.create(b.prototype),{constructor:E,isWebGLRenderTarget:!0,setSize:function(a,b){if(this.width!==
a||this.height!==b)this.width=a,this.height=b,this.dispose();this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});s.prototype=Object.create(E.prototype);
s.prototype.constructor=s;s.prototype.isWebGLRenderTargetCube=!0;D.prototype=Object.create(n.prototype);D.prototype.constructor=D;D.prototype.isDataTexture=!0;q.prototype=Object.create(n.prototype);q.prototype.constructor=q;q.prototype.isCubeTexture=!0;Object.defineProperty(q.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}});var di=new n,ei=new q,$h=[],ai=[],ci=new Float32Array(16),bi=new Float32Array(9);Qa.prototype.setValue=function(a,b){for(var c=this.seq,d=
0,e=c.length;d!==e;++d){var f=c[d];f.setValue(a,b[f.id])}};var Bh=/([\w\d_]+)(\])?(\[|\.)?/g;Xa.prototype.setValue=function(a,b,c){b=this.map[b];void 0!==b&&b.setValue(a,c,this.renderer)};Xa.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};Xa.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};Xa.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};
var si={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(X.prototype,{isColor:!0,r:1,g:1,b:1,set:function(a){a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a;return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;
return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(b,c,v){0>v&&(v+=1);1<v&&(v-=1);return v<1/6?b+6*(c-b)*v:0.5>v?c:v<2/3?b+6*(c-b)*(2/3-v):b}return function(b,c,d){b=Ba.euclideanModulo(b,1);c=Ba.clamp(c,0,1);d=Ba.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=0.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){function b(c){void 0!==c&&1>parseFloat(c)&&console.warn("THREE.Color: Alpha component of "+
a+" will be ignored.")}var c;if(c=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=c[2];switch(c[1]){case "rgb":case "rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,
parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;case "hsl":case "hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var d=parseFloat(c[1])/360,e=parseInt(c[2],10)/100,f=parseInt(c[3],10)/100;b(c[5]);return this.setHSL(d,e,f)}}}else if(c=/^\#([A-Fa-f0-9]+)$/.exec(a)){c=c[1];d=c.length;if(3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+
c.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}a&&0<a.length&&(c=si[a],void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,
b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var c=0<b?1/b:1;this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<
0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f,f=0.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();
d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},sub:function(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);this.b=Math.max(0,this.b-a.b);return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=
a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},toJSON:function(){return this.getHex()}});var ta={common:{diffuse:{value:new X(15658734)},opacity:{value:1},
map:{value:null},uvTransform:{value:new l},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new c(1,1)}},displacementmap:{displacementMap:{value:null},
displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new X(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},
spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},
skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new X(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new l}}},yc={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||
e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}},Ua={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",
color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",
defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",
emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",
envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",
fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",
gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",
logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",
map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",
metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",
normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",
packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",
uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",
uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",
cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",
equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",
normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},
Mf={basic:{uniforms:yc.merge([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.fog]),vertexShader:Ua.meshbasic_vert,fragmentShader:Ua.meshbasic_frag},lambert:{uniforms:yc.merge([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.fog,ta.lights,{emissive:{value:new X(0)}}]),vertexShader:Ua.meshlambert_vert,fragmentShader:Ua.meshlambert_frag},phong:{uniforms:yc.merge([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,
ta.gradientmap,ta.fog,ta.lights,{emissive:{value:new X(0)},specular:{value:new X(1118481)},shininess:{value:30}}]),vertexShader:Ua.meshphong_vert,fragmentShader:Ua.meshphong_frag},standard:{uniforms:yc.merge([ta.common,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.roughnessmap,ta.metalnessmap,ta.fog,ta.lights,{emissive:{value:new X(0)},roughness:{value:0.5},metalness:{value:0.5},envMapIntensity:{value:1}}]),vertexShader:Ua.meshphysical_vert,fragmentShader:Ua.meshphysical_frag},
points:{uniforms:yc.merge([ta.points,ta.fog]),vertexShader:Ua.points_vert,fragmentShader:Ua.points_frag},dashed:{uniforms:yc.merge([ta.common,ta.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ua.linedashed_vert,fragmentShader:Ua.linedashed_frag},depth:{uniforms:yc.merge([ta.common,ta.displacementmap]),vertexShader:Ua.depth_vert,fragmentShader:Ua.depth_frag},normal:{uniforms:yc.merge([ta.common,ta.bumpmap,ta.normalmap,ta.displacementmap,{opacity:{value:1}}]),vertexShader:Ua.normal_vert,
fragmentShader:Ua.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ua.cube_vert,fragmentShader:Ua.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ua.equirect_vert,fragmentShader:Ua.equirect_frag},distanceRGBA:{uniforms:yc.merge([ta.common,ta.displacementmap,{referencePosition:{value:new e},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:Ua.distanceRGBA_vert,fragmentShader:Ua.distanceRGBA_frag},shadow:{uniforms:yc.merge([ta.lights,
ta.fog,{color:{value:new X(0)},opacity:{value:1}}]),vertexShader:Ua.shadow_vert,fragmentShader:Ua.shadow_frag}};Mf.physical={uniforms:yc.merge([Mf.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ua.meshphysical_vert,fragmentShader:Ua.meshphysical_frag};Wb.prototype=Object.create(n.prototype);Wb.prototype.constructor=Wb;var pi=0;aa.prototype=Object.assign(Object.create(b.prototype),{constructor:aa,isMaterial:!0,onBeforeCompile:function(){},setValues:function(a){if(void 0!==
a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===c?!0:!1;else{var d=this[b];void 0===d?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]="overdraw"===b?Number(c):c}}},toJSON:function(a){function b(a){var c=
[],v;for(v in a){var d=a[v];delete d.metadata;c.push(d)}return c}var c=void 0===a||"string"===typeof a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid;d.type=this.type;""!==this.name&&(d.name=this.name);this.color&&this.color.isColor&&(d.color=this.color.getHex());void 0!==this.roughness&&(d.roughness=this.roughness);void 0!==this.metalness&&(d.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex());
1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex());void 0!==this.shininess&&(d.shininess=this.shininess);void 0!==this.clearCoat&&(d.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(d.clearCoatRoughness=this.clearCoatRoughness);this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&
(d.lightMap=this.lightMap.toJSON(a).uuid);this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&
(d.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(a).uuid,d.reflectivity=this.reflectivity);this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=
this.gradientMap.toJSON(a).uuid);void 0!==this.size&&(d.size=this.size);void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation);this.blending!==Hc&&(d.blending=this.blending);!0===this.flatShading&&(d.flatShading=this.flatShading);this.side!==Zf&&(d.side=this.side);this.vertexColors!==td&&(d.vertexColors=this.vertexColors);1>this.opacity&&(d.opacity=this.opacity);!0===this.transparent&&(d.transparent=this.transparent);d.depthFunc=this.depthFunc;d.depthTest=this.depthTest;d.depthWrite=
this.depthWrite;0!==this.rotation&&(d.rotation=this.rotation);1!==this.linewidth&&(d.linewidth=this.linewidth);void 0!==this.dashSize&&(d.dashSize=this.dashSize);void 0!==this.gapSize&&(d.gapSize=this.gapSize);void 0!==this.scale&&(d.scale=this.scale);!0===this.dithering&&(d.dithering=!0);0<this.alphaTest&&(d.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(d.wireframe=this.wireframe);1<this.wireframeLinewidth&&(d.wireframeLinewidth=
this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(d.morphTargets=!0);!0===this.skinning&&(d.skinning=!0);!1===this.visible&&(d.visible=!1);"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData);c&&(c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a));return d},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.name=a.name;this.fog=a.fog;this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;
this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b)for(var d=
b.length,c=Array(d),e=0;e!==d;++e)c[e]=b[e].clone();this.clippingPlanes=c;this.shadowSide=a.shadowSide;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Fb.prototype=Object.create(aa.prototype);Fb.prototype.constructor=Fb;Fb.prototype.isMeshDepthMaterial=!0;Fb.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;
this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};Jb.prototype=Object.create(aa.prototype);Jb.prototype.constructor=Jb;Jb.prototype.isMeshDistanceMaterial=!0;Jb.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.referencePosition.copy(a.referencePosition);this.nearDistance=a.nearDistance;this.farDistance=a.farDistance;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this};Object.assign(fb.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;h<k;h+=3){var l=a[h],m=a[h+1],n=a[h+2];l<b&&(b=l);m<c&&(c=m);n<d&&(d=n);l>e&&(e=l);m>f&&(f=m);n>g&&(g=n)}this.min.set(b,
c,d);this.max.set(e,f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;h<k;h++){var l=a.getX(h),m=a.getY(h),n=a.getZ(h);l<b&&(b=l);m<c&&(c=m);n<d&&(d=n);l>e&&(e=l);m>f&&(f=m);n>g&&(g=n)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new e;return function(b,
c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(a){this.makeEmpty();return this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<
this.min.z},getCenter:function(a){a=a||new e;return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(a){a=a||new e;return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},expandByObject:function(){function a(v){var e=
v.geometry;if(void 0!==e)if(e.isGeometry)for(e=e.vertices,c=0,d=e.length;c<d;c++)f.copy(e[c]),f.applyMatrix4(v.matrixWorld),b.expandByPoint(f);else if(e.isBufferGeometry&&(e=e.attributes.position,void 0!==e))for(c=0,d=e.count;c<d;c++)f.fromBufferAttribute(e,c).applyMatrix4(v.matrixWorld),b.expandByPoint(f)}var b,c,d,f=new e;return function(c){b=this;c.updateMatrixWorld(!0);c.traverse(a);return this}}(),containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||
a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return(b||new e).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||
a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a=new e;return function(b){this.clampPoint(b.center,a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){var b,c;0<a.normal.x?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x);0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):
(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=a.constant&&c>=a.constant},intersectsTriangle:function(){function a(v){var e,f;e=0;for(f=v.length-3;e<=f;e+=3){k.fromArray(v,e);var g=m.x*Math.abs(k.x)+m.y*Math.abs(k.y)+m.z*Math.abs(k.z),h=b.dot(k),u=c.dot(k),S=d.dot(k);if(Math.max(-Math.max(h,u,S),Math.min(h,u,S))>g)return!1}return!0}var b=new e,c=new e,d=new e,f=new e,g=new e,h=new e,k=new e,l=new e,m=new e,n=new e;return function(e){if(this.isEmpty())return!1;this.getCenter(l);m.subVectors(this.max,
l);b.subVectors(e.a,l);c.subVectors(e.b,l);d.subVectors(e.c,l);f.subVectors(c,b);g.subVectors(d,c);h.subVectors(b,d);e=[0,-f.z,f.y,0,-g.z,g.y,0,-h.z,h.y,f.z,0,-f.x,g.z,0,-g.x,h.z,0,-h.x,-f.y,f.x,0,-g.y,g.x,0,-h.y,h.x,0];if(!a(e))return!1;e=[1,0,0,0,1,0,0,0,1];if(!a(e))return!1;n.crossVectors(f,g);e=[n.x,n.y,n.z];return a(e)}}(),clampPoint:function(a,b){return(b||new e).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new e;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),
getBoundingSphere:function(){var a=new e;return function(b){b=b||new hb;this.getCenter(b.center);b.radius=0.5*this.getSize(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new e,new e,new e,new e,new e,new e,new e,new e];return function(b){if(this.isEmpty())return this;a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);
a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);
return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(hb.prototype,{set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new fb;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).getCenter(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));this.radius=Math.sqrt(e);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);
this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,
b){var c=this.center.distanceToSquared(a),d=b||new e;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new fb;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&
a.radius===this.radius}});Object.assign(ib.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new e,b=new e;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return(b||
new e).copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new e;return function(b,c){var d=c||new e,f=b.delta(a),g=this.normal.dot(f);if(0===g){if(0===this.distanceToPoint(b.start))return d.copy(b.start)}else return g=-(b.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:d.copy(f).multiplyScalar(g).add(b.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},
intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return(a||new e).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new e,b=new l;return function(c,d){var e=d||b.getNormalMatrix(c),f=this.coplanarPoint(a).applyMatrix4(c),e=this.normal.applyMatrix3(e).normalize();this.constant=-f.dot(e);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===
this.constant}});Object.assign(Bb.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],m=c[8],n=c[9],p=c[10],s=c[11],q=c[12],r=c[13],w=c[14],c=c[15];
b[0].setComponents(f-a,l-g,s-m,c-q).normalize();b[1].setComponents(f+a,l+g,s+m,c+q).normalize();b[2].setComponents(f+d,l+h,s+n,c+r).normalize();b[3].setComponents(f-d,l-h,s-n,c-r).normalize();b[4].setComponents(f-e,l-k,s-p,c-w).normalize();b[5].setComponents(f+e,l+k,s+p,c+w).normalize();return this},intersectsObject:function(){var a=new hb;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),
intersectsSprite:function(){var a=new hb;return function(b){a.center.set(0,0,0);a.radius=0.7071067811865476;a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new e,b=new e;return function(c){for(var d=this.planes,e=0;6>e;e++){var f=d[e];a.x=0<f.normal.x?c.min.x:c.max.x;b.x=0<f.normal.x?c.max.x:c.min.x;a.y=0<f.normal.y?
c.min.y:c.max.y;b.y=0<f.normal.y?c.max.y:c.min.y;a.z=0<f.normal.z?c.min.z:c.max.z;b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}});wb.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");wb.DefaultOrder="XYZ";Object.defineProperties(wb.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},
y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a;this.onChangeCallback()}}});Object.assign(wb.prototype,{isEuler:!0,set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},
copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=Ba.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],l=e[9],m=e[2],n=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),0.99999>Math.abs(g)?(this._x=Math.atan2(-l,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(l,-1,1)),0.99999>Math.abs(l)?(this._y=Math.atan2(g,e),this._z=
Math.atan2(h,k)):(this._y=Math.atan2(-m,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),0.99999>Math.abs(n)?(this._y=Math.atan2(-m,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(m,-1,1)),0.99999>Math.abs(m)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),0.99999>Math.abs(h)?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(g,e))):
"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),0.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-l,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new d;return function(b,c,d){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},
reorder:function(){var a=new g;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?
a.set(this._x,this._y,this._z):new e(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(ad.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!==(this.mask&a.mask)}});var qi=0;U.DefaultUp=new e(0,1,0);U.DefaultMatrixAutoUpdate=!0;U.prototype=Object.assign(Object.create(b.prototype),
{constructor:U,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){this.quaternion.premultiply(a);return this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},
setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new g;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateOnWorldAxis:function(){var a=new g;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.premultiply(a);return this}}(),rotateX:function(){var a=new e(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new e(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),
rotateZ:function(){var a=new e(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new e;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=new e(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new e(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new e(0,0,1);return function(b){return this.translateOnAxis(a,
b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new d;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new d,b=new e;return function(c,d,e){c.isVector3?b.copy(c):b.set(c,d,e);this.isCamera?a.lookAt(this.position,b,this.up):a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);
return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),
this.children.splice(b,1));return this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){a=a||new e;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=
new e,b=new e;return function(c){c=c||new g;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldRotation:function(){var a=new g;return function(b){b=b||new wb;this.getWorldQuaternion(a);return b.setFromQuaternion(a,this.rotation.order,!1)}}(),getWorldScale:function(){var a=new e,b=new g;return function(c){c=c||new e;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(){var a=new g;return function(b){b=b||new e;this.getWorldQuaternion(a);
return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&
this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},toJSON:function(a){function b(c,d){void 0===c[d.uuid]&&(c[d.uuid]=d.toJSON(a));return d.uuid}function c(a){var b=[],v;for(v in a){var d=a[v];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"===typeof a,
e={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData);f.matrix=this.matrix.toArray();if(void 0!==this.geometry){f.geometry=b(a.geometries,this.geometry);
var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=g}else f.material=b(a.materials,this.material);if(0<this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){var d=
c(a.geometries),h=c(a.materials),k=c(a.textures),l=c(a.images),g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<l.length&&(e.images=l);0<g.length&&(e.shapes=g)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);
this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(var c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}});Na.prototype=Object.assign(Object.create(U.prototype),{constructor:Na,isCamera:!0,
copy:function(a,b){U.prototype.copy.call(this,a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this},getWorldDirection:function(){var a=new g;return function(b){b=b||new e;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}(),updateMatrixWorld:function(a){U.prototype.updateMatrixWorld.call(this,a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});pa.prototype=
Object.assign(Object.create(Na.prototype),{constructor:pa,isOrthographicCamera:!0,copy:function(a,b){Na.prototype.copy.call(this,a,b);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=
a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a,c=c+a,a=d+b,b=d-b;if(null!==this.view&&this.view.enabled)var c=this.zoom/(this.view.width/this.view.fullWidth),
b=this.zoom/(this.view.height/this.view.fullHeight),f=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height,e=e+this.view.offsetX/c*f,c=e+this.view.width/c*f,a=a-this.view.offsetY/b*d,b=a-this.view.height/b*d;this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far)},toJSON:function(a){a=U.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;
a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}});Object.assign(Cb.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});
var hi=0;ma.prototype=Object.assign(Object.create(b.prototype),{constructor:ma,isGeometry:!0,applyMatrix:function(a){for(var b=(new l).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();
this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a=new d;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new d;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new d;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new d;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=
new d;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new U;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,c,v,e){var C=void 0!==k?[p[a].clone(),p[c].clone(),p[v].clone()]:[],f=void 0!==l?[d.colors[a].clone(),d.colors[c].clone(),d.colors[v].clone()]:[];e=new Cb(a,c,v,C,f,e);d.faces.push(e);void 0!==m&&d.faceVertexUvs[0].push([s[a].clone(),s[c].clone(),s[v].clone()]);void 0!==
n&&d.faceVertexUvs[1].push([q[a].clone(),q[c].clone(),q[v].clone()])}var d=this,f=null!==a.index?a.index.array:void 0,g=a.attributes,h=g.position.array,k=void 0!==g.normal?g.normal.array:void 0,l=void 0!==g.color?g.color.array:void 0,m=void 0!==g.uv?g.uv.array:void 0,n=void 0!==g.uv2?g.uv2.array:void 0;void 0!==n&&(this.faceVertexUvs[1]=[]);for(var p=[],s=[],q=[],r=g=0;g<h.length;g+=3,r+=2)d.vertices.push(new e(h[g],h[g+1],h[g+2])),void 0!==k&&p.push(new e(k[g],k[g+1],k[g+2])),void 0!==l&&d.colors.push(new X(l[g],
l[g+1],l[g+2])),void 0!==m&&s.push(new c(m[r],m[r+1])),void 0!==n&&q.push(new c(n[r],n[r+1]));var w=a.groups;if(0<w.length)for(g=0;g<w.length;g++)for(var h=w[g],x=h.start,B=h.count,r=x,x=x+B;r<x;r+=3)void 0!==f?b(f[r],f[r+1],f[r+2],h.materialIndex):b(r,r+1,r+2,h.materialIndex);else if(void 0!==f)for(g=0;g<f.length;g+=3)b(f[g],f[g+1],f[g+2]);else for(g=0;g<h.length/3;g+=3)b(g,g+1,g+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&
(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var a=this.boundingBox.getCenter().negate();this.translate(a.x,a.y,a.z);return a},normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius,b=0===b?1:1/b,c=new d;c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},computeFaceNormals:function(){for(var a=new e,b=new e,c=0,d=this.faces.length;c<d;c++){var f=this.faces[c],
g=this.vertices[f.a],h=this.vertices[f.b];a.subVectors(this.vertices[f.c],h);b.subVectors(g,h);a.cross(b);a.normalize();f.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b,c,d;d=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)d[b]=new e;if(a){var f,g,h,k=new e,l=new e;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],f=this.vertices[c.a],g=this.vertices[c.b],h=this.vertices[c.c],k.subVectors(h,g),l.subVectors(f,g),k.cross(l),d[c.a].add(k),d[c.b].add(k),
d[c.c].add(k)}else for(this.computeFaceNormals(),a=0,b=this.faces.length;a<b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)d[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],f=c.vertexNormals,3===f.length?(f[0].copy(d[c.a]),f[1].copy(d[c.b]),f[2].copy(d[c.c])):(f[0]=d[c.a].clone(),f[1]=d[c.b].clone(),f[2]=d[c.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var a,
b,c;this.computeFaceNormals();a=0;for(b=this.faces.length;a<b;a++){c=this.faces[a];var d=c.vertexNormals;3===d.length?(d[0].copy(c.normal),d[1].copy(c.normal),d[2].copy(c.normal)):(d[0]=c.normal.clone(),d[1]=c.normal.clone(),d[2]=c.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b,c,d,f;c=0;for(d=this.faces.length;c<d;c++)for(f=this.faces[c],f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=f.normal.clone(),f.__originalVertexNormals||
(f.__originalVertexNormals=[]),a=0,b=f.vertexNormals.length;a<b;a++)f.__originalVertexNormals[a]?f.__originalVertexNormals[a].copy(f.vertexNormals[a]):f.__originalVertexNormals[a]=f.vertexNormals[a].clone();var g=new ma;g.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];f=this.morphNormals[a].faceNormals;var h=this.morphNormals[a].vertexNormals,k,l;c=0;for(d=this.faces.length;c<
d;c++)k=new e,l={a:new e,b:new e,c:new e},f.push(k),h.push(l)}h=this.morphNormals[a];g.vertices=this.morphTargets[a].vertices;g.computeFaceNormals();g.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)f=this.faces[c],k=h.faceNormals[c],l=h.vertexNormals[c],k.copy(f.normal),l.a.copy(f.vertexNormals[0]),l.b.copy(f.vertexNormals[1]),l.c.copy(f.vertexNormals[2])}c=0;for(d=this.faces.length;c<d;c++)f=this.faces[c],f.normal=f.__originalFaceNormal,f.vertexNormals=f.__originalVertexNormals},computeLineDistances:function(){for(var a=
0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fb);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new hb);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,m=this.faceVertexUvs[0],
n=a.faceVertexUvs[0],p=this.colors,s=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new l).getNormalMatrix(b));a=0;for(var q=g.length;a<q;a++){var r=g[a].clone();void 0!==b&&r.applyMatrix4(b);f.push(r)}a=0;for(q=s.length;a<q;a++)p.push(s[a].clone());a=0;for(q=k.length;a<q;a++){var g=k[a],w=g.vertexNormals,s=g.vertexColors,p=new Cb(g.a+e,g.b+e,g.c+e);p.normal.copy(g.normal);void 0!==d&&p.normal.applyMatrix3(d).normalize();b=0;for(f=w.length;b<f;b++)r=w[b].clone(),void 0!==d&&r.applyMatrix3(d).normalize(),
p.vertexNormals.push(r);p.color.copy(g.color);b=0;for(f=s.length;b<f;b++)r=s[b],p.vertexColors.push(r.clone());p.materialIndex=g.materialIndex+c;h.push(p)}a=0;for(q=n.length;a<q;a++)if(c=n[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a)},mergeMesh:function(a){a&&a.isMesh?(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",
a)},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,g;f=0;for(g=this.vertices.length;f<g;f++)d=this.vertices[f],d=Math.round(d.x*e)+"_"+Math.round(d.y*e)+"_"+Math.round(d.z*e),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];a=[];f=0;for(g=this.faces.length;f<g;f++)for(e=this.faces[f],e.a=c[e.a],e.b=c[e.b],e.c=c[e.c],e=[e.a,e.b,e.c],d=0;3>d;d++)if(e[d]===e[(d+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(e=a[f],this.faces.splice(e,1),c=0,g=this.faceVertexUvs.length;c<
g;c++)this.faceVertexUvs[c].splice(e,1);f=this.vertices.length-b.length;this.vertices=b;return f},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new e(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],f,g;d&&d.length===b&&(f=[]);e&&e.length===b&&(g=[]);for(c=
0;c<b;c++){var h=a[c]._id;f&&f.push(d[h]);g&&g.push(e[h])}f&&(this.faceVertexUvs[0]=f);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(b,c,d){return d?b|1<<c:b&~(1<<c)}function b(a){var c=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==l[c])return l[c];l[c]=k.length/3;k.push(a.x,a.y,a.z);return l[c]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==n[b])return n[b];n[b]=m.length;m.push(a.getHex());return n[b]}function d(a){var b=a.x.toString()+a.y.toString();
if(void 0!==s[b])return s[b];s[b]=p.length/2;p.push(a.x,a.y);return s[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}var h=[],k=[],l={},m=[],n={},p=[],s={};for(g=0;g<this.faces.length;g++){var q=this.faces[g],r=void 0!==
this.faceVertexUvs[0][g],w=0<q.normal.length(),x=0<q.vertexNormals.length,B=1!==q.color.r||1!==q.color.g||1!==q.color.b,z=0<q.vertexColors.length,A=0,A=a(A,0,0),A=a(A,1,!0),A=a(A,2,!1),A=a(A,3,r),A=a(A,4,w),A=a(A,5,x),A=a(A,6,B),A=a(A,7,z);h.push(A);h.push(q.a,q.b,q.c);h.push(q.materialIndex);r&&(r=this.faceVertexUvs[0][g],h.push(d(r[0]),d(r[1]),d(r[2])));w&&h.push(b(q.normal));x&&(w=q.vertexNormals,h.push(b(w[0]),b(w[1]),b(w[2])));B&&h.push(c(q.color));z&&(q=q.vertexColors,h.push(c(q[0]),c(q[1]),
c(q[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<m.length&&(e.data.colors=m);0<p.length&&(e.data.uvs=[p]);e.data.faces=h;return e},clone:function(){return(new ma).copy(this)},copy:function(a){var b,c,d,e,f,g;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;d=a.vertices;b=0;for(c=d.length;b<c;b++)this.vertices.push(d[b].clone());
d=a.colors;b=0;for(c=d.length;b<c;b++)this.colors.push(d[b].clone());d=a.faces;b=0;for(c=d.length;b<c;b++)this.faces.push(d[b].clone());b=0;for(c=a.faceVertexUvs.length;b<c;b++){var h=a.faceVertexUvs[b];void 0===this.faceVertexUvs[b]&&(this.faceVertexUvs[b]=[]);d=0;for(e=h.length;d<e;d++){var k=h[d],l=[];f=0;for(g=k.length;f<g;f++)l.push(k[f].clone());this.faceVertexUvs[b].push(l)}}f=a.morphTargets;b=0;for(c=f.length;b<c;b++){g={};g.name=f[b].name;if(void 0!==f[b].vertices)for(g.vertices=[],d=0,e=
f[b].vertices.length;d<e;d++)g.vertices.push(f[b].vertices[d].clone());if(void 0!==f[b].normals)for(g.normals=[],d=0,e=f[b].normals.length;d<e;d++)g.normals.push(f[b].normals[d].clone());this.morphTargets.push(g)}f=a.morphNormals;b=0;for(c=f.length;b<c;b++){g={};if(void 0!==f[b].vertexNormals)for(g.vertexNormals=[],d=0,e=f[b].vertexNormals.length;d<e;d++)h=f[b].vertexNormals[d],k={},k.a=h.a.clone(),k.b=h.b.clone(),k.c=h.c.clone(),g.vertexNormals.push(k);if(void 0!==f[b].faceNormals)for(g.faceNormals=
[],d=0,e=f[b].faceNormals.length;d<e;d++)g.faceNormals.push(f[b].faceNormals[d].clone());this.morphNormals.push(g)}d=a.skinWeights;b=0;for(c=d.length;b<c;b++)this.skinWeights.push(d[b].clone());d=a.skinIndices;b=0;for(c=d.length;b<c;b++)this.skinIndices.push(d[b].clone());d=a.lineDistances;b=0;for(c=d.length;b<c;b++)this.lineDistances.push(d[b]);b=a.boundingBox;null!==b&&(this.boundingBox=b.clone());b=a.boundingSphere;null!==b&&(this.boundingSphere=b.clone());this.elementsNeedUpdate=a.elementsNeedUpdate;
this.verticesNeedUpdate=a.verticesNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(ra.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(ra.prototype,{isBufferAttribute:!0,setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
this.count=void 0!==a?a.length/this.itemSize:0;this.array=a},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=
this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new X);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyIndicesArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];b[c++]=f.a;b[c++]=f.b;b[c++]=f.c}return this},copyVector2sArray:function(a){for(var b=this.array,d=0,e=0,f=a.length;e<f;e++){var g=a[e];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",
e),g=new c);b[d++]=g.x;b[d++]=g.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,f=a.length;d<f;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),g=new e);b[c++]=g.x;b[c++]=g.y;b[c++]=g.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new B);b[c++]=f.x;b[c++]=f.y;
b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+
3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},onUpload:function(a){this.onUploadCallback=a;return this},clone:function(){return(new this.constructor(this.array,
this.itemSize)).copy(this)}});Kb.prototype=Object.create(ra.prototype);Kb.prototype.constructor=Kb;Gb.prototype=Object.create(ra.prototype);Gb.prototype.constructor=Gb;jb.prototype=Object.create(ra.prototype);jb.prototype.constructor=jb;dc.prototype=Object.create(ra.prototype);dc.prototype.constructor=dc;ab.prototype=Object.create(ra.prototype);ab.prototype.constructor=ab;La.prototype=Object.create(ra.prototype);La.prototype.constructor=La;Aa.prototype=Object.create(ra.prototype);Aa.prototype.constructor=
Aa;da.prototype=Object.create(ra.prototype);da.prototype.constructor=da;ob.prototype=Object.create(ra.prototype);ob.prototype.constructor=ob;Object.assign(V.prototype,{computeGroups:function(a){var b,c=[],d=void 0;a=a.faces;for(var e=0;e<a.length;e++){var f=a[e];f.materialIndex!==d&&(d=f.materialIndex,void 0!==b&&(b.count=3*e-b.start,c.push(b)),b={start:3*e,materialIndex:d})}void 0!==b&&(b.count=3*e-b.start,c.push(b));this.groups=c},fromGeometry:function(a){var b=a.faces,d=a.vertices,e=a.faceVertexUvs,
f=e[0]&&0<e[0].length,g=e[1]&&0<e[1].length,h=a.morphTargets,k=h.length,l;if(0<k){l=[];for(var m=0;m<k;m++)l[m]=[];this.morphTargets.position=l}var n=a.morphNormals,p=n.length,s;if(0<p){s=[];for(m=0;m<p;m++)s[m]=[];this.morphTargets.normal=s}for(var q=a.skinIndices,r=a.skinWeights,w=q.length===d.length,x=r.length===d.length,m=0;m<b.length;m++){var B=b[m];this.vertices.push(d[B.a],d[B.b],d[B.c]);var z=B.vertexNormals;3===z.length?this.normals.push(z[0],z[1],z[2]):(z=B.normal,this.normals.push(z,z,
z));z=B.vertexColors;3===z.length?this.colors.push(z[0],z[1],z[2]):(z=B.color,this.colors.push(z,z,z));!0===f&&(z=e[0][m],void 0!==z?this.uvs.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new c,new c,new c)));!0===g&&(z=e[1][m],void 0!==z?this.uvs2.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new c,new c,new c)));for(z=0;z<k;z++){var A=h[z].vertices;l[z].push(A[B.a],
A[B.b],A[B.c])}for(z=0;z<p;z++)A=n[z].vertexNormals[m],s[z].push(A.a,A.b,A.c);w&&this.skinIndices.push(q[B.a],q[B.b],q[B.c]);x&&this.skinWeights.push(r[B.a],r[B.b],r[B.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this}});var ii=1;ba.prototype=Object.assign(Object.create(b.prototype),{constructor:ba,isBufferGeometry:!0,
getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<za(a)?Aa:ab)(a,1):this.index=a},addAttribute:function(a,b,c){if(b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute)if("index"===a)console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b);else return this.attributes[a]=b,this;else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new ra(b,c))},
getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new l).getNormalMatrix(a).applyToBufferAttribute(b),
b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a=new d;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new d;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new d;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new d;return function(b,
c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new d;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new U;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.getCenter().negate();this.translate(a.x,a.y,a.z);return a},setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new da(3*b.vertices.length,
3);var c=new da(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new da(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);
return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}this.addAttribute("position",new da(b,3));return this},updateFromObject:function(a){var b=a.geometry;if(a.isMesh){var c=b.__directGeometry;!0===b.elementsNeedUpdate&&(c=void 0,b.elementsNeedUpdate=!1);if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;
c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=!1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),
c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new V).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},
fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new ra(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new ra(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new ra(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new ra(b,2)).copyVector2sArray(a.uvs)));
0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new ra(b,2)).copyVector2sArray(a.uvs2)));0<a.indices.length&&(b=new (65535<za(a.indices)?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex((new ra(b,1)).copyIndicesArray(a.indices)));this.groups=a.groups;for(var c in a.morphTargets){for(var b=[],d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=d[e],h=new da(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new da(4*
a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new da(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fb);var a=this.attributes.position;void 0!==a?this.boundingBox.setFromBufferAttribute(a):
this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new fb,b=new e;return function(){null===this.boundingSphere&&(this.boundingSphere=new hb);var c=this.attributes.position;if(c){var d=this.boundingSphere.center;a.setFromBufferAttribute(c);
a.getCenter(d);for(var e=0,f=0,g=c.count;f<g;f++)b.x=c.getX(f),b.y=c.getY(f),b.z=c.getZ(f),e=Math.max(e,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(e);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;
if(void 0===b.normal)this.addAttribute("normal",new ra(new Float32Array(d.length),3));else for(var f=b.normal.array,g=0,h=f.length;g<h;g++)f[g]=0;var f=b.normal.array,k,l,m,n=new e,p=new e,s=new e,q=new e,r=new e;if(a){a=a.array;0===c.length&&this.addGroup(0,a.length);for(var w=0,x=c.length;w<x;++w)for(g=c[w],h=g.start,k=g.count,g=h,h+=k;g<h;g+=3)k=3*a[g+0],l=3*a[g+1],m=3*a[g+2],n.fromArray(d,k),p.fromArray(d,l),s.fromArray(d,m),q.subVectors(s,p),r.subVectors(n,p),q.cross(r),f[k]+=q.x,f[k+1]+=q.y,
f[k+2]+=q.z,f[l]+=q.x,f[l+1]+=q.y,f[l+2]+=q.z,f[m]+=q.x,f[m+1]+=q.y,f[m+2]+=q.z}else for(g=0,h=d.length;g<h;g+=9)n.fromArray(d,g),p.fromArray(d,g+3),s.fromArray(d,g+6),q.subVectors(s,p),r.subVectors(n,p),q.cross(r),f[g]=q.x,f[g+1]=q.y,f[g+2]=q.z,f[g+3]=q.x,f[g+4]=q.y,f[g+5]=q.z,f[g+6]=q.x,f[g+7]=q.y,f[g+8]=q.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,b){if(a&&a.isBufferGeometry){void 0===b&&(b=0);var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d])for(var e=c[d].array,
f=a.attributes[d],g=f.array,h=0,f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){var a=new e;return function(){for(var b=this.attributes.normal,c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.normalize(),b.setXYZ(c,a.x,a.y,a.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),
this;var a=new ba,b=this.index.array,c=this.attributes,d;for(d in c){for(var e=c[d],f=e.array,e=e.itemSize,g=new f.constructor(b.length*e),h=0,k=0,l=0,m=b.length;l<m;l++)for(var h=b[l]*e,n=0;n<e;n++)g[k++]=f[h++];a.addAttribute(d,new ra(g,e))}return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);if(void 0!==this.parameters){var b=this.parameters,c;for(c in b)void 0!==b[c]&&
(a[c]=b[c]);return a}a.data={attributes:{}};var d=this.index;null!==d&&(b=Array.prototype.slice.call(d.array),a.data.index={type:d.array.constructor.name,array:b});d=this.attributes;for(c in d){var e=d[c],b=Array.prototype.slice.call(e.array);a.data.attributes[c]={itemSize:e.itemSize,type:e.array.constructor.name,array:b,normalized:e.normalized}}c=this.groups;0<c.length&&(a.data.groups=JSON.parse(JSON.stringify(c)));c=this.boundingSphere;null!==c&&(a.data.boundingSphere={center:c.center.toArray(),
radius:c.radius});return a},clone:function(){return(new ba).copy(this)},copy:function(a){var b,c,d;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;c=a.index;null!==c&&this.setIndex(c.clone());c=a.attributes;for(b in c)this.addAttribute(b,c[b].clone());var e=a.morphAttributes;for(b in e){var f=[],g=e[b];c=0;for(d=g.length;c<d;c++)f.push(g[c].clone());this.morphAttributes[b]=f}b=a.groups;c=0;for(d=b.length;c<d;c++)e=
b[c],this.addGroup(e.start,e.count,e.materialIndex);b=a.boundingBox;null!==b&&(this.boundingBox=b.clone());b=a.boundingSphere;null!==b&&(this.boundingSphere=b.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});ca.prototype=Object.create(ma.prototype);ca.prototype.constructor=ca;gb.prototype=Object.create(ba.prototype);gb.prototype.constructor=gb;kb.prototype=Object.create(ma.prototype);kb.prototype.constructor=
kb;M.prototype=Object.create(ba.prototype);M.prototype.constructor=M;pb.prototype=Object.create(aa.prototype);pb.prototype.constructor=pb;pb.prototype.isMeshBasicMaterial=!0;pb.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=
a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};R.prototype=Object.create(aa.prototype);R.prototype.constructor=R;R.prototype.isShaderMaterial=!0;R.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;
this.uniforms=yc.clone(a.uniforms);this.defines=a.defines;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.lights=a.lights;this.clipping=a.clipping;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};R.prototype.toJSON=function(a){a=aa.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};Object.assign(oa.prototype,
{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new e).copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize();return this},recast:function(){var a=new e;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,
b){var c=b||new e;c.subVectors(a,this.origin);var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new e;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=
new e,b=new e,c=new e;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(0.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=0.5*d.distanceTo(e),k=-this.direction.dot(b),l=c.dot(this.direction),m=-c.dot(b),n=c.lengthSq(),p=Math.abs(1-k*k),q;0<p?(d=k*m-l,e=k*l-m,q=h*p,0<=d?e>=-q?e<=q?(h=1/p,d*=h,e*=h,k=d*(d+k*e+2*l)+e*(k*d+e+2*m)+n):(e=h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+n):(e=-h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+n):e<=-q?(d=Math.max(0,-(-k*h+l)),e=0<d?-h:Math.min(Math.max(-h,
-m),h),k=-d*d+e*(e+2*m)+n):e<=q?(d=0,e=Math.min(Math.max(-h,-m),h),k=e*(e+2*m)+n):(d=Math.max(0,-(k*h+l)),e=0<d?h:Math.min(Math.max(-h,-m),h),k=-d*d+e*(e+2*m)+n)):(e=0<k?-h:h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+n);f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),intersectSphere:function(){var a=new e;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d,f=b.radius*b.radius;if(e>f)return null;
f=Math.sqrt(f-e);e=d-f;d+=f;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);
return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,b){var c,d,e,f,g;d=1/this.direction.x;f=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x);0<=f?(e=(a.min.y-h.y)*f,f*=a.max.y-h.y):(e=(a.max.y-h.y)*f,f*=a.min.y-h.y);if(c>f||e>d)return null;if(e>c||c!==c)c=e;if(f<d||d!==d)d=f;0<=g?(e=(a.min.z-h.z)*g,g*=a.max.z-h.z):(e=(a.max.z-h.z)*g,g*=a.min.z-h.z);if(c>g||e>d)return null;if(e>c||c!==c)c=
e;if(g<d||d!==d)d=g;return 0>d?null:this.at(0<=c?c:d,b)},intersectsBox:function(){var a=new e;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new e,b=new e,c=new e,d=new e;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;g=h*this.direction.dot(b.cross(a));
if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(A.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},getCenter:function(a){return(a||
new e).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new e).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,b){var c=b||new e;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new e,b=new e;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),
e=b.dot(a)/e;d&&(e=Ba.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new e;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});Object.assign(fa,{normal:function(){var a=new e;return function(b,c,d,f){f=f||new e;f.subVectors(d,c);a.subVectors(b,c);f.cross(a);b=f.lengthSq();
return 0<b?f.multiplyScalar(1/Math.sqrt(b)):f.set(0,0,0)}}(),barycoordFromPoint:function(){var a=new e,b=new e,c=new e;return function(d,f,g,h,k){a.subVectors(h,f);b.subVectors(g,f);c.subVectors(d,f);d=a.dot(a);f=a.dot(b);g=a.dot(c);var l=b.dot(b);h=b.dot(c);var m=d*l-f*f;k=k||new e;if(0===m)return k.set(-2,-1,-1);m=1/m;l=(l*g-f*h)*m;d=(d*h-f*g)*m;return k.set(1-l-d,d,l)}}(),containsPoint:function(){var a=new e;return function(b,c,d,e){b=fa.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=
b.x+b.y}}()});Object.assign(fa.prototype,{set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new e,b=new e;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),
midpoint:function(a){return(a||new e).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return fa.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new ib).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return fa.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return fa.containsPoint(a,this.a,this.b,this.c)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:function(){var a=
new ib,b=[new A,new A,new A],c=new e,d=new e;return function(f,g){var h=g||new e,k=Infinity;a.setFromCoplanarPoints(this.a,this.b,this.c);a.projectPoint(f,c);if(!0===this.containsPoint(c))h.copy(c);else{b[0].set(this.a,this.b);b[1].set(this.b,this.c);b[2].set(this.c,this.a);for(var l=0;l<b.length;l++){b[l].closestPointToPoint(c,!0,d);var m=c.distanceToSquared(d);m<k&&(k=m,h.copy(d))}}return h}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});ga.prototype=
Object.assign(Object.create(U.prototype),{constructor:ga,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){U.prototype.copy.call(this,a);this.drawMode=a.drawMode;void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));return this},updateMorphTargets:function(){var a=this.geometry,b,c;if(a.isBufferGeometry){if(a=a.morphAttributes,b=Object.keys(a),
0<b.length){var d=a[b[0]];if(void 0!==d)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=d.length;a<b;a++)c=d[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}else if(d=a.morphTargets,void 0!==d&&0<d.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=d.length;a<b;a++)c=d[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a},raycast:function(){function a(b,c,d,v,e,f,g){fa.barycoordFromPoint(b,
c,d,v,B);e.multiplyScalar(B.x);f.multiplyScalar(B.y);g.multiplyScalar(B.z);e.add(f).add(g);return e.clone()}function b(a,c,d,v,e,f,g,h){if(null===(c.side===Gc?v.intersectTriangle(g,f,e,!0,h):v.intersectTriangle(e,f,g,c.side!==ed,h)))return null;A.copy(h);A.applyMatrix4(a.matrixWorld);c=d.ray.origin.distanceTo(A);return c<d.near||c>d.far?null:{distance:c,point:A.clone(),object:a}}function f(c,d,e,g,h,t,y,k){l.fromBufferAttribute(g,t);m.fromBufferAttribute(g,y);n.fromBufferAttribute(g,k);if(c=b(c,c.material,
d,e,l,m,n,z))h&&(r.fromBufferAttribute(h,t),w.fromBufferAttribute(h,y),x.fromBufferAttribute(h,k),c.uv=a(z,l,m,n,r,w,x)),c.face=new Cb(t,y,k,fa.normal(l,m,n)),c.faceIndex=t;return c}var g=new d,h=new oa,k=new hb,l=new e,m=new e,n=new e,p=new e,q=new e,s=new e,r=new c,w=new c,x=new c,B=new e,z=new e,A=new e;return function(c,d){var e=this.geometry,B=this.material,A=this.matrixWorld;if(void 0!==B&&(null===e.boundingSphere&&e.computeBoundingSphere(),k.copy(e.boundingSphere),k.applyMatrix4(A),!1!==c.ray.intersectsSphere(k)&&
(g.getInverse(A),h.copy(c.ray).applyMatrix4(g),null===e.boundingBox||!1!==h.intersectsBox(e.boundingBox)))){var D;if(e.isBufferGeometry){var E,F,B=e.index,P=e.attributes.position,A=e.attributes.uv,Z,H;if(null!==B)for(Z=0,H=B.count;Z<H;Z+=3){if(e=B.getX(Z),E=B.getX(Z+1),F=B.getX(Z+2),D=f(this,c,h,P,A,e,E,F))D.faceIndex=Math.floor(Z/3),d.push(D)}else if(void 0!==P)for(Z=0,H=P.count;Z<H;Z+=3)if(e=Z,E=Z+1,F=Z+2,D=f(this,c,h,P,A,e,E,F))D.index=e,d.push(D)}else if(e.isGeometry){var I,A=Array.isArray(B);
Z=e.vertices;H=e.faces;E=e.faceVertexUvs[0];0<E.length&&(P=E);for(var K=0,L=H.length;K<L;K++){var J=H[K];D=A?B[J.materialIndex]:B;if(void 0!==D){E=Z[J.a];F=Z[J.b];I=Z[J.c];if(!0===D.morphTargets){var G=e.morphTargets,N=this.morphTargetInfluences;l.set(0,0,0);m.set(0,0,0);n.set(0,0,0);for(var O=0,R=G.length;O<R;O++){var $=N[O];if(0!==$){var T=G[O].vertices;l.addScaledVector(p.subVectors(T[J.a],E),$);m.addScaledVector(q.subVectors(T[J.b],F),$);n.addScaledVector(s.subVectors(T[J.c],I),$)}}l.add(E);m.add(F);
n.add(I);E=l;F=m;I=n}if(D=b(this,D,c,h,E,F,I,z))P&&P[K]&&(G=P[K],r.copy(G[0]),w.copy(G[1]),x.copy(G[2]),D.uv=a(z,E,F,I,r,w,x)),D.face=J,D.faceIndex=K,d.push(D)}}}}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});var ri=0;Ya.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ya,isPerspectiveCamera:!0,copy:function(a,b){Na.prototype.copy.call(this,a,b);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=
a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this},setFocalLength:function(a){a=0.5*this.getFilmHeight()/a;this.fov=2*Ba.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(0.5*Ba.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*Ba.RAD2DEG*Math.atan(Math.tan(0.5*Ba.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*
Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},
updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(0.5*Ba.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-0.5*d,f=this.view;if(null!==this.view&&this.view.enabled)var g=f.fullWidth,h=f.fullHeight,e=e+f.offsetX*d/g,b=b-f.offsetY*c/h,d=f.width/g*d,c=f.height/h*c;f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far)},toJSON:function(a){a=U.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=
this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}});Ae.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Ae,isArrayCamera:!0});vd.prototype.isFogExp2=!0;vd.prototype.clone=function(){return new vd(this.color.getHex(),this.density)};vd.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),
density:this.density}};Bc.prototype.isFog=!0;Bc.prototype.clone=function(){return new Bc(this.color.getHex(),this.near,this.far)};Bc.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};nc.prototype=Object.assign(Object.create(U.prototype),{constructor:nc,copy:function(a,b){U.prototype.copy.call(this,a,b);null!==a.background&&(this.background=a.background.clone());null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=
a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this},toJSON:function(a){var b=U.prototype.toJSON.call(this,a);null!==this.background&&(b.object.background=this.background.toJSON(a));null!==this.fog&&(b.object.fog=this.fog.toJSON());return b}});bd.prototype=Object.create(aa.prototype);bd.prototype.constructor=bd;bd.prototype.isSpriteMaterial=!0;bd.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;
this.rotation=a.rotation;return this};Be.prototype=Object.assign(Object.create(U.prototype),{constructor:Be,isSprite:!0,raycast:function(){var a=new e,b=new e,c=new e;return function(d,e){b.setFromMatrixPosition(this.matrixWorld);d.ray.closestPointToPoint(b,a);c.setFromMatrixScale(this.matrixWorld);var f=c.x*c.y/4;b.distanceToSquared(a)>f||(f=d.ray.origin.distanceTo(a),f<d.near||f>d.far||e.push({distance:f,point:a.clone(),face:null,object:this}))}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},
copy:function(a){U.prototype.copy.call(this,a);void 0!==a.center&&this.center.copy(a.center);return this}});Ce.prototype=Object.assign(Object.create(U.prototype),{constructor:Ce,copy:function(a){U.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},
getObjectForDistance:function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:function(){var a=new e;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),update:function(){var a=new e,b=new e;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=
!0;for(var e=1,f=d.length;e<f;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<f;e++)d[e].object.visible=!1}}}(),toJSON:function(a){a=U.prototype.toJSON.call(this,a);a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});Object.assign(dd.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new d;this.bones[a]&&
c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},pose:function(){var a,b,c;b=0;for(c=this.bones.length;b<c;b++)(a=this.bones[b])&&a.matrixWorld.getInverse(this.boneInverses[b]);b=0;for(c=this.bones.length;b<c;b++)if(a=this.bones[b])a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)},update:function(){var a=new d,b=new d;return function(){for(var c=
this.bones,d=this.boneInverses,e=this.boneMatrices,f=this.boneTexture,g=0,h=c.length;g<h;g++)a.multiplyMatrices(c[g]?c[g].matrixWorld:b,d[g]),a.toArray(e,16*g);void 0!==f&&(f.needsUpdate=!0)}}(),clone:function(){return new dd(this.bones,this.boneInverses)},getBoneByName:function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});qf.prototype=Object.assign(Object.create(U.prototype),{constructor:qf,isBone:!0});sf.prototype=Object.assign(Object.create(ga.prototype),
{constructor:sf,isSkinnedMesh:!0,initBones:function(){var a=[],b,c,d,e;if(this.geometry&&void 0!==this.geometry.bones){d=0;for(e=this.geometry.bones.length;d<e;d++)c=this.geometry.bones[d],b=new qf,a.push(b),b.name=c.name,b.position.fromArray(c.pos),b.quaternion.fromArray(c.rotq),void 0!==c.scl&&b.scale.fromArray(c.scl);d=0;for(e=this.geometry.bones.length;d<e;d++)c=this.geometry.bones[d],-1!==c.parent&&null!==c.parent&&void 0!==a[c.parent]?a[c.parent].add(a[d]):this.add(a[d])}this.updateMatrixWorld(!0);
return a},bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var a,b;if(this.geometry&&this.geometry.isGeometry)for(b=0;b<this.geometry.skinWeights.length;b++){var c=this.geometry.skinWeights[b];a=1/c.manhattanLength();Infinity!==a?c.multiplyScalar(a):c.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var c=
new B,d=this.geometry.attributes.skinWeight;for(b=0;b<d.count;b++)c.x=d.getX(b),c.y=d.getY(b),c.z=d.getZ(b),c.w=d.getW(b),a=1/c.manhattanLength(),Infinity!==a?c.multiplyScalar(a):c.set(1,0,0,0),d.setXYZW(b,c.x,c.y,c.z,c.w)}},updateMatrixWorld:function(a){ga.prototype.updateMatrixWorld.call(this,a);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+
this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Ka.prototype=Object.create(aa.prototype);Ka.prototype.constructor=Ka;Ka.prototype.isLineBasicMaterial=!0;Ka.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;return this};Sb.prototype=Object.assign(Object.create(U.prototype),{constructor:Sb,isLine:!0,raycast:function(){var a=new d,b=new oa,
c=new hb;return function(d,f){var g=d.linePrecision,g=g*g,h=this.geometry,k=this.matrixWorld;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(k);if(!1!==d.ray.intersectsSphere(c)){a.getInverse(k);b.copy(d.ray).applyMatrix4(a);var l=new e,m=new e,k=new e,n=new e,p=this&&this.isLineSegments?2:1;if(h.isBufferGeometry){var q=h.index,s=h.attributes.position.array;if(null!==q)for(var q=q.array,h=0,r=q.length-1;h<r;h+=p){var w=q[h+1];l.fromArray(s,3*q[h]);m.fromArray(s,
3*w);w=b.distanceSqToSegment(l,m,n,k);w>g||(n.applyMatrix4(this.matrixWorld),w=d.ray.origin.distanceTo(n),w<d.near||w>d.far||f.push({distance:w,point:k.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}else for(h=0,r=s.length/3-1;h<r;h+=p)l.fromArray(s,3*h),m.fromArray(s,3*h+3),w=b.distanceSqToSegment(l,m,n,k),w>g||(n.applyMatrix4(this.matrixWorld),w=d.ray.origin.distanceTo(n),w<d.near||w>d.far||f.push({distance:w,point:k.clone().applyMatrix4(this.matrixWorld),
index:h,face:null,faceIndex:null,object:this}))}else if(h.isGeometry)for(l=h.vertices,m=l.length,h=0;h<m-1;h+=p)w=b.distanceSqToSegment(l[h],l[h+1],n,k),w>g||(n.applyMatrix4(this.matrixWorld),w=d.ray.origin.distanceTo(n),w<d.near||w>d.far||f.push({distance:w,point:k.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Ra.prototype=Object.assign(Object.create(Sb.prototype),
{constructor:Ra,isLineSegments:!0});Xb.prototype=Object.assign(Object.create(Sb.prototype),{constructor:Xb,isLineLoop:!0});oc.prototype=Object.create(aa.prototype);oc.prototype.constructor=oc;oc.prototype.isPointsMaterial=!0;oc.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;return this};xd.prototype=Object.assign(Object.create(U.prototype),{constructor:xd,isPoints:!0,raycast:function(){var a=
new d,b=new oa,c=new hb;return function(d,f){function g(a,c){var v=b.distanceSqToPoint(a);if(v<n){var e=b.closestPointToPoint(a);e.applyMatrix4(l);var k=d.ray.origin.distanceTo(e);k<d.near||k>d.far||f.push({distance:k,distanceToRay:Math.sqrt(v),point:e.clone(),index:c,face:null,object:h})}}var h=this,k=this.geometry,l=this.matrixWorld,m=d.params.Points.threshold;null===k.boundingSphere&&k.computeBoundingSphere();c.copy(k.boundingSphere);c.applyMatrix4(l);c.radius+=m;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(l);
b.copy(d.ray).applyMatrix4(a);var m=m/((this.scale.x+this.scale.y+this.scale.z)/3),n=m*m,m=new e;if(k.isBufferGeometry){var p=k.index,k=k.attributes.position.array;if(null!==p)for(var q=p.array,p=0,s=q.length;p<s;p++){var r=q[p];m.fromArray(k,3*r);g(m,r)}else for(p=0,q=k.length/3;p<q;p++)m.fromArray(k,3*p),g(m,p)}else for(m=k.vertices,p=0,q=m.length;p<q;p++)g(m[p],p)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});kf.prototype=Object.assign(Object.create(U.prototype),
{constructor:kf,isGroup:!0});zg.prototype=Object.assign(Object.create(n.prototype),{constructor:zg,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});pc.prototype=Object.create(n.prototype);pc.prototype.constructor=pc;pc.prototype.isCompressedTexture=!0;cd.prototype=Object.create(n.prototype);cd.prototype.constructor=cd;cd.prototype.isDepthTexture=!0;wd.prototype=Object.create(ba.prototype);wd.prototype.constructor=wd;$d.prototype=Object.create(ma.prototype);
$d.prototype.constructor=$d;ae.prototype=Object.create(ba.prototype);ae.prototype.constructor=ae;be.prototype=Object.create(ma.prototype);be.prototype.constructor=be;sb.prototype=Object.create(ba.prototype);sb.prototype.constructor=sb;Cc.prototype=Object.create(ma.prototype);Cc.prototype.constructor=Cc;Oc.prototype=Object.create(sb.prototype);Oc.prototype.constructor=Oc;De.prototype=Object.create(ma.prototype);De.prototype.constructor=De;yd.prototype=Object.create(sb.prototype);yd.prototype.constructor=
yd;tf.prototype=Object.create(ma.prototype);tf.prototype.constructor=tf;zd.prototype=Object.create(sb.prototype);zd.prototype.constructor=zd;Ee.prototype=Object.create(ma.prototype);Ee.prototype.constructor=Ee;de.prototype=Object.create(sb.prototype);de.prototype.constructor=de;ce.prototype=Object.create(ma.prototype);ce.prototype.constructor=ce;Pc.prototype=Object.create(ba.prototype);Pc.prototype.constructor=Pc;Ad.prototype=Object.create(ma.prototype);Ad.prototype.constructor=Ad;ee.prototype=Object.create(ba.prototype);
ee.prototype.constructor=ee;fe.prototype=Object.create(ma.prototype);fe.prototype.constructor=fe;ge.prototype=Object.create(ba.prototype);ge.prototype.constructor=ge;var ti={triangulate:function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=Ag(a,0,e,c,!0),g=[];if(!f)return g;var h,k,l,m;if(d){var n=c,d=[],p,q,s;m=0;for(p=b.length;m<p;m++)q=b[m]*n,s=m<p-1?b[m+1]*n:a.length,q=Ag(a,q,s,n,!1),q===q.next&&(q.steiner=!0),d.push(jh(q));d.sort(Ge);for(m=0;m<d.length;m++){b=d[m];n=f;if(n=uf(b,n))b=
Bg(n,b),he(b,b.next);f=he(f,f.next)}}if(a.length>80*c){h=l=a[0];k=d=a[1];for(n=c;n<e;n+=c)m=a[n],b=a[n+1],m<h&&(h=m),b<k&&(k=b),m>l&&(l=m),b>d&&(d=b);l=Math.max(l-h,d-k);l=0!==l?1/l:0}Cd(f,g,c,h,k,l);return g}},we={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return 0.5*c},isClockWise:function(a){return 0>we.area(a)},triangulateShape:function(a,b){var c=[],d=[],e=[];Tb(a);tb(c,a);var f=a.length;b.forEach(Tb);for(var g=0;g<b.length;g++)d.push(f),f+=b[g].length,
tb(c,b[g]);c=ti.triangulate(c,d);for(g=0;g<c.length;g+=3)e.push(c.slice(g,g+3));return e}};lb.prototype=Object.create(ma.prototype);lb.prototype.constructor=lb;Sa.prototype=Object.create(ba.prototype);Sa.prototype.constructor=Sa;Sa.prototype.getArrays=function(){var a=this.getAttribute("position"),a=a?Array.prototype.slice.call(a.array):[],b=this.getAttribute("uv"),b=b?Array.prototype.slice.call(b.array):[],c=this.index,c=c?Array.prototype.slice.call(c.array):[];return{position:a,uv:b,index:c}};Sa.prototype.addShapeList=
function(a,b){var c=a.length;b.arrays=this.getArrays();for(var d=0;d<c;d++)this.addShape(a[d],b);this.setIndex(b.arrays.index);this.addAttribute("position",new da(b.arrays.position,3));this.addAttribute("uv",new da(b.arrays.uv,2))};Sa.prototype.addShape=function(a,b){function d(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function f(a,b,d){var v,e,g;e=a.x-b.x;g=a.y-b.y;v=d.x-a.x;var h=d.y-a.y,t=e*e+g*g;if(Math.abs(e*h-g*v)>Number.EPSILON){var k=
Math.sqrt(t),C=Math.sqrt(v*v+h*h),t=b.x-g/k;b=b.y+e/k;h=((d.x-h/C-t)*h-(d.y+v/C-b)*v)/(e*h-g*v);v=t+e*h-a.x;e=b+g*h-a.y;g=v*v+e*e;if(2>=g)return new c(v,e);g=Math.sqrt(g/2)}else a=!1,e>Number.EPSILON?v>Number.EPSILON&&(a=!0):e<-Number.EPSILON?v<-Number.EPSILON&&(a=!0):Math.sign(g)===Math.sign(h)&&(a=!0),a?(v=-g,g=Math.sqrt(t)):(v=e,e=g,g=Math.sqrt(t/2));return new c(v/g,e/g)}function g(a,b){var c,d;for(M=a.length;0<=--M;){c=M;d=M-1;0>d&&(d=a.length-1);for(var v=0,e=D+2*x,v=0;v<e;v++){var f=ca*v,h=
ca*(v+1),t=b+d+f,k=b+d+h,h=b+c+h;l(b+c+f);l(t);l(h);l(t);l(k);l(h);f=p.length/3;f=Z.generateSideWallUV(N,p,f-6,f-3,f-2,f-1);m(f[0]);m(f[1]);m(f[3]);m(f[1]);m(f[2]);m(f[3])}}}function h(a,b,c){r.push(a);r.push(b);r.push(c)}function k(a,b,c){l(a);l(b);l(c);a=p.length/3;a=Z.generateTopUV(N,p,a-3,a-2,a-1);m(a[0]);m(a[1]);m(a[2])}function l(a){q.push(p.length/3);p.push(r[3*a+0]);p.push(r[3*a+1]);p.push(r[3*a+2])}function m(a){s.push(a.x);s.push(a.y)}var n=b.arrays?b.arrays:this.getArrays(),p=n.position,
q=n.index,s=n.uv,r=[],n=void 0!==b.amount?b.amount:100,w=void 0!==b.bevelThickness?b.bevelThickness:6,B=void 0!==b.bevelSize?b.bevelSize:w-2,x=void 0!==b.bevelSegments?b.bevelSegments:3,z=void 0!==b.bevelEnabled?b.bevelEnabled:!0,A=void 0!==b.curveSegments?b.curveSegments:12,D=void 0!==b.steps?b.steps:1,E=b.extrudePath,F,P=!1,Z=void 0!==b.UVGenerator?b.UVGenerator:lb.WorldUVGenerator,H,I,K,J;E&&(F=E.getSpacedPoints(D),P=!0,z=!1,H=void 0!==b.frames?b.frames:E.computeFrenetFrames(D,!1),I=new e,K=new e,
J=new e);z||(B=w=x=0);var L,G,O,N=this,E=a.extractPoints(A),A=E.shape,$=E.holes;if(!we.isClockWise(A))for(A=A.reverse(),G=0,O=$.length;G<O;G++)L=$[G],we.isClockWise(L)&&($[G]=L.reverse());var R=we.triangulateShape(A,$),T=A;G=0;for(O=$.length;G<O;G++)L=$[G],A=A.concat(L);var V,U,Q,ba,X,ca=A.length,aa,ea=R.length,E=[],M=0;Q=T.length;V=Q-1;for(U=M+1;M<Q;M++,V++,U++)V===Q&&(V=0),U===Q&&(U=0),E[M]=f(T[M],T[V],T[U]);var ha=[],fa,ga=E.concat();G=0;for(O=$.length;G<O;G++){L=$[G];fa=[];M=0;Q=L.length;V=Q-
1;for(U=M+1;M<Q;M++,V++,U++)V===Q&&(V=0),U===Q&&(U=0),fa[M]=f(L[M],L[V],L[U]);ha.push(fa);ga=ga.concat(fa)}for(V=0;V<x;V++){Q=V/x;ba=w*Math.cos(Q*Math.PI/2);U=B*Math.sin(Q*Math.PI/2);M=0;for(Q=T.length;M<Q;M++)X=d(T[M],E[M],U),h(X.x,X.y,-ba);G=0;for(O=$.length;G<O;G++)for(L=$[G],fa=ha[G],M=0,Q=L.length;M<Q;M++)X=d(L[M],fa[M],U),h(X.x,X.y,-ba)}U=B;for(M=0;M<ca;M++)X=z?d(A[M],ga[M],U):A[M],P?(K.copy(H.normals[0]).multiplyScalar(X.x),I.copy(H.binormals[0]).multiplyScalar(X.y),J.copy(F[0]).add(K).add(I),
h(J.x,J.y,J.z)):h(X.x,X.y,0);for(Q=1;Q<=D;Q++)for(M=0;M<ca;M++)X=z?d(A[M],ga[M],U):A[M],P?(K.copy(H.normals[Q]).multiplyScalar(X.x),I.copy(H.binormals[Q]).multiplyScalar(X.y),J.copy(F[Q]).add(K).add(I),h(J.x,J.y,J.z)):h(X.x,X.y,n/D*Q);for(V=x-1;0<=V;V--){Q=V/x;ba=w*Math.cos(Q*Math.PI/2);U=B*Math.sin(Q*Math.PI/2);M=0;for(Q=T.length;M<Q;M++)X=d(T[M],E[M],U),h(X.x,X.y,n+ba);G=0;for(O=$.length;G<O;G++)for(L=$[G],fa=ha[G],M=0,Q=L.length;M<Q;M++)X=d(L[M],fa[M],U),P?h(X.x,X.y+F[D-1].y,F[D-1].x+ba):h(X.x,
X.y,n+ba)}(function(){var a=p.length/3;if(z){var c;c=0*ca;for(M=0;M<ea;M++)aa=R[M],k(aa[2]+c,aa[1]+c,aa[0]+c);c=D+2*x;c*=ca;for(M=0;M<ea;M++)aa=R[M],k(aa[0]+c,aa[1]+c,aa[2]+c)}else{for(M=0;M<ea;M++)aa=R[M],k(aa[2],aa[1],aa[0]);for(M=0;M<ea;M++)aa=R[M],k(aa[0]+ca*D,aa[1]+ca*D,aa[2]+ca*D)}N.addGroup(a,p.length/3-a,void 0!==b.material?b.material:0)})();(function(){var a=p.length/3,c=0;g(T,c);c+=T.length;G=0;for(O=$.length;G<O;G++)L=$[G],g(L,c),c+=L.length;N.addGroup(a,p.length/3-a,void 0!==b.extrudeMaterial?
b.extrudeMaterial:1)})();b.arrays||(this.setIndex(q),this.addAttribute("position",new da(p,3)),this.addAttribute("uv",new da(s,2)))};lb.WorldUVGenerator={generateTopUV:function(a,b,d,e,f){a=b[3*e];e=b[3*e+1];var g=b[3*f];f=b[3*f+1];return[new c(b[3*d],b[3*d+1]),new c(a,e),new c(g,f)]},generateSideWallUV:function(a,b,d,e,f,g){a=b[3*d];var h=b[3*d+1];d=b[3*d+2];var k=b[3*e],l=b[3*e+1];e=b[3*e+2];var m=b[3*f],n=b[3*f+1];f=b[3*f+2];var p=b[3*g],q=b[3*g+1];b=b[3*g+2];return 0.01>Math.abs(h-l)?[new c(a,
1-d),new c(k,1-e),new c(m,1-f),new c(p,1-b)]:[new c(h,1-d),new c(l,1-e),new c(n,1-f),new c(q,1-b)]}};xb.prototype=Object.create(ma.prototype);xb.prototype.constructor=xb;hc.prototype=Object.create(Sa.prototype);hc.prototype.constructor=hc;qc.prototype=Object.create(ma.prototype);qc.prototype.constructor=qc;Tc.prototype=Object.create(ba.prototype);Tc.prototype.constructor=Tc;Ie.prototype=Object.create(ma.prototype);Ie.prototype.constructor=Ie;Qc.prototype=Object.create(ba.prototype);Qc.prototype.constructor=
Qc;vf.prototype=Object.create(ma.prototype);vf.prototype.constructor=vf;Fd.prototype=Object.create(ba.prototype);Fd.prototype.constructor=Fd;Gd.prototype=Object.create(ma.prototype);Gd.prototype.constructor=Gd;Gd.prototype.toJSON=function(){var a=ma.prototype.toJSON.call(this);return kh(this.parameters.shapes,a)};gd.prototype=Object.create(ba.prototype);gd.prototype.constructor=gd;gd.prototype.toJSON=function(){var a=ba.prototype.toJSON.call(this);return kh(this.parameters.shapes,a)};Bd.prototype=
Object.create(ba.prototype);Bd.prototype.constructor=Bd;hd.prototype=Object.create(ma.prototype);hd.prototype.constructor=hd;Uc.prototype=Object.create(ba.prototype);Uc.prototype.constructor=Uc;je.prototype=Object.create(hd.prototype);je.prototype.constructor=je;Je.prototype=Object.create(Uc.prototype);Je.prototype.constructor=Je;wf.prototype=Object.create(ma.prototype);wf.prototype.constructor=wf;ke.prototype=Object.create(ba.prototype);ke.prototype.constructor=ke;var Ic=Object.freeze({WireframeGeometry:wd,
ParametricGeometry:$d,ParametricBufferGeometry:ae,TetrahedronGeometry:Cc,TetrahedronBufferGeometry:Oc,OctahedronGeometry:De,OctahedronBufferGeometry:yd,IcosahedronGeometry:tf,IcosahedronBufferGeometry:zd,DodecahedronGeometry:Ee,DodecahedronBufferGeometry:de,PolyhedronGeometry:be,PolyhedronBufferGeometry:sb,TubeGeometry:ce,TubeBufferGeometry:Pc,TorusKnotGeometry:Ad,TorusKnotBufferGeometry:ee,TorusGeometry:fe,TorusBufferGeometry:ge,TextGeometry:xb,TextBufferGeometry:hc,SphereGeometry:qc,SphereBufferGeometry:Tc,
RingGeometry:Ie,RingBufferGeometry:Qc,PlaneGeometry:kb,PlaneBufferGeometry:M,LatheGeometry:vf,LatheBufferGeometry:Fd,ShapeGeometry:Gd,ShapeBufferGeometry:gd,ExtrudeGeometry:lb,ExtrudeBufferGeometry:Sa,EdgesGeometry:Bd,ConeGeometry:je,ConeBufferGeometry:Je,CylinderGeometry:hd,CylinderBufferGeometry:Uc,CircleGeometry:wf,CircleBufferGeometry:ke,BoxGeometry:ca,BoxBufferGeometry:gb});Mb.prototype=Object.create(aa.prototype);Mb.prototype.constructor=Mb;Mb.prototype.isShadowMaterial=!0;Yb.prototype=Object.create(R.prototype);
Yb.prototype.constructor=Yb;Yb.prototype.isRawShaderMaterial=!0;Hb.prototype=Object.create(aa.prototype);Hb.prototype.constructor=Hb;Hb.prototype.isMeshStandardMaterial=!0;Hb.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);
this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;
this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Hd.prototype=Object.create(Hb.prototype);Hd.prototype.constructor=Hd;Hd.prototype.isMeshPhysicalMaterial=!0;Hd.prototype.copy=function(a){Hb.prototype.copy.call(this,a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;this.clearCoat=
a.clearCoat;this.clearCoatRoughness=a.clearCoatRoughness;return this};ic.prototype=Object.create(aa.prototype);ic.prototype.constructor=ic;ic.prototype.isMeshPhongMaterial=!0;ic.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=
a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Id.prototype=Object.create(ic.prototype);Id.prototype.constructor=Id;Id.prototype.isMeshToonMaterial=!0;Id.prototype.copy=function(a){ic.prototype.copy.call(this,a);this.gradientMap=a.gradientMap;return this};id.prototype=Object.create(aa.prototype);id.prototype.constructor=id;id.prototype.isMeshNormalMaterial=
!0;id.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Dc.prototype=Object.create(aa.prototype);
Dc.prototype.constructor=Dc;Dc.prototype.isMeshLambertMaterial=!0;Dc.prototype.copy=function(a){aa.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=
a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Jd.prototype=Object.create(Ka.prototype);Jd.prototype.constructor=Jd;Jd.prototype.isLineDashedMaterial=!0;Jd.prototype.copy=function(a){Ka.prototype.copy.call(this,a);this.scale=a.scale;this.dashSize=
a.dashSize;this.gapSize=a.gapSize;return this};var ui=Object.freeze({ShadowMaterial:Mb,SpriteMaterial:bd,RawShaderMaterial:Yb,ShaderMaterial:R,PointsMaterial:oc,MeshPhysicalMaterial:Hd,MeshStandardMaterial:Hb,MeshPhongMaterial:ic,MeshToonMaterial:Id,MeshNormalMaterial:id,MeshLambertMaterial:Dc,MeshDepthMaterial:Fb,MeshDistanceMaterial:Jb,MeshBasicMaterial:pb,LineDashedMaterial:Jd,LineBasicMaterial:Ka,Material:aa}),Nf={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==
this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},zc=new xf,xe={};Object.assign(Ib.prototype,{load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Nf.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0!==xe[a])xe[a].push({onLoad:b,onProgress:c,onError:d});else{var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=
g[1];var h=!!g[2],g=g[3],g=window.decodeURIComponent(g);h&&(g=window.atob(g));try{var k,l=(this.responseType||"").toLowerCase();switch(l){case "arraybuffer":case "blob":for(var m=new Uint8Array(g.length),h=0;h<g.length;h++)m[h]=g.charCodeAt(h);k="blob"===l?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":k=(new DOMParser).parseFromString(g,c);break;case "json":k=JSON.parse(g);break;default:k=g}window.setTimeout(function(){b&&b(k);e.manager.itemEnd(a)},0)}catch(n){window.setTimeout(function(){d&&
d(n);e.manager.itemEnd(a);e.manager.itemError(a)},0)}}else{xe[a]=[];xe[a].push({onLoad:b,onProgress:c,onError:d});var p=new XMLHttpRequest;p.open("GET",a,!0);p.addEventListener("load",function(b){var c=this.response;Nf.add(a,c);var d=xe[a];delete xe[a];if(200===this.status){for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h.onLoad)h.onLoad(c)}e.manager.itemEnd(a)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");f=0;for(g=d.length;f<g;f++)if(h=d[f],h.onLoad)h.onLoad(c);
e.manager.itemEnd(a)}else{f=0;for(g=d.length;f<g;f++)if(h=d[f],h.onError)h.onError(b);e.manager.itemEnd(a);e.manager.itemError(a)}},!1);p.addEventListener("progress",function(b){for(var c=xe[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f.onProgress)f.onProgress(b)}},!1);p.addEventListener("error",function(b){var c=xe[a];delete xe[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemEnd(a);e.manager.itemError(a)},!1);void 0!==this.responseType&&(p.responseType=this.responseType);
void 0!==this.withCredentials&&(p.withCredentials=this.withCredentials);p.overrideMimeType&&p.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(h in this.requestHeader)p.setRequestHeader(h,this.requestHeader[h]);p.send(null)}e.manager.itemStart(a);return p}},setPath:function(a){this.path=a;return this},setResponseType:function(a){this.responseType=a;return this},setWithCredentials:function(a){this.withCredentials=a;return this},setMimeType:function(a){this.mimeType=a;return this},
setRequestHeader:function(a){this.requestHeader=a;return this}});Object.assign(Dg.prototype,{load:function(a,b,c,d){function e(m){k.load(a[m],function(a){a=f._parser(a,!0);g[m]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};l+=1;6===l&&(1===a.mipmapCount&&(h.minFilter=Eb),h.format=a.format,h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new pc;h.image=g;var k=new Ib(this.manager);k.setPath(this.path);k.setResponseType("arraybuffer");if(Array.isArray(a))for(var l=0,m=0,n=a.length;m<
n;++m)e(m);else k.load(a,function(a){a=f._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var v=0;v<a.mipmapCount;v++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+v]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=Eb);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){this.path=a;return this}});Object.assign($f.prototype,
{load:function(a,b,c,d){var e=this,f=new D,g=new Ib(this.manager);g.setResponseType("arraybuffer");g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:cb,f.wrapT=void 0!==a.wrapT?a.wrapT:cb,f.magFilter=void 0!==a.magFilter?a.magFilter:Eb,f.minFilter=void 0!==a.minFilter?a.minFilter:wc,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=
a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=Eb),f.needsUpdate=!0,b&&b(f,a)},c,d);return f}});Object.assign(yf.prototype,{crossOrigin:"Anonymous",load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Nf.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;c=document.createElementNS("http://www.w3.org/1999/xhtml",
"img");c.addEventListener("load",function(){Nf.add(a,this);b&&b(this);e.manager.itemEnd(a)},!1);c.addEventListener("error",function(b){d&&d(b);e.manager.itemEnd(a);e.manager.itemError(a)},!1);"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(c.crossOrigin=this.crossOrigin);e.manager.itemStart(a);c.src=a;return c},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(Ke.prototype,{crossOrigin:"Anonymous",load:function(a,b,c,d){function e(c){g.load(a[c],
function(a){f.images[c]=a;h++;6===h&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}var f=new q,g=new yf(this.manager);g.setCrossOrigin(this.crossOrigin);g.setPath(this.path);var h=0;for(c=0;c<a.length;++c)e(c);return f},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(Le.prototype,{crossOrigin:"Anonymous",load:function(a,b,c,d){var e=new n,f=new yf(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(c){e.image=
c;c=0<a.search(/\.(jpg|jpeg)$/)||0===a.search(/^data\:image\/jpeg/);e.format=c?qd:kc;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(la.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(a,b){var c=this.getUtoTmapping(a);return this.getPoint(c,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=
a;c++)b.push(this.getPoint(c/a));return b},getSpacedPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){void 0===a&&(a=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,f=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),f+=c.distanceTo(d),
b.push(f),d=c;return this.cacheArcLengths=b},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=0,e=c.length,f;f=b?b:a*c[e-1];for(var g=0,h=e-1,k;g<=h;)if(d=Math.floor(g+(h-g)/2),k=c[d]-f,0>k)g=d+1;else if(0<k)h=d-1;else{h=d;break}d=h;if(c[d]===f)return d/(e-1);g=c[d];return(d+(f-g)/(c[d+1]-g))/(e-1)},getTangent:function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},
getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)},computeFrenetFrames:function(a,b){var c=new e,f=[],g=[],h=[],k=new e,l=new d,m,n;for(m=0;m<=a;m++)n=m/a,f[m]=this.getTangentAt(n),f[m].normalize();g[0]=new e;h[0]=new e;m=Number.MAX_VALUE;n=Math.abs(f[0].x);var p=Math.abs(f[0].y),q=Math.abs(f[0].z);n<=m&&(m=n,c.set(1,0,0));p<=m&&(m=p,c.set(0,1,0));q<=m&&c.set(0,0,1);k.crossVectors(f[0],c).normalize();g[0].crossVectors(f[0],k);h[0].crossVectors(f[0],g[0]);for(m=1;m<=a;m++)g[m]=
g[m-1].clone(),h[m]=h[m-1].clone(),k.crossVectors(f[m-1],f[m]),k.length()>Number.EPSILON&&(k.normalize(),c=Math.acos(Ba.clamp(f[m-1].dot(f[m]),-1,1)),g[m].applyMatrix4(l.makeRotationAxis(k,c))),h[m].crossVectors(f[m],g[m]);if(!0===b)for(c=Math.acos(Ba.clamp(g[0].dot(g[a]),-1,1)),c/=a,0<f[0].dot(k.crossVectors(g[0],g[a]))&&(c=-c),m=1;m<=a;m++)g[m].applyMatrix4(l.makeRotationAxis(f[m],c*m)),h[m].crossVectors(f[m],g[m]);return{tangents:f,normals:g,binormals:h}},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this},toJSON:function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a},fromJSON:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}});Zb.prototype=Object.create(la.prototype);Zb.prototype.constructor=Zb;Zb.prototype.isEllipseCurve=!0;Zb.prototype.getPoint=function(a,b){for(var d=b||new c,e=2*Math.PI,f=this.aEndAngle-this.aStartAngle,
g=Math.abs(f)<Number.EPSILON;0>f;)f+=e;for(;f>e;)f-=e;f<Number.EPSILON&&(f=g?0:e);!0!==this.aClockwise||g||(f=f===e?-e:f-e);var f=this.aStartAngle+a*f,e=this.aX+this.xRadius*Math.cos(f),h=this.aY+this.yRadius*Math.sin(f);if(0!==this.aRotation)var f=Math.cos(this.aRotation),g=Math.sin(this.aRotation),k=e-this.aX,h=h-this.aY,e=k*f-h*g+this.aX,h=k*g+h*f+this.aY;return d.set(e,h)};Zb.prototype.copy=function(a){la.prototype.copy.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=
a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};Zb.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a};Zb.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=
a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};kd.prototype=Object.create(Zb.prototype);kd.prototype.constructor=kd;kd.prototype.isArcCurve=!0;var th=new e,Eh=new ag,Fh=new ag,Gh=new ag;Nb.prototype=Object.create(la.prototype);Nb.prototype.constructor=Nb;Nb.prototype.isCatmullRomCurve3=!0;Nb.prototype.getPoint=function(a,b){var c=b||new e,d=this.points,f=d.length,g=(f-(this.closed?0:1))*
a,h=Math.floor(g),g=g-h;this.closed?h+=0<h?0:(Math.floor(Math.abs(h)/d.length)+1)*d.length:0===g&&h===f-1&&(h=f-2,g=1);var k,l,m;this.closed||0<h?k=d[(h-1)%f]:(th.subVectors(d[0],d[1]).add(d[0]),k=th);l=d[h%f];m=d[(h+1)%f];this.closed||h+2<f?d=d[(h+2)%f]:(th.subVectors(d[f-1],d[f-2]).add(d[f-1]),d=th);if("centripetal"===this.curveType||"chordal"===this.curveType){var n="chordal"===this.curveType?0.5:0.25,f=Math.pow(k.distanceToSquared(l),n),h=Math.pow(l.distanceToSquared(m),n),n=Math.pow(m.distanceToSquared(d),
n);1E-4>h&&(h=1);1E-4>f&&(f=h);1E-4>n&&(n=h);Eh.initNonuniformCatmullRom(k.x,l.x,m.x,d.x,f,h,n);Fh.initNonuniformCatmullRom(k.y,l.y,m.y,d.y,f,h,n);Gh.initNonuniformCatmullRom(k.z,l.z,m.z,d.z,f,h,n)}else"catmullrom"===this.curveType&&(Eh.initCatmullRom(k.x,l.x,m.x,d.x,this.tension),Fh.initCatmullRom(k.y,l.y,m.y,d.y,this.tension),Gh.initCatmullRom(k.z,l.z,m.z,d.z,this.tension));c.set(Eh.calc(g),Fh.calc(g),Gh.calc(g));return c};Nb.prototype.copy=function(a){la.prototype.copy.call(this,a);this.points=
[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};Nb.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a};Nb.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,
c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new e).fromArray(d))}this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};$b.prototype=Object.create(la.prototype);$b.prototype.constructor=$b;$b.prototype.isCubicBezierCurve=!0;$b.prototype.getPoint=function(a,b){var d=b||new c,e=this.v0,f=this.v1,g=this.v2,h=this.v3;d.set(ld(a,e.x,f.x,g.x,h.x),ld(a,e.y,f.y,g.y,h.y));return d};$b.prototype.copy=function(a){la.prototype.copy.call(this,a);this.v0.copy(a.v0);
this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};$b.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};$b.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};Ec.prototype=Object.create(la.prototype);Ec.prototype.constructor=Ec;Ec.prototype.isCubicBezierCurve3=
!0;Ec.prototype.getPoint=function(a,b){var c=b||new e,d=this.v0,f=this.v1,g=this.v2,h=this.v3;c.set(ld(a,d.x,f.x,g.x,h.x),ld(a,d.y,f.y,g.y,h.y),ld(a,d.z,f.z,g.z,h.z));return c};Ec.prototype.copy=function(a){la.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ec.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ec.prototype.fromJSON=
function(a){la.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};Ob.prototype=Object.create(la.prototype);Ob.prototype.constructor=Ob;Ob.prototype.isLineCurve=!0;Ob.prototype.getPoint=function(a,b){var d=b||new c;1===a?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(a).add(this.v1));return d};Ob.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Ob.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};
Ob.prototype.copy=function(a){la.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ob.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ob.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Fc.prototype=Object.create(la.prototype);Fc.prototype.constructor=Fc;Fc.prototype.isLineCurve3=!0;Fc.prototype.getPoint=function(a,b){var c=
b||new e;1===a?c.copy(this.v2):(c.copy(this.v2).sub(this.v1),c.multiplyScalar(a).add(this.v1));return c};Fc.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Fc.prototype.copy=function(a){la.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Fc.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Fc.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);
return this};tc.prototype=Object.create(la.prototype);tc.prototype.constructor=tc;tc.prototype.isQuadraticBezierCurve=!0;tc.prototype.getPoint=function(a,b){var d=b||new c,e=this.v0,f=this.v1,g=this.v2;d.set(Vc(a,e.x,f.x,g.x),Vc(a,e.y,f.y,g.y));return d};tc.prototype.copy=function(a){la.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};tc.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=
this.v2.toArray();return a};tc.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Za.prototype=Object.create(la.prototype);Za.prototype.constructor=Za;Za.prototype.isQuadraticBezierCurve3=!0;Za.prototype.getPoint=function(a,b){var c=b||new e,d=this.v0,f=this.v1,g=this.v2;c.set(Vc(a,d.x,f.x,g.x),Vc(a,d.y,f.y,g.y),Vc(a,d.z,f.z,g.z));return c};Za.prototype.copy=function(a){la.prototype.copy.call(this,
a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Za.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Za.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};ac.prototype=Object.create(la.prototype);ac.prototype.constructor=ac;ac.prototype.isSplineCurve=!0;ac.prototype.getPoint=function(a,
b){var d=b||new c,e=this.points,f=(e.length-1)*a,g=Math.floor(f),f=f-g,h=e[0===g?g:g-1],k=e[g],l=e[g>e.length-2?e.length-1:g+1],e=e[g>e.length-3?e.length-1:g+2];d.set(Eg(f,h.x,k.x,l.x,e.x),Eg(f,h.y,k.y,l.y,e.y));return d};ac.prototype.copy=function(a){la.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};ac.prototype.toJSON=function(){var a=la.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<
c;b++)a.points.push(this.points[b].toArray());return a};ac.prototype.fromJSON=function(a){la.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,d=a.points.length;b<d;b++){var e=a.points[b];this.points.push((new c).fromArray(e))}return this};var vi=Object.freeze({ArcCurve:kd,CatmullRomCurve3:Nb,CubicBezierCurve:$b,CubicBezierCurve3:Ec,EllipseCurve:Zb,LineCurve:Ob,LineCurve3:Fc,QuadraticBezierCurve:tc,QuadraticBezierCurve3:Za,SplineCurve:ac});Wc.prototype=Object.assign(Object.create(la.prototype),
{constructor:Wc,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Ob(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=
!0;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&b.push(b[0]);return b},getPoints:function(a){a=a||12;for(var b=[],c,d=0,e=this.curves;d<e.length;d++)for(var f=
e[d],f=f.getPoints(f&&f.isEllipseCurve?2*a:f&&f.isLineCurve?1:f&&f.isSplineCurve?a*f.points.length:a),g=0;g<f.length;g++){var h=f[g];c&&c.equals(h)||(b.push(h),c=h)}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b},copy:function(a){la.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this},toJSON:function(){var a=la.prototype.toJSON.call(this);a.autoClose=this.autoClose;
a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){la.prototype.fromJSON.call(this,a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new vi[d.type]).fromJSON(d))}return this}});uc.prototype=Object.assign(Object.create(Wc.prototype),{constructor:uc,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},
moveTo:function(a,b){this.currentPoint.set(a,b)},lineTo:function(a,b){var d=new Ob(this.currentPoint.clone(),new c(a,b));this.curves.push(d);this.currentPoint.set(a,b)},quadraticCurveTo:function(a,b,d,e){a=new tc(this.currentPoint.clone(),new c(a,b),new c(d,e));this.curves.push(a);this.currentPoint.set(d,e)},bezierCurveTo:function(a,b,d,e,f,g){a=new $b(this.currentPoint.clone(),new c(a,b),new c(d,e),new c(f,g));this.curves.push(a);this.currentPoint.set(f,g)},splineThru:function(a){var b=[this.currentPoint.clone()].concat(a),
b=new ac(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new Zb(a,b,c,d,e,f,g,h);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);
a=a.getPoint(1);this.currentPoint.copy(a)},copy:function(a){Wc.prototype.copy.call(this,a);this.currentPoint.copy(a.currentPoint);return this},toJSON:function(){var a=Wc.prototype.toJSON.call(this);a.currentPoint=this.currentPoint.toArray();return a},fromJSON:function(a){Wc.prototype.fromJSON.call(this,a);this.currentPoint.fromArray(a.currentPoint);return this}});md.prototype=Object.assign(Object.create(uc.prototype),{constructor:md,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<
d;c++)b[c]=this.holes[c].getPoints(a);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){uc.prototype.copy.call(this,a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=uc.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a},fromJSON:function(a){uc.prototype.fromJSON.call(this,
a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new uc).fromJSON(d))}return this}});$a.prototype=Object.assign(Object.create(U.prototype),{constructor:$a,isLight:!0,copy:function(a){U.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this},toJSON:function(a){a=U.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=
this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}});Me.prototype=Object.assign(Object.create($a.prototype),{constructor:Me,isHemisphereLight:!0,copy:function(a){$a.prototype.copy.call(this,a);this.groundColor.copy(a.groundColor);return this}});
Object.assign(Kd.prototype,{copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var a={};0!==this.bias&&(a.bias=this.bias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;return a}});zf.prototype=Object.assign(Object.create(Kd.prototype),
{constructor:zf,isSpotLightShadow:!0,update:function(a){var b=this.camera,c=2*Ba.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;if(c!==b.fov||d!==b.aspect||a!==b.far)b.fov=c,b.aspect=d,b.far=a,b.updateProjectionMatrix()}});Af.prototype=Object.assign(Object.create($a.prototype),{constructor:Af,isSpotLight:!0,copy:function(a){$a.prototype.copy.call(this,a);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();
this.shadow=a.shadow.clone();return this}});nd.prototype=Object.assign(Object.create($a.prototype),{constructor:nd,isPointLight:!0,copy:function(a){$a.prototype.copy.call(this,a);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this}});Bf.prototype=Object.assign(Object.create(Kd.prototype),{constructor:Bf});le.prototype=Object.assign(Object.create($a.prototype),{constructor:le,isDirectionalLight:!0,copy:function(a){$a.prototype.copy.call(this,a);this.target=a.target.clone();
this.shadow=a.shadow.clone();return this}});Cf.prototype=Object.assign(Object.create($a.prototype),{constructor:Cf,isAmbientLight:!0});Ld.prototype=Object.assign(Object.create($a.prototype),{constructor:Ld,isRectAreaLight:!0,copy:function(a){$a.prototype.copy.call(this,a);this.width=a.width;this.height=a.height;return this},toJSON:function(a){a=$a.prototype.toJSON.call(this,a);a.object.width=this.width;a.object.height=this.height;return a}});cg.prototype=Object.assign(Object.create(zb.prototype),
{constructor:cg,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});od.prototype=Object.assign(Object.create(zb.prototype),{constructor:od,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Object.assign(bc.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<
d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.afterEnd_(c-1,a,e)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}d=b.length;break c}if(a>=e)break a;else{f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;d=e;e=b[--c-1];if(a>=e)break b}d=c;c=0}}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=
c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(bc.prototype,{beforeStart_:bc.prototype.copySampleValue_,
afterEnd_:bc.prototype.copySampleValue_});Df.prototype=Object.assign(Object.create(bc.prototype),{constructor:Df,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,h=this.valueSize;a*=h;b=(c-b)/(d-b);for(c=a+h;a!==c;a+=4)g.slerpFlat(e,0,f,a-h,f,a,b);return e}});Ne.prototype=Object.assign(Object.create(zb.prototype),{constructor:Ne,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Df(this.times,this.values,this.getValueSize(),
a)},InterpolantFactoryMethodSmooth:void 0});Md.prototype=Object.assign(Object.create(zb.prototype),{constructor:Md,ValueTypeName:"color"});Oe.prototype=Object.assign(Object.create(zb.prototype),{constructor:Oe,ValueTypeName:"number"});pd.prototype=Object.assign(Object.create(bc.prototype),{constructor:pd,DefaultSettings_:{endingStart:lf,endingEnd:lf},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=
a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:f=1;h=c+d[1]-d[0];break;default:f=a-1,h=b}a=0.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,l=this._offsetNext,m=this._weightPrev,n=this._weightNext,
p=(c-b)/(d-b);c=p*p;d=c*p;b=-m*d+2*m*c-m*p;m=(1+m)*d+(-1.5-2*m)*c+(-0.5+m)*p+1;p=(-1-n)*d+(1.5+n)*c+0.5*p;n=n*d-n*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+m*f[h+c]+p*f[a+c]+n*f[l+c];return e}});Ef.prototype=Object.assign(Object.create(bc.prototype),{constructor:Ef,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Ff.prototype=Object.assign(Object.create(bc.prototype),{constructor:Ff,
interpolate_:function(a){return this.copySampleValue_(a-1)}});var cc={arraySlice:function(a,b,c){return cc.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;c.sort(function(b,
c){return a[b]-a[c]});return c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];
while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}}};Object.assign(zb,{parse:function(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var b=zb._getTrackTypeForValueTypeName(a.type);if(void 0===a.times){var c=[],d=[];cc.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)},toJSON:function(a){var b=a.constructor;if(void 0!==
b.toJSON)b=b.toJSON(a);else{var b={name:a.name,times:cc.convertArray(a.times,Array),values:cc.convertArray(a.values,Array)},c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b},_getTrackTypeForValueTypeName:function(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return Oe;case "vector":case "vector2":case "vector3":case "vector4":return Pe;case "color":return Md;case "quaternion":return Ne;case "bool":case "boolean":return od;
case "string":return cg}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}});Object.assign(zb.prototype,{constructor:zb,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Ff(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new Ef(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new pd(this.times,this.values,
this.getValueSize(),a)},setInterpolation:function(a){var b;switch(a){case 2300:b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",
b)}else this.createInterpolant=b},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},
trim:function(a,b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),d=this.getValueSize(),this.times=cc.arraySlice(c,e,f),this.values=cc.arraySlice(this.values,e*d,f*d);return this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times,b=this.values,d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",
this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&cc.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,d);a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,
c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else for(var l=g*c,m=l-c,n=l+c,k=0;k!==c;++k){var p=b[l+k];if(p!==b[m+k]||p!==b[n+k]){h=!0;break}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,l=e*c,k=0;k!==c;++k)b[l+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;l=e*c;for(k=0;k!==c;++k)b[l+k]=b[h+k];++e}e!==a.length&&(this.times=cc.arraySlice(a,0,e),this.values=cc.arraySlice(b,0,e*c));return this}});Pe.prototype=Object.assign(Object.create(zb.prototype),
{constructor:Pe,ValueTypeName:"vector"});Object.assign(jc,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(zb.parse(c[e]).scale(d));return new jc(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b};for(var d=0,e=c.length;d!==e;++d)b.push(zb.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);
var l=cc.getKeyframeOrder(h),h=cc.sortedArray(h,1,l),k=cc.sortedArray(k,1,l);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new Oe(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/c))}return new jc(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(var d=0;d<c.length;d++)if(c[d].name===b)return c[d];return null},CreateClipsFromMorphTargetSequences:function(a,b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=
a[f],k=h.name.match(e);if(k&&1<k.length){var l=k[1];(k=d[l])||(d[l]=k=[]);k.push(h)}}a=[];for(l in d)a.push(jc.CreateFromMorphTargetSequence(l,d[l],b,c));return a},parseAnimation:function(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];cc.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.length||-1,g=a.fps||30,h=a.hierarchy||[],k=0;k<h.length;k++){var l=h[k].keys;
if(l&&0!==l.length)if(l[0].morphTargets){for(var f={},m=0;m<l.length;m++)if(l[m].morphTargets)for(var n=0;n<l[m].morphTargets.length;n++)f[l[m].morphTargets[n]]=-1;for(var p in f){for(var q=[],s=[],n=0;n!==l[m].morphTargets.length;++n){var r=l[m];q.push(r.time);s.push(r.morphTarget===p?1:0)}d.push(new Oe(".morphTargetInfluence["+p+"]",q,s))}f=f.length*(g||1)}else m=".bones["+b[k].name+"]",c(Pe,m+".position",l,"pos",d),c(Ne,m+".quaternion",l,"rot",d),c(Pe,m+".scale",l,"scl",d)}return 0===d.length?
null:new jc(e,f,d)}});Object.assign(jc.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b)var d=this.tracks[b],a=Math.max(a,d.times[d.times.length-1]);this.duration=a},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}});Object.assign(Gf.prototype,{load:function(a,b,c,d){var e=this;(new Ib(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},
c,d)},setTextures:function(a){this.textures=a},parse:function(a){function b(a){void 0===d[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return d[a]}var d=this.textures,e=new ui[a.type];void 0!==a.uuid&&(e.uuid=a.uuid);void 0!==a.name&&(e.name=a.name);void 0!==a.color&&e.color.setHex(a.color);void 0!==a.roughness&&(e.roughness=a.roughness);void 0!==a.metalness&&(e.metalness=a.metalness);void 0!==a.emissive&&e.emissive.setHex(a.emissive);void 0!==a.specular&&e.specular.setHex(a.specular);
void 0!==a.shininess&&(e.shininess=a.shininess);void 0!==a.clearCoat&&(e.clearCoat=a.clearCoat);void 0!==a.clearCoatRoughness&&(e.clearCoatRoughness=a.clearCoatRoughness);void 0!==a.uniforms&&(e.uniforms=a.uniforms);void 0!==a.vertexShader&&(e.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(e.fragmentShader=a.fragmentShader);void 0!==a.vertexColors&&(e.vertexColors=a.vertexColors);void 0!==a.fog&&(e.fog=a.fog);void 0!==a.flatShading&&(e.flatShading=a.flatShading);void 0!==a.blending&&(e.blending=
a.blending);void 0!==a.side&&(e.side=a.side);void 0!==a.opacity&&(e.opacity=a.opacity);void 0!==a.transparent&&(e.transparent=a.transparent);void 0!==a.alphaTest&&(e.alphaTest=a.alphaTest);void 0!==a.depthTest&&(e.depthTest=a.depthTest);void 0!==a.depthWrite&&(e.depthWrite=a.depthWrite);void 0!==a.colorWrite&&(e.colorWrite=a.colorWrite);void 0!==a.wireframe&&(e.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(e.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(e.wireframeLinecap=
a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(e.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(e.rotation=a.rotation);1!==a.linewidth&&(e.linewidth=a.linewidth);void 0!==a.dashSize&&(e.dashSize=a.dashSize);void 0!==a.gapSize&&(e.gapSize=a.gapSize);void 0!==a.scale&&(e.scale=a.scale);void 0!==a.skinning&&(e.skinning=a.skinning);void 0!==a.morphTargets&&(e.morphTargets=a.morphTargets);void 0!==a.dithering&&(e.dithering=a.dithering);void 0!==a.visible&&(e.visible=a.visible);void 0!==
a.userData&&(e.userData=a.userData);void 0!==a.shading&&(e.flatShading=1===a.shading);void 0!==a.size&&(e.size=a.size);void 0!==a.sizeAttenuation&&(e.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(e.map=b(a.map));void 0!==a.alphaMap&&(e.alphaMap=b(a.alphaMap),e.transparent=!0);void 0!==a.bumpMap&&(e.bumpMap=b(a.bumpMap));void 0!==a.bumpScale&&(e.bumpScale=a.bumpScale);void 0!==a.normalMap&&(e.normalMap=b(a.normalMap));if(void 0!==a.normalScale){var f=a.normalScale;!1===Array.isArray(f)&&(f=[f,
f]);e.normalScale=(new c).fromArray(f)}void 0!==a.displacementMap&&(e.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(e.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(e.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(e.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(e.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(e.emissiveMap=b(a.emissiveMap));void 0!==a.emissiveIntensity&&(e.emissiveIntensity=a.emissiveIntensity);void 0!==
a.specularMap&&(e.specularMap=b(a.specularMap));void 0!==a.envMap&&(e.envMap=b(a.envMap));void 0!==a.reflectivity&&(e.reflectivity=a.reflectivity);void 0!==a.lightMap&&(e.lightMap=b(a.lightMap));void 0!==a.lightMapIntensity&&(e.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(e.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(e.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(e.gradientMap=b(a.gradientMap));return e}});Object.assign(Fg.prototype,{load:function(a,b,c,d){var e=this;(new Ib(e.manager)).load(a,
function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){var b=new ba,c=a.data.index;void 0!==c&&(c=new li[c.type](c.array),b.setIndex(new ra(c,1)));var d=a.data.attributes,f;for(f in d){var g=d[f],c=new li[g.type](g.array);b.addAttribute(f,new ra(c,g.itemSize,g.normalized))}f=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==f)for(c=0,d=f.length;c!==d;++c)g=f[c],b.addGroup(g.start,g.count,g.materialIndex);a=a.data.boundingSphere;void 0!==a&&(f=new e,void 0!==a.center&&f.fromArray(a.center),
b.boundingSphere=new hb(f,a.radius));return b}});var li={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Re.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};
Object.assign(Re.prototype,{crossOrigin:void 0,initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a={NoBlending:rg,NormalBlending:Hc,AdditiveBlending:gg,SubtractiveBlending:Lf,MultiplyBlending:fd,CustomBlending:ud},b=new X,c=new Le,d=new Gf;return function(e,f,g){function h(a,b,d,e,v){a=f+a;var l=Re.Handlers.get(a);null!==l?a=l.load(a):(c.setCrossOrigin(g),a=c.load(a));void 0!==b&&(a.repeat.fromArray(b),1!==b[0]&&
(a.wrapS=sc),1!==b[1]&&(a.wrapT=sc));void 0!==d&&a.offset.fromArray(d);void 0!==e&&("repeat"===e[0]&&(a.wrapS=sc),"mirror"===e[0]&&(a.wrapS=yb),"repeat"===e[1]&&(a.wrapT=sc),"mirror"===e[1]&&(a.wrapT=yb));void 0!==v&&(a.anisotropy=v);b=Ba.generateUUID();k[b]=a;return b}var k={},l={uuid:Ba.generateUUID(),type:"MeshLambertMaterial"},m;for(m in e){var n=e[m];switch(m){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":l.name=n;break;case "blending":l.blending=
a[n];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",m,"is no longer supported.");break;case "colorDiffuse":l.color=b.fromArray(n).getHex();break;case "colorSpecular":l.specular=b.fromArray(n).getHex();break;case "colorEmissive":l.emissive=b.fromArray(n).getHex();break;case "specularCoef":l.shininess=n;break;case "shading":"basic"===n.toLowerCase()&&(l.type="MeshBasicMaterial");"phong"===n.toLowerCase()&&(l.type="MeshPhongMaterial");"standard"===n.toLowerCase()&&
(l.type="MeshStandardMaterial");break;case "mapDiffuse":l.map=h(n,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;case "mapEmissive":l.emissiveMap=h(n,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case "mapEmissiveRepeat":case "mapEmissiveOffset":case "mapEmissiveWrap":case "mapEmissiveAnisotropy":break;case "mapLight":l.lightMap=
h(n,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":l.aoMap=h(n,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":l.bumpMap=h(n,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case "mapBumpScale":l.bumpScale=n;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;
case "mapNormal":l.normalMap=h(n,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case "mapNormalFactor":l.normalScale=[n,n];break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":l.specularMap=h(n,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;case "mapMetalness":l.metalnessMap=
h(n,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case "mapMetalnessRepeat":case "mapMetalnessOffset":case "mapMetalnessWrap":case "mapMetalnessAnisotropy":break;case "mapRoughness":l.roughnessMap=h(n,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case "mapRoughnessRepeat":case "mapRoughnessOffset":case "mapRoughnessWrap":case "mapRoughnessAnisotropy":break;case "mapAlpha":l.alphaMap=h(n,e.mapAlphaRepeat,
e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":l.side=Gc;break;case "doubleSided":l.side=ed;break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");l.opacity=n;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":l[m]=n;break;case "vertexColors":!0===
n&&(l.vertexColors=me);"face"===n&&(l.vertexColors=ec);break;default:console.error("THREE.Loader.createMaterial: Unsupported",m,n)}}"MeshBasicMaterial"===l.type&&delete l.emissive;"MeshPhongMaterial"!==l.type&&delete l.specular;1>l.opacity&&(l.transparent=!0);d.setTextures(k);return d.parse(l)}}()});var Hh={decodeText:function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},
extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"}};Object.assign(Gg.prototype,{load:function(a,b,c,d){var e=this,f=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:Hh.extractUrlBase(a),g=new Ib(this.manager);g.setWithCredentials(this.withCredentials);g.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d&&(d=d.type,void 0!==d)){if("object"===d.toLowerCase()){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");
return}if("scene"===d.toLowerCase()){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.SceneLoader instead.");return}}c=e.parse(c,f);b(c.geometry,c.materials)},c,d)},setTexturePath:function(a){this.texturePath=a},parse:function(){return function(a,b){void 0!==a.data&&(a=a.data);a.scale=void 0!==a.scale?1/a.scale:1;var d=new ma,f=a,g,h,k,l,m,n,p,q,s,r,w,x,z,A,D=f.faces;s=f.vertices;var E=f.normals,F=f.colors;n=f.scale;var P=0;if(void 0!==f.uvs){for(g=0;g<f.uvs.length;g++)f.uvs[g].length&&
P++;for(g=0;g<P;g++)d.faceVertexUvs[g]=[]}l=0;for(m=s.length;l<m;)g=new e,g.x=s[l++]*n,g.y=s[l++]*n,g.z=s[l++]*n,d.vertices.push(g);l=0;for(m=D.length;l<m;)if(s=D[l++],r=s&1,k=s&2,g=s&8,p=s&16,w=s&32,n=s&64,s&=128,r){r=new Cb;r.a=D[l];r.b=D[l+1];r.c=D[l+3];x=new Cb;x.a=D[l+1];x.b=D[l+2];x.c=D[l+3];l+=4;k&&(k=D[l++],r.materialIndex=k,x.materialIndex=k);k=d.faces.length;if(g)for(g=0;g<P;g++)for(z=f.uvs[g],d.faceVertexUvs[g][k]=[],d.faceVertexUvs[g][k+1]=[],h=0;4>h;h++)q=D[l++],A=z[2*q],q=z[2*q+1],A=
new c(A,q),2!==h&&d.faceVertexUvs[g][k].push(A),0!==h&&d.faceVertexUvs[g][k+1].push(A);p&&(p=3*D[l++],r.normal.set(E[p++],E[p++],E[p]),x.normal.copy(r.normal));if(w)for(g=0;4>g;g++)p=3*D[l++],w=new e(E[p++],E[p++],E[p]),2!==g&&r.vertexNormals.push(w),0!==g&&x.vertexNormals.push(w);n&&(n=D[l++],n=F[n],r.color.setHex(n),x.color.setHex(n));if(s)for(g=0;4>g;g++)n=D[l++],n=F[n],2!==g&&r.vertexColors.push(new X(n)),0!==g&&x.vertexColors.push(new X(n));d.faces.push(r);d.faces.push(x)}else{r=new Cb;r.a=D[l++];
r.b=D[l++];r.c=D[l++];k&&(k=D[l++],r.materialIndex=k);k=d.faces.length;if(g)for(g=0;g<P;g++)for(z=f.uvs[g],d.faceVertexUvs[g][k]=[],h=0;3>h;h++)q=D[l++],A=z[2*q],q=z[2*q+1],A=new c(A,q),d.faceVertexUvs[g][k].push(A);p&&(p=3*D[l++],r.normal.set(E[p++],E[p++],E[p]));if(w)for(g=0;3>g;g++)p=3*D[l++],w=new e(E[p++],E[p++],E[p]),r.vertexNormals.push(w);n&&(n=D[l++],r.color.setHex(F[n]));if(s)for(g=0;3>g;g++)n=D[l++],r.vertexColors.push(new X(F[n]));d.faces.push(r)}f=a;l=void 0!==f.influencesPerVertex?f.influencesPerVertex:
2;if(f.skinWeights)for(m=0,D=f.skinWeights.length;m<D;m+=l)d.skinWeights.push(new B(f.skinWeights[m],1<l?f.skinWeights[m+1]:0,2<l?f.skinWeights[m+2]:0,3<l?f.skinWeights[m+3]:0));if(f.skinIndices)for(m=0,D=f.skinIndices.length;m<D;m+=l)d.skinIndices.push(new B(f.skinIndices[m],1<l?f.skinIndices[m+1]:0,2<l?f.skinIndices[m+2]:0,3<l?f.skinIndices[m+3]:0));d.bones=f.bones;d.bones&&0<d.bones.length&&(d.skinWeights.length!==d.skinIndices.length||d.skinIndices.length!==d.vertices.length)&&console.warn("When skinning, number of vertices ("+
d.vertices.length+"), skinIndices ("+d.skinIndices.length+"), and skinWeights ("+d.skinWeights.length+") should match.");m=a;D=m.scale;if(void 0!==m.morphTargets)for(f=0,l=m.morphTargets.length;f<l;f++)for(d.morphTargets[f]={},d.morphTargets[f].name=m.morphTargets[f].name,d.morphTargets[f].vertices=[],E=d.morphTargets[f].vertices,F=m.morphTargets[f].vertices,P=0,s=F.length;P<s;P+=3)n=new e,n.x=F[P]*D,n.y=F[P+1]*D,n.z=F[P+2]*D,E.push(n);if(void 0!==m.morphColors&&0<m.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),
D=d.faces,m=m.morphColors[0].colors,f=0,l=D.length;f<l;f++)D[f].color.fromArray(m,3*f);m=a;f=[];l=[];void 0!==m.animation&&l.push(m.animation);void 0!==m.animations&&(m.animations.length?l=l.concat(m.animations):l.push(m.animations));for(m=0;m<l.length;m++)(D=jc.parseAnimation(l[m],d.bones))&&f.push(D);d.morphTargets&&(l=jc.CreateClipsFromMorphTargetSequences(d.morphTargets,10),f=f.concat(l));0<f.length&&(d.animations=f);d.computeFaceNormals();d.computeBoundingSphere();if(void 0===a.materials||0===
a.materials.length)return{geometry:d};f=Re.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:d,materials:f}}}()});Object.assign(lh.prototype,{load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this;(new Ib(e.manager)).load(a,function(c){var f=null;try{f=JSON.parse(c)}catch(g){void 0!==d&&d(g);console.error("THREE:ObjectLoader: Can't parse "+a+".",g.message);return}c=f.metadata;void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase()?
console.error("THREE.ObjectLoader: Can't load "+a+". Use THREE.JSONLoader instead."):e.parse(f,b)},c,d)},setTexturePath:function(a){this.texturePath=a},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a,b){var c=this.parseShape(a.shapes),c=this.parseGeometries(a.geometries,c),d=this.parseImages(a.images,function(){void 0!==b&&b(e)}),d=this.parseTextures(a.textures,d),d=this.parseMaterials(a.materials,d),e=this.parseObject(a.object,c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));
void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new md).fromJSON(a[c]);b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new Gg,e=new Fg,f=0,g=a.length;f<g;f++){var h,k=a[f];switch(k.type){case "PlaneGeometry":case "PlaneBufferGeometry":h=new Ic[k.type](k.width,k.height,k.widthSegments,k.heightSegments);break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":h=
new Ic[k.type](k.width,k.height,k.depth,k.widthSegments,k.heightSegments,k.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":h=new Ic[k.type](k.radius,k.segments,k.thetaStart,k.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":h=new Ic[k.type](k.radiusTop,k.radiusBottom,k.height,k.radialSegments,k.heightSegments,k.openEnded,k.thetaStart,k.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":h=new Ic[k.type](k.radius,k.height,k.radialSegments,
k.heightSegments,k.openEnded,k.thetaStart,k.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":h=new Ic[k.type](k.radius,k.widthSegments,k.heightSegments,k.phiStart,k.phiLength,k.thetaStart,k.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":h=new Ic[k.type](k.radius,k.detail);
break;case "RingGeometry":case "RingBufferGeometry":h=new Ic[k.type](k.innerRadius,k.outerRadius,k.thetaSegments,k.phiSegments,k.thetaStart,k.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":h=new Ic[k.type](k.radius,k.tube,k.radialSegments,k.tubularSegments,k.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":h=new Ic[k.type](k.radius,k.tube,k.tubularSegments,k.radialSegments,k.p,k.q);break;case "LatheGeometry":case "LatheBufferGeometry":h=new Ic[k.type](k.points,
k.segments,k.phiStart,k.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":h=new Ic[k.type](k.vertices,k.indices,k.radius,k.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":h=[];f=0;for(g=k.shapes.length;f<g;f++)h.push(b[k.shapes[f]]);h=new Ic[k.type](h,k.curveSegments);break;case "BufferGeometry":h=e.parse(k);break;case "Geometry":h=d.parse(k,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+k.type+'"');continue}h.uuid=
k.uuid;void 0!==k.name&&(h.name=k.name);c[k.uuid]=h}return c},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new Gf;d.setTextures(b);for(var e=0,f=a.length;e<f;e++){var g=a[e];if("MultiMaterial"===g.type){for(var h=[],k=0;k<g.materials.length;k++)h.push(d.parse(g.materials[k]));c[g.uuid]=h}else c[g.uuid]=d.parse(g)}}return c},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=jc.parse(a[c]);b.push(d)}return b},parseImages:function(a,b){function c(a){d.manager.itemStart(a);
return g.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemEnd(a);d.manager.itemError(a)})}var d=this,e={};if(void 0!==a&&0<a.length){var f=new xf(b),g=new yf(f);g.setCrossOrigin(this.crossOrigin);for(var f=0,h=a.length;f<h;f++){var k=a[f],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(k.url)?k.url:d.texturePath+k.url;e[k.uuid]=c(l)}}return e},parseTextures:function(a,b){function c(a,b){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
a);return b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=new n(b[g.image]);h.needsUpdate=!0;h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);void 0!==g.mapping&&(h.mapping=c(g.mapping,wi));void 0!==g.offset&&h.offset.fromArray(g.offset);void 0!==g.repeat&&h.repeat.fromArray(g.repeat);void 0!==g.center&&h.center.fromArray(g.center);
void 0!==g.rotation&&(h.rotation=g.rotation);void 0!==g.wrap&&(h.wrapS=c(g.wrap[0],mi),h.wrapT=c(g.wrap[1],mi));void 0!==g.minFilter&&(h.minFilter=c(g.minFilter,ni));void 0!==g.magFilter&&(h.magFilter=c(g.magFilter,ni));void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy);void 0!==g.flipY&&(h.flipY=g.flipY);d[g.uuid]=h}return d},parseObject:function(a,b,c){function d(a){void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a);return b[a]}function e(a){if(void 0!==a){if(Array.isArray(a)){for(var b=
[],d=0,f=a.length;d<f;d++){var g=a[d];void 0===c[g]&&console.warn("THREE.ObjectLoader: Undefined material",g);b.push(c[g])}return b}void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);return c[a]}}var f;switch(a.type){case "Scene":f=new nc;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new X(a.background));void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new Bc(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(f.fog=new vd(a.fog.color,a.fog.density)));break;
case "PerspectiveCamera":f=new Ya(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new pa(a.left,a.right,a.top,a.bottom,a.near,a.far);break;case "AmbientLight":f=new Cf(a.color,a.intensity);break;case "DirectionalLight":f=new le(a.color,a.intensity);break;case "PointLight":f=
new nd(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Ld(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new Af(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new Me(a.color,a.groundColor,a.intensity);break;case "SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new sf(f,g):new ga(f,g);break;case "LOD":f=
new Ce;break;case "Line":f=new Sb(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new Xb(d(a.geometry),e(a.material));break;case "LineSegments":f=new Ra(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new xd(d(a.geometry),e(a.material));break;case "Sprite":f=new Be(e(a.material));break;case "Group":f=new kf;break;default:f=new U}f.uuid=a.uuid;void 0!==a.name&&(f.name=a.name);void 0!==a.matrix?(f.matrix.fromArray(a.matrix),f.matrix.decompose(f.position,f.quaternion,
f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale));void 0!==a.castShadow&&(f.castShadow=a.castShadow);void 0!==a.receiveShadow&&(f.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),
void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(f.visible=a.visible);void 0!==a.userData&&(f.userData=a.userData);if(void 0!==a.children)for(var g=a.children,h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c));if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){var h=a[g],k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var wi={UVMapping:300,CubeReflectionMapping:pf,CubeRefractionMapping:Nc,EquirectangularReflectionMapping:sd,
EquirectangularRefractionMapping:Vd,SphericalReflectionMapping:Xf,CubeUVReflectionMapping:Yf,CubeUVRefractionMapping:ie},mi={RepeatWrapping:sc,ClampToEdgeWrapping:cb,MirroredRepeatWrapping:yb},ni={NearestFilter:wa,NearestMipMapNearestFilter:xc,NearestMipMapLinearFilter:lc,LinearFilter:Eb,LinearMipMapNearestFilter:dg,LinearMipMapLinearFilter:wc};Od.prototype={constructor:Od,setOptions:function(a){this.options=a;return this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+
a);var e=this,f=Nf.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,e.options)}).then(function(c){Nf.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemEnd(a);e.manager.itemError(a)})},setCrossOrigin:function(){return this},setPath:function(a){this.path=a;return this}};Object.assign(eg.prototype,{moveTo:function(a,b){this.currentPath=
new uc;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d],g=new md;g.curves=f.curves;b.push(g)}return b}function d(a,b){for(var c=b.length,
e=!1,f=c-1,g=0;g<c;f=g++){var h=b[f],k=b[g],v=k.x-h.x,l=k.y-h.y;if(Math.abs(l)>Number.EPSILON){if(0>l&&(h=b[g],v=-v,k=b[f],l=-l),!(a.y<h.y||a.y>k.y))if(a.y===h.y){if(a.x===h.x)return!0}else{f=l*(a.x-h.x)-v*(a.y-h.y);if(0===f)return!0;0>f||(e=!e)}}else if(a.y===h.y&&(k.x<=a.x&&a.x<=h.x||h.x<=a.x&&a.x<=k.x))return!0}return e}var e=we.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);var g,h,k,l=[];if(1===f.length)return h=f[0],k=new md,k.curves=h.curves,l.push(k),l;var m=!e(f[0].getPoints()),
m=a?!m:m;k=[];var n=[],p=[],q=0,s;n[q]=void 0;p[q]=[];for(var r=0,w=f.length;r<w;r++)h=f[r],s=h.getPoints(),g=e(s),(g=a?!g:g)?(!m&&n[q]&&q++,n[q]={s:new md,p:s},n[q].s.curves=h.curves,m&&q++,p[q]=[]):p[q].push({h:h,p:s[0]});if(!n[0])return c(f);if(1<n.length){r=!1;h=[];e=0;for(f=n.length;e<f;e++)k[e]=[];e=0;for(f=n.length;e<f;e++)for(g=p[e],m=0;m<g.length;m++){q=g[m];s=!0;for(w=0;w<n.length;w++)d(q.p,n[w].p)&&(e!==w&&h.push({froms:e,tos:w,hole:m}),s?(s=!1,k[w].push(q)):r=!0);s&&k[e].push(q)}0<h.length&&
(r||(p=k))}r=0;for(e=n.length;r<e;r++)for(k=n[r].s,l.push(k),h=p[r],f=0,g=h.length;f<g;f++)k.holes.push(h[f].h);return l}});Object.assign(fg.prototype,{isFont:!0,generateShapes:function(a,b,c){void 0===b&&(b=100);c=[];var d=b;b=this.data;var e=String(a).split(""),d=d/b.resolution,f=(b.boundingBox.yMax-b.boundingBox.yMin+b.underlineThickness)*d;a=[];for(var g=0,h=0,k=0;k<e.length;k++){var l=e[k];if("\n"===l)g=0,h-=f;else{var m;m=d;var n=g,p=h;if(l=b.glyphs[l]||b.glyphs["?"]){var q=new eg,s=void 0,
r=void 0,w=r=s=void 0,x=void 0,B=void 0,z=void 0;if(l.o)for(var A=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),D=0,E=A.length;D<E;)switch(A[D++]){case "m":s=A[D++]*m+n;r=A[D++]*m+p;q.moveTo(s,r);break;case "l":s=A[D++]*m+n;r=A[D++]*m+p;q.lineTo(s,r);break;case "q":s=A[D++]*m+n;r=A[D++]*m+p;w=A[D++]*m+n;x=A[D++]*m+p;q.quadraticCurveTo(w,x,s,r);break;case "b":s=A[D++]*m+n,r=A[D++]*m+p,w=A[D++]*m+n,x=A[D++]*m+p,B=A[D++]*m+n,z=A[D++]*m+p,q.bezierCurveTo(w,x,B,z,s,r)}m={offsetX:l.ha*m,path:q}}else m=
void 0;g+=m.offsetX;a.push(m.path)}}b=0;for(e=a.length;b<e;b++)Array.prototype.push.apply(c,a[b].toShapes());return c}});Object.assign(Hf.prototype,{load:function(a,b,c,d){var e=this,f=new Ib(this.manager);f.setPath(this.path);f.load(a,function(a){var c;try{c=JSON.parse(a)}catch(d){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new fg(a)},setPath:function(a){this.path=
a;return this}});var uh,Ch={getContext:function(){void 0===uh&&(uh=new (window.AudioContext||window.webkitAudioContext));return uh},setContext:function(a){uh=a}};Object.assign(Pd.prototype,{load:function(a,b,c,d){var e=new Ib(this.manager);e.setResponseType("arraybuffer");e.load(a,function(a){Ch.getContext().decodeAudioData(a,function(a){b(a)})},c,d)}});Object.assign(Hg.prototype,{update:function(){var a,b,c,e,f,g,h,k,l=new d,m=new d;return function(d){if(a!==this||b!==d.focus||c!==d.fov||e!==d.aspect*
this.aspect||f!==d.near||g!==d.far||h!==d.zoom||k!==this.eyeSep){a=this;b=d.focus;c=d.fov;e=d.aspect*this.aspect;f=d.near;g=d.far;h=d.zoom;var n=d.projectionMatrix.clone();k=this.eyeSep/2;var p=k*f/b,q=f*Math.tan(Ba.DEG2RAD*c*0.5)/h,s,r;m.elements[12]=-k;l.elements[12]=k;s=-q*e+p;r=q*e+p;n.elements[0]=2*f/(r-s);n.elements[8]=(r+s)/(r-s);this.cameraL.projectionMatrix.copy(n);s=-q*e-p;r=q*e-p;n.elements[0]=2*f/(r-s);n.elements[8]=(r+s)/(r-s);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(d.matrixWorld).multiply(m);
this.cameraR.matrixWorld.copy(d.matrixWorld).multiply(l)}}()});Te.prototype=Object.create(U.prototype);Te.prototype.constructor=Te;Ue.prototype=Object.assign(Object.create(U.prototype),{constructor:Ue,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(a){null!==this.filter?
(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(a){this.gain.gain.value=a},updateMatrixWorld:function(){var a=new e,b=new g,c=new e,d=new e;return function(e){U.prototype.updateMatrixWorld.call(this,e);e=this.context.listener;var f=this.up;this.matrixWorld.decompose(a,
b,c);d.set(0,0,-1).applyQuaternion(b);e.positionX?(e.positionX.setValueAtTime(a.x,this.context.currentTime),e.positionY.setValueAtTime(a.y,this.context.currentTime),e.positionZ.setValueAtTime(a.z,this.context.currentTime),e.forwardX.setValueAtTime(d.x,this.context.currentTime),e.forwardY.setValueAtTime(d.y,this.context.currentTime),e.forwardZ.setValueAtTime(d.z,this.context.currentTime),e.upX.setValueAtTime(f.x,this.context.currentTime),e.upY.setValueAtTime(f.y,this.context.currentTime),e.upZ.setValueAtTime(f.z,
this.context.currentTime)):(e.setPosition(a.x,a.y,a.z),e.setOrientation(d.x,d.y,d.z,f.x,f.y,f.z))}}()});Ve.prototype=Object.assign(Object.create(U.prototype),{constructor:Ve,getOutput:function(){return this.gain},setNodeSource:function(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this},setBuffer:function(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");
else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var a=this.context.createBufferSource();a.buffer=this.buffer;a.loop=this.loop;a.onended=this.onEnded.bind(this);a.playbackRate.setValueAtTime(this.playbackRate,this.startTime);this.startTime=this.context.currentTime;a.start(this.startTime,this.offset);this.isPlaying=!0;this.source=a;return this.connect()}},pause:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-
1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(a){a||(a=[]);!0===this.isPlaying?(this.disconnect(),this.filters=
a,this.connect()):this.filters=a;return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=
!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(a){this.gain.gain.value=a;return this}});We.prototype=Object.assign(Object.create(Ve.prototype),
{constructor:We,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){this.panner.refDistance=a},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(a){this.panner.rolloffFactor=a},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(a){this.panner.distanceModel=a},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){this.panner.maxDistance=
a},updateMatrixWorld:function(){var a=new e;return function(b){U.prototype.updateMatrixWorld.call(this,b);a.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(a.x,a.y,a.z)}}()});Object.assign(hg.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){for(var a=0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(Ig.prototype,{accumulate:function(a,b){var c=this.buffer,d=
this.valueSize,e=a*d+d,f=this.cumulativeWeight;if(0===f){for(f=0;f!==d;++f)c[e+f]=c[f];f=b}else f+=b,this._mixBufferRegion(c,e,0,b/f,d);this.cumulativeWeight=f},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);for(var d=b,f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=
b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(a,b,c,d,e){if(0.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){g.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}});Object.assign(Jg.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,
b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(Pb,{Composite:Jg,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new Pb.Composite(a,b,c):new Pb(a,b,c)},sanitizeNodeName:function(){var a=/[\[\]\.:\/]/g;
return function(b){return b.replace(/\s/g,"_").replace(a,"")}}(),parseTrackName:function(){var a="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",b=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),a=/(WCOD+)?/.source.replace("WCOD",a),c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),d=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),e=RegExp("^"+b+a+c+d+"$"),f=["material","materials","bones"];return function(a){var b=e.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+
a);var b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==f.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}}(),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;
if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=function(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(c=d(a.children))return c}return null}});Object.assign(Pb.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,
b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,
b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,
d=b.propertyName,e=b.propertyIndex;a||(this.node=a=Pb.findNode(this.rootNode,b.nodeName)||this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",
this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",
this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);else{b=this.Versioning.None;void 0!==a.needsUpdate?(b=this.Versioning.NeedsUpdate,this.targetObject=a):void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=a);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",
this);return}if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",
this);return}for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+
this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(Pb.prototype,{_getValue_unbound:Pb.prototype.getValue,_setValue_unbound:Pb.prototype.setValue});Object.assign(Lg.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=void 0,l=0,m=arguments.length;l!==
m;++l){var n=arguments[l],p=n.uuid,q=d[p];if(void 0===q){q=b++;d[p]=q;a.push(n);for(var p=0,s=h;p!==s;++p)g[p].push(new Pb(n,e[p],f[p]))}else if(q<c){var k=a[q],r=--c,s=a[r];d[s.uuid]=q;a[q]=s;d[p]=r;a[r]=n;p=0;for(s=h;p!==s;++p){var w=g[p],x=w[q];w[q]=w[r];void 0===x&&(x=new Pb(n,e[p],f[p]));w[r]=x}}else a[q]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=
c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=arguments[f],k=h.uuid,l=c[k];if(void 0!==l&&l>=b){var m=b++,n=a[m];c[n.uuid]=l;a[l]=n;c[k]=m;a[m]=h;h=0;for(k=e;h!==k;++h){var n=d[h],p=n[l];n[l]=n[m];n[m]=p}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=
arguments[g].uuid,l=d[k];if(void 0!==l)if(delete d[k],l<c){var k=--c,m=a[k],n=--b,p=a[n];d[m.uuid]=l;a[l]=m;d[p.uuid]=k;a[k]=p;a.pop();m=0;for(p=f;m!==p;++m){var q=e[m],s=q[n];q[l]=q[k];q[k]=s;q.pop()}}else for(n=--b,p=a[n],d[p.uuid]=l,a[l]=p,a.pop(),m=0,p=f;m!==p;++m)q=e[m],q[l]=q[n],q.pop()}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,
l=Array(h.length),d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);c=k;for(d=h.length;c!==d;++c)l[c]=new Pb(h[c],a,b);return l},unsubscribe_:function(a){var b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c;f[c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(Mg.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},
reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){this._startTime=a;return this},setLoop:function(a,b){this.loop=a;this.repetitions=b;return this},setEffectiveWeight:function(a){this.weight=a;
this._effectiveWeight=this.enabled?a:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,1,0)},crossFadeFrom:function(a,b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;
null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},setEffectiveTimeScale:function(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(a){this.timeScale=this._clip.duration/a;return this.stopWarping()},syncWith:function(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,
0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;d[1]=e+c;f[0]=a/g;f[1]=b/g;return this},stopWarping:function(){var a=this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||
this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;for(var e=this._propertyBindings,f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){var b=this.weight,c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0],
b=b*d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){var b=this.timeScale,c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0],b=b*d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a;if(0===a)return b;var c=this._clip.duration,d=this.loop,e=this._loopCount;if(2200===
d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>a?-1:1})}else{d=2202===d;-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,d)):this._setEndings(0===this.repetitions,!0,d));if(b>=c||0>b){var f=Math.floor(b/c),b=b-c*f,e=e+Math.abs(f),g=this.repetitions-e;0>g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0<a?
c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(0===g?(a=0>a,this._setEndings(a,!a,d)):this._setEndings(!1,!1,d),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f}))}if(d&&1===(e&1))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:lf:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:lf:2402)},_scheduleFading:function(a,
b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}});Ng.prototype=Object.assign(Object.create(b.prototype),{constructor:Ng,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings,g=a._interpolants,h=c.uuid,k=this._bindingsByRootAndName,l=k[h];void 0===l&&(l={},k[h]=l);for(k=0;k!==e;++k){var m=
d[k],n=m.name,p=l[n];if(void 0===p){p=f[k];if(void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,h,n));continue}p=new Ig(Pb.create(c,n,b&&b._propertyBindings[k].binding.parsedPath),m.ValueTypeName,m.getValueSize());++p.referenceCount;this._addInactiveBinding(p,h,n)}f[k]=p;g[k].resultBuffer=p.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,
d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip=
{};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){a=a._cacheIndex;
return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;var b=a._clip.uuid,c=this._actionsByClip,d=c[b],e=
d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=
d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=e);e[c]=a;a._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid,c=c.path,e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex;
g._cacheIndex=a;b[a]=g;b.pop();delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];void 0===c&&(c=new Ef(new Float32Array(2),
new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c);return c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=c;b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid,e="string"===typeof a?jc.findByName(c,a):a,c=null!==e?e.uuid:a,f=this._actionsByClip[c],g=null;if(void 0!==f){g=f.actionByRoot[d];
if(void 0!==g)return g;g=f.knownActions[0];null===e&&(e=g._clip)}if(null===e)return null;e=new Mg(this,e,b);this._bindAction(e,g);this._addInactiveAction(e,c,d);return e},existingAction:function(a,b){var c=b||this._root,d=c.uuid,c="string"===typeof a?jc.findByName(c,a):a,c=this._actionsByClip[c?c.uuid:a];return void 0!==c?c.actionByRoot[d]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=
0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){for(var d=d.knownActions,e=0,f=d.length;e!==
f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;k._cacheIndex=h;b[h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=a.uuid;var b=this._actionsByClip,c;for(c in b){var d=b[c].actionByRoot[a];void 0!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}c=this._bindingsByRootAndName[a];if(void 0!==c)for(var e in c)a=c[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},
uncacheAction:function(a,b){var c=this.existingAction(a,b);null!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}});jg.prototype.clone=function(){return new jg(void 0===this.value.clone?this.value:this.value.clone())};Og.prototype=Object.assign(Object.create(ba.prototype),{constructor:Og,isInstancedBufferGeometry:!0,copy:function(a){ba.prototype.copy.call(this,a);this.maxInstancedCount=a.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});Object.defineProperties(Pg.prototype,
{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(Pg.prototype,{isInterleavedBufferAttribute:!0,setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*
this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},
setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}});Object.defineProperty(Qd.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(Qd.prototype,{isInterleavedBuffer:!0,setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.stride:0;this.array=a},setDynamic:function(a){this.dynamic=
a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=a.stride;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){this.onUploadCallback=a;return this}});kg.prototype=Object.assign(Object.create(Qd.prototype),
{constructor:kg,isInstancedInterleavedBuffer:!0,copy:function(a){Qd.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});mg.prototype=Object.assign(Object.create(ra.prototype),{constructor:mg,isInstancedBufferAttribute:!0,copy:function(a){ra.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Object.assign(Xe.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),
this.ray.direction.set(a.x,a.y,0.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,b){var c=[];Qg(a,this,c,b);c.sort(nh);return c},intersectObjects:function(a,b){var c=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),
c;for(var d=0,e=a.length;d<e;d++)Qg(a[d],this,c,b);c.sort(nh);return c}});Object.assign(bb.prototype,{start:function(){this.oldTime=this.startTime=("undefined"===typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"===typeof performance?
Date:performance).now(),a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});Object.assign(oh.prototype,{set:function(a,b,c){this.radius=a;this.phi=b;this.theta=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this},makeSafe:function(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this},setFromVector3:function(a){this.radius=a.length();0===this.radius?this.phi=this.theta=
0:(this.theta=Math.atan2(a.x,a.z),this.phi=Math.acos(Ba.clamp(a.y/this.radius,-1,1)));return this}});Object.assign(Ye.prototype,{set:function(a,b,c){this.radius=a;this.theta=b;this.y=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this},setFromVector3:function(a){this.radius=Math.sqrt(a.x*a.x+a.z*a.z);this.theta=Math.atan2(a.x,a.z);this.y=a.y;return this}});Object.assign(pg.prototype,{set:function(a,
b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;
this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){a=a||new c;return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(a){a=a||new c;return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){return(b||new c).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},
clampPoint:function(a,b){return(b||new c).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});oe.prototype=Object.create(U.prototype);
oe.prototype.constructor=oe;oe.prototype.isImmediateRenderObject=!0;$e.prototype=Object.create(Ra.prototype);$e.prototype.constructor=$e;$e.prototype.update=function(){var a=new e,b=new e,c=new l;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,k=g.faces,l=g=0,m=k.length;l<m;l++)for(var n=k[l],p=0,q=n.vertexNormals.length;p<
q;p++){var s=n.vertexNormals[p];a.copy(h[n[d[p]]]).applyMatrix4(e);b.copy(s).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);f.setXYZ(g,a.x,a.y,a.z);g+=1;f.setXYZ(g,b.x,b.y,b.z);g+=1}else if(g&&g.isBufferGeometry)for(d=g.attributes.position,h=g.attributes.normal,p=g=0,q=d.count;p<q;p++)a.set(d.getX(p),d.getY(p),d.getZ(p)).applyMatrix4(e),b.set(h.getX(p),h.getY(p),h.getZ(p)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,
b.z),g+=1;f.needsUpdate=!0}}();pe.prototype=Object.create(U.prototype);pe.prototype.constructor=pe;pe.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};pe.prototype.update=function(){var a=new e,b=new e;return function(){this.light.updateMatrixWorld();var c=this.light.distance?this.light.distance:1E3,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);
this.cone.lookAt(b.sub(a));void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();qe.prototype=Object.create(Ra.prototype);qe.prototype.constructor=qe;qe.prototype.updateMatrixWorld=function(){var a=new e,b=new d,c=new d;return function(d){var e=this.bones,f=this.geometry,g=f.getAttribute("position");c.getInverse(this.root.matrixWorld);for(var h=0,k=0;h<e.length;h++){var l=e[h];l.parent&&l.parent.isBone&&(b.multiplyMatrices(c,l.matrixWorld),
a.setFromMatrixPosition(b),g.setXYZ(k,a.x,a.y,a.z),b.multiplyMatrices(c,l.parent.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k+1,a.x,a.y,a.z),k+=2)}f.getAttribute("position").needsUpdate=!0;U.prototype.updateMatrixWorld.call(this,d)}}();re.prototype=Object.create(ga.prototype);re.prototype.constructor=re;re.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};re.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};
Sd.prototype=Object.create(U.prototype);Sd.prototype.constructor=Sd;Sd.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};Sd.prototype.update=function(){var a=0.5*this.light.width,b=0.5*this.light.height,c=this.line.geometry.attributes.position,d=c.array;d[0]=a;d[1]=-b;d[2]=0;d[3]=a;d[4]=b;d[5]=0;d[6]=-a;d[7]=b;d[8]=0;d[9]=-a;d[10]=-b;d[11]=0;d[12]=a;d[13]=-b;d[14]=0;c.needsUpdate=!0;void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};
se.prototype=Object.create(U.prototype);se.prototype.constructor=se;se.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};se.prototype.update=function(){var a=new e,b=new X,c=new X;return function(){var d=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=d.geometry.getAttribute("color");b.copy(this.light.color);c.copy(this.light.groundColor);for(var f=0,g=e.count;f<g;f++){var h=f<g/2?b:c;e.setXYZ(f,h.r,h.g,h.b)}e.needsUpdate=
!0}d.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate())}}();af.prototype=Object.create(Ra.prototype);af.prototype.constructor=af;qg.prototype=Object.create(Ra.prototype);qg.prototype.constructor=qg;Yc.prototype=Object.create(Ra.prototype);Yc.prototype.constructor=Yc;Yc.prototype.update=function(){var a=new e,b=new e,c=new l;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);for(var d=this.object.matrixWorld,e=this.geometry.attributes.position,
f=this.object.geometry,g=f.vertices,f=f.faces,h=0,k=0,l=f.length;k<l;k++){var m=f[k],n=m.normal;a.copy(g[m.a]).add(g[m.b]).add(g[m.c]).divideScalar(3).applyMatrix4(d);b.copy(n).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=1}e.needsUpdate=!0}}();bf.prototype=Object.create(U.prototype);bf.prototype.constructor=bf;bf.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();
this.targetLine.material.dispose()};bf.prototype.update=function(){var a=new e,b=new e,c=new e;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(c);
this.targetLine.scale.z=c.length()}}();Td.prototype=Object.create(Ra.prototype);Td.prototype.constructor=Td;Td.prototype.update=function(){function a(e,g,h,k){d.set(g,h,k).unproject(f);e=c[e];if(void 0!==e)for(g=b.getAttribute("position"),h=0,k=e.length;h<k;h++)g.setXYZ(e[h],d.x,d.y,d.z)}var b,c,d=new e,f=new Na;return function(){b=this.geometry;c=this.pointMap;f.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",
1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",0.7,1.1,-1);a("u2",-0.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.getAttribute("position").needsUpdate=!0}}();te.prototype=Object.create(Ra.prototype);te.prototype.constructor=te;te.prototype.update=function(){var a=new fb;return function(b){void 0!==b&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");
void 0!==this.object&&a.setFromObject(this.object);if(!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();te.prototype.setFromObject=function(a){this.object=a;this.update();return this};
ub.prototype=Object.create(Ra.prototype);ub.prototype.constructor=ub;ub.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(0.5),U.prototype.updateMatrixWorld.call(this,a))};cf.prototype=Object.create(Sb.prototype);cf.prototype.constructor=cf;cf.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(0.5*this.size,0.5*this.size,b);this.lookAt(this.plane.normal);
U.prototype.updateMatrixWorld.call(this,a)};var sh,Dh;Vb.prototype=Object.create(U.prototype);Vb.prototype.constructor=Vb;Vb.prototype.setDirection=function(){var a=new e,b;return function(c){0.99999<c.y?this.quaternion.set(0,0,0,1):-0.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();Vb.prototype.setLength=function(a,b,c){void 0===b&&(b=0.2*a);void 0===c&&(c=0.2*b);this.line.scale.set(1,Math.max(0,a-b),1);this.line.updateMatrix();
this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};Vb.prototype.setColor=function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};df.prototype=Object.create(Ra.prototype);df.prototype.constructor=df;la.create=function(a,b){console.log("THREE.Curve.create() has been deprecated");a.prototype=Object.create(la.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};Object.assign(Wc.prototype,{createPointsGeometry:function(a){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var b=new ma,c=0,d=a.length;c<d;c++){var f=a[c];b.vertices.push(new e(f.x,
f.y,f.z||0))}return b}});Object.assign(uc.prototype,{fromPoints:function(a){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(a)}});Ug.prototype=Object.create(Nb.prototype);ef.prototype=Object.create(Nb.prototype);Da.prototype=Object.create(Nb.prototype);Object.assign(Da.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},
reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});af.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};qe.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(Re.prototype,{extractUrlBase:function(a){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");
return Hh.extractUrlBase(a)}});Object.assign(pg.prototype,{center:function(a){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},size:function(a){console.warn("THREE.Box2: .size() has been renamed to .getSize().");
return this.getSize(a)}});Object.assign(fb.prototype,{center:function(a){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");
return this.intersectsSphere(a)},size:function(a){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(a)}});A.prototype.center=function(a){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(a)};Object.assign(Ba,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(a){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");
return Ba.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return Ba.ceilPowerOfTwo(a)}});Object.assign(l.prototype,{flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(d.prototype,{extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},getPosition:function(){var a;return function(){void 0===a&&(a=new e);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");
return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},
rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},
rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");
return this.makePerspective(a,b,d,c,e,f)}});ib.prototype.isIntersectionLine=function(a){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(a)};g.prototype.multiplyVector3=function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)};Object.assign(oa.prototype,{isIntersectionBox:function(a){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");
return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(a)},isIntersectionSphere:function(a){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)}});Object.assign(md.prototype,{extractAllPoints:function(a){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(a)},
extrude:function(a){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new lb(this,a)},makeGeometry:function(a){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new Gd(this,a)}});Object.assign(c.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");
return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(e.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},
getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,
a)},applyProjection:function(a){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(a)},fromAttribute:function(a,b,c){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");
return this.manhattanLength()}});Object.assign(B.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});ma.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")};Object.assign(U.prototype,
{getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)}});Object.defineProperties(U.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");
return this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.defineProperties(Ce.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");
return this.levels}}});Object.defineProperty(dd.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Object.defineProperty(la.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");return this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");
this.arcLengthDivisions=a}});Ya.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties($a.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=a}},
shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");
this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");
this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(ra.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");
return this.array.length}}});Object.assign(ba.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");
this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(ba.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});
Object.defineProperties(jg.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(aa.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},
wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new X}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}}});Object.defineProperties(ic.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");
return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(R.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});Object.assign(Vf.prototype,
{getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");
return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");
return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},
supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");
return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}});
Object.defineProperties(Vf.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},
set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Kc.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},
set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(E.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");
return this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=a}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},
set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=a}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},
set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=a}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");
this.texture.repeat=a}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");
return this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});Object.assign(Tf.prototype,{getStandingMatrix:function(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}});Object.defineProperties(Tf.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}});Ve.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
var b=this;(new Pd).load(a,function(a){b.setBuffer(a)});return this};hg.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");return this.getFrequencyData()};Te.prototype.updateCubeMap=function(a,b){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(a,b)};a.WebGLRenderTargetCube=s;a.WebGLRenderTarget=E;a.WebGLRenderer=Vf;a.ShaderLib=Mf;a.UniformsLib=ta;a.UniformsUtils=yc;a.ShaderChunk=Ua;a.FogExp2=vd;a.Fog=Bc;
a.Scene=nc;a.Sprite=Be;a.LOD=Ce;a.SkinnedMesh=sf;a.Skeleton=dd;a.Bone=qf;a.Mesh=ga;a.LineSegments=Ra;a.LineLoop=Xb;a.Line=Sb;a.Points=xd;a.Group=kf;a.VideoTexture=zg;a.DataTexture=D;a.CompressedTexture=pc;a.CubeTexture=q;a.CanvasTexture=Wb;a.DepthTexture=cd;a.Texture=n;a.CompressedTextureLoader=Dg;a.DataTextureLoader=$f;a.CubeTextureLoader=Ke;a.TextureLoader=Le;a.ObjectLoader=lh;a.MaterialLoader=Gf;a.BufferGeometryLoader=Fg;a.DefaultLoadingManager=zc;a.LoadingManager=xf;a.JSONLoader=Gg;a.ImageLoader=
yf;a.ImageBitmapLoader=Od;a.FontLoader=Hf;a.FileLoader=Ib;a.Loader=Re;a.LoaderUtils=Hh;a.Cache=Nf;a.AudioLoader=Pd;a.SpotLightShadow=zf;a.SpotLight=Af;a.PointLight=nd;a.RectAreaLight=Ld;a.HemisphereLight=Me;a.DirectionalLightShadow=Bf;a.DirectionalLight=le;a.AmbientLight=Cf;a.LightShadow=Kd;a.Light=$a;a.StereoCamera=Hg;a.PerspectiveCamera=Ya;a.OrthographicCamera=pa;a.CubeCamera=Te;a.ArrayCamera=Ae;a.Camera=Na;a.AudioListener=Ue;a.PositionalAudio=We;a.AudioContext=Ch;a.AudioAnalyser=hg;a.Audio=Ve;
a.VectorKeyframeTrack=Pe;a.StringKeyframeTrack=cg;a.QuaternionKeyframeTrack=Ne;a.NumberKeyframeTrack=Oe;a.ColorKeyframeTrack=Md;a.BooleanKeyframeTrack=od;a.PropertyMixer=Ig;a.PropertyBinding=Pb;a.KeyframeTrack=zb;a.AnimationUtils=cc;a.AnimationObjectGroup=Lg;a.AnimationMixer=Ng;a.AnimationClip=jc;a.Uniform=jg;a.InstancedBufferGeometry=Og;a.BufferGeometry=ba;a.Geometry=ma;a.InterleavedBufferAttribute=Pg;a.InstancedInterleavedBuffer=kg;a.InterleavedBuffer=Qd;a.InstancedBufferAttribute=mg;a.Face3=Cb;
a.Object3D=U;a.Raycaster=Xe;a.Layers=ad;a.EventDispatcher=b;a.Clock=bb;a.QuaternionLinearInterpolant=Df;a.LinearInterpolant=Ef;a.DiscreteInterpolant=Ff;a.CubicInterpolant=pd;a.Interpolant=bc;a.Triangle=fa;a.Math=Ba;a.Spherical=oh;a.Cylindrical=Ye;a.Plane=ib;a.Frustum=Bb;a.Sphere=hb;a.Ray=oa;a.Matrix4=d;a.Matrix3=l;a.Box3=fb;a.Box2=pg;a.Line3=A;a.Euler=wb;a.Vector4=B;a.Vector3=e;a.Vector2=c;a.Quaternion=g;a.Color=X;a.ImmediateRenderObject=oe;a.VertexNormalsHelper=$e;a.SpotLightHelper=pe;a.SkeletonHelper=
qe;a.PointLightHelper=re;a.RectAreaLightHelper=Sd;a.HemisphereLightHelper=se;a.GridHelper=af;a.PolarGridHelper=qg;a.FaceNormalsHelper=Yc;a.DirectionalLightHelper=bf;a.CameraHelper=Td;a.BoxHelper=te;a.Box3Helper=ub;a.PlaneHelper=cf;a.ArrowHelper=Vb;a.AxesHelper=df;a.Shape=md;a.Path=uc;a.ShapePath=eg;a.Font=fg;a.CurvePath=Wc;a.Curve=la;a.ShapeUtils=we;a.WebGLUtils=Uf;a.WireframeGeometry=wd;a.ParametricGeometry=$d;a.ParametricBufferGeometry=ae;a.TetrahedronGeometry=Cc;a.TetrahedronBufferGeometry=Oc;
a.OctahedronGeometry=De;a.OctahedronBufferGeometry=yd;a.IcosahedronGeometry=tf;a.IcosahedronBufferGeometry=zd;a.DodecahedronGeometry=Ee;a.DodecahedronBufferGeometry=de;a.PolyhedronGeometry=be;a.PolyhedronBufferGeometry=sb;a.TubeGeometry=ce;a.TubeBufferGeometry=Pc;a.TorusKnotGeometry=Ad;a.TorusKnotBufferGeometry=ee;a.TorusGeometry=fe;a.TorusBufferGeometry=ge;a.TextGeometry=xb;a.TextBufferGeometry=hc;a.SphereGeometry=qc;a.SphereBufferGeometry=Tc;a.RingGeometry=Ie;a.RingBufferGeometry=Qc;a.PlaneGeometry=
kb;a.PlaneBufferGeometry=M;a.LatheGeometry=vf;a.LatheBufferGeometry=Fd;a.ShapeGeometry=Gd;a.ShapeBufferGeometry=gd;a.ExtrudeGeometry=lb;a.ExtrudeBufferGeometry=Sa;a.EdgesGeometry=Bd;a.ConeGeometry=je;a.ConeBufferGeometry=Je;a.CylinderGeometry=hd;a.CylinderBufferGeometry=Uc;a.CircleGeometry=wf;a.CircleBufferGeometry=ke;a.BoxGeometry=ca;a.BoxBufferGeometry=gb;a.ShadowMaterial=Mb;a.SpriteMaterial=bd;a.RawShaderMaterial=Yb;a.ShaderMaterial=R;a.PointsMaterial=oc;a.MeshPhysicalMaterial=Hd;a.MeshStandardMaterial=
Hb;a.MeshPhongMaterial=ic;a.MeshToonMaterial=Id;a.MeshNormalMaterial=id;a.MeshLambertMaterial=Dc;a.MeshDepthMaterial=Fb;a.MeshDistanceMaterial=Jb;a.MeshBasicMaterial=pb;a.LineDashedMaterial=Jd;a.LineBasicMaterial=Ka;a.Material=aa;a.Float64BufferAttribute=ob;a.Float32BufferAttribute=da;a.Uint32BufferAttribute=Aa;a.Int32BufferAttribute=La;a.Uint16BufferAttribute=ab;a.Int16BufferAttribute=dc;a.Uint8ClampedBufferAttribute=jb;a.Uint8BufferAttribute=Gb;a.Int8BufferAttribute=Kb;a.BufferAttribute=ra;a.ArcCurve=
kd;a.CatmullRomCurve3=Nb;a.CubicBezierCurve=$b;a.CubicBezierCurve3=Ec;a.EllipseCurve=Zb;a.LineCurve=Ob;a.LineCurve3=Fc;a.QuadraticBezierCurve=tc;a.QuadraticBezierCurve3=Za;a.SplineCurve=ac;a.REVISION=Wa;a.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};a.CullFaceNone=vb;a.CullFaceBack=Vg;a.CullFaceFront=rf;a.CullFaceFrontBack=3;a.FrontFaceDirectionCW=rc;a.FrontFaceDirectionCCW=1;a.BasicShadowMap=0;a.PCFShadowMap=og;a.PCFSoftShadowMap=ph;a.FrontSide=Zf;a.BackSide=Gc;a.DoubleSide=ed;a.FlatShading=1;a.SmoothShading=
2;a.NoColors=td;a.FaceColors=ec;a.VertexColors=me;a.NoBlending=rg;a.NormalBlending=Hc;a.AdditiveBlending=gg;a.SubtractiveBlending=Lf;a.MultiplyBlending=fd;a.CustomBlending=ud;a.AddEquation=Ud;a.SubtractEquation=Rd;a.ReverseSubtractEquation=tg;a.MinEquation=Jf;a.MaxEquation=vc;a.ZeroFactor=lg;a.OneFactor=ff;a.SrcColorFactor=hf;a.OneMinusSrcColorFactor=Zg;a.SrcAlphaFactor=sg;a.OneMinusSrcAlphaFactor=bg;a.DstAlphaFactor=$c;a.OneMinusDstAlphaFactor=ye;a.DstColorFactor=$g;a.OneMinusDstColorFactor=mf;a.SrcAlphaSaturateFactor=
ha;a.NeverDepth=mh;a.AlwaysDepth=Of;a.LessDepth=Qf;a.LessEqualDepth=Ze;a.EqualDepth=qh;a.GreaterEqualDepth=Kg;a.GreaterDepth=Wf;a.NotEqualDepth=Pf;a.MultiplyOperation=Lc;a.MixOperation=Wd;a.AddOperation=rb;a.NoToneMapping=jd;a.LinearToneMapping=ug;a.ReinhardToneMapping=bh;a.Uncharted2ToneMapping=Xd;a.CineonToneMapping=ze;a.UVMapping=300;a.CubeReflectionMapping=pf;a.CubeRefractionMapping=Nc;a.EquirectangularReflectionMapping=sd;a.EquirectangularRefractionMapping=Vd;a.SphericalReflectionMapping=Xf;
a.CubeUVReflectionMapping=Yf;a.CubeUVRefractionMapping=ie;a.RepeatWrapping=sc;a.ClampToEdgeWrapping=cb;a.MirroredRepeatWrapping=yb;a.NearestFilter=wa;a.NearestMipMapNearestFilter=xc;a.NearestMipMapLinearFilter=lc;a.LinearFilter=Eb;a.LinearMipMapNearestFilter=dg;a.LinearMipMapLinearFilter=wc;a.UnsignedByteType=Nd;a.ByteType=rh;a.ShortType=Qb;a.UnsignedShortType=Qe;a.IntType=Sg;a.UnsignedIntType=Xc;a.FloatType=Zc;a.HalfFloatType=ue;a.UnsignedShort4444Type=gf;a.UnsignedShort5551Type=Se;a.UnsignedShort565Type=
If;a.UnsignedInt248Type=Kf;a.AlphaFormat=ig;a.RGBFormat=qd;a.RGBAFormat=kc;a.LuminanceFormat=ne;a.LuminanceAlphaFormat=Rg;a.RGBEFormat=ng;a.DepthFormat=rd;a.DepthStencilFormat=Ab;a.RGB_S3TC_DXT1_Format=Ma;a.RGBA_S3TC_DXT1_Format=mb;a.RGBA_S3TC_DXT3_Format=Wg;a.RGBA_S3TC_DXT5_Format=ve;a.RGB_PVRTC_4BPPV1_Format=m;a.RGB_PVRTC_2BPPV1_Format=ja;a.RGBA_PVRTC_4BPPV1_Format=p;a.RGBA_PVRTC_2BPPV1_Format=h;a.RGB_ETC1_Format=w;a.RGBA_ASTC_4x4_Format=Va;a.RGBA_ASTC_5x4_Format=Rb;a.RGBA_ASTC_5x5_Format=jf;a.RGBA_ASTC_6x5_Format=
Ih;a.RGBA_ASTC_6x6_Format=Jh;a.RGBA_ASTC_8x5_Format=Kh;a.RGBA_ASTC_8x6_Format=Lh;a.RGBA_ASTC_8x8_Format=Mh;a.RGBA_ASTC_10x5_Format=Nh;a.RGBA_ASTC_10x6_Format=Oh;a.RGBA_ASTC_10x8_Format=Ph;a.RGBA_ASTC_10x10_Format=Qh;a.RGBA_ASTC_12x10_Format=Rh;a.RGBA_ASTC_12x12_Format=Sh;a.LoopOnce=2200;a.LoopRepeat=Th;a.LoopPingPong=2202;a.InterpolateDiscrete=2300;a.InterpolateLinear=2301;a.InterpolateSmooth=2302;a.ZeroCurvatureEnding=lf;a.ZeroSlopeEnding=2401;a.WrapAroundEnding=2402;a.TrianglesDrawMode=vh;a.TriangleStripDrawMode=
Uh;a.TriangleFanDrawMode=Vh;a.LinearEncoding=vg;a.sRGBEncoding=Wh;a.GammaEncoding=xh;a.RGBEEncoding=Xh;a.LogLuvEncoding=3003;a.RGBM7Encoding=Yh;a.RGBM16Encoding=ji;a.RGBDEncoding=ki;a.BasicDepthPacking=fi;a.RGBADepthPacking=gi;a.CubeGeometry=ca;a.Face4=function(a,b,c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Cb(a,b,c,e,f,g)};a.LineStrip=0;a.LinePieces=1;a.MeshFaceMaterial=function(a){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");
return a};a.MultiMaterial=function(a){void 0===a&&(a=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");a.isMultiMaterial=!0;a.materials=a;a.clone=function(){return a.slice()};return a};a.PointCloud=function(a,b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new xd(a,b)};a.Particle=function(a){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new Be(a)};a.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");
return new xd(a,b)};a.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new oc(a)};a.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new oc(a)};a.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new oc(a)};a.Vertex=function(a,b,c){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");
return new e(a,b,c)};a.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new ra(a,b)).setDynamic(!0)};a.Int8Attribute=function(a,b){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new Kb(a,b)};a.Uint8Attribute=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new Gb(a,
b)};a.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new jb(a,b)};a.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");return new dc(a,b)};a.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new ab(a,b)};a.Int32Attribute=
function(a,b){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new La(a,b)};a.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new Aa(a,b)};a.Float32Attribute=function(a,b){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new da(a,b)};a.Float64Attribute=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");
return new ob(a,b)};a.ClosedSplineCurve3=Ug;a.SplineCurve3=ef;a.Spline=Da;a.AxisHelper=function(a){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new df(a)};a.BoundingBoxHelper=function(a,b){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");return new te(a,b)};a.EdgesHelper=function(a,b){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new Ra(new Bd(a.geometry),new Ka({color:void 0!==
b?b:16777215}))};a.WireframeHelper=function(a,b){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new Ra(new wd(a.geometry),new Ka({color:void 0!==b?b:16777215}))};a.XHRLoader=function(a){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Ib(a)};a.BinaryTextureLoader=function(a){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new $f(a)};a.GeometryUtils={merge:function(a,b,
c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b.isMesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};a.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
var e=new Le;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a},loadTextureCube:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var e=new Ke;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};
a.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};a.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");
this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};a.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};
a.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/LensFlare.js")};Object.defineProperty(a,"__esModule",{value:!0})});var SEA3D={VERSION:18110,getVersion:function(){var a=SEA3D.VERSION.toString(),b=a.length;return a.substring(0,b-4)+"."+a.substring(b-4,b-3)+"."+a.substring(b-3,b-2)+"."+parseFloat(a.substring(b-2,b)).toString()}};console.log("SEA3D "+SEA3D.getVersion());SEA3D.Stream=function(a){this.position=0;this.buffer=a||new ArrayBuffer};SEA3D.Stream.NONE=0;SEA3D.Stream.BOOLEAN=1;SEA3D.Stream.BYTE=2;SEA3D.Stream.UBYTE=3;SEA3D.Stream.SHORT=4;SEA3D.Stream.USHORT=5;SEA3D.Stream.INT24=6;SEA3D.Stream.UINT24=7;
SEA3D.Stream.INT=8;SEA3D.Stream.UINT=9;SEA3D.Stream.FLOAT=10;SEA3D.Stream.DOUBLE=11;SEA3D.Stream.DECIMAL=12;SEA3D.Stream.VECTOR3D=74;SEA3D.Stream.VECTOR4D=106;SEA3D.Stream.STRING_TINY=128;SEA3D.Stream.STRING_SHORT=129;SEA3D.Stream.STRING_LONG=130;SEA3D.Stream.ASSET=200;SEA3D.Stream.GROUP=255;SEA3D.Stream.BLEND_MODE="normal add subtract multiply dividing mix alpha screen darken overlay colorburn linearburn lighten colordodge lineardodge softlight hardlight pinlight spotlight spotlightblend hardmix average difference exclusion hue saturation color value linearlight grainextract reflect glow darkercolor lightercolor phoenix negation".split(" ");
SEA3D.Stream.INTERPOLATION_TABLE="normal linear sine.in sine.out sine.inout cubic.in cubic.out cubic.inout quint.in quint.out quint.inout circ.in circ.out circ.inout back.in back.out back.inout quad.in quad.out quad.inout quart.in quart.out quart.inout expo.in expo.out expo.inout elastic.in elastic.out elastic.inout bounce.in bounce.out bounce.inout".split(" ");SEA3D.Stream.sizeOf=function(a){return 0==a?0:1<=a&&31>=a?1:32<=a&&63>=a?2:64<=a&&95>=a?3:96<=a&&125>=a?4:-1};
SEA3D.Stream.prototype={constructor:SEA3D.Stream,set buffer(a){this.buf=a;this.data=new DataView(a)},get buffer(){return this.buf},get bytesAvailable(){return this.length-this.position},get length(){return this.buf.byteLength}};SEA3D.Stream.prototype.getByte=function(a){return this.data.getInt8(a)};SEA3D.Stream.prototype.readBytes=function(a){var b=this.buf.slice(this.position,this.position+a);this.position+=a;return b};SEA3D.Stream.prototype.readByte=function(){return this.data.getInt8(this.position++)};
SEA3D.Stream.prototype.readUByte=function(){return this.data.getUint8(this.position++)};SEA3D.Stream.prototype.readBool=function(){return 0!=this.data.getInt8(this.position++)};SEA3D.Stream.prototype.readShort=function(){var a=this.data.getInt16(this.position,!0);this.position+=2;return a};SEA3D.Stream.prototype.readUShort=function(){var a=this.data.getUint16(this.position,!0);this.position+=2;return a};
SEA3D.Stream.prototype.readUInt24=function(){var a=this.data.getUint32(this.position,!0)&16777215;this.position+=3;return a};SEA3D.Stream.prototype.readUInt24F=function(){return this.readUShort()|this.readUByte()<<16};SEA3D.Stream.prototype.readInt=function(){var a=this.data.getInt32(this.position,!0);this.position+=4;return a};SEA3D.Stream.prototype.readUInt=function(){var a=this.data.getUint32(this.position,!0);this.position+=4;return a};
SEA3D.Stream.prototype.readFloat=function(){var a=this.data.getFloat32(this.position,!0);this.position+=4;return a};SEA3D.Stream.prototype.readUInteger=function(){var a=this.readUByte(),b=a&127;0!=(a&128)&&(a=this.readUByte(),b|=(a&127)<<7,0!=(a&128)&&(a=this.readUByte(),b|=(a&127)<<13));return b};SEA3D.Stream.prototype.readVector2=function(){return{x:this.readFloat(),y:this.readFloat()}};SEA3D.Stream.prototype.readVector3=function(){return{x:this.readFloat(),y:this.readFloat(),z:this.readFloat()}};
SEA3D.Stream.prototype.readVector4=function(){return{x:this.readFloat(),y:this.readFloat(),z:this.readFloat(),w:this.readFloat()}};
SEA3D.Stream.prototype.readMatrix=function(){var a=new Float32Array(16);a[0]=this.readFloat();a[1]=this.readFloat();a[2]=this.readFloat();a[3]=0;a[4]=this.readFloat();a[5]=this.readFloat();a[6]=this.readFloat();a[7]=0;a[8]=this.readFloat();a[9]=this.readFloat();a[10]=this.readFloat();a[11]=0;a[12]=this.readFloat();a[13]=this.readFloat();a[14]=this.readFloat();a[15]=1;return a};
SEA3D.decodeText=function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))};SEA3D.extractUrlBase=function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"};SEA3D.Stream.prototype.readUTF8=function(a){a=this.readBytes(a);return SEA3D.decodeText(new Uint8Array(a))};SEA3D.Stream.prototype.readExt=function(){return this.readUTF8(4).replace(/\0/g,"")};
SEA3D.Stream.prototype.readUTF8Tiny=function(){return this.readUTF8(this.readUByte())};SEA3D.Stream.prototype.readUTF8Short=function(){return this.readUTF8(this.readUShort())};SEA3D.Stream.prototype.readUTF8Long=function(){return this.readUTF8(this.readUInt())};SEA3D.Stream.prototype.readUByteArray=function(a){var b=new Uint8Array(a);SEA3D.Stream.memcpy(b.buffer,0,this.buffer,this.position,a);this.position+=a;return b};
SEA3D.Stream.prototype.readUShortArray=function(a){var b=new Uint16Array(a);a*=2;SEA3D.Stream.memcpy(b.buffer,0,this.buffer,this.position,a);this.position+=a;return b};SEA3D.Stream.prototype.readUInt24Array=function(a){for(var b=new Uint32Array(a),c=0;c<a;c++)b[c]=this.readUInt24();return b};SEA3D.Stream.prototype.readUIntArray=function(a){var b=new Uint32Array(a);a*=4;SEA3D.Stream.memcpy(b.buffer,0,this.buffer,this.position,a);this.position+=a;return b};
SEA3D.Stream.prototype.readFloatArray=function(a){var b=new Float32Array(a);a*=4;SEA3D.Stream.memcpy(b.buffer,0,this.buffer,this.position,a);this.position+=a;return b};SEA3D.Stream.prototype.readBlendMode=function(){return SEA3D.Stream.BLEND_MODE[this.readUByte()]};SEA3D.Stream.prototype.readInterpolation=function(){return SEA3D.Stream.INTERPOLATION_TABLE[this.readUByte()]};
SEA3D.Stream.prototype.readTags=function(a){for(var b=this.readUByte(),c=0;c<b;++c){var d=this.readUShort(),g=this.readUInt(),e=this.position;a(d,this,g);this.position=e+g}};SEA3D.Stream.prototype.readProperties=function(a){var b=this.readUByte(),c={},d={};c.__type=d;for(var g=0;g<b;g++){var e=this.readUTF8Tiny(),l=this.readUByte();d[e]=l;c[e]=l==SEA3D.Stream.GROUP?this.readProperties(a):this.readToken(l,a)}return c};
SEA3D.Stream.prototype.readAnimationList=function(a){for(var b=[],c=this.readUByte(),d=0;d<c;){var g=this.readUByte(),e={};e.relative=0!=(g&1);g&2&&(e.timeScale=this.readFloat());e.tag=a.getObject(this.readUInt());b[d++]=e}return b};
SEA3D.Stream.prototype.readScriptList=function(a){for(var b=[],c=this.readUByte(),d=0;d<c;){var g=this.readUByte(),e={};e.priority=g&1|g&2;if(g&4){var l=this.readUByte();e.params={};for(var n=0;n<l;n++){var B=this.readUTF8Tiny();e.params[B]=this.readObject(a)}}g&8&&(e.method=this.readUTF8Tiny());e.tag=a.getObject(this.readUInt());b[d++]=e}return b};SEA3D.Stream.prototype.readObject=function(a){return this.readToken(this.readUByte(),a)};
SEA3D.Stream.prototype.readToken=function(a,b){switch(a){case SEA3D.Stream.BOOLEAN:return this.readBool();case SEA3D.Stream.UBYTE:return this.readUByte();case SEA3D.Stream.USHORT:return this.readUShort();case SEA3D.Stream.UINT24:return this.readUInt24();case SEA3D.Stream.INT:return this.readInt();case SEA3D.Stream.UINT:return this.readUInt();case SEA3D.Stream.FLOAT:return this.readFloat();case SEA3D.Stream.VECTOR3D:return this.readVector3();case SEA3D.Stream.VECTOR4D:return this.readVector4();case SEA3D.Stream.STRING_TINY:return this.readUTF8Tiny();
case SEA3D.Stream.STRING_SHORT:return this.readUTF8Short();case SEA3D.Stream.STRING_LONG:return this.readUTF8Long();case SEA3D.Stream.ASSET:var c=this.readUInt();return 0<c?b.getObject(c-1):null;default:console.error("DataType not found!")}return null};
SEA3D.Stream.prototype.readVector=function(a,b,c){var d=SEA3D.Stream.sizeOf(a);b=c*d+b*d;switch(a){case SEA3D.Stream.BOOLEAN:return this.readUByteArray(b);case SEA3D.Stream.UBYTE:return this.readUByteArray(b);case SEA3D.Stream.USHORT:return this.readUShortArray(b);case SEA3D.Stream.UINT24:return this.readUInt24Array(b);case SEA3D.Stream.UINT:return this.readUIntArray(b);case SEA3D.Stream.FLOAT:return this.readFloatArray(b);case SEA3D.Stream.VECTOR3D:return this.readFloatArray(b);case SEA3D.Stream.VECTOR4D:return this.readFloatArray(b)}};
SEA3D.Stream.prototype.append=function(a){var b=new ArrayBuffer(this.data.byteLength+a.byteLength);SEA3D.Stream.memcpy(b,0,this.data.buffer,0,this.data.byteLength);SEA3D.Stream.memcpy(b,this.data.byteLength,a,0,a.byteLength);this.buffer=b};SEA3D.Stream.prototype.concat=function(a,b){return new SEA3D.Stream(this.buffer.slice(a,a+b))};SEA3D.Stream.memcpy=function(a,b,c,d,g){a=new Uint8Array(a,b,g);c=new Uint8Array(c,d,g);a.set(c)};SEA3D.UByteArray=function(){this.ubytes=[];this.length=0};
SEA3D.UByteArray.prototype={constructor:SEA3D.UByteArray,add:function(a){this.ubytes.push(a);this.length+=a.byteLength},toBuffer:function(){for(var a=new Uint8Array(this.length),b=0,c=0;b<this.ubytes.length;b++)a.set(this.ubytes[b],c),c+=this.ubytes[b].byteLength;return a.buffer}};SEA3D.Math={RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180};SEA3D.Math.angle=function(a){var b=0>a;a=(b?-a:a)%360;180<a&&(a=-180+(a-180));return b?-a:a};
SEA3D.Math.angleDiff=function(a,b){a*=this.DEG_TO_RAD;b*=this.DEG_TO_RAD;return Math.atan2(Math.sin(a-b),Math.cos(a-b))*this.RAD_TO_DEG};SEA3D.Math.angleArea=function(a,b,c){return Math.abs(this.angleDiff(a,b))<=c};SEA3D.Math.direction=function(a,b,c,d){return Math.atan2(d-b,c-a)};SEA3D.Math.physicalLerp=function(a,b,c,d){c/=d;1<c&&(c=1);return a+(b-a)*c};SEA3D.Math.physicalAngle=function(a,b,c,d){180<Math.abs(a-b)&&(b=a>b?b+360:b-360);c/=d;1<c&&(c=1);return this.angle(a+(b-a)*c)};
SEA3D.Math.zero=function(a,b){0>(0>a?-a:a)-(b||0.001)&&(a=0);return a};SEA3D.Math.round=function(a,b){b=Math.pow(10,b);return Math.round(a*b)/b};SEA3D.Math.lerpAngle=function(a,b,c){180<Math.abs(a-b)&&(b=a>b?b+360:b-360);return SEA3D.Math.angle(a+(b-a)*c)};SEA3D.Math.lerpColor=function(a,b,c){var d=a>>24&255,g=a>>16&255,e=a>>8&255;a&=255;g+=((b>>16&255)-g)*c;e+=((b>>8&255)-e)*c;a+=((b&255)-a)*c;return d+((b>>24&255)-d)*c<<24|g<<16|e<<8|a};SEA3D.Math.lerp=function(a,b,c){return a+(b-a)*c};
SEA3D.Timer=function(){this.time=this.start=Date.now()};SEA3D.Timer.prototype={constructor:SEA3D.Timer,get now(){return Date.now()},get deltaTime(){return Date.now()-this.time},get elapsedTime(){return Date.now()-this.start},update:function(){this.time=Date.now()}};SEA3D.Object=function(a,b,c,d){this.name=a;this.data=b;this.type=c;this.sea3d=d};
SEA3D.GeometryBase=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.attrib=b.readUShort();this.isBig=0!=(this.attrib&1);b.readVInt=this.isBig?b.readUInt:b.readUShort;this.numVertex=b.readVInt();this.length=3*this.numVertex};
SEA3D.Geometry=function(a,b,c){SEA3D.GeometryBase.call(this,a,b,c);var d;this.attrib&4&&(this.normal=b.readFloatArray(this.length));this.attrib&8&&(this.tangent=b.readFloatArray(this.length));if(this.attrib&32&&(d=b.readUByte()))for(this.uv=[],c=2*this.numVertex,a=0;a<d;)this.uv[a++]=b.readFloatArray(c);this.attrib&64&&(this.jointPerVertex=b.readUByte(),a=this.numVertex*this.jointPerVertex,this.joint=b.readUShortArray(a),this.weight=b.readFloatArray(a));if(this.attrib&128&&(a=b.readUByte(),c=b.readUByte()))for(this.numColor=
((a&64)>>6|(a&128)>>6)+1,this.color=[],a=0;a<c;a++)this.color.push(b.readFloatArray(this.numVertex*this.numColor));this.vertex=b.readFloatArray(this.length);var g=b.readUByte();this.groups=[];if(this.attrib&1024){for(c=a=0;a<g;a++)d=3*b.readVInt(),this.groups.push({start:c,count:d}),c+=d;this.attrib&2048||(this.indexes=this.isBig?b.readUIntArray(c):b.readUShortArray(c))}else{var e=this.isBig?4:2,l=new SEA3D.UByteArray;for(d=a=0;a<g;a++)c=3*b.readVInt(),this.groups.push({start:d,count:c}),d+=c,l.add(b.readUByteArray(c*
e));this.indexes=this.isBig?new Uint32Array(l.toBuffer()):new Uint16Array(l.toBuffer())}};SEA3D.Geometry.prototype=Object.create(SEA3D.GeometryBase.prototype);SEA3D.Geometry.prototype.constructor=SEA3D.Geometry;SEA3D.Geometry.prototype.type="geo";
SEA3D.Object3D=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.isStatic=!1;this.visible=!0;this.attrib=b.readUShort();this.attrib&1&&(this.parent=c.getObject(b.readUInt()));this.attrib&2&&(this.animations=b.readAnimationList(c));this.attrib&4&&(this.scripts=b.readScriptList(c));this.attrib&16&&(this.attributes=c.getObject(b.readUInt()));this.attrib&32&&(a=b.readUByte(),this.isStatic=0!=(a&1),this.visible=0==(a&2))};SEA3D.Object3D.prototype.readTag=function(a,b,c){};
SEA3D.Entity3D=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.castShadows=!0;this.attrib&64&&(this.castShadows=0==(b.readUByte()&1))};SEA3D.Entity3D.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Entity3D.prototype.constructor=SEA3D.Entity3D;SEA3D.Sound3D=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.autoPlay=0!=(this.attrib&64);this.attrib&128&&(this.mixer=c.getObject(b.readUInt()));this.sound=c.getObject(b.readUInt());this.volume=b.readFloat()};SEA3D.Sound3D.prototype=Object.create(SEA3D.Object3D.prototype);
SEA3D.Sound3D.prototype.constructor=SEA3D.Sound3D;SEA3D.SoundPoint=function(a,b,c){SEA3D.Sound3D.call(this,a,b,c);this.position=b.readVector3();this.distance=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.SoundPoint.prototype=Object.create(SEA3D.Sound3D.prototype);SEA3D.SoundPoint.prototype.constructor=SEA3D.SoundPoint;SEA3D.SoundPoint.prototype.type="sp";SEA3D.Container3D=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.transform=b.readMatrix();b.readTags(this.readTag.bind(this))};
SEA3D.Container3D.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Container3D.prototype.constructor=SEA3D.Container3D;SEA3D.Container3D.prototype.type="c3d";SEA3D.ScriptURL=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.url=b.readUTF8(b.length)};SEA3D.ScriptURL.prototype.type="src";SEA3D.TextureURL=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.url=c.config.path+b.readUTF8(b.length)};SEA3D.TextureURL.prototype.type="urlT";
SEA3D.CubeMapURL=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.faces=[];for(a=0;6>a;a++)this.faces[a]=b.readUTF8Tiny()};SEA3D.CubeMapURL.prototype.type="cURL";
SEA3D.Actions=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.count=b.readUInt();this.actions=[];for(a=0;a<this.count;a++){var d=b.readUByte(),g=b.readUShort(),e=b.readUShort(),l=b.position,n=this.actions[a]={kind:g};d&1&&(n.range=[b.readUInt(),b.readUInt()]);d&2&&(n.time=b.readUInt());d&4&&(n.intrpl=b.readInterpolation(),0==n.intrpl.indexOf("back.")?n.intrplParam0=b.readFloat():0==n.intrpl.indexOf("elastic.")&&(n.intrplParam0=b.readFloat(),n.intrplParam1=b.readFloat()));switch(g){case SEA3D.Actions.RTT_TARGET:n.source=
c.getObject(b.readUInt());n.target=c.getObject(b.readUInt());break;case SEA3D.Actions.LOOK_AT:n.source=c.getObject(b.readUInt());n.target=c.getObject(b.readUInt());break;case SEA3D.Actions.PLAY_SOUND:n.sound=c.getObject(b.readUInt());n.offset=b.readUInt();break;case SEA3D.Actions.PLAY_ANIMATION:n.object=c.getObject(b.readUInt());n.name=b.readUTF8Tiny();break;case SEA3D.Actions.FOG:n.color=b.readUInt24();n.min=b.readFloat();n.max=b.readFloat();break;case SEA3D.Actions.ENVIRONMENT:n.texture=c.getObject(b.readUInt());
break;case SEA3D.Actions.ENVIRONMENT_COLOR:n.color=b.readUInt24F();break;case SEA3D.Actions.CAMERA:n.camera=c.getObject(b.readUInt());break;case SEA3D.Actions.SCRIPTS:n.scripts=b.readScriptList(c);break;case SEA3D.Actions.CLASS_OF:n.classof=c.getObject(b.readUInt());break;case SEA3D.Actions.ATTRIBUTES:n.attributes=c.getObject(b.readUInt());break;default:console.log('Action "'+g+'" not found.')}b.position=l+e}};SEA3D.Actions.SCENE=0;SEA3D.Actions.ENVIRONMENT_COLOR=1;SEA3D.Actions.ENVIRONMENT=2;
SEA3D.Actions.FOG=3;SEA3D.Actions.PLAY_ANIMATION=4;SEA3D.Actions.PLAY_SOUND=5;SEA3D.Actions.ANIMATION_AUDIO_SYNC=6;SEA3D.Actions.LOOK_AT=7;SEA3D.Actions.RTT_TARGET=8;SEA3D.Actions.CAMERA=9;SEA3D.Actions.SCRIPTS=10;SEA3D.Actions.CLASS_OF=11;SEA3D.Actions.ATTRIBUTES=12;SEA3D.Actions.prototype.type="act";SEA3D.Properties=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.props=b.readProperties(c);this.props.__name=a};SEA3D.Properties.prototype.type="prop";
SEA3D.FileInfo=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.info=b.readProperties(c);this.info.__name=a;c.info=this.info};SEA3D.FileInfo.prototype.type="info";SEA3D.JavaScript=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.src=b.readUTF8(b.length)};SEA3D.JavaScript.prototype.type="js";SEA3D.JavaScriptMethod=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;a=b.readUShort();this.methods={};for(c=0;c<a;c++){b.readUByte();var d=b.readUTF8Tiny();this.methods[d]={src:b.readUTF8Long()}}};
SEA3D.JavaScriptMethod.prototype.type="jsm";SEA3D.GLSL=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.src=b.readUTF8(b.length)};SEA3D.GLSL.prototype.type="glsl";SEA3D.Dummy=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.transform=b.readMatrix();this.width=b.readFloat();this.height=b.readFloat();this.depth=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.Dummy.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Dummy.prototype.constructor=SEA3D.Dummy;
SEA3D.Dummy.prototype.type="dmy";SEA3D.Line=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.count=3*(this.attrib&64?b.readUInt():b.readUShort());this.closed=0!=(this.attrib&128);this.transform=b.readMatrix();this.vertex=[];for(a=0;a<this.count;)this.vertex[a++]=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.Line.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Line.prototype.constructor=SEA3D.Line;SEA3D.Line.prototype.type="line";
SEA3D.Sprite=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.attrib&256&&(this.material=c.getObject(b.readUInt()));this.position=b.readVector3();this.width=b.readFloat();this.height=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.Sprite.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Sprite.prototype.constructor=SEA3D.Sprite;SEA3D.Sprite.prototype.type="m2d";
SEA3D.Mesh=function(a,b,c){SEA3D.Entity3D.call(this,a,b,c);if(this.attrib&256)if(this.material=[],a=b.readUByte(),1==a)this.material[0]=c.getObject(b.readUInt());else for(var d=0;d<a;){var g=b.readUInt();0<g?this.material[d++]=c.getObject(g-1):this.material[d++]=void 0}if(this.attrib&512)for(this.modifiers=[],a=b.readUByte(),d=0;d<a;d++)this.modifiers[d]=c.getObject(b.readUInt());this.attrib&1024&&(this.reference={type:b.readUByte(),ref:c.getObject(b.readUInt())});this.transform=b.readMatrix();this.geometry=
c.getObject(b.readUInt());b.readTags(this.readTag.bind(this))};SEA3D.Mesh.prototype=Object.create(SEA3D.Entity3D.prototype);SEA3D.Mesh.prototype.constructor=SEA3D.Mesh;SEA3D.Mesh.prototype.type="m3d";SEA3D.Skeleton=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;a=b.readUShort();this.joint=[];for(c=0;c<a;c++)this.joint[c]={name:b.readUTF8Tiny(),parentIndex:b.readUShort()-1,inverseBindMatrix:b.readMatrix()}};SEA3D.Skeleton.prototype.type="skl";
SEA3D.SkeletonLocal=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;a=b.readUShort();this.joint=[];for(c=0;c<a;c++)this.joint[c]={name:b.readUTF8Tiny(),parentIndex:b.readUShort()-1,x:b.readFloat(),y:b.readFloat(),z:b.readFloat(),qx:b.readFloat(),qy:b.readFloat(),qz:b.readFloat(),qw:b.readFloat()}};SEA3D.SkeletonLocal.prototype.type="sklq";
SEA3D.AnimationBase=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;a=b.readUByte();this.sequence=[];if(a&1)for(a=b.readUShort(),c=0;c<a;c++){var d=b.readUByte();this.sequence[c]={name:b.readUTF8Tiny(),start:b.readUInt(),count:b.readUInt(),repeat:0!=(d&1),intrpl:0==(d&2)}}this.frameRate=b.readUByte();this.numFrames=b.readUInt();0==this.sequence.length&&(this.sequence[0]={name:"root",start:0,count:this.numFrames,repeat:!0,intrpl:!0})};
SEA3D.Animation=function(a,b,c){SEA3D.AnimationBase.call(this,a,b,c);this.dataList=[];a=0;for(c=b.readUByte();a<c;a++){var d=b.readUShort(),g=b.readUByte(),e=b.readVector(g,this.numFrames,0);this.dataList.push({kind:d,type:g,blockSize:SEA3D.Stream.sizeOf(g),data:e})}};SEA3D.Animation.POSITION=0;SEA3D.Animation.ROTATION=1;SEA3D.Animation.SCALE=2;SEA3D.Animation.COLOR=3;SEA3D.Animation.MULTIPLIER=4;SEA3D.Animation.ATTENUATION_START=5;SEA3D.Animation.ATTENUATION_END=6;SEA3D.Animation.FOV=7;
SEA3D.Animation.OFFSET_U=8;SEA3D.Animation.OFFSET_V=9;SEA3D.Animation.SCALE_U=10;SEA3D.Animation.SCALE_V=11;SEA3D.Animation.ANGLE=12;SEA3D.Animation.ALPHA=13;SEA3D.Animation.VOLUME=14;SEA3D.Animation.MORPH=250;SEA3D.Animation.prototype=Object.create(SEA3D.AnimationBase.prototype);SEA3D.Animation.prototype.constructor=SEA3D.Animation;SEA3D.Animation.prototype.type="anm";
SEA3D.SkeletonAnimation=function(a,b,c){SEA3D.AnimationBase.call(this,a,b,c);this.name=a;this.data=b;this.sea3d=c;this.numJoints=b.readUShort();this.raw=b.readFloatArray(this.numFrames*this.numJoints*7)};SEA3D.SkeletonAnimation.prototype.type="skla";SEA3D.UVWAnimation=function(a,b,c){SEA3D.Animation.call(this,a,b,c)};SEA3D.UVWAnimation.prototype.type="auvw";
SEA3D.Morph=function(a,b,c){SEA3D.GeometryBase.call(this,a,b,c);a=0!=(this.attrib&2);c=0!=(this.attrib&4);var d=b.readUShort();this.node=[];for(var g=0;g<d;g++){var e=b.readUTF8Tiny(),l,n;a&&(l=b.readFloatArray(this.length));c&&(n=b.readFloatArray(this.length));this.node[g]={vertex:l,normal:n,name:e}}};SEA3D.Morph.prototype=Object.create(SEA3D.GeometryBase.prototype);SEA3D.Morph.prototype.constructor=SEA3D.Morph;SEA3D.Morph.prototype.type="mph";
SEA3D.MorphAnimation=function(a,b,c){SEA3D.AnimationBase.call(this,a,b,c);this.dataList=[];a=0;for(c=b.readUByte();a<c;a++)this.dataList.push({kind:SEA3D.Animation.MORPH,type:SEA3D.Stream.FLOAT,name:b.readUTF8Tiny(),blockSize:1,data:b.readVector(SEA3D.Stream.FLOAT,this.numFrames,0)})};SEA3D.MorphAnimation.prototype.type="mpha";
SEA3D.VertexAnimation=function(a,b,c){SEA3D.AnimationBase.call(this,a,b,c);c=b.readUByte();this.isBig=0!=(c&1);b.readVInt=this.isBig?b.readUInt:b.readUShort;this.numVertex=b.readVInt();this.length=3*this.numVertex;a=0!=(c&2);c=0!=(c&4);this.frame=[];var d,g,e;for(d=0;d<this.numFrames;d++)a&&(g=b.readFloatArray(this.length)),c&&(e=b.readFloatArray(this.length)),this.frame[d]={vertex:g,normal:e}};SEA3D.VertexAnimation.prototype=Object.create(SEA3D.AnimationBase.prototype);
SEA3D.VertexAnimation.prototype.constructor=SEA3D.VertexAnimation;SEA3D.VertexAnimation.prototype.type="vtxa";SEA3D.Camera=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.attrib&64&&(this.dof={distance:b.readFloat(),range:b.readFloat()});this.transform=b.readMatrix();this.fov=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.Camera.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Camera.prototype.constructor=SEA3D.Camera;SEA3D.Camera.prototype.type="cam";
SEA3D.OrthographicCamera=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.transform=b.readMatrix();this.height=b.readFloat();b.readTags(this.readTag.bind(this))};SEA3D.OrthographicCamera.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.OrthographicCamera.prototype.constructor=SEA3D.OrthographicCamera;SEA3D.OrthographicCamera.prototype.type="camo";SEA3D.JointObject=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.target=c.getObject(b.readUInt());this.joint=b.readUShort();b.readTags(this.readTag.bind(this))};
SEA3D.JointObject.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.JointObject.prototype.constructor=SEA3D.JointObject;SEA3D.JointObject.prototype.type="jnt";
SEA3D.Light=function(a,b,c){SEA3D.Object3D.call(this,a,b,c);this.attenEnd=this.attenStart=Number.MAX_VALUE;this.attrib&64&&(a=b.readUByte(),this.shadow={},this.shadow.opacity=a&1?b.readFloat():1,this.shadow.color=a&2?b.readUInt24():0);this.attrib&512&&(this.attenStart=b.readFloat(),this.attenEnd=b.readFloat());this.color=b.readUInt24();this.multiplier=b.readFloat()};SEA3D.Light.prototype=Object.create(SEA3D.Object3D.prototype);SEA3D.Light.prototype.constructor=SEA3D.Light;
SEA3D.PointLight=function(a,b,c){SEA3D.Light.call(this,a,b,c);this.attrib&128&&(this.attenuation={start:b.readFloat(),end:b.readFloat()});this.position=b.readVector3();b.readTags(this.readTag.bind(this))};SEA3D.PointLight.prototype=Object.create(SEA3D.Light.prototype);SEA3D.PointLight.prototype.constructor=SEA3D.PointLight;SEA3D.PointLight.prototype.type="plht";
SEA3D.HemisphereLight=function(a,b,c){SEA3D.Light.call(this,a,b,c);this.attrib&128&&(this.attenuation={start:b.readFloat(),end:b.readFloat()});this.secondColor=b.readUInt24();b.readTags(this.readTag.bind(this))};SEA3D.HemisphereLight.prototype=Object.create(SEA3D.Light.prototype);SEA3D.HemisphereLight.prototype.constructor=SEA3D.HemisphereLight;SEA3D.HemisphereLight.prototype.type="hlht";SEA3D.AmbientLight=function(a,b,c){SEA3D.Light.call(this,a,b,c);b.readTags(this.readTag.bind(this))};
SEA3D.AmbientLight.prototype=Object.create(SEA3D.Light.prototype);SEA3D.AmbientLight.prototype.constructor=SEA3D.AmbientLight;SEA3D.AmbientLight.prototype.type="alht";SEA3D.DirectionalLight=function(a,b,c){SEA3D.Light.call(this,a,b,c);this.transform=b.readMatrix();b.readTags(this.readTag.bind(this))};SEA3D.DirectionalLight.prototype=Object.create(SEA3D.Light.prototype);SEA3D.DirectionalLight.prototype.constructor=SEA3D.DirectionalLight;SEA3D.DirectionalLight.prototype.type="dlht";
SEA3D.Material=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.technique=[];this.tecniquesDict={};this.attrib=b.readUShort();this.alpha=1;this.blendMode="normal";this.doubleSided=0!=(this.attrib&1);this.receiveLights=0==(this.attrib&2);this.receiveShadows=0==(this.attrib&4);this.receiveFog=0==(this.attrib&8);this.repeat=0==(this.attrib&16);this.attrib&32&&(this.alpha=b.readFloat());this.attrib&64&&(this.blendMode=b.readBlendMode());this.attrib&128&&(this.animations=b.readAnimationList(c));
this.depthWrite=0==(this.attrib&256);this.depthTest=0==(this.attrib&512);this.premultipliedAlpha=0!=(this.attrib&1024);a=b.readUByte();for(var d=0;d<a;++d){var g=b.readUShort(),e=b.readUShort(),l=b.position,n,B;switch(g){case SEA3D.Material.PHONG:n={ambientColor:b.readUInt24(),diffuseColor:b.readUInt24(),specularColor:b.readUInt24(),specular:b.readFloat(),gloss:b.readFloat()};break;case SEA3D.Material.PHYSICAL:n={color:b.readUInt24(),roughness:b.readFloat(),metalness:b.readFloat()};break;case SEA3D.Material.ANISOTROPIC:break;
case SEA3D.Material.COMPOSITE_TEXTURE:n={composite:c.getObject(b.readUInt())};break;case SEA3D.Material.DIFFUSE_MAP:case SEA3D.Material.SPECULAR_MAP:case SEA3D.Material.NORMAL_MAP:case SEA3D.Material.AMBIENT_MAP:case SEA3D.Material.ALPHA_MAP:case SEA3D.Material.EMISSIVE_MAP:case SEA3D.Material.ROUGHNESS_MAP:case SEA3D.Material.METALNESS_MAP:n={texture:c.getObject(b.readUInt())};break;case SEA3D.Material.REFLECTION:case SEA3D.Material.FRESNEL_REFLECTION:n={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};
g==SEA3D.Material.FRESNEL_REFLECTION&&(n.power=b.readFloat(),n.normal=b.readFloat());break;case SEA3D.Material.REFRACTION:n={texture:c.getObject(b.readUInt()),alpha:b.readFloat(),ior:b.readFloat()};break;case SEA3D.Material.RIM:n={color:b.readUInt24(),strength:b.readFloat(),power:b.readFloat(),blendMode:b.readBlendMode()};break;case SEA3D.Material.LIGHT_MAP:n={texture:c.getObject(b.readUInt()),channel:b.readUByte(),blendMode:b.readBlendMode()};break;case SEA3D.Material.DETAIL_MAP:n={texture:c.getObject(b.readUInt()),
scale:b.readFloat(),blendMode:b.readBlendMode()};break;case SEA3D.Material.CEL:n={color:b.readUInt24(),levels:b.readUByte(),size:b.readFloat(),specularCutOff:b.readFloat(),smoothness:b.readFloat()};break;case SEA3D.Material.TRANSLUCENT:n={translucency:b.readFloat(),scattering:b.readFloat()};break;case SEA3D.Material.BLEND_NORMAL_MAP:B=b.readUByte();n={texture:c.getObject(b.readUInt()),secondaryTexture:c.getObject(b.readUInt())};B&1?(n.offsetX0=b.readFloat(),n.offsetY0=b.readFloat(),n.offsetX1=b.readFloat(),
n.offsetY1=b.readFloat()):n.offsetX0=n.offsetY0=n.offsetX1=n.offsetY1=0;n.animate=B&2;break;case SEA3D.Material.MIRROR_REFLECTION:n={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};break;case SEA3D.Material.EMISSIVE:n={color:b.readUInt24F()};break;case SEA3D.Material.VERTEX_COLOR:n={blendMode:b.readBlendMode()};break;case SEA3D.Material.WRAP_LIGHTING:n={color:b.readUInt24(),strength:b.readFloat()};break;case SEA3D.Material.COLOR_REPLACE:B=b.readUByte();n={red:b.readUInt24(),green:b.readUInt24(),
blue:b.readUInt24F()};B&1&&(n.mask=c.getObject(b.readUInt()));B&2&&(n.alpha=b.readFloat());break;case SEA3D.Material.REFLECTION_SPHERICAL:n={texture:c.getObject(b.readUInt()),alpha:b.readFloat()};break;case SEA3D.Material.REFLECTIVITY:B=b.readUByte();n={strength:b.readFloat()};B&1&&(n.mask=c.getObject(b.readUInt()));break;case SEA3D.Material.CLEAR_COAT:n={strength:b.readFloat(),roughness:b.readFloat()};break;case SEA3D.Material.FLACCIDITY:B=b.readUByte();n={target:c.getObject(b.readUInt()),scale:b.readFloat(),
spring:b.readFloat(),damping:b.readFloat()};B&1&&(n.mask=c.getObject(b.readUInt()));break;default:console.warn("SEA3D: MaterialTechnique not found:",g.toString(16));b.position=l+e;continue}n.kind=g;this.technique.push(n);this.tecniquesDict[g]=n;b.position=l+e}};SEA3D.Material.PHONG=0;SEA3D.Material.COMPOSITE_TEXTURE=1;SEA3D.Material.DIFFUSE_MAP=2;SEA3D.Material.SPECULAR_MAP=3;SEA3D.Material.REFLECTION=4;SEA3D.Material.REFRACTION=5;SEA3D.Material.NORMAL_MAP=6;SEA3D.Material.FRESNEL_REFLECTION=7;
SEA3D.Material.RIM=8;SEA3D.Material.LIGHT_MAP=9;SEA3D.Material.DETAIL_MAP=10;SEA3D.Material.CEL=11;SEA3D.Material.TRANSLUCENT=12;SEA3D.Material.BLEND_NORMAL_MAP=13;SEA3D.Material.MIRROR_REFLECTION=14;SEA3D.Material.AMBIENT_MAP=15;SEA3D.Material.ALPHA_MAP=16;SEA3D.Material.EMISSIVE_MAP=17;SEA3D.Material.VERTEX_COLOR=18;SEA3D.Material.WRAP_LIGHTING=19;SEA3D.Material.COLOR_REPLACE=20;SEA3D.Material.REFLECTION_SPHERICAL=21;SEA3D.Material.ANISOTROPIC=22;SEA3D.Material.EMISSIVE=23;
SEA3D.Material.PHYSICAL=24;SEA3D.Material.ROUGHNESS_MAP=25;SEA3D.Material.METALNESS_MAP=26;SEA3D.Material.REFLECTIVITY=27;SEA3D.Material.CLEAR_COAT=28;SEA3D.Material.FLACCIDITY=29;SEA3D.Material.prototype.type="mat";SEA3D.Composite=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;a=b.readUByte();this.layer=[];for(var d=0;d<a;d++)this.layer[d]=new SEA3D.Composite.prototype.Layer(b,c)};
SEA3D.Composite.prototype.getLayerByName=function(a){for(var b=0;b<this.layer.length;b++)if(this.layer[b].name==a)return this.layer[b]};SEA3D.Composite.prototype.Layer=function(a,b){var c=a.readUShort();c&1?this.texture=new SEA3D.Composite.LayerBitmap(a,b):this.color=a.readUInt24();c&2&&(this.mask=new SEA3D.Composite.LayerBitmap(a,b));c&4&&(this.name=a.readUTF8Tiny());this.blendMode=c&8?a.readBlendMode():"normal";this.opacity=c&16?a.readFloat():1};
SEA3D.Composite.LayerBitmap=function(a,b){this.map=b.getObject(a.readUInt());var c=a.readUShort();this.channel=c&1?a.readUByte():0;this.repeat=c&0;this.offsetU=c&4?a.readFloat():0;this.offsetV=c&8?a.readFloat():0;this.scaleU=c&16?a.readFloat():1;this.scaleV=c&32?a.readFloat():1;this.rotation=c&64?a.readFloat():0;c&128&&(this.animation=a.readAnimationList(b))};SEA3D.Composite.prototype.type="ctex";
SEA3D.PlanarRender=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.attrib=b.readUByte();this.quality=this.attrib&1|this.attrib&2;this.transform=b.readMatrix()};SEA3D.PlanarRender.prototype.type="rttp";SEA3D.CubeRender=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.attrib=b.readUByte();this.quality=this.attrib&1|this.attrib&2;this.position=b.readVector3()};SEA3D.CubeRender.prototype.type="rttc";
SEA3D.CubeMap=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.transparent=!1;this.extension=b.readExt();this.faces=[];for(a=0;6>a;a++)c=b.readUInt(),this.faces[a]=b.concat(b.position,c),b.position+=c};SEA3D.CubeMap.prototype.type="cmap";SEA3D.JPEG=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.transparent=!1};SEA3D.JPEG.prototype.type="jpg";SEA3D.JPEG_XR=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.transparent=!0};SEA3D.JPEG_XR.prototype.type="wdp";
SEA3D.PNG=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.transparent=6==b.getByte(25)};SEA3D.PNG.prototype.type="png";SEA3D.GIF=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.transparent=0<b.getByte(11)};SEA3D.GIF.prototype.type="gif";SEA3D.OGG=function(a,b,c){this.name=a;this.data=b;this.sea3d=c};SEA3D.OGG.prototype.type="ogg";SEA3D.MP3=function(a,b,c){this.name=a;this.data=b;this.sea3d=c};SEA3D.MP3.prototype.type="mp3";
SEA3D.TextureUpdate=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.index=b.readUInt();this.bytes=b.concat(b.position,b.length-b.position)};SEA3D.TextureUpdate.prototype.type="uTex";
SEA3D.File=function(a){this.config={streaming:!0,timeLimit:60,progressive:!1};a&&(void 0!==a.streaming&&(this.config.streaming=a.streaming),void 0!==a.timeLimit&&(this.config.timeLimit=a.timeLimit),void 0!==a.progressive&&(this.config.progressive=a.progressive),void 0!==a.path&&(this.config.path=a.path));this.version=SEA3D.VERSION;this.objects=[];this.typeClass={};this.typeRead={};this.typeUnique={};this.position=this.dataPosition=0;this.scope=this;this.addClass(SEA3D.FileInfo,!0);this.addClass(SEA3D.Geometry,
!0);this.addClass(SEA3D.Mesh);this.addClass(SEA3D.Sprite);this.addClass(SEA3D.Material);this.addClass(SEA3D.Composite);this.addClass(SEA3D.PointLight);this.addClass(SEA3D.DirectionalLight);this.addClass(SEA3D.HemisphereLight);this.addClass(SEA3D.AmbientLight);this.addClass(SEA3D.Animation,!0);this.addClass(SEA3D.Skeleton,!0);this.addClass(SEA3D.SkeletonLocal,!0);this.addClass(SEA3D.SkeletonAnimation,!0);this.addClass(SEA3D.UVWAnimation,!0);this.addClass(SEA3D.JointObject);this.addClass(SEA3D.Camera);
this.addClass(SEA3D.OrthographicCamera);this.addClass(SEA3D.Morph,!0);this.addClass(SEA3D.MorphAnimation,!0);this.addClass(SEA3D.VertexAnimation,!0);this.addClass(SEA3D.CubeMap,!0);this.addClass(SEA3D.Dummy);this.addClass(SEA3D.Line);this.addClass(SEA3D.SoundPoint);this.addClass(SEA3D.PlanarRender);this.addClass(SEA3D.CubeRender);this.addClass(SEA3D.Actions);this.addClass(SEA3D.Container3D);this.addClass(SEA3D.Properties);this.addClass(SEA3D.ScriptURL,!0);this.addClass(SEA3D.TextureURL,!0);this.addClass(SEA3D.CubeMapURL,
!0);this.addClass(SEA3D.JPEG,!0);this.addClass(SEA3D.JPEG_XR,!0);this.addClass(SEA3D.PNG,!0);this.addClass(SEA3D.GIF,!0);this.addClass(SEA3D.OGG,!0);this.addClass(SEA3D.MP3,!0);this.addClass(SEA3D.JavaScript,!0);this.addClass(SEA3D.JavaScriptMethod,!0);this.addClass(SEA3D.GLSL,!0);this.addClass(SEA3D.TextureUpdate,!0);for(a=SEA3D.File.Extensions.length;a--;)SEA3D.File.Extensions[a].call(this)};SEA3D.File.Extensions=[];SEA3D.File.CompressionLibs={};SEA3D.File.DecompressionMethod={};
SEA3D.File.setExtension=function(a){SEA3D.File.Extensions.push(a)};SEA3D.File.setDecompressionEngine=function(a,b,c){SEA3D.File.CompressionLibs[a]=b;SEA3D.File.DecompressionMethod[a]=c};SEA3D.File.prototype.addClass=function(a,b){this.typeClass[a.prototype.type]=a;this.typeUnique[a.prototype.type]=!0===b};
SEA3D.File.prototype.readHead=function(){if(16>this.stream.bytesAvailable)return!1;if("SEA"!=this.stream.readUTF8(3))throw Error("Invalid SEA3D format.");this.sign=this.stream.readUTF8(3);this.version=this.stream.readUInt24();if(0!=this.stream.readUByte())throw Error("Protection algorithm not compatible.");this.compressionID=this.stream.readUByte();this.compressionAlgorithm=SEA3D.File.CompressionLibs[this.compressionID];this.decompressionMethod=SEA3D.File.DecompressionMethod[this.compressionID];if(0<
this.compressionID&&!this.decompressionMethod)throw Error("Compression algorithm not compatible.");this.length=this.stream.readUInt();this.dataPosition=this.stream.position;this.objects.length=0;this.state=this.readBody;if(this.onHead)this.onHead({file:this,sign:this.sign});return!0};SEA3D.File.prototype.getObject=function(a){return this.objects[a]};SEA3D.File.prototype.getObjectByName=function(a){return this.objects[a]};
SEA3D.File.prototype.readSEAObject=function(){if(4>this.stream.bytesAvailable)return null;var a=this.stream.readUInt(),b=this.stream.position;if(this.stream.bytesAvailable<a)return null;var c=this.stream.readUByte(),d=this.stream.readExt(),g=null,e=c&1?this.stream.readUTF8Tiny():"",l=0!=(c&2),n=0!=(c&4);c&8&&(g=this.stream.readUShort(),c=this.stream.concat(this.stream.position,g),this.stream.position+=g,l&&this.decompressionMethod&&(c.buffer=this.decompressionMethod(c.buffer)),g=c.readProperties(this));
a-=this.stream.position-b;b=this.stream.position;c=this.stream.concat(b,a);this.typeClass[d]?(l&&this.decompressionMethod&&(c.buffer=this.decompressionMethod(c.buffer)),l=new this.typeClass[d](e,c,this),(this.config.streaming&&n||this.config.forceStreaming)&&this.typeRead[d]&&this.typeRead[d].call(this.scope,l)):(l=new SEA3D.Object(e,c,d,this),console.warn('SEA3D: Unknown format "'+d+'" of file "'+e+'". Add a module referring for this format.'));l.streaming=n;l.metadata=g;this.objects.push(this.objects[l.name+
"."+l.type]=l);this.dataPosition=b+a;++this.position;return l};SEA3D.File.prototype.isDone=function(){return this.position==this.length};SEA3D.File.prototype.readBody=function(){this.timer.update();if(!this.resume)return!1;for(;this.position<this.length;)if(this.timer.deltaTime<this.config.timeLimit){this.stream.position=this.dataPosition;var a=this.readSEAObject();if(a)this.dispatchCompleteObject(a);else return!1}else return!1;this.state=this.readComplete;return!0};
SEA3D.File.prototype.initParse=function(){this.timer=new SEA3D.Timer;this.position=0;this.resume=!0};SEA3D.File.prototype.parse=function(){this.initParse();isFinite(this.config.timeLimit)?requestAnimationFrame(this.parseObject.bind(this)):this.parseObject()};
SEA3D.File.prototype.parseObject=function(){for(this.timer.update();this.position<this.length&&this.timer.deltaTime<this.config.timeLimit;){var a=this.objects[this.position++],b=a.type;this.typeUnique[b]||delete a.tag;(a.streaming||this.config.forceStreaming)&&this.typeRead[b]&&void 0==a.tag&&this.typeRead[b].call(this.scope,a)}if(this.position==this.length)if(a=this.timer.elapsedTime,b=a+"ms, "+this.objects.length+" objects",this.onParseComplete)this.onParseComplete({file:this,timeTotal:a,message:b});
else console.log("SEA3D Parse Complete:",b);else{if(this.onParseProgress)this.onParseProgress({file:this,loaded:this.position,total:this.length});setTimeout(this.parseObject.bind(this),10)}};SEA3D.File.prototype.readComplete=function(){this.stream.position=this.dataPosition;6202321!=this.stream.readUInt24F()&&console.warn("SEA3D file is corrupted.");delete this.state;return!1};
SEA3D.File.prototype.readState=function(){for(;this.state(););this.state?(requestAnimationFrame(this.readState.bind(this)),this.dispatchProgress()):this.dispatchComplete()};SEA3D.File.prototype.append=function(a){this.state?this.stream.append(a):this.read(a)};SEA3D.File.prototype.read=function(a){if(!a)throw Error("No data found.");this.initParse();this.stream=new SEA3D.Stream(a);this.state=this.readHead;this.readState()};
SEA3D.File.prototype.dispatchCompleteObject=function(a){if(this.onCompleteObject)this.onCompleteObject({file:this,object:a})};SEA3D.File.prototype.dispatchProgress=function(){if(this.onProgress)this.onProgress({file:this,loaded:this.position,total:this.length})};SEA3D.File.prototype.dispatchDownloadProgress=function(a,b){if(this.onDownloadProgress)this.onDownloadProgress({file:this,loaded:a,total:b})};
SEA3D.File.prototype.dispatchComplete=function(){var a=this.timer.elapsedTime,b=a+"ms, "+this.objects.length+" objects";if(this.onComplete)this.onComplete({file:this,timeTotal:a,message:b});else console.log("SEA3D:",b)};SEA3D.File.prototype.dispatchError=function(a,b){if(this.onError)this.onError({file:this,id:a,message:b});else console.error("SEA3D: #"+a,b)};
SEA3D.File.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);this.config.path||(this.config.path=SEA3D.extractUrlBase(a));if(b.config.progressive){var d=0;c.overrideMimeType("text/plain; charset=x-user-defined")}else c.responseType="arraybuffer";c.onprogress=function(a){if(b.config.progressive){for(var e=c.responseText.substring(d),l=new Uint8Array(e.length),n=0;n<e.length;n++)l[n]=e.charCodeAt(n)&255;d+=e.length;b.append(l.buffer)}b.dispatchDownloadProgress(a.loaded,a.total)};
b.config.progressive||(c.onreadystatechange=function(){4===c.readyState&&(200===c.status||0===c.status?b.read(this.response):this.dispatchError(1001,"Couldn't load ["+a+"] ["+c.status+"]"))});c.send()};
SEA3D.LZMA=function(){var a=a||{};a.OutWindow=function(){this._windowSize=0};a.OutWindow.prototype.create=function(a){this._buffer&&this._windowSize===a||(this._buffer=[]);this._windowSize=a;this._streamPos=this._pos=0};a.OutWindow.prototype.flush=function(){var a=this._pos-this._streamPos;if(0!==a){for(;a--;)this._stream.writeByte(this._buffer[this._streamPos++]);this._pos>=this._windowSize&&(this._pos=0);this._streamPos=this._pos}};a.OutWindow.prototype.releaseStream=function(){this.flush();this._stream=
null};a.OutWindow.prototype.setStream=function(a){this.releaseStream();this._stream=a};a.OutWindow.prototype.init=function(a){a||(this._pos=this._streamPos=0)};a.OutWindow.prototype.copyBlock=function(a,c){var d=this._pos-a-1;for(0>d&&(d+=this._windowSize);c--;)d>=this._windowSize&&(d=0),this._buffer[this._pos++]=this._buffer[d++],this._pos>=this._windowSize&&this.flush()};a.OutWindow.prototype.putByte=function(a){this._buffer[this._pos++]=a;this._pos>=this._windowSize&&this.flush()};a.OutWindow.prototype.getByte=
function(a){a=this._pos-a-1;0>a&&(a+=this._windowSize);return this._buffer[a]};a.RangeDecoder=function(){};a.RangeDecoder.prototype.setStream=function(a){this._stream=a};a.RangeDecoder.prototype.releaseStream=function(){this._stream=null};a.RangeDecoder.prototype.init=function(){var a=5;this._code=0;for(this._range=-1;a--;)this._code=this._code<<8|this._stream.readByte()};a.RangeDecoder.prototype.decodeDirectBits=function(a){for(var c=0,d;a--;)this._range>>>=1,d=this._code-this._range>>>31,this._code-=
this._range&d-1,c=c<<1|1-d,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return c};a.RangeDecoder.prototype.decodeBit=function(a,c){var d=a[c],g=(this._range>>>11)*d;if((this._code^2147483648)<(g^2147483648))return this._range=g,a[c]+=2048-d>>>5,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0;this._range-=g;this._code-=g;a[c]-=d>>>5;0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),
this._range<<=8);return 1};a.initBitModels=function(a,c){for(;c--;)a[c]=1024};a.BitTreeDecoder=function(a){this._models=[];this._numBitLevels=a};a.BitTreeDecoder.prototype.init=function(){a.initBitModels(this._models,1<<this._numBitLevels)};a.BitTreeDecoder.prototype.decode=function(a){for(var c=1,d=this._numBitLevels;d--;)c=c<<1|a.decodeBit(this._models,c);return c-(1<<this._numBitLevels)};a.BitTreeDecoder.prototype.reverseDecode=function(a){for(var c=1,d=0,g=0,e;g<this._numBitLevels;++g)e=a.decodeBit(this._models,
c),c=c<<1|e,d|=e<<g;return d};a.reverseDecode2=function(a,c,d,g){for(var e=1,l=0,n=0,B;n<g;++n)B=d.decodeBit(a,c+e),e=e<<1|B,l|=B<<n;return l};a.LenDecoder=function(){this._choice=[];this._lowCoder=[];this._midCoder=[];this._highCoder=new a.BitTreeDecoder(8);this._numPosStates=0};a.LenDecoder.prototype.create=function(b){for(;this._numPosStates<b;++this._numPosStates)this._lowCoder[this._numPosStates]=new a.BitTreeDecoder(3),this._midCoder[this._numPosStates]=new a.BitTreeDecoder(3)};a.LenDecoder.prototype.init=
function(){var b=this._numPosStates;for(a.initBitModels(this._choice,2);b--;)this._lowCoder[b].init(),this._midCoder[b].init();this._highCoder.init()};a.LenDecoder.prototype.decode=function(a,c){return 0===a.decodeBit(this._choice,0)?this._lowCoder[c].decode(a):0===a.decodeBit(this._choice,1)?8+this._midCoder[c].decode(a):16+this._highCoder.decode(a)};a.Decoder2=function(){this._decoders=[]};a.Decoder2.prototype.init=function(){a.initBitModels(this._decoders,768)};a.Decoder2.prototype.decodeNormal=
function(a){var c=1;do c=c<<1|a.decodeBit(this._decoders,c);while(256>c);return c&255};a.Decoder2.prototype.decodeWithMatchByte=function(a,c){var d=1,g,e;do if(g=c>>7&1,c<<=1,e=a.decodeBit(this._decoders,(1+g<<8)+d),d=d<<1|e,g!==e){for(;256>d;)d=d<<1|a.decodeBit(this._decoders,d);break}while(256>d);return d&255};a.LiteralDecoder=function(){};a.LiteralDecoder.prototype.create=function(b,c){var d;if(!this._coders||this._numPrevBits!==c||this._numPosBits!==b)for(this._numPosBits=b,this._posMask=(1<<
b)-1,this._numPrevBits=c,this._coders=[],d=1<<this._numPrevBits+this._numPosBits;d--;)this._coders[d]=new a.Decoder2};a.LiteralDecoder.prototype.init=function(){for(var a=1<<this._numPrevBits+this._numPosBits;a--;)this._coders[a].init()};a.LiteralDecoder.prototype.getDecoder=function(a,c){return this._coders[((a&this._posMask)<<this._numPrevBits)+((c&255)>>>8-this._numPrevBits)]};a.Decoder=function(){this._outWindow=new a.OutWindow;this._rangeDecoder=new a.RangeDecoder;this._isMatchDecoders=[];this._isRepDecoders=
[];this._isRepG0Decoders=[];this._isRepG1Decoders=[];this._isRepG2Decoders=[];this._isRep0LongDecoders=[];this._posSlotDecoder=[];this._posDecoders=[];this._posAlignDecoder=new a.BitTreeDecoder(4);this._lenDecoder=new a.LenDecoder;this._repLenDecoder=new a.LenDecoder;this._literalDecoder=new a.LiteralDecoder;this._dictionarySizeCheck=this._dictionarySize=-1;this._posSlotDecoder[0]=new a.BitTreeDecoder(6);this._posSlotDecoder[1]=new a.BitTreeDecoder(6);this._posSlotDecoder[2]=new a.BitTreeDecoder(6);
this._posSlotDecoder[3]=new a.BitTreeDecoder(6)};a.Decoder.prototype.setDictionarySize=function(a){if(0>a)return!1;this._dictionarySize!==a&&(this._dictionarySize=a,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096)));return!0};a.Decoder.prototype.setLcLpPb=function(a,c,d){var g=1<<d;if(8<a||4<c||4<d)return!1;this._literalDecoder.create(c,a);this._lenDecoder.create(g);this._repLenDecoder.create(g);this._posStateMask=g-1;return!0};
a.Decoder.prototype.init=function(){var b=4;this._outWindow.init(!1);a.initBitModels(this._isMatchDecoders,192);a.initBitModels(this._isRep0LongDecoders,192);a.initBitModels(this._isRepDecoders,12);a.initBitModels(this._isRepG0Decoders,12);a.initBitModels(this._isRepG1Decoders,12);a.initBitModels(this._isRepG2Decoders,12);a.initBitModels(this._posDecoders,114);for(this._literalDecoder.init();b--;)this._posSlotDecoder[b].init();this._lenDecoder.init();this._repLenDecoder.init();this._posAlignDecoder.init();
this._rangeDecoder.init()};a.Decoder.prototype.decode=function(b,c,d){var g=0,e=0,l=0,n=0,B=0,E=0,s=0;this._rangeDecoder.setStream(b);this._outWindow.setStream(c);for(this.init();0>d||E<d;)if(b=E&this._posStateMask,0===this._rangeDecoder.decodeBit(this._isMatchDecoders,(g<<4)+b))s=this._literalDecoder.getDecoder(E++,s),s=7<=g?s.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(e)):s.decodeNormal(this._rangeDecoder),this._outWindow.putByte(s),g=4>g?0:g-(10>g?3:6);else{if(1===this._rangeDecoder.decodeBit(this._isRepDecoders,
g))s=0,0===this._rangeDecoder.decodeBit(this._isRepG0Decoders,g)?0===this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(g<<4)+b)&&(g=7>g?9:11,s=1):(0===this._rangeDecoder.decodeBit(this._isRepG1Decoders,g)?c=l:(0===this._rangeDecoder.decodeBit(this._isRepG2Decoders,g)?c=n:(c=B,B=n),n=l),l=e,e=c),0===s&&(s=2+this._repLenDecoder.decode(this._rangeDecoder,b),g=7>g?8:11);else if(B=n,n=l,l=e,s=2+this._lenDecoder.decode(this._rangeDecoder,b),g=7>g?7:10,b=this._posSlotDecoder[5>=s?s-2:3].decode(this._rangeDecoder),
4<=b)if(c=(b>>1)-1,e=(2|b&1)<<c,14>b)e+=a.reverseDecode2(this._posDecoders,e-b-1,this._rangeDecoder,c);else{if(e+=this._rangeDecoder.decodeDirectBits(c-4)<<4,e+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),0>e){if(-1===e)break;return!1}}else e=b;if(e>=E||e>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(e,s);E+=s;s=this._outWindow.getByte(0)}this._outWindow.flush();this._outWindow.releaseStream();this._rangeDecoder.releaseStream();return!0};a.Decoder.prototype.setDecoderProperties=
function(a){var c,d;if(5>a.size)return!1;c=a.readByte();d=c%9;c=~~(c/9);if(!this.setLcLpPb(d,c%5,~~(c/5)))return!1;c=a.readByte();c|=a.readByte()<<8;c|=a.readByte()<<16;c+=16777216*a.readByte();return this.setDictionarySize(c)};a.decompress=function(b,c,d,g){var e=new a.Decoder;if(!e.setDecoderProperties(b))throw"Incorrect stream properties";if(!e.decode(c,d,g))throw"Error in data stream";return!0};a.decompressFile=function(b,c){var d=new a.Decoder,g;if(!d.setDecoderProperties(b))throw"Incorrect stream properties";
g=b.readByte();g|=b.readByte()<<8;g|=b.readByte()<<16;g+=16777216*b.readByte();b.readByte();b.readByte();b.readByte();b.readByte();if(!d.decode(b,c,g))throw"Error in data stream";return!0};return a}();SEA3D.File.LZMAUncompress=function(a){a=new Uint8Array(a);var b={data:[],position:0,writeByte:function(a){this.data[this.position++]=a}};SEA3D.LZMA.decompressFile({data:a,position:0,readByte:function(){return this.data[this.position++]}},b);return(new Uint8Array(b.data)).buffer};
SEA3D.File.setDecompressionEngine(2,"lzma",SEA3D.File.LZMAUncompress);THREE.SEA3D=function(a){this.config={id:"",scripts:!0,runScripts:!0,autoPlay:!1,dummys:!0,multiplier:1,bounding:!0,audioRolloffFactor:10,lights:!0,useEnvironment:!0,useVertexTexture:!0,forceStatic:!1,streaming:!0,async:!0,paths:{},timeLimit:10};a&&this.loadConfig(a)};void 0===THREE.Float32BufferAttribute&&(THREE.Float32BufferAttribute=THREE.Float32Attribute);THREE.SEA3D.useMultiMaterial=THREE.MultiMaterial.prototype.isMultiMaterial;
THREE.SEA3D.MTXBUF=new THREE.Matrix4;THREE.SEA3D.VECBUF=new THREE.Vector3;THREE.SEA3D.QUABUF=new THREE.Quaternion;THREE.SEA3D.BACKGROUND_COLOR=3355443;THREE.SEA3D.HELPER_COLOR=10140133;THREE.SEA3D.RTT_SIZE=512;THREE.SEA3D.identityMatrixScale=function(){var a=new THREE.Vector3;return function(b){a.setFromMatrixScale(b);return b.scale(a.set(1/a.x,1/a.y,1/a.z))}}();
THREE.SEA3D.prototype=Object.assign(Object.create(THREE.EventDispatcher.prototype),{constructor:THREE.SEA3D,setShadowMap:function(a){a.shadow.mapSize.width=2048;a.shadow.mapSize.height=1024;a.castShadow=!0;a.shadow.camera.left=-200;a.shadow.camera.right=200;a.shadow.camera.top=200;a.shadow.camera.bottom=-200;a.shadow.camera.near=1;a.shadow.camera.far=3E3;a.shadow.camera.fov=45;a.shadow.bias=-0.001}});
Object.defineProperties(THREE.SEA3D.prototype,{container:{set:function(a){this.config.container=a},get:function(){return this.config.container}},elapsedTime:{get:function(){return this.file.timer.elapsedTime}}});THREE.SEA3D.Domain=function(a,b,c){this.id=a;this.objects=b;this.container=c;this.sources=[];this.local={};this.scriptTargets=[];this.events=new THREE.EventDispatcher};THREE.SEA3D.Domain.global={};
THREE.SEA3D.Domain.prototype=Object.assign(Object.create(THREE.EventDispatcher.prototype),{constructor:THREE.SEA3D.Domain,add:function(a){this.sources.push(a)},remove:function(a){this.sources.splice(this.sources.indexOf(a),1)},contains:function(a){return-1!=this.sources.indexOf(a)},addEventListener:function(a,b){this.events.addEventListener(a,b)},hasEventListener:function(a,b){return this.events.hasEventListener(a,b)},removeEventListener:function(a,b){this.events.removeEventListener(a,b)},print:function(){console.log.apply(console,
arguments)},watch:function(){console.log.apply(console,"watch:",arguments)},runScripts:function(){for(var a=0;a<this.scriptTargets.length;a++)this.runJSMList(this.scriptTargets[a])},runJSMList:function(a){for(var b=a.scripts,c=0;c<b.length;c++)this.runJSM(a,b[c]);return b},runJSM:function(a,b){var c={print:this.print,watch:this.watch,sea3d:this,scene:this.container,source:new THREE.SEA3D.ScriptDomain(this,a instanceof THREE.SEA3D.Domain)};Object.freeze(c.source);THREE.SEA3D.ScriptHandler.add(c.source);
try{this.methods[b.method](c,this.getReference,THREE.SEA3D.Domain.global,this.local,a,b.params)}catch(d){console.error('SEA3D JavaScript: Error running method "'+b.method+'".'),console.error(d)}},getReference:function(a){return eval(a)},disposeList:function(a){if(a&&a.length){a=a.concat();for(var b=a.length;b--;)a[b].dispose()}},dispatchEvent:function(a){a.domain=this;for(var b=this.sources.concat(),c=b.length;c--;)b[c].dispatchEvent(a);this.events.dispatchEvent(a)},dispose:function(){for(this.disposeList(this.sources);this.container.children.length;)this.container.remove(this.container.children[0]);
for(var a=THREE.SEA3D.EXTENSIONS_DOMAIN.length;a--;){var b=THREE.SEA3D.EXTENSIONS_DOMAIN[a];b.dispose&&b.dispose.call(this)}this.disposeList(this.materials);this.disposeList(this.dummys);this.dispatchEvent({type:"dispose"})}});THREE.SEA3D.DomainManager=function(a){this.domains=[];this.autoDisposeRootDomain=void 0!==a?a:!0};
Object.assign(THREE.SEA3D.DomainManager.prototype,{onDisposeDomain:function(a){this.remove(a.domain);this.autoDisposeRootDomain&&1==this.domains.length&&this.dispose()},add:function(a){this._onDisposeDomain=this._onDisposeDomain||this.onDisposeDomain.bind(this);a.on("dispose",this._onDisposeDomain);this.domains.push(a);this.textures=this.textures||a.textures;this.cubemaps=this.cubemaps||a.cubemaps;this.geometries=this.geometries||a.geometries},remove:function(a){a.removeEvent("dispose",this._onDisposeDomain);
this.domains.splice(this.domains.indexOf(a),1)},contains:function(a){return-1!=this.domains.indexOf(a)},disposeList:function(a){if(a&&a.length){a=a.concat();for(var b=a.length;b--;)a[b].dispose()}},dispose:function(){this.disposeList(this.domains);this.disposeList(this.textures);this.disposeList(this.cubemaps);this.disposeList(this.geometries)}});
THREE.SEA3D.ScriptDomain=function(a,b){a=a||new THREE.SEA3D.Domain;a.add(this);var c=new THREE.EventDispatcher;this.getId=function(){return a.id};this.isRoot=function(){return b};this.addEventListener=function(a,b){c.addEventListener(a,b)};this.hasEventListener=function(a,b){return c.hasEventListener(a,b)};this.removeEventListener=function(a,b){c.removeEventListener(a,b)};this.dispatchEvent=function(a){a.script=this;c.dispatchEvent(a)};this.dispose=function(){a.remove(this);b&&a.dispose();this.dispatchEvent({type:"dispose"})}};
THREE.SEA3D.ScriptManager=function(){this.scripts=[];var a=function(a){this.remove(a.script)}.bind(this);this.add=function(b){b.addEventListener("dispose",a);this.scripts.push(b)};this.remove=function(b){b.removeEventListener("dispose",a);this.scripts.splice(this.scripts.indexOf(b),1)};this.contains=function(a){return-1<this.scripts.indexOf(a)};this.dispatchEvent=function(a){for(var c=this.scripts.concat(),d=c.length;d--;)c[d].dispatchEvent(a)}};THREE.SEA3D.ScriptHandler=new THREE.SEA3D.ScriptManager;
THREE.SEA3D.ScriptHandler.dispatchUpdate=function(a){this.dispatchEvent({type:"update",delta:a})};THREE.SEA3D.AnimationClip=function(a,b,c,d){THREE.AnimationClip.call(this,a,b,c);this.repeat=void 0!==d?d:!0};THREE.SEA3D.AnimationClip.fromClip=function(a,b){return new THREE.SEA3D.AnimationClip(a.name,a.duration,a.tracks,b)};THREE.SEA3D.AnimationClip.prototype=Object.assign(Object.create(THREE.AnimationClip.prototype),{constructor:THREE.SEA3D.AnimationClip});
THREE.SEA3D.Animation=function(a,b){this.clip=a;this.timeScale=void 0!==b?b:1};THREE.SEA3D.Animation.COMPLETE="animationComplete";THREE.SEA3D.Animation.prototype=Object.assign(Object.create(THREE.EventDispatcher.prototype),{constructor:THREE.SEA3D.Animation,onComplete:function(a){this.dispatchEvent({type:THREE.SEA3D.Animation.COMPLETE,target:this})}});
Object.defineProperties(THREE.SEA3D.Animation.prototype,{name:{get:function(){return this.clip.name}},repeat:{get:function(){return this.clip.repeat}},duration:{get:function(){return this.clip.duration}},mixer:{set:function(a){this.mx&&(this.mx.uncacheClip(this.clip),delete this.mx);a&&(this.mx=a,this.mx.clipAction(this.clip))},get:function(){return this.mx}}});THREE.SEA3D.Animator=function(a,b){this.updateAnimations(a,b);this.clone=function(a){return(new this.constructor(this.clips,new THREE.AnimationMixer(a))).copyFrom(this)}.bind(this)};
Object.assign(THREE.SEA3D.Animator.prototype,{update:function(a){this.mixer.update(a||0);if(this.currentAnimationAction&&this.currentAnimationAction.paused&&(this.pause(),this.currentAnimation))this.currentAnimation.onComplete(this);return this},updateAnimations:function(a,b){this.playing&&this.stop();this.mixer&&THREE.SEA3D.AnimationHandler.remove(this);this.mixer=b;this.paused=this.playing=this.relative=!1;this.timeScale=1;this.animations=[];this.animation={};this.clips=[];if(a)for(var c=0;c<a.length;c++)this.addAnimation(a[c]);
return this},addAnimation:function(a){a instanceof THREE.AnimationClip&&(this.clips.push(a),a=new THREE.SEA3D.Animation(a));this.animations.push(a);this.animation[a.name]=a;a.mixer=this.mixer;return a},removeAnimation:function(a){a instanceof THREE.AnimationClip&&(a=this.getAnimationByClip(a));this.clips.splice(this.clips.indexOf(a.clip),1);delete this.animation[a.name];this.animations.splice(this.animations.indexOf(a),1);a.mixer=null;return a},getAnimationByClip:function(a){for(var b=0;b<this.animations.length;b++)if(this.animations[b].clip===
a)return a},getAnimationByName:function(a){return"number"===typeof a?this.animations[a]:this.animation[a]},setAnimationWeight:function(a,b){this.mixer.clipAction(this.getAnimationByName(a).clip).setEffectiveWeight(b)},getAnimationWeight:function(a){return this.mixer.clipAction(this.getAnimationByName(a).clip).getEffectiveWeight()},pause:function(){this.playing&&this.currentAnimation&&(THREE.SEA3D.AnimationHandler.remove(this),this.playing=!1);return this},resume:function(){!this.playing&&this.currentAnimation&&
(THREE.SEA3D.AnimationHandler.add(this),this.playing=!0);return this},setTimeScale:function(a){this.timeScale=a;this.currentAnimationAction&&this.updateTimeScale();return this},getTimeScale:function(){return this.timeScale},updateTimeScale:function(){this.currentAnimationAction.setEffectiveTimeScale(this.timeScale*(this.currentAnimation?this.currentAnimation.timeScale:1));return this},play:function(a,b,c,d){var g=this.getAnimationByName(a);if(!g)throw Error('Animation "'+a+'" not found.');if(g==this.currentAnimation)return void 0===
c&&g.repeat||(this.currentAnimationAction.time=void 0!==c?c:0<=this.currentAnimationAction.timeScale?0:this.currentAnimation.duration),this.currentAnimationAction.setEffectiveWeight(void 0!==d?d:1),this.currentAnimationAction.paused=!1,this.resume();this.previousAnimation=this.currentAnimation;this.currentAnimation=g;this.previousAnimationAction=this.currentAnimationAction;this.currentAnimationAction=this.mixer.clipAction(g.clip).setLoop(g.repeat?THREE.LoopRepeat:THREE.LoopOnce,Infinity).reset();
this.currentAnimationAction.clampWhenFinished=!g.repeat;this.currentAnimationAction.paused=!1;this.updateTimeScale();void 0===c&&g.repeat||(this.currentAnimationAction.time=void 0!==c?c:0<=this.currentAnimationAction.timeScale?0:this.currentAnimation.duration);this.currentAnimationAction.setEffectiveWeight(void 0!==d?d:1);this.currentAnimationAction.play();this.playing||this.mixer.update(0);this.playing=!0;this.previousAnimation&&this.previousAnimationAction.crossFadeTo(this.currentAnimationAction,
b||0,!1);THREE.SEA3D.AnimationHandler.add(this);return this},stop:function(){this.playing&&THREE.SEA3D.AnimationHandler.remove(this);this.currentAnimation&&(this.currentAnimationAction.stop(),this.previousAnimation=this.currentAnimation,this.previousAnimationAction=this.currentAnimationAction,delete this.currentAnimationAction,delete this.currentAnimation,this.playing=!1);return this},playw:function(a,b){this.playing||this.paused||THREE.SEA3D.AnimationHandler.add(this);var c=this.getAnimationByName(a);
this.playing=!0;var d=this.mixer.clipAction(c.clip);d.setLoop(c.repeat?THREE.LoopRepeat:THREE.LoopOnce,Infinity).reset();d.clampWhenFinished=!c.repeat;d.paused=!1;d.setEffectiveWeight(b).play();return d},crossFade:function(a,b,c,d){this.mixer.stopAllAction();a=this.playw(a,1);b=this.playw(b,1);a.crossFadeTo(b,c,void 0!==d?d:!1);return this},stopAll:function(){this.stop().mixer.stopAllAction();this.playing=!1;return this},unPauseAll:function(){this.mixer.timeScale=1;this.playing=!0;this.paused=!1;
return this},pauseAll:function(){this.mixer.timeScale=0;this.playing=!1;this.paused=!0;return this},setRelative:function(a){if(this.relative!=a)return this.stop(),this.relative=a,this},getRelative:function(){return this.relative},copyFrom:function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].timeScale=a.animations[b].timeScale;return this}});
THREE.SEA3D.Object3DAnimator=function(a,b){this.object3d=b;THREE.SEA3D.Animator.call(this,a,new THREE.AnimationMixer(b));this.clone=function(a){return(new this.constructor(this.clips,a)).copyFrom(this)}.bind(this)};
THREE.SEA3D.Object3DAnimator.prototype=Object.assign(Object.create(THREE.SEA3D.Animator.prototype),{constructor:THREE.SEA3D.Object3DAnimator,stop:function(){if(this.currentAnimation){var a=this.object3d.animate;a&&this instanceof THREE.SEA3D.Object3DAnimator&&(a.position.set(0,0,0),a.quaternion.set(0,0,0,1),a.scale.set(1,1,1))}THREE.SEA3D.Animator.prototype.stop.call(this)},setRelative:function(a){THREE.SEA3D.Animator.prototype.setRelative.call(this,a);this.object3d.setAnimator(this.relative);this.updateAnimations(this.clips,
new THREE.AnimationMixer(this.relative?this.object3d.animate:this.object3d))}});THREE.SEA3D.CameraAnimator=function(a,b){THREE.SEA3D.Object3DAnimator.call(this,a,b)};THREE.SEA3D.CameraAnimator.prototype=Object.assign(Object.create(THREE.SEA3D.Object3DAnimator.prototype),{constructor:THREE.SEA3D.CameraAnimator});THREE.SEA3D.SoundAnimator=function(a,b){THREE.SEA3D.Object3DAnimator.call(this,a,b)};
THREE.SEA3D.SoundAnimator.prototype=Object.assign(Object.create(THREE.SEA3D.Object3DAnimator.prototype),{constructor:THREE.SEA3D.SoundAnimator});THREE.SEA3D.LightAnimator=function(a,b){THREE.SEA3D.Object3DAnimator.call(this,a,b)};THREE.SEA3D.LightAnimator.prototype=Object.assign(Object.create(THREE.SEA3D.Object3DAnimator.prototype),{constructor:THREE.SEA3D.LightAnimator});THREE.SEA3D.Object3D=function(){THREE.Object3D.call(this)};
THREE.SEA3D.Object3D.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.SEA3D.Object3D,updateAnimateMatrix:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.animate.updateMatrix(),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.animate.matrix),this.matrixWorldNeedsUpdate=!1,a=
!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},setAnimator:function(a){this.getAnimator()!=a&&(a?(this.animate=new THREE.Object3D,this.updateMatrixWorld=THREE.SEA3D.Object3D.prototype.updateAnimateMatrix):(delete this.animate,this.updateMatrixWorld=THREE.Object3D.prototype.updateMatrixWorld),this.matrixWorldNeedsUpdate=!0)},getAnimator:function(){return void 0!=this.animate},copy:function(a){THREE.Object3D.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=
a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});THREE.SEA3D.Dummy=function(a,b,c){this.width=void 0!=a?a:100;this.height=void 0!=b?b:100;this.depth=void 0!=c?c:100;a=new THREE.BoxGeometry(this.width,this.height,this.depth,1,1,1);a.computeBoundingBox();a.computeBoundingSphere();THREE.Mesh.call(this,a,THREE.SEA3D.Dummy.MATERIAL)};THREE.SEA3D.Dummy.MATERIAL=new THREE.MeshBasicMaterial({wireframe:!0,color:THREE.SEA3D.HELPER_COLOR});
THREE.SEA3D.Dummy.prototype=Object.assign(Object.create(THREE.Mesh.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.Dummy,copy:function(a){THREE.Mesh.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this},dispose:function(){this.geometry.dispose()}});THREE.SEA3D.Mesh=function(a,b){THREE.Mesh.call(this,a,b)};
THREE.SEA3D.Mesh.prototype=Object.assign(Object.create(THREE.Mesh.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.Mesh,setWeight:function(a,b){this.morphTargetInfluences["number"===typeof a?a:this.morphTargetDictionary[a]]=b},getWeight:function(a){return this.morphTargetInfluences["number"===typeof a?a:this.morphTargetDictionary[a]]},copy:function(a){THREE.Mesh.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));
return this}});THREE.SEA3D.SkinnedMesh=function(a,b,c){THREE.SkinnedMesh.call(this,a,b,c);this.updateAnimations(a.animations,new THREE.AnimationMixer(this))};
THREE.SEA3D.SkinnedMesh.prototype=Object.assign(Object.create(THREE.SkinnedMesh.prototype),THREE.SEA3D.Mesh.prototype,THREE.SEA3D.Animator.prototype,{constructor:THREE.SEA3D.SkinnedMesh,boneByName:function(a){for(var b=this.skeleton.bones,c=0,d=b.length;c<d;c++)if(a==b[c].name)return b[c]},copy:function(a){THREE.SkinnedMesh.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});
THREE.SEA3D.VertexAnimationMesh=function(a,b){THREE.Mesh.call(this,a,b);this.type="MorphAnimMesh";this.updateAnimations(a.animations,new THREE.AnimationMixer(this))};
THREE.SEA3D.VertexAnimationMesh.prototype=Object.assign(Object.create(THREE.Mesh.prototype),THREE.SEA3D.Mesh.prototype,THREE.SEA3D.Animator.prototype,{constructor:THREE.SEA3D.VertexAnimationMesh,copy:function(a){THREE.Mesh.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});THREE.SEA3D.Camera=function(a,b,c,d){THREE.PerspectiveCamera.call(this,a,b,c,d)};
THREE.SEA3D.Camera.prototype=Object.assign(Object.create(THREE.PerspectiveCamera.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.Camera,copy:function(a){THREE.PerspectiveCamera.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});THREE.SEA3D.OrthographicCamera=function(a,b,c,d,g,e){THREE.OrthographicCamera.call(this,a,b,c,d,g,e)};
THREE.SEA3D.OrthographicCamera.prototype=Object.assign(Object.create(THREE.OrthographicCamera.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.OrthographicCamera,copy:function(a){THREE.OrthographicCamera.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});THREE.SEA3D.PointLight=function(a,b,c,d){THREE.PointLight.call(this,a,b,c,d)};
THREE.SEA3D.PointLight.prototype=Object.assign(Object.create(THREE.PointLight.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.PointLight,copy:function(a){THREE.PointLight.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});THREE.SEA3D.PointSound=function(a,b){THREE.PositionalAudio.call(this,a);this.setSound(b)};
THREE.SEA3D.PointSound.prototype=Object.assign(Object.create(THREE.PositionalAudio.prototype),THREE.SEA3D.Object3D.prototype,{constructor:THREE.SEA3D.PointSound,setSound:function(a){(this.sound=a)&&(a.buffer?this.setBuffer(a.buffer):a.addEventListener("complete",function(b){this.setBuffer(a.buffer)}.bind(this)));return this},copy:function(a){THREE.PositionalAudio.prototype.copy.call(this,a);this.attribs=a.attribs;this.scripts=a.scripts;a.animator&&(this.animator=a.animator.clone(this));return this}});
THREE.SEA3D.AnimationHandler={animators:[],update:function(a){for(var b=0;b<this.animators.length;)this.animators[b++].update(a)},add:function(a){-1===this.animators.indexOf(a)&&this.animators.push(a)},remove:function(a){a=this.animators.indexOf(a);-1!==a&&this.animators.splice(a,1)}};THREE.SEA3D.Sound=function(a){this.uuid=THREE.Math.generateUUID();this.src=a;(new THREE.AudioLoader).load(a,function(a){this.buffer=a;this.dispatchEvent({type:"complete"})}.bind(this))};
THREE.SEA3D.Sound.prototype=Object.assign(Object.create(THREE.EventDispatcher.prototype),{constructor:THREE.SEA3D.Sound});THREE.SEA3D.Domain.prototype.getMesh=THREE.SEA3D.prototype.getMesh=function(a){return this.objects["m3d/"+a]};THREE.SEA3D.Domain.prototype.getDummy=THREE.SEA3D.prototype.getDummy=function(a){return this.objects["dmy/"+a]};THREE.SEA3D.Domain.prototype.getLine=THREE.SEA3D.prototype.getLine=function(a){return this.objects["line/"+a]};
THREE.SEA3D.Domain.prototype.getSound3D=THREE.SEA3D.prototype.getSound3D=function(a){return this.objects["sn3d/"+a]};THREE.SEA3D.Domain.prototype.getMaterial=THREE.SEA3D.prototype.getMaterial=function(a){return this.objects["mat/"+a]};THREE.SEA3D.Domain.prototype.getLight=THREE.SEA3D.prototype.getLight=function(a){return this.objects["lht/"+a]};THREE.SEA3D.Domain.prototype.getGLSL=THREE.SEA3D.prototype.getGLSL=function(a){return this.objects["glsl/"+a]};
THREE.SEA3D.Domain.prototype.getCamera=THREE.SEA3D.prototype.getCamera=function(a){return this.objects["cam/"+a]};THREE.SEA3D.Domain.prototype.getTexture=THREE.SEA3D.prototype.getTexture=function(a){return this.objects["tex/"+a]};THREE.SEA3D.Domain.prototype.getCubeMap=THREE.SEA3D.prototype.getCubeMap=function(a){return this.objects["cmap/"+a]};THREE.SEA3D.Domain.prototype.getJointObject=THREE.SEA3D.prototype.getJointObject=function(a){return this.objects["jnt/"+a]};
THREE.SEA3D.Domain.prototype.getContainer3D=THREE.SEA3D.prototype.getContainer3D=function(a){return this.objects["c3d/"+a]};THREE.SEA3D.Domain.prototype.getSprite=THREE.SEA3D.prototype.getSprite=function(a){return this.objects["m2d/"+a]};THREE.SEA3D.Domain.prototype.getProperties=THREE.SEA3D.prototype.getProperties=function(a){return this.objects["prop/"+a]};THREE.SEA3D.prototype.isPowerOfTwo=function(a){return a?(a&-a)==a:!1};
THREE.SEA3D.prototype.nearestPowerOfTwo=function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))};THREE.SEA3D.prototype.updateTransform=function(a,b){var c=THREE.SEA3D.MTXBUF;b.transform?c.fromArray(b.transform):c.makeTranslation(b.position.x,b.position.y,b.position.z);a.position.setFromMatrixPosition(c);a.scale.setFromMatrixScale(c);a.rotation.setFromRotationMatrix(THREE.SEA3D.identityMatrixScale(c));if(this.config.forceStatic||b.isStatic)a.updateMatrix(),a.matrixAutoUpdate=!1};
THREE.SEA3D.prototype.toVector3=function(a){return new THREE.Vector3(a.x,a.y,a.z)};THREE.SEA3D.prototype.toFaces=function(a){var b=[];b[0]=a[1];b[1]=a[0];b[2]=a[3];b[3]=a[2];b[4]=a[5];b[5]=a[4];return b};THREE.SEA3D.prototype.updateScene=function(){if(void 0!=this.materials)for(var a=0,b=this.materials.length;a<b;++a)this.materials[a].needsUpdate=!0};
THREE.SEA3D.prototype.addSceneObject=function(a,b){b=b||a.tag;b.visible=a.visible;a.parent?a.parent.tag.add(b):this.config.container&&this.config.container.add(b);a.attributes&&(b.attribs=a.attributes.tag);a.scripts&&(b.scripts=this.getJSMList(b,a.scripts),this.config.scripts&&this.config.runScripts&&this.domain.runJSMList(b))};THREE.SEA3D.prototype.createObjectURL=function(a,b){return(window.URL||window.webkitURL).createObjectURL(new Blob([a],{type:b}))};
THREE.SEA3D.prototype.parsePath=function(a){var b=this.config.paths,c;for(c in b)a=a.replace(RegExp("%"+c+"%","g"),b[c]);return a};
THREE.SEA3D.prototype.addDefaultAnimation=function(a,b){for(var c=a.tag,d=0,g=a.animations?a.animations.length:0;d<g;d++){var e=a.animations[d];switch(e.tag.type){case SEA3D.Animation.prototype.type:return d=e.tag.tag||this.getModifier({sea:e.tag,scope:c,relative:e.relative}),c.animator=new b(d,c),c.animator.setRelative(e.relative),this.config.autoPlay&&c.animator.play(0),c.animator}}};
THREE.SEA3D.prototype.readGeometryBuffer=function(a){for(var b=a.tag||new THREE.BufferGeometry,c=0;c<a.groups.length;c++){var d=a.groups[c];b.addGroup(d.start,d.count,c)}a.indexes&&b.setIndex(new THREE.BufferAttribute(a.indexes,1));b.addAttribute("position",new THREE.BufferAttribute(a.vertex,3));a.uv&&(b.addAttribute("uv",new THREE.BufferAttribute(a.uv[0],2)),1<a.uv.length&&b.addAttribute("uv2",new THREE.BufferAttribute(a.uv[1],2)));a.normal?b.addAttribute("normal",new THREE.BufferAttribute(a.normal,
3)):b.computeVertexNormals();a.tangent4&&b.addAttribute("tangent",new THREE.BufferAttribute(a.tangent4,4));a.color&&b.addAttribute("color",new THREE.BufferAttribute(a.color[0],a.numColor));a.joint&&(b.addAttribute("skinIndex",new THREE.Float32BufferAttribute(a.joint,a.jointPerVertex)),b.addAttribute("skinWeight",new THREE.Float32BufferAttribute(a.weight,a.jointPerVertex)));this.config.bounding&&(b.computeBoundingBox(),b.computeBoundingSphere());b.name=a.name;this.domain.geometries=this.geometries=
this.geometries||[];this.geometries.push(this.objects["geo/"+a.name]=a.tag=b)};THREE.SEA3D.prototype.readDummy=function(a){var b=new THREE.SEA3D.Dummy(a.width,a.height,a.depth);b.name=a.name;this.domain.dummys=this.dummys=this.dummys||[];this.dummys.push(this.objects["dmy/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readLine=function(a){var b=new THREE.BufferGeometry;a.closed&&a.vertex.push(a.vertex[0],a.vertex[1],a.vertex[2]);b.addAttribute("position",new THREE.Float32BufferAttribute(a.vertex,3));b=new THREE.Line(b,new THREE.LineBasicMaterial({color:THREE.SEA3D.HELPER_COLOR,linewidth:3}));b.name=a.name;this.lines=this.lines||[];this.lines.push(this.objects["line/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readContainer3D=function(a){var b=new THREE.SEA3D.Object3D;this.domain.containers=this.containers=this.containers||[];this.containers.push(this.objects["c3d/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readSprite=function(a){var b;if(a.material)if(a.material.tag.sprite)b=a.material.tag.sprite;else{b=a.material.tag.sprite=new THREE.SpriteMaterial;this.setBlending(b,a.blendMode);var c=a.material.tag.map;c&&(c.flipY=!0,b.map=c);b.color.set(a.material.tag.color);b.opacity=a.material.tag.opacity;b.fog=a.material.receiveFog}b=new THREE.Sprite(b);b.name=a.name;this.domain.sprites=this.sprites=this.sprites||[];this.sprites.push(this.objects["m2d/"+a.name]=a.tag=b);this.addSceneObject(a);
this.updateTransform(b,a);b.scale.set(a.width,a.height,1)};
THREE.SEA3D.prototype.readMesh=function(a){var b,c,d=a.geometry.tag,g,e,l,n,B,E,s;b=0;for(c=a.modifiers?a.modifiers.length:0;b<c;b++){var D=a.modifiers[b];switch(D.type){case SEA3D.Skeleton.prototype.type:case SEA3D.SkeletonLocal.prototype.type:e=D;d.bones=e.tag;break;case SEA3D.Morph.prototype.type:l=D.tag||this.getModifier({sea:D,geometry:a.geometry}),d.morphAttributes=l.attribs,d.morphTargets=l.targets}}b=0;for(c=a.animations?a.animations.length:0;b<c;b++)switch(D=a.animations[b].tag,D.type){case SEA3D.SkeletonAnimation.prototype.type:n=
D;d.animations=n.tag||this.getModifier({sea:n,skeleton:e,relative:!0});break;case SEA3D.VertexAnimation.prototype.type:B=D;d.morphAttributes=B.tag.attribs;d.morphTargets=B.tag.targets;d.animations=B.tag.animations;break;case SEA3D.UVWAnimation.prototype.type:E=D.tag||this.getModifier({sea:D});break;case SEA3D.MorphAnimation.prototype.type:s=D.tag||this.getModifier({sea:D})}c=void 0!=l||void 0!=B;l=l&&void 0!=l.attribs.normal||B&&void 0!=B.tag.attribs.normal;if(a.material)if(1<a.material.length){g=
[];for(b=0;b<a.material.length;b++)g[b]=a.material[b].tag,g[b].skinning=void 0!=e,g[b].morphTargets=c,g[b].morphNormals=l,g[b].vertexColors=a.geometry.color?THREE.VertexColors:THREE.NoColors;g=THREE.SEA3D.useMultiMaterial?new THREE.MultiMaterial(g):g}else g=a.material[0].tag,g.skinning=void 0!=e,g.morphTargets=c,g.morphNormals=l,g.vertexColors=a.geometry.color?THREE.VertexColors:THREE.NoColors;e?(b=new THREE.SEA3D.SkinnedMesh(d,g,this.config.useVertexTexture),this.config.autoPlay&&n&&b.play(0)):B?
(b=new THREE.SEA3D.VertexAnimationMesh(d,g),this.config.autoPlay&&b.play(0)):b=new THREE.SEA3D.Mesh(d,g);E&&(b.uvwAnimator=new THREE.SEA3D.Animator(E,new THREE.AnimationMixer(g.map)),this.config.autoPlay&&b.uvwAnimator.play(0));s&&(b.morphAnimator=new THREE.SEA3D.Animator(s,new THREE.AnimationMixer(b)),this.config.autoPlay&&b.morphAnimator.play(0));b.name=a.name;b.castShadow=a.castShadows;b.receiveShadow=a.material?a.material[0].receiveShadows:!0;this.domain.meshes=this.meshes=this.meshes||[];this.meshes.push(this.objects["m3d/"+
a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.Object3DAnimator)};
THREE.SEA3D.prototype.readSoundPoint=function(a){this.audioListener||(this.audioListener=new THREE.AudioListener,this.config.container&&this.config.container.add(this.audioListener));var b=new THREE.SEA3D.PointSound(this.audioListener);b.autoplay=a.autoPlay;b.setLoop(a.autoPlay);b.setVolume(a.volume);b.setRefDistance(a.distance);b.setRolloffFactor(this.config.audioRolloffFactor);b.setSound(a.sound.tag);b.name=a.name;this.domain.sounds3d=this.sounds3d=this.sounds3d||[];this.sounds3d.push(this.objects["sn3d/"+
a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.SoundAnimator)};THREE.SEA3D.prototype.readCubeRender=function(a){var b=new THREE.CubeCamera(0.1,5E3,THREE.SEA3D.RTT_SIZE);b.renderTarget.cubeCamera=b;a.tag=b.renderTarget;this.domain.cubeRenderers=this.cubeRenderers=this.cubeRenderers||[];this.cubeRenderers.push(this.objects["rttc/"+a.name]=b);this.addSceneObject(a,b);this.updateTransform(b,a)};
THREE.SEA3D.prototype.readTexture=function(a){var b=new Image,c=new THREE.Texture;c.name=a.name;c.wrapS=c.wrapT=THREE.RepeatWrapping;c.flipY=!1;c.image=b;void 0!==this.config.anisotropy&&(c.anisotropy=this.config.anisotropy);b.onload=function(){c.needsUpdate=!0};b.src=this.createObjectURL(a.data.buffer,"image/"+a.type);this.domain.textures=this.textures=this.textures||[];this.textures.push(this.objects["tex/"+a.name]=a.tag=c)};
THREE.SEA3D.prototype.readCubeMap=function(a){var b=this.toFaces(a.faces),c=new THREE.CubeTexture([]),d=0;c.name=a.name;c.flipY=!1;c.format=THREE.RGBFormat;for(var g=function(){6==++d&&(c.needsUpdate=!0,this.config.async||(this.file.resume=!0))}.bind(this),e=0;e<b.length;++e){var l=new Image;l.onload=g;l.src=this.createObjectURL(b[e].buffer,"image/"+a.extension);c.images[e]=l}this.config.async||(this.file.resume=!1);this.domain.cubemaps=this.cubemaps=this.cubemaps||[];this.cubemaps.push(this.objects["cmap/"+
a.name]=a.tag=c)};THREE.SEA3D.prototype.readTextureUpdate=function(a){var b=this.file.objects[a.index],c=b.tag,d=new Image;d.onload=function(){c.image=d;c.needsUpdate=!0};d.src=this.createObjectURL(a.bytes.buffer,"image/"+b.type)};THREE.SEA3D.prototype.readSound=function(a){var b=new THREE.SEA3D.Sound(this.createObjectURL(a.data.buffer,"audio/"+a.type));b.name=a.name;this.domain.sounds=this.sounds=this.sounds||[];this.sounds.push(this.objects["snd/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readScriptURL=function(a){this.file.resume=!1;(new THREE.FileLoader).setResponseType("text").load(a.url,function(b){this.file.resume=!0;this.domain.scripts=this.scripts=this.scripts||[];this.scripts.push(this.objects["src/"+a.name]=a.tag=b)}.bind(this))};
THREE.SEA3D.prototype.readTextureURL=function(a){var b=(new THREE.TextureLoader).load(this.parsePath(a.url));b.name=a.name;b.wrapS=b.wrapT=THREE.RepeatWrapping;b.flipY=!1;void 0!==this.config.anisotropy&&(b.anisotropy=this.config.anisotropy);this.domain.textures=this.textures=this.textures||[];this.textures.push(this.objects["tex/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readCubeMapURL=function(a){for(var b=this.toFaces(a.faces),c=0;c<b.length;c++)b[c]=this.parsePath(b[c]);if("hdr"==b[0].substr(-3)){var d=null!=THREE.PMREMGenerator;this.file.resume=!d;b=(new THREE.HDRCubeTextureLoader).load(THREE.UnsignedByteType,b,function(b){if(d){var c=new THREE.PMREMGenerator(b);c.update(this.config.renderer);c=new THREE.PMREMCubeUVPacker(c.cubeLods);c.update(this.config.renderer);b.dispose();this.objects["cmap/"+a.name]=a.tag=c.CubeUVRenderTarget.texture;
this.file.resume=!0}}.bind(this))}else b=(new THREE.CubeTextureLoader).load(b);b.name=a.name;b.wrapS=b.wrapT=THREE.RepeatWrapping;b.flipY=!1;void 0!==this.config.anisotropy&&(b.anisotropy=this.config.anisotropy);this.domain.cubemaps=this.cubemaps=this.cubemaps||[];this.cubemaps.push(this.objects["cmap/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.getJSMList=function(a,b){for(var c=[],d=0;d<b.length;d++){var g=b[d];g.tag.type==SEA3D.JavaScriptMethod.prototype.type&&c.push(g)}this.domain.scriptTargets=this.scriptTargets=this.scriptTargets||[];this.scriptTargets.push(a);return c};
THREE.SEA3D.prototype.readJavaScriptMethod=function(a){try{var b="(function() {\nvar $METHOD = {}\n",c='function($INC, $REF, global, local, self, $PARAM) {\nvar watch = $INC["watch"],\nscene = $INC["scene"],\nsea3d = $INC["sea3d"],\nprint = $INC["print"];\n',c=c+'var $SRC = $INC["source"],\naddEventListener = $SRC.addEventListener.bind( $SRC ),\nhasEventListener = $SRC.hasEventListener.bind( $SRC ),\nremoveEventListener = $SRC.removeEventListener.bind( $SRC ),\ndispatchEvent = $SRC.dispatchEvent.bind( $SRC ),\ndispose = $SRC.dispose.bind( $SRC );\n',
d;for(d in a.methods)b+='$METHOD["'+d+'"] = '+c+a.methods[d].src+"}\n";this.domain.methods=eval(b+"return $METHOD; })")()}catch(g){console.error('SEA3D JavaScriptMethod: Error running "'+a.name+'".'),console.error(g)}};THREE.SEA3D.prototype.readGLSL=function(a){this.domain.glsl=this.glsl=this.glsl||[];this.glsl.push(this.objects["glsl/"+a.name]=a.tag=a.src)};
THREE.SEA3D.prototype.materialTechnique=function(){var a={onComplete:function(a,c){if(1>c.alpha||a.blending>THREE.NormalBlending)a.opacity=c.alpha,a.transparent=!0}};a[SEA3D.Material.PHYSICAL]=function(a,c){a.color.setHex(c.color);a.roughness=c.roughness;a.metalness=c.metalness};a[SEA3D.Material.REFLECTIVITY]=function(a,c){a.reflectivity=c.strength};a[SEA3D.Material.CLEAR_COAT]=function(a,c){a.clearCoat=c.strength;a.clearCoatRoughness=c.roughness};a[SEA3D.Material.PHONG]=function(a,c){a.color.setHex(c.diffuseColor);
a.specular.setHex(c.specularColor).multiplyScalar(c.specular);a.shininess=c.gloss};a[SEA3D.Material.DIFFUSE_MAP]=function(a,c,d){a.map=c.texture.tag;a.color.setHex(16777215);a.map.wrapS=a.map.wrapT=d.repeat?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;c.texture.transparent&&(a.transparent=!0)};a[SEA3D.Material.ROUGHNESS_MAP]=function(a,c){a.roughnessMap=c.texture.tag};a[SEA3D.Material.METALNESS_MAP]=function(a,c){a.metalnessMap=c.texture.tag};a[SEA3D.Material.SPECULAR_MAP]=function(a,c){a.specular&&
(a.specularMap=c.texture.tag,a.specular.setHex(16777215))};a[SEA3D.Material.NORMAL_MAP]=function(a,c){a.normalMap=c.texture.tag};a[SEA3D.Material.REFLECTION]=a[SEA3D.Material.FRESNEL_REFLECTION]=function(a,c){a.envMap=c.texture.tag;a.envMap.mapping=THREE.CubeReflectionMapping;a.combine=THREE.MixOperation;a.reflectivity=c.alpha};a[SEA3D.Material.REFLECTION_SPHERICAL]=function(a,c){a.envMap=c.texture.tag;a.envMap.mapping=THREE.SphericalReflectionMapping;a.combine=THREE.MixOperation;a.reflectivity=c.alpha};
a[SEA3D.Material.REFRACTION_MAP]=function(a,c){a.envMap=c.texture.tag;a.envMap.mapping=THREE.CubeRefractionMapping;a.refractionRatio=c.ior;a.reflectivity=c.alpha};a[SEA3D.Material.LIGHT_MAP]=function(a,c){"multiply"==c.blendMode?a.aoMap=c.texture.tag:a.lightMap=c.texture.tag};a[SEA3D.Material.EMISSIVE]=function(a,c){a.emissive.setHex(c.color)};a[SEA3D.Material.EMISSIVE_MAP]=function(a,c){a.emissiveMap=c.texture.tag};a[SEA3D.Material.ALPHA_MAP]=function(a,c,d){a.alphaMap=c.texture.tag;a.transparent=
!0;a.alphaMap.wrapS=a.alphaMap.wrapT=d.repeat?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping};return a}();THREE.SEA3D.prototype.createMaterial=function(a){return a.tecniquesDict[SEA3D.Material.REFLECTIVITY]||a.tecniquesDict[SEA3D.Material.CLEAR_COAT]?new THREE.MeshPhysicalMaterial:a.tecniquesDict[SEA3D.Material.PHYSICAL]?new THREE.MeshStandardMaterial:new THREE.MeshPhongMaterial};
THREE.SEA3D.prototype.setBlending=function(a,b){if("normal"!==b){switch(b){case "add":a.blending=THREE.AdditiveBlending;break;case "subtract":a.blending=THREE.SubtractiveBlending;break;case "multiply":a.blending=THREE.MultiplyBlending;break;case "screen":a.blending=THREE.CustomBlending,a.blendSrc=THREE.OneFactor,a.blendDst=THREE.OneMinusSrcColorFactor,a.blendEquation=THREE.AddEquation}a.transparent=!0}};
THREE.SEA3D.prototype.readMaterial=function(a){var b=this.createMaterial(a);b.name=a.name;b.lights=a.receiveLights;b.fog=a.receiveFog;b.depthWrite=a.depthWrite;b.depthTest=a.depthTest;b.premultipliedAlpha=a.premultipliedAlpha;b.side=a.doubleSided?THREE.DoubleSide:THREE.FrontSide;this.setBlending(b,a.blendMode);for(var c=0;c<a.technique.length;c++){var d=a.technique[c];this.materialTechnique[d.kind]&&this.materialTechnique[d.kind].call(this,b,d,a)}this.materialTechnique.onComplete&&this.materialTechnique.onComplete.call(this,
b,a);this.domain.materials=this.materials=this.materials||[];this.materials.push(this.objects["mat/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readPointLight=function(a){var b=new THREE.SEA3D.PointLight(a.color,a.multiplier*this.config.multiplier);b.name=a.name;a.attenuation&&(b.distance=a.attenuation.end);a.shadow&&this.setShadowMap(b);this.domain.lights=this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readHemisphereLight=function(a){var b=new THREE.HemisphereLight(a.color,a.secondColor,a.multiplier*this.config.multiplier);b.position.set(0,500,0);b.name=a.name;this.domain.lights=this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.addDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readAmbientLight=function(a){var b=new THREE.AmbientLight(a.color,a.multiplier*this.config.multiplier);b.name=a.name;this.domain.lights=this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.addDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readDirectionalLight=function(a){var b=new THREE.DirectionalLight(a.color,a.multiplier*this.config.multiplier);b.name=a.name;a.shadow&&this.setShadowMap(b);this.domain.lights=this.lights=this.lights||[];this.lights.push(this.objects["lht/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.LightAnimator);this.updateScene()};
THREE.SEA3D.prototype.readCamera=function(a){var b=new THREE.SEA3D.Camera(a.fov);b.name=a.name;this.domain.cameras=this.cameras=this.cameras||[];this.cameras.push(this.objects["cam/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,a);this.addDefaultAnimation(a,THREE.SEA3D.CameraAnimator)};
THREE.SEA3D.prototype.readOrthographicCamera=function(a){var b,c;c=void 0!==this.config.stageWidth?this.config.stageWidth:window?window.innerWidth:1024;var d=void 0!==this.config.stageHeight?this.config.stageHeight:window?window.innerHeight:1024;c>d?(b=c/d*a.height,c=a.height):(b=a.height,c=d/c*a.height);b=new THREE.SEA3D.OrthographicCamera(-b,b,c,-c);b.name=a.name;this.domain.cameras=this.cameras=this.cameras||[];this.cameras.push(this.objects["cam/"+a.name]=a.tag=b);this.addSceneObject(a);this.updateTransform(b,
a);this.addDefaultAnimation(a,THREE.SEA3D.CameraAnimator)};THREE.SEA3D.prototype.getSkeletonFromBones=function(a){var b=[],c,d,g,e;g=0;for(e=a.length;g<e;g++)d=a[g],c=new THREE.Bone,b.push(c),c.name=d.name,c.position.fromArray(d.pos),c.quaternion.fromArray(d.rotq),void 0!==d.scl&&c.scale.fromArray(d.scl);g=0;for(e=a.length;g<e;g++)d=a[g],-1!==d.parent&&null!==d.parent&&void 0!==b[d.parent]&&b[d.parent].add(b[g]);return new THREE.Skeleton(b)};
THREE.SEA3D.prototype.readSkeletonLocal=function(a){for(var b=[],c=0;c<a.joint.length;c++){var d=a.joint[c];b[c]={name:d.name,pos:[d.x,d.y,d.z],rotq:[d.qx,d.qy,d.qz,d.qw],parent:d.parentIndex}}this.domain.bones=this.bones=this.bones||[];this.bones.push(this.objects[a.name+".sklq"]=a.tag=b)};THREE.SEA3D.prototype.readJointObject=function(a){var b=a.target.tag.skeleton.bones[a.joint];this.domain.joints=this.joints=this.joints||[];this.joints.push(this.objects["jnt/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readMorph=function(a){for(var b={position:[]},c=[],d=0;d<a.node.length;d++){var g=a.node[d];b.position[d]=new THREE.Float32BufferAttribute(g.vertex,3);b.position[d].name=g.name;g.normal&&(b.normal=b.normal||[],b.normal[d]=new THREE.Float32BufferAttribute(g.normal,3));c[d]={name:g.name}}a.tag={attribs:b,targets:c}};
THREE.SEA3D.prototype.readAnimation=function(a){for(var b=[],c=1E3/a.frameRate/1E3,d=0;d<a.sequence.length;d++){for(var g=a.sequence[d],e=[],l=0;l<a.dataList.length;l++){var n=a.dataList[l],B,E,s,D=n.data;s=g.start*n.blockSize;B=s+g.count*n.blockSize;var q=g.intrpl?THREE.InterpolateLinear:!1,O=null;switch(n.kind){case SEA3D.Animation.POSITION:O=".position";break;case SEA3D.Animation.ROTATION:O=".quaternion";break;case SEA3D.Animation.SCALE:O=".scale";break;case SEA3D.Animation.COLOR:O=".color";break;
case SEA3D.Animation.MULTIPLIER:O=".intensity";break;case SEA3D.Animation.FOV:O=".fov";break;case SEA3D.Animation.OFFSET_U:O=".offset[x]";break;case SEA3D.Animation.OFFSET_V:O=".offset[y]";break;case SEA3D.Animation.SCALE_U:O=".repeat[x]";break;case SEA3D.Animation.SCALE_V:O=".repeat[y]";break;case SEA3D.Animation.MORPH:O=".morphTargetInfluences["+n.name+"]"}if(O)switch(n.type){case SEA3D.Stream.BYTE:case SEA3D.Stream.UBYTE:case SEA3D.Stream.INT:case SEA3D.Stream.UINT:case SEA3D.Stream.FLOAT:case SEA3D.Stream.DOUBLE:case SEA3D.Stream.DECIMAL:s=
D.subarray(s,B);E=new Float32Array(s.length);for(B=n=0;B<E.length;B++)E[B]=n,n+=c;e.push(new THREE.NumberKeyframeTrack(O,E,s,q));break;case SEA3D.Stream.VECTOR3D:s=D.subarray(s,B);E=new Float32Array(s.length/n.blockSize);for(B=n=0;B<E.length;B++)E[B]=n,n+=c;e.push(new THREE.VectorKeyframeTrack(O,E,s,q));break;case SEA3D.Stream.VECTOR4D:s=D.subarray(s,B);E=new Float32Array(s.length/n.blockSize);for(B=n=0;B<E.length;B++)E[B]=n,n+=c;e.push(new THREE.QuaternionKeyframeTrack(O,E,s,q));break;case SEA3D.Stream.INT24:case SEA3D.Stream.UINT24:s=
new Float32Array(3*(B-s));E=new Float32Array(s.length/3);for(B=n=0;B<E.length;B++)s[3*B]=(D[B]>>16&255)/255,s[3*B+1]=(D[B]>>8&255)/255,s[3*B+2]=(D[B]&255)/255,E[B]=n,n+=c;e.push(new THREE.VectorKeyframeTrack(O,E,s,q))}}b.push(new THREE.SEA3D.AnimationClip(g.name,-1,e,g.repeat))}this.domain.clips=this.clips=this.clips||[];this.clips.push(this.objects[a.name+".anm"]=a.tag=b)};
THREE.SEA3D.prototype.readSkeletonAnimation=function(a,b){b=!b&&a.metadata&&a.metadata.skeleton?a.metadata.skeleton:b;if(!b||a.tag)return a.tag;for(var c=[],d=1E3/a.frameRate/1E3,g=0;g<a.sequence.length;g++){for(var e=a.sequence[g],l=e.start,n=l+e.count,B={name:e.name,fps:a.frameRate,length:d*e.count,hierarchy:[]},E=a.numJoints,s=a.raw,D=0;D<E;D++){for(var q={parent:b.joint[D].parentIndex,keys:[]},O=q.keys,r=0,I=l;I<n;I++){var F=I*E*7+7*D;O.push({time:r,pos:[s[F],s[F+1],s[F+2]],rot:[s[F+3],s[F+4],
s[F+5],s[F+6]],scl:[1,1,1]});r+=d}B.hierarchy[D]=q}c.push(THREE.SEA3D.AnimationClip.fromClip(THREE.AnimationClip.parseAnimation(B,b.tag),e.repeat))}this.domain.clips=this.clips=this.clips||[];this.clips.push(this.objects[a.name+".skla"]=a.tag=c)};
THREE.SEA3D.prototype.readVertexAnimation=function(a){var b={position:[]},c=[],d=[],g,e;g=0;for(e=a.frame.length;g<e;g++){var l=a.frame[g];b.position[g]=new THREE.Float32BufferAttribute(l.vertex,3);l.normal&&(b.normal=b.normal||[],b.normal[g]=new THREE.Float32BufferAttribute(l.normal,3));c[g]={name:g}}for(g=0;g<a.sequence.length;g++){var l=a.sequence[g],n=[];for(e=0;e<l.count;e++)n[e]=c[l.start+e];d.push(THREE.SEA3D.AnimationClip.fromClip(THREE.AnimationClip.CreateFromMorphTargetSequence(l.name,n,
a.frameRate),l.repeat))}a.tag={attribs:b,targets:c,animations:d};this.domain.clips=this.clips=this.clips||[];this.clips.push(this.objects[a.name+".vtxa"]=a.tag)};
THREE.SEA3D.prototype.getModifier=function(a){var b=a.sea;switch(b.type){case SEA3D.SkeletonAnimation.prototype.type:this.readSkeletonAnimation(b,a.skeleton);break;case SEA3D.Animation.prototype.type:case SEA3D.MorphAnimation.prototype.type:case SEA3D.UVWAnimation.prototype.type:this.readAnimation(b);break;case SEA3D.Morph.prototype.type:this.readMorph(b,a.geometry)}return b.tag};
THREE.SEA3D.prototype.applyEnvironment=function(a){for(var b=0,c=this.materials.length;b<c;++b){var d=this.materials[b];d instanceof THREE.MeshStandardMaterial&&!d.envMap&&(d.envMap=a,d.envMap.mapping=THREE.CubeReflectionMapping,d.needsUpdate=!0)}};
THREE.SEA3D.prototype.readActions=function(a){for(var b=0;b<a.actions.length;b++){var c=a.actions[b];switch(c.kind){case SEA3D.Actions.ATTRIBUTES:this.attribs=this.domain.attribs=c.attributes.tag;break;case SEA3D.Actions.SCRIPTS:this.domain.scripts=this.getJSMList(this.domain,c.scripts);this.config.scripts&&this.config.runScripts&&this.domain.runJSMList(this.domain);break;case SEA3D.Actions.CAMERA:this.domain.camera=this.camera=c.camera.tag;break;case SEA3D.Actions.ENVIRONMENT_COLOR:this.domain.background=
this.background=this.background||{};this.background.color=new THREE.Color(c.color);break;case SEA3D.Actions.ENVIRONMENT:this.domain.background=this.background=this.background||{},this.background.texture=c.texture.tag,this.config.useEnvironment&&void 0!=this.materials&&this.applyEnvironment(c.texture.tag)}}};
THREE.SEA3D.prototype.updatePropertiesAssets=function(a,b){for(var c in b)switch(b.__type[c]){case SEA3D.Stream.ASSET:b.__asset||(b.__asset={});b.__asset[c]||(b.__asset[c]=b[c]);b[c]=b.__asset[c].tag;break;case SEA3D.Stream.GROUP:b[c]=this.updatePropertiesAssets(a,b[c])}return b};THREE.SEA3D.prototype.readProperties=function(a){var b=this.updatePropertiesAssets(a,a.props);this.domain.properties=this.properties=this.properties||[];this.properties.push(this.objects["prop/"+a.name]=a.tag=b)};
THREE.SEA3D.prototype.readFileInfo=function(a){this.domain.info=this.updatePropertiesAssets(a,a.info)};THREE.SEA3D.Event={PROGRESS:"sea3d_progress",LOAD_PROGRESS:"sea3d_load",DOWNLOAD_PROGRESS:"sea3d_download",COMPLETE:"sea3d_complete",OBJECT_COMPLETE:"sea3d_object",PARSE_PROGRESS:"parse_progress",PARSE_COMPLETE:"parse_complete",ERROR:"sea3d_error"};THREE.SEA3D.prototype.onProgress=function(a){a.status=a.type;a.progress=a.loaded/a.total;a.type=THREE.SEA3D.Event.PROGRESS;this.dispatchEvent(a)};
THREE.SEA3D.prototype.onLoadProgress=function(a){a.type=THREE.SEA3D.Event.LOAD_PROGRESS;this.dispatchEvent(a);this.onProgress(a)};THREE.SEA3D.prototype.onDownloadProgress=function(a){a.type=THREE.SEA3D.Event.DOWNLOAD_PROGRESS;this.dispatchEvent(a);this.onProgress(a)};THREE.SEA3D.prototype.onComplete=function(a){a.type=THREE.SEA3D.Event.COMPLETE;this.dispatchEvent(a)};THREE.SEA3D.prototype.onCompleteObject=function(a){a.type=THREE.SEA3D.Event.OBJECT_COMPLETE;this.dispatchEvent(a)};
THREE.SEA3D.prototype.onParseProgress=function(a){a.type=THREE.SEA3D.Event.PARSE_PROGRESS;this.dispatchEvent(a)};THREE.SEA3D.prototype.onParseComplete=function(a){a.type=THREE.SEA3D.Event.PARSE_COMPLETE;this.dispatchEvent(a)};THREE.SEA3D.prototype.onError=function(a){a.type=THREE.SEA3D.Event.ERROR;this.dispatchEvent(a)};THREE.SEA3D.prototype.createDomain=function(){return this.domain=new THREE.SEA3D.Domain(this.config.id,this.objects={},this.config.container)};
THREE.SEA3D.prototype.clone=function(a,b,c){if(!this.file.isDone())throw Error("Previous parse is not completed.");this.config.container=a&&void 0!==a.container?a.container:new THREE.Object3D;a&&this.loadConfig(a);var d=this.config.timeLimit;this.config.timeLimit=a&&void 0!==a.timeLimit?a.timeLimit:Infinity;this.parse(b,c);this.config.timeLimit=d;return this.domain};THREE.SEA3D.prototype.loadConfig=function(a){for(var b in a)this.config[b]=a[b]};
THREE.SEA3D.prototype.parse=function(a,b){delete this.cameras;delete this.containers;delete this.lights;delete this.joints;delete this.meshes;delete this.materials;delete this.sprites;delete this.sounds3d;delete this.cubeRenderers;delete this.sounds;delete this.glsl;delete this.dummy;delete this.camera;delete this.background;delete this.properties;delete this.scriptTargets;delete this.domain;this.createDomain();this.setTypeRead();this.file.onParseComplete=function(b){this.config.manager&&this.config.manager.add(this.domain);
(a||this.onParseComplete).call(this,b)}.bind(this);this.file.onParseProgress=b||this.onParseProgress;for(var c=THREE.SEA3D.EXTENSIONS_LOADER.length;c--;){var d=THREE.SEA3D.EXTENSIONS_LOADER[c];d.parse&&d.parse.call(this)}this.file.parse();return this.domain};THREE.SEA3D.prototype.onHead=function(a){if("TJS"!=a.sign)throw Error("Sign '"+a.sign+"' not supported! Use SEA3D Studio to publish or SEA3DLegacy.js");};THREE.SEA3D.EXTENSIONS_LOADER=[];THREE.SEA3D.EXTENSIONS_DOMAIN=[];
THREE.SEA3D.prototype.setTypeRead=function(){this.file.typeRead={};this.file.typeRead[SEA3D.Geometry.prototype.type]=this.readGeometryBuffer;this.file.typeRead[SEA3D.Mesh.prototype.type]=this.readMesh;this.file.typeRead[SEA3D.Sprite.prototype.type]=this.readSprite;this.file.typeRead[SEA3D.Container3D.prototype.type]=this.readContainer3D;this.file.typeRead[SEA3D.Line.prototype.type]=this.readLine;this.file.typeRead[SEA3D.Material.prototype.type]=this.readMaterial;this.file.typeRead[SEA3D.Camera.prototype.type]=
this.readCamera;this.file.typeRead[SEA3D.OrthographicCamera.prototype.type]=this.readOrthographicCamera;this.file.typeRead[SEA3D.SkeletonLocal.prototype.type]=this.readSkeletonLocal;this.file.typeRead[SEA3D.SkeletonAnimation.prototype.type]=this.readSkeletonAnimation;this.file.typeRead[SEA3D.JointObject.prototype.type]=this.readJointObject;this.file.typeRead[SEA3D.CubeMap.prototype.type]=this.readCubeMap;this.file.typeRead[SEA3D.CubeRender.prototype.type]=this.readCubeRender;this.file.typeRead[SEA3D.Animation.prototype.type]=
this.file.typeRead[SEA3D.MorphAnimation.prototype.type]=this.file.typeRead[SEA3D.UVWAnimation.prototype.type]=this.readAnimation;this.file.typeRead[SEA3D.SoundPoint.prototype.type]=this.readSoundPoint;this.file.typeRead[SEA3D.TextureURL.prototype.type]=this.readTextureURL;this.file.typeRead[SEA3D.CubeMapURL.prototype.type]=this.readCubeMapURL;this.file.typeRead[SEA3D.TextureUpdate.prototype.type]=this.readTextureUpdate;this.file.typeRead[SEA3D.Morph.prototype.type]=this.readMorph;this.file.typeRead[SEA3D.VertexAnimation.prototype.type]=
this.readVertexAnimation;this.file.typeRead[SEA3D.Actions.prototype.type]=this.readActions;this.file.typeRead[SEA3D.FileInfo.prototype.type]=this.readFileInfo;this.file.typeRead[SEA3D.Properties.prototype.type]=this.readProperties;this.config.dummys&&(this.file.typeRead[SEA3D.Dummy.prototype.type]=this.readDummy);this.config.scripts&&(this.file.typeRead[SEA3D.ScriptURL.prototype.type]=this.readScriptURL,this.file.typeRead[SEA3D.JavaScriptMethod.prototype.type]=this.readJavaScriptMethod);this.config.lights&&
(this.file.typeRead[SEA3D.PointLight.prototype.type]=this.readPointLight,this.file.typeRead[SEA3D.DirectionalLight.prototype.type]=this.readDirectionalLight,this.file.typeRead[SEA3D.HemisphereLight.prototype.type]=this.readHemisphereLight,this.file.typeRead[SEA3D.AmbientLight.prototype.type]=this.readAmbientLight);this.file.typeRead[SEA3D.JPEG.prototype.type]=this.file.typeRead[SEA3D.JPEG_XR.prototype.type]=this.file.typeRead[SEA3D.PNG.prototype.type]=this.file.typeRead[SEA3D.GIF.prototype.type]=
this.readTexture;this.file.typeRead[SEA3D.MP3.prototype.type]=this.readSound;this.file.typeRead[SEA3D.GLSL.prototype.type]=this.readGLSL;for(var a=THREE.SEA3D.EXTENSIONS_LOADER.length;a--;){var b=THREE.SEA3D.EXTENSIONS_LOADER[a];b.setTypeRead&&b.setTypeRead.call(this)}};
THREE.SEA3D.prototype.load=function(a){this.file=new SEA3D.File;this.file.scope=this;this.file.config=this.config;this.file.onProgress=this.onLoadProgress.bind(this);this.file.onCompleteObject=this.onCompleteObject.bind(this);this.file.onDownloadProgress=this.onDownloadProgress.bind(this);this.file.onParseProgress=this.onParseProgress.bind(this);this.file.onParseComplete=this.onParseComplete.bind(this);this.file.onError=this.onError.bind(this);this.file.onHead=this.onHead.bind(this);this.file.onComplete=
function(a){this.config.manager&&this.config.manager.add(this.domain);this.onComplete.call(this,a)}.bind(this);this.createDomain();this.setTypeRead();void 0!==a&&("string"===typeof a?this.file.load(a):this.file.read(a))};
Object.assign(THREE.SEA3D.prototype,{_onHead:THREE.SEA3D.prototype.onHead,_updateTransform:THREE.SEA3D.prototype.updateTransform,_readMorph:THREE.SEA3D.prototype.readMorph,_readVertexAnimation:THREE.SEA3D.prototype.readVertexAnimation,_readGeometryBuffer:THREE.SEA3D.prototype.readGeometryBuffer,_readLine:THREE.SEA3D.prototype.readLine,_getModifier:THREE.SEA3D.prototype.getModifier,_readAnimation:THREE.SEA3D.prototype.readAnimation});
THREE.SEA3D.prototype.isLegacy=function(a){a=a.sea3d;return"S3D"===a.sign?a.config.legacy:!1};THREE.SEA3D.prototype.flipVec3=function(a){if(a){for(var b=2;b<a.length;)a[b]=-a[b],b+=3;return a}};THREE.SEA3D.prototype.addVector=function(a,b){if(a){for(var c=0;c<a.length;c++)a[c]+=b[c];return a}};
THREE.SEA3D.prototype.expandJoints=function(a){for(var b=4*a.numVertex,c=a.isBig?new Uint32Array(b):new Uint16Array(b),b=new Float32Array(b),d=0,g=a.jointPerVertex,e=0;e<a.numVertex;e++){var l=4*e,d=e*g;c[l]=a.joint[d];1<g&&(c[l+1]=a.joint[d+1]);2<g&&(c[l+2]=a.joint[d+2]);3<g&&(c[l+3]=a.joint[d+3]);b[l]=a.weight[d];1<g&&(b[l+1]=a.weight[d+1]);2<g&&(b[l+2]=a.weight[d+2]);3<g&&(b[l+3]=a.weight[d+3]);d=b[l]+b[l+1]+b[l+2]+b[l+3];b[l]+=1-d}a.joint=c;a.weight=b;a.jointPerVertex=4};
THREE.SEA3D.prototype.compressJoints=function(a){for(var b=4*a.numVertex,c=a.isBig?new Uint32Array(b):new Uint16Array(b),b=new Float32Array(b),d=0,g=a.jointPerVertex,e=0;e<a.numVertex;e++){var l=4*e,d=e*g;c[l]=a.joint[d];c[l+1]=a.joint[d+1];c[l+2]=a.joint[d+2];c[l+3]=a.joint[d+3];b[l]=a.weight[d];b[l+1]=a.weight[d+1];b[l+2]=a.weight[d+2];b[l+3]=a.weight[d+3];d=b[l]+b[l+1]+b[l+2]+b[l+3];b[l]+=1-d}a.joint=c;a.weight=b;a.jointPerVertex=4};
THREE.SEA3D.prototype.flipIndexes=function(a){for(var b=1;b<a.length;){var c=a[b+1];a[b+1]=a[b];a[b]=c;b+=3}return a};THREE.SEA3D.prototype.flipBoneMatrix=function(){var a=new THREE.Vector3;return function(b){var c=THREE.SEA3D.VECBUF.setFromMatrixPosition(b);c.z=-c.z;b.setPosition(a);b.multiplyMatrices(THREE.SEA3D.MTXBUF.makeRotationZ(THREE.Math.degToRad(180)),b);b.setPosition(c);return b}}();
THREE.SEA3D.prototype.flipScaleMatrix=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3;return function(d,g,e,l){e&&d.multiplyMatrices(e,d);d.decompose(a,b,c);c.z=-c.z;d.compose(a,b,c);g&&d.multiplyMatrices(d,THREE.SEA3D.MTXBUF.makeRotationZ(THREE.Math.degToRad(180)));e&&(e=e.clone(),this.flipScaleMatrix(e,l),d.multiplyMatrices(e.getInverse(e),d));return d}}();
THREE.SEA3D.prototype.flipDefaultAnimation=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Vector3,d=new THREE.Quaternion,g=new THREE.Vector3,e=new THREE.Vector3,l=new THREE.Quaternion,n=new THREE.Vector3;return function(B,E,s){if(!B.isFliped){for(var D=B.dataList,q=[],O=0;O<D.length;O++){var r=D[O],I=r.data,F=r.kind,r=I.length/r.blockSize;switch(F){case SEA3D.Animation.POSITION:case SEA3D.Animation.ROTATION:case SEA3D.Animation.SCALE:q.push({kind:F,numFrames:r,raw:I})}}if(0<q.length)for(r=
q[0].numFrames,I=void 0,s?(a.identity(),this.flipScaleMatrix(b.copy(E.matrixWorld))):(E.parent&&(I=this.flipScaleMatrix(b.copy(E.parent.matrixWorld))),this.flipScaleMatrix(a.copy(E.matrix),!1,I)),a.decompose(c,d,g),E=0;E<r;E++){for(s=0;s<q.length;s++)switch(I=q[s].raw,F=q[s].kind,F){case SEA3D.Animation.POSITION:F=3*E;c.set(I[F],I[F+1],I[F+2]);break;case SEA3D.Animation.ROTATION:F=4*E;d.set(I[F],I[F+1],I[F+2],I[F+3]);break;case SEA3D.Animation.SCALE:F=4*E,g.set(I[F],I[F+1],I[F+2])}a.compose(c,d,g);
this.flipScaleMatrix(a,!1,b);a.decompose(e,l,n);for(s=0;s<q.length;s++)switch(I=q[s].raw,F=q[s].kind,F){case SEA3D.Animation.POSITION:F=3*E;I[F]=e.x;I[F+1]=e.y;I[F+2]=e.z;break;case SEA3D.Animation.ROTATION:F=4*E;I[F]=l.x;I[F+1]=l.y;I[F+2]=l.z;I[F+3]=l.w;break;case SEA3D.Animation.SCALE:F=3*E,I[F]=n.x,I[F+1]=n.y,I[F+2]=n.z}}B.isFliped=!0}}}();THREE.SEA3D.prototype.readAnimation=function(a){this.isLegacy(a)||this._readAnimation(a)};
THREE.SEA3D.prototype.getModifier=function(a){var b=a.sea;if(this.isLegacy(b)&&!b.done)switch(b.done=!0,b.type){case SEA3D.SkeletonAnimation.prototype.type:return this.readSkeletonAnimationLegacy(b,a.skeleton),b.tag;case SEA3D.Animation.prototype.type:case SEA3D.MorphAnimation.prototype.type:case SEA3D.UVWAnimation.prototype.type:return a.scope instanceof THREE.Object3D&&this.flipDefaultAnimation(b,a.scope,a.relative),this._readAnimation(b),b.tag;case SEA3D.Morph.prototype.type:this.readMorphLegacy(b,
a.geometry)}return this._getModifier(a)};
THREE.SEA3D.prototype.updateTransform=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4;return function(c,d){this.isLegacy(d)?(d.transform?a.fromArray(d.transform):a.makeTranslation(d.position.x,d.position.y,d.position.z),this.flipScaleMatrix(a,!1,c.parent?c.parent.matrixWorld:b,c.parent instanceof THREE.Bone),c.position.setFromMatrixPosition(a),c.scale.setFromMatrixScale(a),a.scale(THREE.SEA3D.VECBUF.set(1/c.scale.x,1/c.scale.y,1/c.scale.z)),c.rotation.setFromRotationMatrix(a),c.updateMatrixWorld()):
this._updateTransform(c,d)}}();
THREE.SEA3D.prototype.readSkeleton=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Vector3,g=new THREE.Quaternion;return function(e){for(var l=[],n=e.sea3d.config.legacy,B=0;B<e.joint.length;B++){var E=e.joint[B];a.fromArray(E.inverseBindMatrix);b.getInverse(a);n&&this.flipBoneMatrix(b);-1<E.parentIndex&&(a.fromArray(e.joint[E.parentIndex].inverseBindMatrix),c.getInverse(a),n&&this.flipBoneMatrix(c),c.getInverse(c),b.multiplyMatrices(c,b));d.setFromMatrixPosition(b);
g.setFromRotationMatrix(b);l[B]={name:E.name,pos:[d.x,d.y,d.z],rotq:[g.x,g.y,g.z,g.w],parent:E.parentIndex}}this.domain.bones=this.bones=this.bones||[];this.bones.push(this.objects[e.name+".sklq"]=e.tag=l);return l}}();
THREE.SEA3D.prototype.readSkeletonAnimationLegacy=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Matrix4;return function(g,e){if(g.tag)return g.tag;for(var l=[],n=1E3/g.frameRate/1E3,B=[1,1,1],E=0;E<g.sequence.length;E++){for(var s=g.sequence[E],D=s.start,q=D+s.count,O={name:s.name,repeat:s.repeat,fps:g.frameRate,JIT:0,length:n*s.count,hierarchy:[]},r=g.numJoints,I=g.raw,F=0;F<r;F++){for(var T=e.joint[F],N={parent:T.parentIndex,keys:[]},$=N.keys,L=0,ka=D;ka<
q;ka++){var na=ka*r*7+7*F;b.makeRotationFromQuaternion(THREE.SEA3D.QUABUF.set(I[na+3],I[na+4],I[na+5],I[na+6]));b.setPosition(THREE.SEA3D.VECBUF.set(I[na],I[na+1],I[na+2]));-1<T.parentIndex?(a.fromArray(e.joint[T.parentIndex].inverseBindMatrix),d.getInverse(a),c.multiplyMatrices(d,b),this.flipBoneMatrix(c),this.flipBoneMatrix(d),d.getInverse(d),b.multiplyMatrices(d,c)):this.flipBoneMatrix(b);var na=THREE.SEA3D.VECBUF.setFromMatrixPosition(b),Ja=THREE.SEA3D.QUABUF.setFromRotationMatrix(b);$.push({time:L,
pos:[na.x,na.y,na.z],rot:[Ja.x,Ja.y,Ja.z,Ja.w],scl:B});L+=n}O.hierarchy[F]=N}l.push(THREE.SEA3D.AnimationClip.fromClip(THREE.AnimationClip.parseAnimation(O,e.tag),s.repeat))}this.domain.clips=this.clips=this.clips||[];this.clips.push(this.objects[g.name+".anm"]=g.tag=l)}}();THREE.SEA3D.prototype.readMorphLegacy=function(a,b){for(var c=0;c<a.node.length;c++){var d=a.node[c];this.flipVec3(d.vertex);this.flipVec3(d.normal);this.addVector(d.vertex,b.vertex);this.addVector(d.normal,b.normal)}this._readMorph(a)};
THREE.SEA3D.prototype.readMorph=function(a){this.isLegacy(a)||this._readMorph(a)};THREE.SEA3D.prototype.readVertexAnimation=function(a){if(this.isLegacy(a))for(var b=0,c=a.frame.length;b<c;b++){var d=a.frame[b];this.flipVec3(d.vertex);this.flipVec3(d.normal)}this._readVertexAnimation(a)};
THREE.SEA3D.prototype.readGeometryBuffer=function(a){this.isLegacy(a)&&(this.flipVec3(a.vertex),this.flipVec3(a.normal),this.flipIndexes(a.indexes),4<a.jointPerVertex?this.compressJoints(a):4>a.jointPerVertex&&this.expandJoints(a));this._readGeometryBuffer(a)};THREE.SEA3D.prototype.readLines=function(a){this.isLegacy(a)&&this.flipVec3(a.vertex);this._readLines(a)};THREE.SEA3D.prototype.onHead=function(a){if("S3D"!=a.sign&&"TJS"!=a.sign)throw Error("Sign '"+a.sign+"' unknown.");};
THREE.SEA3D.EXTENSIONS_LOADER.push({setTypeRead:function(){this.config.legacy=void 0==this.config.legacy?!0:this.config.legacy;this.file.typeRead[SEA3D.Skeleton.prototype.type]=this.readSkeleton}});
SEA3D.GeometryGC=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;var d=b.readUShort();a=[];var g,e;this.isBig=0!=(d&1);b.readVInt=this.isBig?b.readUInt:b.readUShort;if(d&2){this.groups=[];var l=b.readUByte(),n=0;for(c=0;c<l;c++){var B=3*b.readVInt();this.groups.push({start:n,count:B});n+=B}}else this.groups=[];if(d&4)for(this.uv=[],l=b.readUByte(),c=0;c<l;c++)a[c]=b.readUByte();d&32&&(g=b.readUByte(),e=b.readUByte());c=b.readUInt();c=b.concat(b.position,c);b=new o3dgc.BinaryStream(c.buffer);
d=new o3dgc.SC3DMCDecoder;l=new o3dgc.IndexedFaceSet;d.DecodeHeader(l,b);c=l.GetNCoordIndex();n=l.GetNCoord();this.groups.length||this.groups.push({start:0,count:3*c});this.indexes=this.isBig?new Uint32Array(3*c):new Uint16Array(3*c);this.vertex=new Float32Array(3*n);l.SetCoordIndex(this.indexes);l.SetCoord(this.vertex);0<l.GetNNormal()&&(this.normal=new Float32Array(3*n),l.SetNormal(this.normal));for(c=0;c<a.length;c++)this.uv[c]=new Float32Array(2*n),l.SetFloatAttribute(a[c],this.uv[c]);void 0!==
g&&(this.jointPerVertex=l.GetIntAttributeDim(g),this.joint=new Uint16Array(n*this.jointPerVertex),this.weight=new Float32Array(n*this.jointPerVertex),l.SetIntAttribute(g,this.joint),l.SetFloatAttribute(e,this.weight));d.DecodePlayload(l,b)};SEA3D.GeometryGC.prototype.type="s3D";SEA3D.GeometryUpdateGC=function(a,b,c){this.name=a;this.data=b;this.sea3d=c;this.index=b.readUInt();this.bytes=b.concat(b.position,b.length-b.position)};SEA3D.GeometryUpdateGC.prototype.type="us3D";
THREE.SEA3D.prototype.readGeometryUpdateGC=function(a){var b=this.file.objects[a.index].tag;a=new SEA3D.GeometryGC("",a.bytes,a.sea3d);a.tag=b;this.readGeometryBuffer(a)};THREE.SEA3D.EXTENSIONS_LOADER.push({setTypeRead:function(){this.file.addClass(SEA3D.GeometryGC,!0);this.file.addClass(SEA3D.GeometryUpdateGC,!0);this.file.typeRead[SEA3D.GeometryGC.prototype.type]=this.readGeometryBuffer;this.file.typeRead[SEA3D.GeometryUpdateGC.prototype.type]=this.readGeometryUpdateGC}});var TWEEN=TWEEN||function(){var a=[];return{getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},update:function(b,c){if(0===a.length)return!1;var d=0;for(b=void 0!==b?b:TWEEN.now();d<a.length;)a[d].update(b)||c?d++:a.splice(d,1);return!0}}}();
TWEEN.now="undefined"===typeof window&&"undefined"!==typeof process?function(){var a=process.hrtime();return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now.bind(window.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};
TWEEN.Tween=function(a){var b={},c={},d={},g=1E3,e=0,l,n=!1,B=!1,E=0,s=null,D=TWEEN.Easing.Linear.None,q=TWEEN.Interpolation.Linear,O=[],r=null,I=!1,F=null,T=null,N=null;this.to=function(a,b){c=a;void 0!==b&&(g=b);return this};this.start=function(e){TWEEN.add(this);B=!0;I=!1;s=void 0!==e?e:TWEEN.now();s+=E;for(var g in c){if(c[g]instanceof Array){if(0===c[g].length)continue;c[g]=[a[g]].concat(c[g])}void 0!==a[g]&&(b[g]=a[g],!1===b[g]instanceof Array&&(b[g]*=1),d[g]=b[g]||0)}return this};this.stop=
function(){if(!B)return this;TWEEN.remove(this);B=!1;null!==N&&N.call(a,a);this.stopChainedTweens();return this};this.end=function(){this.update(s+g);return this};this.stopChainedTweens=function(){for(var a=0,b=O.length;a<b;a++)O[a].stop()};this.delay=function(a){E=a;return this};this.repeat=function(a){e=a;return this};this.repeatDelay=function(a){l=a;return this};this.yoyo=function(a){n=a;return this};this.easing=function(a){D=a;return this};this.interpolation=function(a){q=a;return this};this.chain=
function(){O=arguments;return this};this.onStart=function(a){r=a;return this};this.onUpdate=function(a){F=a;return this};this.onComplete=function(a){T=a;return this};this.onStop=function(a){N=a;return this};this.update=function(B){var L,N,na;if(B<s)return!0;!1===I&&(null!==r&&r.call(a,a),I=!0);N=(B-s)/g;N=1<N?1:N;na=D(N);for(L in c)if(void 0!==b[L]){var Ja=b[L]||0,ea=c[L];ea instanceof Array?a[L]=q(ea,na):("string"===typeof ea&&(ea="+"===ea.charAt(0)||"-"===ea.charAt(0)?Ja+parseFloat(ea):parseFloat(ea)),
"number"===typeof ea&&(a[L]=Ja+(ea-Ja)*na))}null!==F&&F.call(a,na);if(1===N)if(0<e){isFinite(e)&&e--;for(L in d)"string"===typeof c[L]&&(d[L]+=parseFloat(c[L])),n&&(N=d[L],d[L]=c[L],c[L]=N),b[L]=d[L];s=void 0!==l?B+l:B+E}else{null!==T&&T.call(a,a);B=0;for(L=O.length;B<L;B++)O[B].start(s+g);return!1}return!0}};
TWEEN.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a:-0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*
a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?0.5*Math.pow(1024,a-1):0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-
Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-0.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-0.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):0.5*Math.pow(2,-10*(a-1))*Math.sin(5*
(a-1.1)*Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-TWEEN.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},InOut:function(a){return 0.5>a?0.5*TWEEN.Easing.Bounce.In(2*
a):0.5*TWEEN.Easing.Bounce.Out(2*a-1)+0.5}}};
TWEEN.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,g=Math.floor(d),e=TWEEN.Interpolation.Utils.Linear;return 0>b?e(a[0],a[1],d):1<b?e(a[c],a[c-1],c-d):e(a[g],a[g+1>c?c:g+1],d-g)},Bezier:function(a,b){for(var c=0,d=a.length-1,g=Math.pow,e=TWEEN.Interpolation.Utils.Bernstein,l=0;l<=d;l++)c+=g(1-b,d-l)*g(b,l)*a[l]*e(d,l);return c},CatmullRom:function(a,b){var c=a.length-1,d=c*b,g=Math.floor(d),e=TWEEN.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(g=Math.floor(d=c*(1+b))),e(a[(g-
1+c)%c],a[g],a[(g+1)%c],a[(g+2)%c],d-g)):0>b?a[0]-(e(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(e(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):e(a[g?g-1:0],a[g],a[c<g+1?c:g+1],a[c<g+2?c:g+2],d-g)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=TWEEN.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var d=b;1<d;d--)c*=d;return a[b]=c}}(),CatmullRom:function(a,b,c,d,g){a=0.5*(c-a);d=0.5*(d-b);var e=
g*g;return(2*b-2*c+a+d)*g*e+(-3*b+3*c-2*a-d)*e+a*g+b}}};(function(a){"function"===typeof define&&define.amd?define([],function(){return TWEEN}):"undefined"!==typeof module&&"object"===typeof exports?module.exports=TWEEN:void 0!==a&&(a.TWEEN=TWEEN)})(this);THREE.OrbitControls=function(a,b){function c(){return Math.pow(0.95,r.zoomSpeed)}function d(a){r.object instanceof THREE.PerspectiveCamera?Ja/=a:r.object instanceof THREE.OrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*a)),r.object.updateProjectionMatrix(),eb=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function g(a){r.object instanceof THREE.PerspectiveCamera?Ja*=a:r.object instanceof
THREE.OrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/a)),r.object.updateProjectionMatrix(),eb=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function e(a){if(!1!==r.enabled){a.preventDefault();if(a.button===r.mouseButtons.ORBIT){if(!1===r.enableRotate)return;Ta.set(a.clientX,a.clientY);$=N.ROTATE}else if(a.button===r.mouseButtons.ZOOM){if(!1===r.enableZoom)return;Ia.set(a.clientX,a.clientY);
$=N.DOLLY}else if(a.button===r.mouseButtons.PAN){if(!1===r.enablePan)return;ya.set(a.clientX,a.clientY);$=N.PAN}$!==N.NONE&&(document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",n,!1),r.dispatchEvent(F))}}function l(a){!1!==r.enabled&&(a.preventDefault(),$===N.ROTATE?!1!==r.enableRotate&&(P.set(a.clientX,a.clientY),Pa.subVectors(P,Ta),a=r.domElement===document?r.domElement.body:r.domElement,na.theta-=2*Math.PI*Pa.x/a.clientWidth*r.rotateSpeed,na.phi-=2*Math.PI*Pa.y/a.clientHeight*
r.rotateSpeed,Ta.copy(P),r.update()):$===N.DOLLY?!1!==r.enableZoom&&(Fa.set(a.clientX,a.clientY),Ea.subVectors(Fa,Ia),0<Ea.y?d(c()):0>Ea.y&&g(c()),Ia.copy(Fa),r.update()):$===N.PAN&&!1!==r.enablePan&&(sa.set(a.clientX,a.clientY),qa.subVectors(sa,ya),Ga(qa.x,qa.y),ya.copy(sa),r.update()))}function n(a){!1!==r.enabled&&(document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",n,!1),r.dispatchEvent(T),$=N.NONE)}function B(a){!1===r.enabled||!1===r.enableZoom||$!==N.NONE&&
$!==N.ROTATE||(a.preventDefault(),a.stopPropagation(),0>a.deltaY?g(c()):0<a.deltaY&&d(c()),r.update(),r.dispatchEvent(F),r.dispatchEvent(T))}function E(a){if(!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan)switch(a.keyCode){case r.keys.UP:Ga(0,r.keyPanSpeed);r.update();break;case r.keys.BOTTOM:Ga(0,-r.keyPanSpeed);r.update();break;case r.keys.LEFT:Ga(r.keyPanSpeed,0);r.update();break;case r.keys.RIGHT:Ga(-r.keyPanSpeed,0),r.update()}}function s(a){if(!1!==r.enabled){switch(a.touches.length){case 1:if(!1===
r.enableRotate)return;Ta.set(a.touches[0].pageX,a.touches[0].pageY);$=N.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom)return;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;b=Math.sqrt(b*b+a*a);Ia.set(0,b);$=N.TOUCH_DOLLY;break;case 3:if(!1===r.enablePan)return;ya.set(a.touches[0].pageX,a.touches[0].pageY);$=N.TOUCH_PAN;break;default:$=N.NONE}$!==N.NONE&&r.dispatchEvent(F)}}function D(a){if(!1!==r.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:if(!1===
r.enableRotate)break;if($!==N.TOUCH_ROTATE)break;P.set(a.touches[0].pageX,a.touches[0].pageY);Pa.subVectors(P,Ta);var b=r.domElement===document?r.domElement.body:r.domElement;na.theta-=2*Math.PI*Pa.x/b.clientWidth*r.rotateSpeed;na.phi-=2*Math.PI*Pa.y/b.clientHeight*r.rotateSpeed;Ta.copy(P);r.update();break;case 2:if(!1===r.enableZoom)break;if($!==N.TOUCH_DOLLY)break;b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;b=Math.sqrt(b*b+a*a);Fa.set(0,b);Ea.subVectors(Fa,Ia);
0<Ea.y?g(c()):0>Ea.y&&d(c());Ia.copy(Fa);r.update();break;case 3:if(!1===r.enablePan)break;if($!==N.TOUCH_PAN)break;sa.set(a.touches[0].pageX,a.touches[0].pageY);qa.subVectors(sa,ya);Ga(qa.x,qa.y);ya.copy(sa);r.update();break;default:$=N.NONE}}function q(a){!1!==r.enabled&&(r.dispatchEvent(T),$=N.NONE)}function O(a){a.preventDefault()}this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=
Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=!1;this.dampingFactor=0.25;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotate=!0;this.rotateSpeed=1;this.enablePan=!0;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.enableKeys=!0;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();
this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return ka.phi};this.getAzimuthalAngle=function(){return ka.theta};this.reset=function(){r.target.copy(r.target0);r.object.position.copy(r.position0);r.object.zoom=r.zoom0;r.object.updateProjectionMatrix();r.dispatchEvent(I);r.update();$=N.NONE};this.update=function(){var b=new THREE.Vector3,c=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),d=c.clone().inverse(),e=new THREE.Vector3,
g=new THREE.Quaternion;return function(){var a=r.object.position;b.copy(a).sub(r.target);b.applyQuaternion(c);ka.setFromVector3(b);r.autoRotate&&$===N.NONE&&(na.theta-=2*Math.PI/60/60*r.autoRotateSpeed);ka.theta+=na.theta;ka.phi+=na.phi;ka.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,ka.theta));ka.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,ka.phi));ka.makeSafe();ka.radius*=Ja;ka.radius=Math.max(r.minDistance,Math.min(r.maxDistance,ka.radius));r.target.add(ea);b.setFromSpherical(ka);
b.applyQuaternion(d);a.copy(r.target).add(b);r.object.lookAt(r.target);!0===r.enableDamping?(na.theta*=1-r.dampingFactor,na.phi*=1-r.dampingFactor):na.set(0,0,0);Ja=1;ea.set(0,0,0);return eb||e.distanceToSquared(r.object.position)>L||8*(1-g.dot(r.object.quaternion))>L?(r.dispatchEvent(I),e.copy(r.object.position),g.copy(r.object.quaternion),eb=!1,!0):!1}}();this.dispose=function(){r.domElement.removeEventListener("contextmenu",O,!1);r.domElement.removeEventListener("mousedown",e,!1);r.domElement.removeEventListener("wheel",
B,!1);r.domElement.removeEventListener("touchstart",s,!1);r.domElement.removeEventListener("touchend",q,!1);r.domElement.removeEventListener("touchmove",D,!1);document.removeEventListener("mousemove",l,!1);document.removeEventListener("mouseup",n,!1);window.removeEventListener("keydown",E,!1)};var r=this,I={type:"change"},F={type:"start"},T={type:"end"},N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},$=N.NONE,L=1E-6,ka=new THREE.Spherical,na=new THREE.Spherical,Ja=1,ea=
new THREE.Vector3,eb=!1,Ta=new THREE.Vector2,P=new THREE.Vector2,Pa=new THREE.Vector2,ya=new THREE.Vector2,sa=new THREE.Vector2,qa=new THREE.Vector2,Ia=new THREE.Vector2,Fa=new THREE.Vector2,Ea=new THREE.Vector2,J=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0);a.multiplyScalar(-b);ea.add(a)}}(),Q=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,1);a.multiplyScalar(b);ea.add(a)}}(),Ga=function(){var a=new THREE.Vector3;return function(b,
c){var d=r.domElement===document?r.domElement.body:r.domElement;if(r.object instanceof THREE.PerspectiveCamera){a.copy(r.object.position).sub(r.target);var e=a.length(),e=e*Math.tan(r.object.fov/2*Math.PI/180);J(2*b*e/d.clientHeight,r.object.matrix);Q(2*c*e/d.clientHeight,r.object.matrix)}else r.object instanceof THREE.OrthographicCamera?(J(b*(r.object.right-r.object.left)/r.object.zoom/d.clientWidth,r.object.matrix),Q(c*(r.object.top-r.object.bottom)/r.object.zoom/d.clientHeight,r.object.matrix)):
(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();r.domElement.addEventListener("contextmenu",O,!1);r.domElement.addEventListener("mousedown",e,!1);r.domElement.addEventListener("wheel",B,!1);r.domElement.addEventListener("touchstart",s,!1);r.domElement.addEventListener("touchend",q,!1);r.domElement.addEventListener("touchmove",D,!1);window.addEventListener("keydown",E,!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);
THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;
Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},
set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");
return!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");
return this.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=a}}});THREE.OrbitControlsExtra=function(a,b){THREE.OrbitControls.call(this,a,b);this.followTarget=null;this.cam={isFollow:!1,rotationOffset:180,heightOffset:4,acceleration:0.05,speed:10,distance:10,v:new THREE.Vector3,s:new THREE.Spherical};this.followGroup=new THREE.Group};
THREE.OrbitControlsExtra.prototype=Object.assign(Object.create(THREE.OrbitControls.prototype),{constructor:THREE.OrbitControlsExtra,resetFollow:function(){this.followTarget=null},follow:function(){if(null!==this.followTarget){this.stopMoveCam();var a=this.cam;this.enabled=!1;a.isFollow=!0;var b=(new THREE.Matrix4).makeRotationFromQuaternion(this.followTarget.quaternion),b=Math.atan2(b.elements[8],b.elements[10]),b=a.rotationOffset*THREE.Math.DEG2RAD+b;a.v.copy(this.followTarget.position);a.v.add({x:Math.sin(b)*
a.distance,y:a.heightOffset,z:Math.cos(b)*a.distance});a.v.sub(this.object.position);a.v.multiply({x:2*a.acceleration,y:a.acceleration,z:2*a.acceleration});b=a.v;if(b.x>a.speed||b.x<-a.speed)b.x=1>b.x?-a.speed:a.speed;if(b.y>a.speed||b.y<-a.speed)b.y=1>b.y?-a.speed:a.speed;if(b.z>a.speed||b.z<-a.speed)b.z=1>b.z?-a.speed:a.speed;this.object.position.add(a.v);this.target.copy(this.followTarget.position);this.object.lookAt(this.target);this.updateFollowGroup()}},getInfo:function(){this.update();var a=
this.target;return{x:a.x,y:a.y,z:a.z,distance:Math.floor(this.object.position.distanceTo(a)),phi:-Math.floor(this.getPolarAngle()*THREE.Math.RAD2DEG)+90,theta:Math.floor(this.getAzimuthalAngle()*THREE.Math.RAD2DEG)}},stopMoveCam:function(){null!==this.camTween&&(TWEEN.remove(this.camTween),this.camTween=null)},moveCam:function(a,b){var c=this,d=this.getInfo();if(a.constructor===Array){var g={};a[0]&&(g.azim=a[0]);a[1]&&(g.polar=a[1]);a[2]&&(g.distance=a[2]);a[3]&&(g.x=a[3][0],g.y=a[3][1],g.z=a[3][2]);
a=g}a.x=void 0!==a.x?a.x:0;a.y=void 0!==a.y?a.y:0;a.z=void 0!==a.z?a.z:0;a.phi=void 0!==a.phi?a.phi:0;a.theta=void 0!==a.theta?a.theta:0;a.phi=void 0!==a.polar?a.polar:a.phi;a.theta=void 0!==a.azim?a.azim:a.theta;this.enabled=!1;if(0===a.time){for(var e in a)d[e]=a[e];this.stopMoveCam();this.orbit(d);this.enabled=!0}else b=b||function(){},this.camTween=(new TWEEN.Tween(d)).to(a,a.time||2E3).delay(a.delay||0).easing(a.tween||TWEEN.Easing.Quadratic.Out).onUpdate(function(){c.orbit(d)}).onComplete(function(){c.enabled=
!0;b()}).start()},orbit:function(a){var b=this.cam;b.s.set(a.distance,(-a.phi+90)*THREE.Math.DEG2RAD,a.theta*THREE.Math.DEG2RAD);b.s.makeSafe();this.target.set(a.x,a.y,a.z);this.object.position.copy(this.target).setFromSpherical(b.s);this.object.lookAt(this.target);this.updateFollowGroup()},updateFollowGroup:function(){this.followGroup.position.copy(this.target);this.followGroup.position.y=0}});THREE.BVHLoader=function(a){this.animateBoneRotations=this.animateBonePositions=!0;this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.BVHLoader.prototype={constructor:THREE.BVHLoader,load:function(a,b,c,d){var g=this,e=new THREE.FileLoader(g.manager);e.setResponseType("arraybuffer");e.load(a,function(a){b(g.parse(a))},c,d)},parse:function(a){function b(a,c,d){if("ENDSITE"!==d.type){var e={time:c,position:{x:0,y:0,z:0},rotation:new THREE.Quaternion};d.frames.push(e);for(var g=new THREE.Quaternion,l=new THREE.Vector3(1,0,0),n=new THREE.Vector3(0,1,0),I=new THREE.Vector3(0,0,1),F=0;F<d.channels.length;++F)switch(d.channels[F]){case "Xposition":e.position.x=
parseFloat(a.shift().trim());break;case "Yposition":e.position.y=parseFloat(a.shift().trim());break;case "Zposition":e.position.z=parseFloat(a.shift().trim());break;case "Xrotation":g.setFromAxisAngle(l,parseFloat(a.shift().trim())*Math.PI/180);e.rotation.multiply(g);break;case "Yrotation":g.setFromAxisAngle(n,parseFloat(a.shift().trim())*Math.PI/180);e.rotation.multiply(g);break;case "Zrotation":g.setFromAxisAngle(I,parseFloat(a.shift().trim())*Math.PI/180);e.rotation.multiply(g);break;default:throw"invalid channel type";
}for(F=0;F<d.children.length;++F)b(a,c,d.children[F])}}function c(a,b,d){var e={name:"",type:"",frames:[]};d.push(e);b=b.split(/[\s]+/);"END"===b[0].toUpperCase()&&"SITE"===b[1].toUpperCase()?(e.type="ENDSITE",e.name="ENDSITE"):(e.name=b[1],e.type=b[0].toUpperCase());if("{"!=g(a))throw"Expected opening { after type & name";b=g(a).split(/[\s]+/);if("OFFSET"!==b[0])throw"Expected OFFSET, but got: "+b[0];if(4!=b.length)throw"OFFSET: Invalid number of values";b={x:parseFloat(b[1]),y:parseFloat(b[2]),
z:parseFloat(b[3])};if(isNaN(b.x)||isNaN(b.y)||isNaN(b.z))throw"OFFSET: Invalid values";e.offset=b;if("ENDSITE"!=e.type){b=g(a).split(/[\s]+/);if("CHANNELS"!=b[0])throw"Expected CHANNELS definition";var l=parseInt(b[1]);e.channels=b.splice(2,l);e.children=[]}for(;;){b=g(a);if("}"===b)return e;e.children.push(c(a,b,d))}}function d(a,b){var c=new THREE.Bone;b.push(c);c.position.add(a.offset);c.name=a.name;if("ENDSITE"!=a.type)for(var e=0;e<a.children.length;++e)c.add(d(a.children[e],b));return c}function g(a){for(var b;0===
(b=a.shift().trim()).length;);return b}var e=this,l="";a=new Uint8Array(a);for(var n=0;n<a.length;++n)l+=String.fromCharCode(a[n]);a=function(a){if("HIERARCHY"!==g(a))throw"HIERARCHY expected";var d=[],e=c(a,g(a),d);if("MOTION"!=g(a))throw"MOTION  expected";var l=g(a).split(/[\s]+/),n=parseInt(l[1]);if(isNaN(n))throw"Failed to read number of frames.";var l=g(a).split(/[\s]+/),O=parseFloat(l[2]);if(isNaN(O))throw"Failed to read frame time.";for(var r=0;r<n;++r)l=g(a).split(/[\s]+/),b(l,r*O,e,d);return d}(l.split(/[\r\n]+/g));
l=[];d(a[0],l);a=function(a){for(var b=[],c=0;c<a.length;++c){var d=a[c];if("ENDSITE"!=d.type){for(var g=[],l=[],n=[],I=0;I<d.frames.length;++I){var F=d.frames[I];g.push(F.time);l.push(F.position.x+d.offset.x);l.push(F.position.y+d.offset.y);l.push(F.position.z+d.offset.z);n.push(F.rotation.x);n.push(F.rotation.y);n.push(F.rotation.z);n.push(F.rotation.w)}e.animateBonePositions&&b.push(new THREE.VectorKeyframeTrack(".bones["+d.name+"].position",g,l));e.animateBoneRotations&&b.push(new THREE.QuaternionKeyframeTrack(".bones["+
d.name+"].quaternion",g,n))}}return new THREE.AnimationClip("animation",-1,b)}(a);return{skeleton:new THREE.Skeleton(l),clip:a}}};var intro=function(){intro=function(){};var a,b;intro.init=function(c){a=document.createElement("img");a.style.cssText="position:absolute; margin:0; padding:0; top:50%; left:50%; width:300px; height:220px; margin-left:-150px; margin-top:-110px; display:block; pointer-events:none; ";a.src="assets/textures/logo.png";document.body.appendChild(a);b=document.createElement("div");b.style.cssText="text-align:center; position:absolute; margin:0; padding:0; top:50%; left:50%; width:300px; height:20px; margin-left:-150px; margin-top:110px; display:block; pointer-events:none; font-size: 12px;";
b.textContent=c||"loading...";document.body.appendChild(b)};intro.opacity=function(c){a.style.opacity=c;b.style.opacity=c};intro.clear=function(){(new TWEEN.Tween({a:1})).to({a:0},2E3).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){intro.opacity(this.a)}).onComplete(function(){intro.dispose()}).start()};intro.dispose=function(){document.body.removeChild(a);document.body.removeChild(b)};intro.message=function(a){b.innerHTML=a};return intro}();var user=function(){var a,b=!1;user={key:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],init:function(){a=new user.Gamepad(user.key);document.addEventListener("keydown",user.keyDown,!1);document.addEventListener("keyup",user.keyUp,!1)},update:function(){a.update();a.ready&&(b||(b=!0),a.getValue(0))},keyDown:function(b){if(!editor.getFocus()){var d=user.key;b=b||window.event;switch(b.which){case 65:case 81:d[0]=-1;break;case 68:d[0]=1;break;case 87:case 90:d[1]=-1;break;case 83:d[1]=1;break;case 37:d[2]=
-1;break;case 39:d[2]=1;break;case 38:d[3]=-1;break;case 40:d[3]=1;break;case 32:d[4]=1;break;case 17:case 67:d[5]=1;break;case 69:d[5]=1;break;case 16:d[7]=1}a.reset();b.preventDefault();b.stopPropagation()}},keyUp:function(a){if(!editor.getFocus()){var b=user.key;a=a||window.event;switch(a.which){case 65:case 81:b[0]=0>b[0]?0:b[0];break;case 68:b[0]=0<b[0]?0:b[0];break;case 87:case 90:b[1]=0>b[1]?0:b[1];break;case 83:b[1]=0<b[1]?0:b[1];break;case 37:b[2]=0>b[2]?0:b[2];break;case 39:b[2]=0<b[2]?
0:b[2];break;case 38:b[3]=0>b[3]?0:b[3];break;case 40:b[3]=0<b[3]?0:b[3];break;case 32:b[4]=0;break;case 17:case 67:b[5]=0;break;case 69:b[5]=0;break;case 16:b[7]=0}a.preventDefault();a.stopPropagation()}},getGamepad:function(){return b},Gamepad:function(a){this.values=[];this.key=a;this.ready=0}};user.Gamepad.prototype={update:function(){var a,b,g,e,l,n,B=this.fix,E=navigator.getGamepads();for(a=0;a<E.length;a++)if(n=E[a])if(g=n.axes.length,e=n.buttons.length){this.values[a]||(this.values[a]=[]);
for(b=0;b<g;b++)l=B(n.axes[b],0.08),0==this.ready&&0!==l&&(this.ready=1),this.values[a][b]=l;for(b=0;b<e;b++)l=B(n.buttons[b].value),0==this.ready&&0!==l&&(this.ready=1),this.values[a][g+b]=l}else this.values[a]&&(this.values[a]=null)},getValue:function(a){for(var b=19,g;b--;)g=this.values[a][b],0==this.ready&&0!==g&&(this.ready=1),this.key[b]=g},reset:function(){this.ready=0},fix:function(a,b){var g=Number(a.toString().substring(0,5));b&&g<b&&g>-b&&(g=0);return g}};return user}();var SimplexNoise=function(a){void 0==a&&(a=Math);this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],
[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]];this.p=[];for(var b=0;256>b;b++)this.p[b]=Math.floor(256*a.random());this.perm=[];for(b=0;512>b;b++)this.perm[b]=this.p[b&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,
3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(a,b,c){return a[0]*b+a[1]*c};SimplexNoise.prototype.dot3=function(a,b,c,d){return a[0]*b+a[1]*c+a[2]*d};
SimplexNoise.prototype.dot4=function(a,b,c,d,g){return a[0]*b+a[1]*c+a[2]*d+a[3]*g};
SimplexNoise.prototype.noise=function(a,b){var c,d,g;g=0.5*(Math.sqrt(3)-1);g*=a+b;var e=Math.floor(a+g),l=Math.floor(b+g),n=(3-Math.sqrt(3))/6;g=(e+l)*n;c=a-(e-g);var B=b-(l-g),E,s;c>B?(E=1,s=0):(E=0,s=1);d=c-E+n;var D=B-s+n;g=c-1+2*n;var n=B-1+2*n,q=e&255,l=l&255,e=this.perm[q+this.perm[l]]%12;E=this.perm[q+E+this.perm[l+s]]%12;s=this.perm[q+1+this.perm[l+1]]%12;l=0.5-c*c-B*B;0>l?c=0:(l*=l,c=l*l*this.dot(this.grad3[e],c,B));B=0.5-d*d-D*D;0>B?d=0:(B*=B,d=B*B*this.dot(this.grad3[E],d,D));D=0.5-g*
g-n*n;0>D?g=0:(D*=D,g=D*D*this.dot(this.grad3[s],g,n));return 70*(c+d+g)};
SimplexNoise.prototype.noise3d=function(a,b,c){var d,g,e,l=1/3*(a+b+c),n=Math.floor(a+l),B=Math.floor(b+l),E=Math.floor(c+l),l=1/6;e=(n+B+E)*l;d=a-(n-e);g=b-(B-e);var s=c-(E-e),D,q,O,r,I,F;d>=g?g>=s?(D=1,O=q=0,I=r=1,F=0):(d>=s?(D=1,O=q=0):(q=D=0,O=1),r=1,I=0,F=1):g<s?(q=D=0,O=1,r=0,F=I=1):d<s?(D=0,q=1,r=O=0,F=I=1):(D=0,q=1,O=0,I=r=1,F=0);var T=d-D+l,N=g-q+l,$=s-O+l;e=d-r+2*l;a=g-I+2*l;var L=s-F+2*l;c=d-1+3*l;b=g-1+3*l;var l=s-1+3*l,n=n&255,ka=B&255,na=E&255,B=this.perm[n+this.perm[ka+this.perm[na]]]%
12,E=this.perm[n+D+this.perm[ka+q+this.perm[na+O]]]%12;r=this.perm[n+r+this.perm[ka+I+this.perm[na+F]]]%12;n=this.perm[n+1+this.perm[ka+1+this.perm[na+1]]]%12;I=0.6-d*d-g*g-s*s;0>I?d=0:(I*=I,d=I*I*this.dot3(this.grad3[B],d,g,s));g=0.6-T*T-N*N-$*$;0>g?g=0:(g*=g,g=g*g*this.dot3(this.grad3[E],T,N,$));T=0.6-e*e-a*a-L*L;0>T?e=0:(T*=T,e=T*T*this.dot3(this.grad3[r],e,a,L));a=0.6-c*c-b*b-l*l;0>a?c=0:(a*=a,c=a*a*this.dot3(this.grad3[n],c,b,l));return 32*(d+g+e+c)};
SimplexNoise.prototype.noise4d=function(a,b,c,d){var g=this.grad4,e=this.simplex,l=this.perm,n=(Math.sqrt(5)-1)/4,B=(5-Math.sqrt(5))/20,E,s,n=(a+b+c+d)*n,D=Math.floor(a+n),q=Math.floor(b+n),O=Math.floor(c+n),r=Math.floor(d+n),n=(D+q+O+r)*B;a-=D-n;E=b-(q-n);s=c-(O-n);var I=d-(r-n);d=(a>E?32:0)+(a>s?16:0)+(E>s?8:0)+(a>I?4:0)+(E>I?2:0)+(s>I?1:0);var F,T,N,$,L,ka,na,Ja,ea,eb,Ta,P;F=3<=e[d][0]?1:0;T=3<=e[d][1]?1:0;N=3<=e[d][2]?1:0;$=3<=e[d][3]?1:0;L=2<=e[d][0]?1:0;ka=2<=e[d][1]?1:0;na=2<=e[d][2]?1:0;Ja=
2<=e[d][3]?1:0;ea=1<=e[d][0]?1:0;eb=1<=e[d][1]?1:0;Ta=1<=e[d][2]?1:0;P=1<=e[d][3]?1:0;var Pa=a-F+B,ya=E-T+B,sa=s-N+B,qa=I-$+B,Ia=a-L+2*B,Fa=E-ka+2*B,Ea=s-na+2*B,J=I-Ja+2*B;b=a-ea+3*B;var n=E-eb+3*B,Q=s-Ta+3*B,Ga=I-P+3*B,e=a-1+4*B;d=E-1+4*B;c=s-1+4*B;var B=I-1+4*B,D=D&255,q=q&255,Z=O&255,r=r&255,O=l[D+l[q+l[Z+l[r]]]]%32;F=l[D+F+l[q+T+l[Z+N+l[r+$]]]]%32;L=l[D+L+l[q+ka+l[Z+na+l[r+Ja]]]]%32;ea=l[D+ea+l[q+eb+l[Z+Ta+l[r+P]]]]%32;l=l[D+1+l[q+1+l[Z+1+l[r+1]]]]%32;r=0.6-a*a-E*E-s*s-I*I;0>r?a=0:(r*=r,a=r*r*
this.dot4(g[O],a,E,s,I));E=0.6-Pa*Pa-ya*ya-sa*sa-qa*qa;0>E?E=0:(E*=E,E=E*E*this.dot4(g[F],Pa,ya,sa,qa));s=0.6-Ia*Ia-Fa*Fa-Ea*Ea-J*J;0>s?s=0:(s*=s,s=s*s*this.dot4(g[L],Ia,Fa,Ea,J));Ia=0.6-b*b-n*n-Q*Q-Ga*Ga;0>Ia?b=0:(Ia*=Ia,b=Ia*Ia*this.dot4(g[ea],b,n,Q,Ga));n=0.6-e*e-d*d-c*c-B*B;0>n?g=0:(n*=n,g=n*n*this.dot4(g[l],e,d,c,B));return 27*(a+E+s+b+g)};var now;(function(a){var b,c=["now","webkitNow","msNow","mozNow"];if(a.performance)for(var d=0;d<c.length;++d){var g=c[d];if(a.performance[g]){b=function(){return a.performance[g]()};break}}b||(b=Date.now);now=b})(window);Math.torad=0.017453292519943295;Math.todeg=57.29577951308232;Math.Pi=3.141592653589793;Math.TwoPI=6.283185307179586;Math.PI90=1.570796326794896;Math.PI270=4.712388980384689;Math.inv255=0.003921569;Math.golden=10.166407384630519;Math.int=function(a){return Math.floor(a)};
Math.lerp=function(a,b,c){return(1-c)*a+c*b};Math.rand=function(a,b){return a+Math.random()*(b-a)};Math.randInt=function(a,b){return a+Math.floor(Math.random()*(b-a+1))};Math.seed=function(a){return function(){a=1E4*Math.sin(a);return a-Math.floor(a)}};Math.seed1=Math.seed(32);Math.seed2=Math.seed(Math.seed1());Math.ranSeed=Math.seed(Math.seed2());Math.randFix=function(a,b){return a+Math.ranSeed()*(b-a)};Math.randIntFix=function(a,b){return a+Math.floor(Math.ranSeed()*(b-a+1))};
Math.distanceVector=function(a,b){var c=b.x-a.x,d=b.y-a.y,g=b.z-a.z;return Math.sqrt(c*c+d*d+g*g)};Math.clamp=function(a,b,c){a=a<b?b:a;return a>c?c:a};Math.norm=function(a,b,c){return(a-b)/(c-b)};Math.linear=function(a,b,c){return(1-a)*b+a*c};Math.cubicSCurve=function(a){return a*a*(3-2*a)};Math.quinticSCurve=function(a){var b=a*a*a,c=b*a;return 6*c*a-15*c+10*b};Math.vectorad=function(a){for(var b=a.length;b--;)a[b]*=Math.torad;return a};
Math.unwrapDeg=function(a){a%=360;180<a&&(a-=360);-180>a&&(a+=360);return a};Math.unwrapRad=function(a){a%=Math.TwoPI;a>Math.Pi&&(a-=Math.TwoPI);a<-Math.Pi&&(a+=Math.TwoPI);return a};Math.rot2d=function(a,b,c){a=a||{x:0,y:0};var d={};d.x=b*Math.cos(c*Math.torad)+a.x;d.y=b*Math.sin(c*Math.torad)+a.y;d.z=a.z;return d};Math.dist2d=function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)};Math.colorDistance=function(a,b){var c=a[0]-b[0],d=a[1]-b[1],g=a[2]-b[2];return Math.sqrt(c*c+d*d+g*g)};
Math.rgbToHex=function(a){return"0x"+("000000"+(255*a[0]<<16^255*a[1]<<8^255*a[2]<<0).toString(16)).slice(-6)};Math.hslToRgb=function(a,b,c){a/=255;b/=255;c/=255;if(0==b)c=b=a=c;else{var d=0.5>c?c*(1+b):c+b-c*b,g=2*c-d;c=Math.hue2rgb(g,d,a+1/3);b=Math.hue2rgb(g,d,a);a=Math.hue2rgb(g,d,a-1/3)}return[Math.round(255*c),Math.round(255*b),Math.round(255*a)]};Math.hue2rgb=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a};
Math.rgbToHsl=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.max(a,b,c),g=Math.min(a,b,c),e,l=0.5*(d+g);if(d==g)e=g=0;else{var n=d-g,g=0.5<l?n/(2-d-g):n/(d+g);switch(d){case a:e=(b-c)/n+(b<c?6:0);break;case b:e=(c-a)/n+2;break;case c:e=(a-b)/n+4}e/=6}return[Math.round(255*e),Math.round(255*g),Math.round(255*l)]};
Math.orbit=function(a,b,c,d,g){var e={x:0,y:0,z:0};void 0===d&&(d={x:0,y:0,z:0});b*=Math.torad;a*=Math.torad;g?(e.x=c*Math.cos(b)*Math.cos(a),e.z=c*Math.cos(b)*Math.sin(a),e.y=c*Math.sin(b)):(e.x=c*Math.sin(b)*Math.cos(a),e.z=c*Math.sin(b)*Math.sin(a),e.y=c*Math.cos(b));void 0!==d&&(e.x+=d.x,e.y+=d.y,e.z+=d.z);return e};Math.sphericalToUv=function(a){var b={u:0,v:0};b.u=0.5+Math.atan2(a.x,a.z)/Math.TwoPI;b.v=0.5+Math.asin(a.y)/Math.Pi;return b};
Math.spherical=function(a){var b={lat:0,lon:0},c=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);b.lat=Math.asin(a.y/c)*Math.todeg;b.lon=Math.atan2(a.z,a.x)*Math.todeg;return b};Math.perlin=null;Math.noise=function(a,b){null===Math.perlin&&(Math.perlin=new SimplexNoise);b=b||{};var c=b.level||[1,0.2,0.05],d=b.frequency||[0.016,0.05,0.2],g,e,l=0,n=0;for(g=0;g<c.length;g++)e=d[g],l+=c[g]*(0.5+0.5*Math.perlin.noise3d(a.x*e,a.y*e,a.z*e)),n+=c[g];return l/n};var pool=function(){var a={},b=null,c=null,d=window.URL||window.webkitURL,g=0,e=0;return pool={load:function(a,d){b=[];g=("undefined"===typeof performance?Date:performance).now();"string"==typeof a||a instanceof String?b.push(a):b=b.concat(a);c=d||function(){};this.loadOne()},setAssetLoadTechnique:function(a){this.loading=a},reset:function(){c=a=null},get:function(b){return a[b]},getResult:function(){return a},meshByName:function(b){b=a[b];for(var c={},d=b.length;d--;)c[b[d].name]=b[d];return c},
getMesh:function(b,c){for(var d=a[b],e=d.length;e--;)if(d[e].name===c)return d[e]},next:function(){b.shift();0===b.length?(e=("undefined"===typeof performance?Date:performance).now()-g,console.log("loading time v2:",Math.floor(e),"ms"),c(a)):this.loadOne()},loadOne:function(){var a=b[0],c=a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".")),d=a.substring(a.lastIndexOf(".")+1);this.loading(a,c,d)},progress:function(a,b){},loading:function(a,b,c){var d=this,e=new XMLHttpRequest;e.open("GET",a,!0);switch(c){case "sea":case "z":case "bvh":case "BVH":case "wasm":e.responseType=
"arraybuffer";break;case "jpg":case "png":e.responseType="blob"}e.onprogress=function(a){a.lengthComputable&&d.progress(a.loaded,a.total)};e.onreadystatechange=function(){2!==e.readyState&&3!==e.readyState&&4===e.readyState&&(200===e.status||0===e.status?d.load_direct(e.response,b,c):console.error("Couldn't load ["+b+"] ["+e.status+"]"))};e.send(null)},load_direct:function(b,c,e){var g=this;switch(e){case "sea":var s=new THREE.SEA3D;s.onComplete=function(b){a[c]=s.meshes;g.next()};s.load(b);break;
case "jpg":case "png":var D=new Image;D.onload=function(b){d.revokeObjectURL(D.src);a[c]=D;g.next()};D.src=d.createObjectURL(b);break;case "z":a[c]=SEA3D.File.LZMAUncompress(b);g.next();break;case "bvh":case "BVH":a[c]=b;g.next();break;case "glsl":a[c]=b;g.next();break;case "json":a[c]=JSON.parse(b);g.next();break;case "wasm":a[c]=new Uint8Array(b),g.next()}},load_blob:function(b,c,d){var e=this,g=new FileReader;"png"===d||"jpg"===d?g.readAsDataURL(b):"json"===d||"glsl"===d?g.readAsText(b):g.readAsArrayBuffer(b);
g.onload=function(b){switch(d){case "sea":var g=new THREE.SEA3D;g.onComplete=function(b){a[c]=g.meshes;e.next()};g.load(b.target.result);break;case "jpg":case "png":a[c]=new Image;a[c].src=b.target.result;e.next();break;case "z":a[c]=SEA3D.File.LZMAUncompress(b.target.result);e.next();break;case "bvh":case "BVH":a[c]=b.target.result;e.next();break;case "glsl":a[c]=b.target.result;e.next();break;case "json":a[c]=JSON.parse(b.target.result),e.next()}}}}}();var editor=function(){var a,b,c,d,g,e,l,n=function(){},B=!1,E=!1,s=[],D=[],q=null,O=0,r=0,I="",F="#DE5825",T,N=[],$,L=!1,ka=!0,na=!1,Ja=!1,ea="",eb,Ta;return editor={init:function(q,r,s,D){F=s||"#DE5825";void 0!==D&&(ea=D);editor.createClass(".menuButtonBig","font-size: 11px; font-weight: 500; height: 30px; padding: 4px; padding-top: 10px; background: none; pointer-events:auto; cursor: pointer; text-align: left; display: inline-block; width:110px;");editor.createClass(".menuButtonBig:hover","color:"+
F);editor.createClass(".bigButton","border: 1px solid #3f3f3f; background: #151515; color:#3998d6; width:70px; height:30px; font-size: 16px; font-weight: 500; text-align: center; pointer-events:auto; line-height: 28px; cursor:pointer; display: inline-block; margin-left: 40px; margin-right: -20px; border-radius: 3px;");q&&(n=q);ka=r||!1;T=document.createElement("div");T.style.cssText="position: absolute; padding-top:40px; background: rgba(0,0,0,0); border-bottom:  1px solid rgba(255, 255, 255, 0);";
document.body.appendChild(T);this.makeBigMenu();q=document.createElement("div");q.style.cssText="position:absolute; right:0; top:0; width:1px; height:1px; pointer-events:none;";q.innerHTML="<svg width='80' height='80' viewBox='0 0 250 250' style='fill:rgba(256,256,256,0.1); color:#151515; position: absolute; top: 0; border: 0; right: 0;'>\n<path d='M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z' id='octo' onmouseover='editor.Gover();' onmouseout='editor.Gout();' onmousedown='editor.Gdown();'></path>\n<path d='M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2' fill='currentColor' style='transform-origin: 130px 106px;' id='octo-arm'></path>\n<path d='M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z' fill='currentColor' id='octo-body'></path></svg>";
document.body.appendChild(q);eb=document.getElementById("octo");Ta=document.getElementById("octo-arm");e=document.createElement("div");e.style.cssText="font-size: 9px; position:absolute; padding-left: 40px; bottom: 40px;";document.body.appendChild(e);l=document.createElement("div");l.style.cssText="position:absolute; font-size: 16px; font-style: normal; font-variant: normal; font-weight: 500; bottom: 55px; padding-left: 40px;";document.body.appendChild(l);a=document.createElement("div");a.style.cssText=
"position:absolute; background:none; pointer-events:none; top:0; left:0; width:50%; height:100%;";document.body.appendChild(a);b=document.createElement("div");b.style.cssText="position:absolute; background:none; pointer-events:none; display:block; left:0px; top:40px; width:100%; background:none; padding-top:10px; padding-left:10px; height:calc(100% - 40px);";a.appendChild(b);c=CodeMirror(b,{lineNumbers:!0,matchBrackets:!0,indentWithTabs:!1,styleActiveLine:!0,theme:"monokai",mode:"text/javascript",
tabSize:4,indentUnit:4,highlightSelectionMatches:{showToken:/\w/}});d=document.createElement("div");d.style.cssText="position:absolute; background:none; pointer-events:auto; display:block;  border-left:1px solid #3f3f3f; border-right:1px solid #3f3f3f; left:calc(50% - 5px); top:0px; width:10px; height:100%; color: rgba(255, 255, 255, 0.2);  cursor: e-resize;";document.body.appendChild(d);g=document.createElement("div");g.style.cssText="position:absolute; top : 0px; left: 0px; width: 100%; padding-left: 10px; padding-top: 9px; font-size: 16px; font-weight: 500; line-height: 23px; height: 40px; background: none; border-bottom:1px solid #3f3f3f; overflow: hidden;";
a.appendChild(g);a.style.display="none";d.style.display="none";c.on("change",function(){editor.onChange()});c.on("focus",function(){E=!0;view.needFocus()});c.on("blur",function(){E=!1});c.on("drop",function(){B?B=!1:c.setValue("")});c.on("dragstart",function(){B=!0});ka&&(O=~~(0.4*window.innerWidth),a.style.display="block",d.style.display="block",this.addSeparatorEvent(),this.resize());T.style.width=window.innerWidth-O+"px"},addSeparatorEvent:function(){d.addEventListener("mouseover",editor.mid_over,
!1);d.addEventListener("mouseout",editor.mid_out,!1);d.addEventListener("mousedown",editor.mid_down,!1)},removeSeparatorEvent:function(){d.removeEventListener("mouseover",editor.mid_over,!1);d.removeEventListener("mouseout",editor.mid_out,!1);d.removeEventListener("mousedown",editor.mid_down,!1)},selectCode:function(){ka?editor.hide():editor.show()},hide:function(){ka=!1;a.style.display="none";d.style.display="none";r=O;O=0;this.removeSeparatorEvent();editor.Bdefault(N[1]);editor.resize()},show:function(){ka=
!0;a.style.display="block";d.style.display="block";O=r?r:Math.floor(0.4*window.innerWidth);this.addSeparatorEvent();editor.resize()},resizeMenu:function(a){T&&(T.style.width=a+"px")},resize:function(b){b&&(O=b.clientX+10);view&&(view.setLeft(O),view.resize());T.style.left=O+"px";l.style.left=O+"px";e.style.left=O+"px";d.style.left=O-10+"px";a.style.width=O-10+"px";c.refresh()},tell:function(a){e.textContent=a},makeBigMenu:function(){T.style.width=window.innerWidth-O+"px";N[0]=document.createElement("div");
N[0].className="bigButton";T.appendChild(N[0]);N[0].innerHTML="DEMO";N[0].addEventListener("click",editor.selectBigMenu,!1);N[0].name="demo";N[0].style.color=F;N[1]=document.createElement("div");N[1].className="bigButton";T.appendChild(N[1]);N[1].innerHTML="CODE";N[1].addEventListener("click",editor.selectCode,!1);N[1].name="code";N[1].style.color=F;N[2]=document.createElement("div");N[2].className="bigButton";T.appendChild(N[2]);N[2].innerHTML="&#9654;";N[2].style.width="30px";N[2].addEventListener("click",
editor.pause,!1);N[2].name="pause";N[2].style.color=F;$=document.createElement("div");$.style.cssText="padding: 10px 40px; width:100%; display: block;";T.appendChild($);for(var a=N.length;a--;)N[a].addEventListener("mouseover",editor.Bover,!1),N[a].addEventListener("mouseout",editor.Bout,!1)},pause:function(a){a.preventDefault();Ja?(N[2].innerHTML="&#9654;",Ja=!1):(N[2].innerHTML="&#10074;&#10074;",Ja=!0)},selectBigMenu:function(a){a.preventDefault();L?editor.hideBigMenu():editor.showBigMenu()},showBigMenu:function(){T.style.background=
"rgba(21,21,21,0.75)";T.style.borderBottom="1px solid #3f3f3f";L=!0;for(var a=demos.length,b,c=0;c<a;c++)b=demos[c],b!==I&&editor.addButtonBig(demos[c])},hideBigMenu:function(){T.style.background="none";T.style.borderBottom="none";L=!1;for(var a=$.childNodes.length,b;a--;)b=$.childNodes[a],b.removeEventListener("click",editor.demoClick),$.removeChild(b);editor.Bdefault(N[0])},addButtonBig:function(a){var b=document.createElement("div");b.className="menuButtonBig";$.appendChild(b);b.innerHTML="&bull; "+
a.charAt(0).toUpperCase()+a.substring(1).toLowerCase();b.name=a;b.addEventListener("click",editor.demoClick,!1)},demoClick:function(a){a.preventDefault();editor.hideBigMenu();editor.load("demos/"+a.target.name+".js")},Bover:function(a){a.preventDefault();a.target.style.border="1px solid "+F;a.target.style.background=F;a.target.style.color="#000000"},Bout:function(a){a.preventDefault();var b=0;"code"==a.target.name&&ka&&(b=1);"demo"==a.target.name&&L&&(b=1);b?(a.target.style.border="1px solid #3f3f3f",
a.target.style.background="#3f3f3f",a.target.style.color="#999999"):editor.Bdefault(a.target)},Bdefault:function(a){a.style.border="1px solid #3f3f3f";a.style.background="#151515";a.style.color=F},Gover:function(){eb.setAttribute("fill",F);Ta.style.webkitAnimationName="octocat-wave";Ta.style.webkitAnimationDuration="560ms"},Gout:function(){eb.setAttribute("fill","rgba(256,256,256,0.1)");Ta.style.webkitAnimationName="none"},setLink:function(a){ea=a},Gdown:function(){ea&&window.location.assign("https://github.com/lo-th/"+
ea)},mid_over:function(a){a.preventDefault();d.style.background="#5f5f5f"},mid_out:function(a){a.preventDefault();na||(d.style.background="none")},mid_down:function(a){a.preventDefault();na=!0;document.addEventListener("mouseup",editor.mid_up,!1);document.addEventListener("mousemove",editor.resize,!1)},mid_up:function(){na=!1;document.removeEventListener("mouseup",editor.mid_up,!1);document.removeEventListener("mousemove",editor.resize,!1)},load:function(a){I=a.substring(a.indexOf("/")+1,a.indexOf("."));
var b=new XMLHttpRequest;b.overrideMimeType("text/plain; charset=x-user-defined");b.open("GET",a,!0);b.onload=function(){c.setValue(b.responseText)};b.send()},unFocus:function(){c.getInputField().blur();view.haveFocus()},refresh:function(){c.refresh()},getFocus:function(){return E},validate:function(a){return c.operation(function(){for(;0<s.length;)c.removeLineClass(s.shift(),"background","errorLine");for(var b=D.length;b--;)c.removeLineWidget(D[b]);D.length=0;try{for(var d=esprima.parse(a,{tolerant:!0}).errors,
b=d.length;b--;){var e=d[b],g=document.createElement("div");g.className="esprima-error";g.textContent=e.message.replace(/Line [0-9]+: /,"");var l=e.lineNumber-1;s.push(l);c.addLineClass(l,"background","errorLine");var n=c.addLineWidget(l,g);D.push(n)}}catch(q){g=document.createElement("div"),g.className="esprima-error",g.textContent=q.message.replace(/Line [0-9]+: /,""),l=q.lineNumber-1,s.push(l),c.addLineClass(l,"background","errorLine"),n=c.addLineWidget(l,g),D.push(n)}return 0===s.length})},onChange:function(){location.hash.substr(1);
clearTimeout(q);var a=c.getValue();this.validate(a)&&(q=setTimeout(function(){editor.inject(a)},0))},inject:function(a){location.hash=I;var b=document.createElement("script");b.language="javascript";b.type="text/javascript";b.text=a;document.getElementsByTagName("BODY").item(0).appendChild(b);g.innerHTML="&bull; "+I;l.innerHTML=I.charAt(0).toUpperCase()+I.substring(1).toLowerCase();n(I)},createClass:function(a,b){var c=document.createElement("style");c.type="text/css";document.getElementsByTagName("head")[0].appendChild(c);
(c.sheet||{}).insertRule?c.sheet.insertRule(a+"{"+b+"}",0):(c.styleSheet||c.sheet).addRule(a,b)}}}();
